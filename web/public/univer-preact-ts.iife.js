var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,e,n)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,__spreadValues=(t,e)=>{for(var n in e||(e={}))__hasOwnProp.call(e,n)&&__defNormalProp(t,n,e[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))__propIsEnum.call(e,n)&&__defNormalProp(t,n,e[n]);return t},__spreadProps=(t,e)=>__defProps(t,__getOwnPropDescs(e)),UniverPreactTs=function(t){"use strict";var e,n;(n=e||(e={}))[n.OBSERVER_ACTION=1]="OBSERVER_ACTION",n[n.SERVER_ACTION=2]="SERVER_ACTION",n[n.UNDO_ACTION=3]="UNDO_ACTION",n[n.EXTENSION_ACTION=4]="EXTENSION_ACTION",n[n.DEFAULT_ACTION=7]="DEFAULT_ACTION";class r{constructor(t,e){this._doActionData=t,this._observers=e,this._operation=1}getDoActionData(){return this._doActionData}getOldActionData(){return this._oldActionData}hasOperation(t){return(this._operation&t)===t}addOperation(t){this._operation|=t}removeOperation(t){this._operation&=~t}}class s{constructor(t=!1){this.isStopPropagation=!1,this.initialize(t)}initialize(t=!1){return this.skipNextObservers=t,this}stopPropagation(){this.isStopPropagation=!0}}class o{constructor(t){this.callback=t,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class i{constructor(t){this._observers=new Array,this._eventState=new s,t&&(this._onObserverAdded=t)}get observers(){return this._observers}add(t,e=!1,n=!1){if(!t)return null;const r=new o(t);return r.unregisterOnNextCall=n,e?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r}addOnce(t){return this.add(t,void 0,!0)}remove(t){if(!t)return!1;return-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0)}removeCallback(t){for(let e=0;e<this._observers.length;e++){const n=this._observers[e];if(!n._willBeUnregistered&&n.callback===t)return this._deferUnregister(n),!0}return!1}makeObserverTopPriority(t){this._remove(t),this._observers.unshift(t)}makeObserverBottomPriority(t){this._remove(t),this._observers.push(t)}notifyObservers(t){if(!this._observers.length)return null;const e=this._eventState;e.skipNextObservers=!1,e.lastReturnValue=t,e.isStopPropagation=!1;let n=!1;for(let r=0;r<this._observers.length;r++){const s=this._observers[r];if(!s._willBeUnregistered&&(e.lastReturnValue=s.callback(t,e),s.unregisterOnNextCall&&this._deferUnregister(s),e.isStopPropagation&&(n=!0),e.skipNextObservers))return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(t){let e=Promise.resolve(t);if(!this._observers.length)return e;const n=this._eventState;n.skipNextObservers=!1;for(let r=0;r<this._observers.length;r++){const s=this._observers[r];n.skipNextObservers||(s._willBeUnregistered||(e=e.then((()=>s.callback(t,n))),s.unregisterOnNextCall&&this._deferUnregister(s)))}return e.then((()=>t))}notifyObserver(t,e){if(t._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,t.callback(e,n),t.unregisterOnNextCall&&this._deferUnregister(t),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const t=new i;return t._observers=this._observers.slice(0),t}_deferUnregister(t){t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,setTimeout((()=>{this._remove(t)}),0)}_remove(t){if(!t)return!1;const e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)}}class a{constructor(t,e){this.name=t,this.observableHooks=e}}class l{constructor(){this._observableHooksArray=new Array}addHooks(t,e){this._observableHooksArray.push(new a(t,e))}getHooks(t){const e=this._observableHooksArray.find((e=>e.name===t));return e?e.observableHooks:null}}function h(t,e){let n=0,r=t.length-1;for(;n<=r;){let s=Math.floor((r+n)/2);if(e<t[s]&&(0===s||e>=t[s-1]))return s;if(e>=t[s])n=s+1;else{if(!(e<t[s]))return-1;r=s-1}}return-1}function c(t,e){let n=0,r=0,s=0,o=-1,i=t.length-1;for(;n<t.length&&i>=0&&i>=n;){if(r=t[i],s=0===i?0:t[i-1],e>=s&&e<r){o=i;break}if(r=t[n],s=0===n?0:t[n-1],e>=s&&e<r){o=n;break}n++,i--}return o}function d(t,e){let n=t.length-1;return n=t.length<40||e<=t[20]||e>=t[n-20]?c(t,e):h(t,e),n}const u=t=>null!=t,g=t=>{let e=Object.keys(t),n=/^\d+$/,r=0;for(let s=0;s<e.length;s++){let t=e[s];if(!n.test(t))return-1;let o=parseInt(t)+1;o>r&&(r=o)}return r};class p{constructor(...t){switch(t.length){case 0:return this._array={},void(this._length=0);case 1:{if("number"==typeof t[0])return this._array={},void(this._length=t[0]);const e=g(t[0]);if(e>-1)return this._array=t[0],void(this._length=e);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}case 2:if(g(t[0])>-1)return this._array=t[0],void(this._length=t[1]);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}}static objectKeys(t){if(t){const e=Object.keys(t),n=e.indexOf("length");return n>-1&&e.splice(n,1),e}return[]}static getMaxLength(t){if(t){if(t.length)return t.length;const e=p.objectKeys(t);if(e.length)return Math.max(...e)+1}return 0}obtain(t,e){var n;return null!=(n=this._array[t])?n:e}getKeys(){return p.objectKeys(this._array)}get(t){return this._array[t]}set(t,e){if(u(e)){const n=this._length;this._array[t]=e,t>=n&&(this._length=t+1)}}pop(){const t=this._length,e=this._array;if(t>0){const n=t-1,r=e[n];return n>0&&(delete e[n],this._length--),r}return null}push(t){if(u(t)){let e=this._length;this._array[e++]=t,this._length=e}}first(){return this._array[0]}last(){const t=this._length-1;return this._array[t]}shift(){const t=this._length;if(t>0){const e=this._array[0],n=t-1;let r;for(let t=0;t<n;t++)r=this._array[t+1],u(r)&&(this._array[t]=r);return this._length--,delete this._array[n],e}return null}unshift(t){if(u(t)){const e=this._length,n=this._array,r=e+1;let s=n[0];for(let t=1;t<r;t++){const e=this._array[t];u(s)&&(n[t]=s),s=e}n[0]=t,this._length=r}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const t=this._array;return Object.keys(t).length}toJSON(){return this._array}toArray(){const t=new Array,e=this._array,n=Object.keys(e),r=n.length;for(let s=0;s<r;s++){const r=+n[s];t[r]=e[r]}return t}forEach(t){const e=this._array,n=Object.keys(e),r=n.length;for(let s=0;s<r;s++){const r=+n[s];if(!1===t(r,e[r]))return this}return this}clone(t){const e=new p;return t?this.forEach(((n,r)=>{e.set(n,t(r))})):this.forEach(((t,n)=>{e.set(t,n)})),e}isEmpty(){const t=this._array;return 0===Object.keys(t).length}delete(t){this.splice(t,1)}includes(t){const e=this._array,n=Object.keys(e),r=n.length;for(let s=0;s<r;s++){if(e[+n[s]]===t)return!0}return!1}slice(t,e){const n=this._array;if(this._length>0){const r={};let s=0;for(let o=t;o<e;o++){const t=n[o];u(t)&&(r[s]=n[o],s++)}return new p(r,s)}return new p}concat(t){const e=this._array,n=Object.keys(e),r=n.length,s=t._array,o=Object.keys(s),i=o.length,a=new p(r+i),l=a._array;let h=0;for(let c=0;c<r;c++,h++){const t=n[c];l[h]=e[t]}for(let c=0;c<i;c++,h++){const t=o[c];l[h]=s[t]}return a}find(t){const e=this._array,n=Object.keys(e),r=n.length;for(let s=0;s<r;s++){const r=+n[s],o=e[r];if(!0===t(r,o))return o}return null}splice(t,e){const n=this._length;if(n>0){const r=t+e,s=this._array;let o=0;const i={};for(let e=t;e<r;e++){const t=s[e];u(t)&&(delete s[e],i[o]=t,o++)}const a=r-t,l=n;if(this._length-=a,this._length<=0)this._array={},this._length=0;else for(let t=r;t<l;t++){const e=s[t];u(e)&&(s[t-a]=s[t],delete s[t])}return new p(i,o)}return new p}findIndex(t){const e=this._array,n=Object.keys(e),r=n.length;for(let s=0;s<r;s++){const r=+n[s];if(!0===t(r,e[r]))return s}return-1}map(t){const e=this._array,n=Object.keys(e),r=n.length,s={};for(let o=0;o<r;o++){const r=e[+n[o]];s[o]=t(r)}return new p(s)}filter(t){const e=this._array,n=Object.keys(e),r=n.length,s={};let o=0;for(let i=0;i<r;i++){const r=+n[i],a=e[r];t(r,a)&&(s[o]=a,o++)}return new p(s,o)}insert(t,e){const n=this._length,r=this._array;for(let s=n-1;s>=t;s--)r[s+1]=r[s];return r[t]=e,this._length=n+1,this}inserts(t,e){const n=e._array,r=e._length,s=this._array;for(let o=this._length-1;o>=t;o--){const t=s[o];u(t)&&(delete s[o],s[o+r]=t)}for(let o=0;o<r;o++){const e=n[o];u(e)&&(s[o+t]=n[o])}return this._length+=r,this}[Symbol.iterator](){return new _(this)}}class _{constructor(t){this._array=t,this._keys=t.getKeys(),this._cursor=0}next(){const t=this._array,e=this._keys,n=this._cursor;if(n<e.length){const r=e[n],s=t.get(+r);return this._cursor++,{value:s,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new _(this._array)}}class m{constructor(t={}){this._matrix=t,this._option=new p(t)}static MakeObjectMatrixSize(t){return new m({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const r=+e[n];if(!1===t(r,this.getRow(r)))return this}return this}forValue(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const r=+e[n],s=this.getRow(r),o=s.getKeys(),i=o.length;for(let e=0;e<i;e++){const n=+o[e];if(!1===t(r,n,s.get(n)))return this}}return this}swapRow(t,e){const n=this._option.get(t),r=this._option.get(e);this._option.set(e,n),this._option.set(t,r)}getRow(t){let e=this._option.get(t);if(e)return new p(e)}getRowOrCreate(t){let e=this.getRow(t);if(null==e){let e={};return this._option.set(t,e),new p(e)}return e}reset(){this._matrix={}}hasValue(){const t=this._option;for(const e of t)if(!new p(e).isEmpty())return!0;return!1}getValue(t,e){const n=this.getRow(t);return n?n.get(e):null}setValue(t,e,n){this.getRowOrCreate(t).set(e,n)}deleteValue(t,e){const n=this.getRow(t);n&&n.delete(e)}spliceRows(t,e){const n=this._option.splice(t,e);return new m(n.toJSON())}pushRow(t){this._option.push(t.toJSON())}insertRow(t,e){this._option.insert(t,e.toJSON())}insertRows(t,e){this._option.inserts(t,e._option),console.dir(this._option)}spliceColumns(t,e){const n=new m;return this._option.forEach(((r,s)=>{for(let i=t;i<t+e;i++)n.setValue(r,i-t,this.getValue(r,i));let o=this._option.get(r);o&&new p(o).splice(t,e)})),n}insertColumns(t,e){let n=0;e.forEach((t=>{const r=e.getRow(t);if(r)return n=r.getLength(),!1})),this.forEach(((r,s)=>{var o,i;for(let a=t;a<t+n;a++)null==(o=e.getRow(r))||o.get(a-t),s.insert(a,null==(i=e.getRow(r))?void 0:i.get(a-t))}))}getFragments(t,e,n,r){const s=new m;for(let o=t;o<=e;o++){const t=new p;for(let e=n;e<=r;e++){const n=this.getValue(o,e);t.push(n)}s.pushRow(t)}return s}getSizeOf(){return this._option.getSizeOf()}getLength(){return this._option.getLength()}getRange(){const t=this.getSizeOf();let e=0;const n=this.getLength();for(let r=0;r<n;r++){const t=this.getRow(r);if(t){const n=t.getSizeOf();t.getSizeOf()>e&&(e=n-1)}}return{startRow:0,startColumn:0,endRow:t,endColumn:e}}toArray(){return this._option.toArray().map((t=>new p(t).toArray()))}toJSON(){return this._matrix}getData(){const t=JSON.stringify(this);return JSON.parse(t)}getArrayData(){let t=0,e=0,n=!1,r=!1;const s=new m;return this.forEach(((o,i)=>{n||(n=!0,t=o),i.forEach(((n,i)=>{r?n<e&&(e=n):(r=!0,e=n);const a=this.getValue(o,n);s.setValue(o-t,n-e,a)}))})),s.getData()}getDataRange(){let t=0,e=0,n=0,r=!1,s=!1;this.forEach(((o,i)=>{r||(r=!0,t=o);const a=i.getLength()-1;a>n&&(n=a),i.forEach(((t,n)=>{s?t<e&&(e=t):(s=!0,e=t)}))}));const o=t+this.getSizeOf()-1;return{startRow:t,startColumn:e,endRow:o,endColumn:n}}}const f=/^-ms-/,v=/-([a-z])/g,b=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class C{static stringAt(t){let e="",n=t;for(;n>=b.length;)n/=b.length,n-=1,e+=b[n%b.length];return e+=b[t%b.length],e}static getEnvironment(){const{appVersion:t}=navigator,e=this.getSystemType();return{app_version:t,os:e,os_version:e,device_id:"",platform:"web"}}static indexAt(t){let e=0;for(let n=0;n<t.length-1;n+=1){const r=t.charCodeAt(n)-65,s=t.length-1-n;e+=b.length**s+b.length*r}return e+=t.charCodeAt(t.length-1)-65,e}static deleteBlank(t){return C.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,e="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!e&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(e){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,e=t.indexOf("Opera")>-1,n=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!e,r=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,s=t.indexOf("Edge")>-1,o=t.indexOf("Firefox")>-1,i=t.indexOf("Safari")>-1&&-1===t.indexOf("Chrome"),a=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const e=parseFloat(RegExp.$1);return 7===e?"IE7":8===e?"IE8":9===e?"IE9":10===e?"IE10":"0"}return o?"FF":e?"Opera":i?"Safari":a?"Chrome":s?"Edge":r?"IE11":"Unknown browser"}static generateRandomId(t=21){return((t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_")),""))(t)}static getClassName(t){return t.constructor.name}static deepMerge(t,...e){function n(t,e){t.forEach(((t,s)=>{var o,i;if(C.isArray(t)){const r=null!=(o=e[s])?o:[];return e[s]=r,void n(t,r)}if(C.isObject(t)){const n=null!=(i=e[s])?i:{};return e[s]=n,void r(t,n)}e[s]=t}))}function r(t,e){Object.keys(t).forEach((s=>{var o,i;const a=t[s];if(C.isObject(a)){const t=null!=(o=e[s])?o:{};return e[s]=t,void r(a,t)}if(C.isArray(a)){const t=null!=(i=e[s])?i:[];return e[s]=t,void n(a,t)}e[s]=a}))}return e.forEach((e=>e&&function(e){Object.keys(e).forEach((s=>{var o,i;const a=e[s];if(C.isArray(a)){const e=null!=(o=t[s])?o:[];return t[s]=e,void n(a,e)}if(C.isObject(a)){const e=null!=(i=t[s])?i:{};return t[s]=e,void r(a,e)}t[s]=a}))}(e))),t}static numberFixed(t,e){return Number(Number(t).toFixed(e))}static diffValue(t,e){function n(r,s){return C.getValueType(r)===C.getValueType(s)&&(C.isArray(r)?function(r,s){if(t.length!==e.length)return!1;for(let t=0,e=r.length;t<e;t++){if(!n(r[t],s[t]))return!1}return!0}(r,s):C.isObject(r)?function(t,e){const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const o of r){if(!s.includes(o))return!1;if(!n(t[o],e[o]))return!1}return!0}(r,s):C.isDate(r)?r.getTime()===s.getTime():C.isRegExp(r)?r.toString()===s.toString():r===s)}return n(t,e)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const e=[];return t.forEach(((t,n)=>{e[n]=C.deepClone(t)})),e}if(this.isObject(t)){const e={};return Object.keys(t).forEach((n=>{const r=t[n];e[n]=C.deepClone(r)})),Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return null!=t}static isBlank(t){return!this.isDefine(t)||!!this.isString(t)&&""===t.trim()}static isAssignableFrom(t,e){return t instanceof e}static isBoolean(t){return"[object Boolean]"===this.getValueType(t)}static isPlainObject(t){return!!this.isDefine(t)&&Object.getPrototypeOf(t)===Object.getPrototypeOf({})}static isFunction(t){return"[object Function]"===this.getValueType(t)}static isDate(t){return"[object Date]"===this.getValueType(t)}static isRegExp(t){return"[object RegExp]"===this.getValueType(t)}static isArray(t){return"[object Array]"===this.getValueType(t)}static isString(t){return"[object String]"===this.getValueType(t)}static isNumber(t){return"[object Number]"===this.getValueType(t)}static isStringNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}static isObject(t){return"[object Object]"===this.getValueType(t)}static isEmptyObject(t){for(const e in t)return!1;return!0}static isMobile(){let t=0,e=0;return document.body.clientWidth&&(t=document.body.clientWidth),document.body.clientHeight&&(e=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||t<350&&e<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const t=navigator.userAgent.toLowerCase();return"micromessenger"===String(t.match(/MicroMessenger/i))}static isAndroid(){const t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(t){return e=>{for(let n=0;n<t;n++)e&&e()}}static hasLength(t,e){return!!C.isDefine(t)&&(C.isDefine(e)?t.length===e:t.length>0)}static capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}static fCamelCase(t,e){return e.toUpperCase()}static camelCase(t){return t.replace(f,"ms-").replace(v,this.fCamelCase)}static removeNull(t){if(this.isObject(t)){const e={};return Object.keys(t).forEach((e=>{const n=t[e];null==n?delete t[e]:C.removeNull(n)})),e}return t}static fillTwoDimensionalArray(t,e,n){return new Array(t).fill(n).map((t=>new Array(e).fill(n)))}static fillObjectMatrix(t,e,n){const r=new m;for(let s=0;s<t;s++)for(let t=0;t<e;t++)r.setValue(s,t,n);return r.getData()}static numToWord(t){let e="";for(;t>0;){let n=t%26;n=0===n?n=26:n,e=String.fromCharCode(96+n)+e,t=(t-n)/26}return e.toLocaleUpperCase()}static ABCatNum(t){if(null==t||0===t.length)return NaN;const e=t.toLowerCase().split(""),n=e.length;let r=0,s=0;for(let o=0;o<n;o++)s=e[o].charCodeAt(0)-96,r+=s*26**(n-o-1);return 0===r?NaN:r-1}static chatAtABC(t){const e="a".charCodeAt(0),n="z".charCodeAt(0)-e+1;let r="";for(;t>=0;)r=String.fromCharCode(t%n+e)+r,t=Math.floor(t/n)-1;return r.toUpperCase()}static randSort(t){for(let e=0,n=t.length;e<n;e++){const r=parseInt((Math.random()*n).toString()),s=t[r];t[r]=t[e],t[e]=s}return t}static commonExtend(t,e){let n={};for(let r in t)n[r]=t[r];for(let r in e)null!=e[r]&&(n[r]=e[r]);return n}static commonExtend1(t,e){for(let n in t)null==e[n]&&(e[n]=t[n]);return e}static arrayToObject(t){const e={};return t.forEach(((t,n)=>{e[n]={},t.forEach(((t,r)=>{e[n][r]=t}))})),e}}var T,w,S,E,y,R,I,A,O,N,M,x,k,D,L,P,B,H,F,U,z,W,V,Y,G,X,j,$,K,q,Z,J,Q,tt,et,nt,rt,st,ot,it,at,lt,ht,ct,dt,ut,gt,pt,_t,mt,ft,vt,bt,Ct,Tt,wt,St,Et,yt,Rt,It,At,Ot,Nt,Mt,xt,kt,Dt,Lt,Pt,Bt,Ht,Ft,Ut,zt,Wt,Vt,Yt,Gt,Xt,jt,$t,Kt,qt,Zt,Jt,Qt,te,ee,ne,re,se,oe,ie,ae,le,he,ce,de,ue,ge,pe,_e,me,fe,ve,be,Ce,Te,we,Se,Ee,ye,Re,Ie,Ae;(w=T||(T={}))[w.TAB=0]="TAB",w[w.SPACE=1]="SPACE",w[w.NOTHING=2]="NOTHING",(E=S||(S={}))[E.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",E[E.NONE=1]="NONE",E[E.DECIMAL=2]="DECIMAL",E[E.ZERO_DECIMAL=3]="ZERO_DECIMAL",E[E.UPPER_ALPHA=4]="UPPER_ALPHA",E[E.ALPHA=5]="ALPHA",E[E.UPPER_ROMAN=6]="UPPER_ROMAN",E[E.ROMAN=7]="ROMAN",(R=y||(y={}))[R.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",R[R.START=1]="START",R[R.CENTER=2]="CENTER",R[R.END=3]="END",(A=I||(I={}))[A.PARAGRAPH=0]="PARAGRAPH",A[A.TABLE=1]="TABLE",A[A.SECTION_BREAK=2]="SECTION_BREAK",A[A.CUSTOM=3]="CUSTOM",(N=O||(O={}))[N.DEFAULT=0]="DEFAULT",N[N.LINES=1]="LINES",N[N.LINES_AND_CHARS=2]="LINES_AND_CHARS",N[N.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",(x=M||(M={}))[x.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",x[x.CONTINUOUS=1]="CONTINUOUS",x[x.NEXT_PAGE=2]="NEXT_PAGE",x[x.EVEN_PAGE=3]="EVEN_PAGE",x[x.ODD_PAGE=4]="ODD_PAGE",(D=k||(k={}))[D.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",D[D.NONE=1]="NONE",D[D.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",(P=L||(L={}))[P.NORMAL=0]="NORMAL",P[P.TBRL=1]="TBRL",P[P.LRTBV=2]="LRTBV",(H=B||(B={}))[H.TEXT_RUN=0]="TEXT_RUN",H[H.AUTO_TEXT=1]="AUTO_TEXT",H[H.PAGE_BREAK=2]="PAGE_BREAK",H[H.COLUMN_BREAK=3]="COLUMN_BREAK",H[H.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",H[H.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",H[H.EQUATION=6]="EQUATION",H[H.DRAWING=7]="DRAWING",H[H.PERSON=8]="PERSON",H[H.RICH_LINK=9]="RICH_LINK",(U=F||(F={}))[U.BOTH_SIDES=0]="BOTH_SIDES",U[U.LEFT=1]="LEFT",U[U.RIGHT=2]="RIGHT",U[U.LARGEST=3]="LARGEST",(W=z||(z={}))[W.INLINE=0]="INLINE",W[W.WRAP_NONE=1]="WRAP_NONE",W[W.WRAP_POLYGON=2]="WRAP_POLYGON",W[W.WRAP_SQUARE=3]="WRAP_SQUARE",W[W.WRAP_THROUGH=4]="WRAP_THROUGH",W[W.WRAP_TIGHT=5]="WRAP_TIGHT",W[W.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",(Y=V||(V={}))[Y.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",Y[Y.NORMAL_TEXT=1]="NORMAL_TEXT",Y[Y.TITLE=2]="TITLE",Y[Y.SUBTITLE=3]="SUBTITLE",Y[Y.HEADING_1=4]="HEADING_1",Y[Y.HEADING_2=5]="HEADING_2",Y[Y.HEADING_3=6]="HEADING_3",Y[Y.HEADING_4=7]="HEADING_4",Y[Y.HEADING_5=8]="HEADING_5",Y[Y.HEADING_6=9]="HEADING_6",(X=G||(G={}))[X.AUTO=0]="AUTO",X[X.AT_LEAST=1]="AT_LEAST",X[X.EXACT=2]="EXACT",($=j||(j={}))[$.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",$[$.SOLID=1]="SOLID",$[$.DOT=2]="DOT",$[$.DASH=3]="DASH",(q=K||(K={}))[q.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",q[q.START=1]="START",q[q.CENTER=2]="CENTER",q[q.END=3]="END",(J=Z||(Z={})).EVENLY_DISTRIBUTED="0",J.FIXED_WIDTH="1",(tt=Q||(Q={}))[tt.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",tt[tt.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",tt[tt.TOP=2]="TOP",tt[tt.MIDDLE=3]="MIDDLE",tt[tt.BOTTOM=4]="BOTTOM",(nt=et||(et={})).NORMAL="normal",nt.BOLD="bold",nt.ITALIC="italic",(st=rt||(rt={}))[st.CHARACTER=0]="CHARACTER",st[st.COLUMN=1]="COLUMN",st[st.INSIDE_MARGIN=2]="INSIDE_MARGIN",st[st.LEFT_MARGIN=3]="LEFT_MARGIN",st[st.MARGIN=4]="MARGIN",st[st.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",st[st.PAGE=6]="PAGE",st[st.RIGHT_MARGIN=7]="RIGHT_MARGIN",(it=ot||(ot={}))[it.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",it[it.INSIDE_MARGIN=1]="INSIDE_MARGIN",it[it.LINE=2]="LINE",it[it.MARGIN=3]="MARGIN",it[it.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",it[it.PAGE=5]="PAGE",it[it.PARAGRAPH=6]="PARAGRAPH",it[it.TOP_MARGIN=7]="TOP_MARGIN",(lt=at||(at={}))[lt.POINT=0]="POINT",lt[lt.LINE=1]="LINE",lt[lt.CHARACTER=2]="CHARACTER",(ct=ht||(ht={}))[ct.CENTER=0]="CENTER",ct[ct.INSIDE=1]="INSIDE",ct[ct.LEFT=2]="LEFT",ct[ct.OUTSIDE=3]="OUTSIDE",ct[ct.RIGHT=4]="RIGHT",(ut=dt||(dt={}))[ut.BOTTOM=0]="BOTTOM",ut[ut.CENTER=1]="CENTER",ut[ut.INSIDE=2]="INSIDE",ut[ut.OUTSIDE=3]="OUTSIDE",ut[ut.TOP=4]="TOP",(pt=gt||(gt={}))[pt.compressPunctuation=0]="compressPunctuation",pt[pt.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",pt[pt.doNotCompress=2]="doNotCompress",(mt=_t||(_t={}))[mt.PORTRAIT=0]="PORTRAIT",mt[mt.LANDSCAPE=1]="LANDSCAPE",(vt=ft||(ft={})).INSERT_ROW_DATA_ACTION="InsertRowDataAction",vt.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",vt.INSERT_ROW_ACTION="InsertRowAction",vt.REMOVE_ROW_ACTION="RemoveRowAction",vt.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",vt.SET_SELECTION_ACTION="SetSelectionActivateAction",vt.SET_RANGE_DATA_ACTION="SetRangeDataAction",vt.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",vt.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",vt.DELETE_RANGE_ACTION="DeleteRangeAction",vt.INSERT_SHEET_ACTION="InsertSheetAction",vt.REMOVE_SHEET_ACTION="RemoveSheetAction",vt.CLEAR_RANGE_ACTION="ClearRangeAction",vt.INSERT_RANGE_ACTION="InsertRangeAction",vt.SET_TAB_COLOR_ACTION="SetTabColorAction",vt.HIDE_SHEET_ACTION="SetWorkSheetHideAction",vt.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",vt.INSERT_COLUMN_ACTION="InsertColumnAction",vt.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",vt.REMOVE_COLUMN_ACTION="RemoveColumnAction",vt.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",vt.SET_HIDE_ROW_ACTION="SetRowHideAction",vt.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",vt.SET_SHOW_ROW_ACTION="SetRowShowAction",vt.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",vt.ADD_MERGE_ACTION="AddMergeAction",vt.REMOVE_MERGE_ACTION="RemoveMergeAction",vt.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",vt.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",vt.SET_BORDER_ACTION="SetBorderAction",vt.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",vt.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",vt.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",vt.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",vt.DELETE_BANDING_ACTION="DeleteBandingAction",vt.SET_BANDING_ACTION="SetBandingAction",vt.ADD_BANDING_ACTION="AddBandingAction",vt.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",vt.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",vt.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",vt.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",vt.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",vt.SET_FROZEN_COLUMNS_ACTION="SetFrozenColumnsAction",vt.SET_FROZEN_ROWS_ACTION="SetFrozenRowsAction",(Ct=bt||(bt={}))[Ct.DEFAULT_SERIES=0]="DEFAULT_SERIES",Ct[Ct.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",(wt=Tt||(Tt={})).CELL_EMPTY="CELL_EMPTY",wt.CELL_NOT_EMPTY="CELL_NOT_EMPTY",wt.DATE_AFTER="DATE_AFTER",wt.DATE_BEFORE="DATE_BEFORE",wt.DATE_EQUAL_TO="DATE_EQUAL_TO",wt.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",wt.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",wt.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",wt.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",wt.NUMBER_BETWEEN="NUMBER_BETWEEN",wt.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",wt.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",wt.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",wt.NUMBER_LESS_THAN="NUMBER_LESS_THAN",wt.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",wt.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",wt.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",wt.TEXT_CONTAINS="TEXT_CONTAINS",wt.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",wt.TEXT_EQUAL_TO="TEXT_EQUAL_TO",wt.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",wt.TEXT_STARTS_WITH="TEXT_STARTS_WITH",wt.TEXT_ENDS_WITH="TEXT_ENDS_WITH",wt.CUSTOM_FORMULA="CUSTOM_FORMULA",(Et=St||(St={}))[Et.NONE=0]="NONE",Et[Et.THIN=1]="THIN",Et[Et.HAIR=2]="HAIR",Et[Et.DOTTED=3]="DOTTED",Et[Et.DASHED=4]="DASHED",Et[Et.DASH_DOT=5]="DASH_DOT",Et[Et.DASH_DOT_DOT=6]="DASH_DOT_DOT",Et[Et.DOUBLE=7]="DOUBLE",Et[Et.MEDIUM=8]="MEDIUM",Et[Et.MEDIUM_DASHED=9]="MEDIUM_DASHED",Et[Et.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",Et[Et.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",Et[Et.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",Et[Et.THICK=13]="THICK",(Rt=yt||(yt={})).TOP="top",Rt.BOTTOM="bottom",Rt.LEFT="left",Rt.RIGHT="right",Rt.NONE="none",Rt.ALL="all",Rt.OUTSIDE="outside",Rt.INSIDE="inside",Rt.HORIZONTAL="horizontal",Rt.VERTICAL="vertical",(At=It||(It={}))[At.UNSUPPORTED=0]="UNSUPPORTED",At[At.RGB=1]="RGB",At[At.HEX=2]="HEX",At[At.THEME=3]="THEME",(Nt=Ot||(Ot={}))[Nt.ON=0]="ON",Nt[Nt.OFF=1]="OFF",(xt=Mt||(Mt={}))[xt.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",xt[xt.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",xt[xt.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",xt[xt.NUMBER_LESS=3]="NUMBER_LESS",xt[xt.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",xt[xt.NUMBER_EQ=5]="NUMBER_EQ",xt[xt.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",xt[xt.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",xt[xt.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",xt[xt.TEXT_CONTAINS=9]="TEXT_CONTAINS",xt[xt.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",xt[xt.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",xt[xt.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",xt[xt.TEXT_EQ=13]="TEXT_EQ",xt[xt.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",xt[xt.TEXT_IS_URL=15]="TEXT_IS_URL",xt[xt.DATE_EQ=16]="DATE_EQ",xt[xt.DATE_BEFORE=17]="DATE_BEFORE",xt[xt.DATE_AFTER=18]="DATE_AFTER",xt[xt.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",xt[xt.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",xt[xt.DATE_BETWEEN=21]="DATE_BETWEEN",xt[xt.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",xt[xt.DATE_IS_VALID=23]="DATE_IS_VALID",xt[xt.ONE_OF_RANGE=24]="ONE_OF_RANGE",xt[xt.ONE_OF_LIST=25]="ONE_OF_LIST",xt[xt.BLANK=26]="BLANK",xt[xt.NOT_BLANK=27]="NOT_BLANK",xt[xt.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",xt[xt.BOOLEAN=29]="BOOLEAN",xt[xt.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",xt[xt.DATE_NOT_EQ=31]="DATE_NOT_EQ",(Dt=kt||(kt={}))[Dt.PASTE_NORMAL=0]="PASTE_NORMAL",Dt[Dt.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",Dt[Dt.PASTE_FORMAT=2]="PASTE_FORMAT",Dt[Dt.PASTE_FORMULA=3]="PASTE_FORMULA",Dt[Dt.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",Dt[Dt.PASTE_VALUES=5]="PASTE_VALUES",Dt[Dt.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",Dt[Dt.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",(Pt=Lt||(Lt={}))[Pt.DOCUMENT=0]="DOCUMENT",Pt[Pt.PROJECT=1]="PROJECT",(Ht=Bt||(Bt={}))[Ht.COLUMNS=0]="COLUMNS",Ht[Ht.ROWS=1]="ROWS",(Ut=Ft||(Ft={}))[Ut.LEFT=0]="LEFT",Ut[Ut.RIGHT=1]="RIGHT",Ut[Ut.TOP=2]="TOP",Ut[Ut.BOTTOM=3]="BOTTOM",(Wt=zt||(zt={}))[Wt.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",Wt[Wt.TEXT=1]="TEXT",Wt[Wt.NUMBER=2]="NUMBER",Wt[Wt.PERCENT=3]="PERCENT",Wt[Wt.CURRENCY=4]="CURRENCY",Wt[Wt.DATE=5]="DATE",Wt[Wt.TIME=6]="TIME",Wt[Wt.DATE_TIME=7]="DATE_TIME",Wt[Wt.SCIENTIFIC=8]="SCIENTIFIC",(Yt=Vt||(Vt={}))[Yt.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",Yt[Yt.MIN=1]="MIN",Yt[Yt.MAX=2]="MAX",Yt[Yt.NUMBER=3]="NUMBER",Yt[Yt.PERCENT=4]="PERCENT",Yt[Yt.PERCENTILE=5]="PERCENTILE",(Xt=Gt||(Gt={}))[Xt.BACKSPACE=8]="BACKSPACE",Xt[Xt.TAB=9]="TAB",Xt[Xt.ENTER=13]="ENTER",Xt[Xt.SHIFT=16]="SHIFT",Xt[Xt.CTRL=17]="CTRL",Xt[Xt.PAUSE=19]="PAUSE",Xt[Xt.CAPS_LOCK=20]="CAPS_LOCK",Xt[Xt.ESC=27]="ESC",Xt[Xt.SPACE=33]="SPACE",Xt[Xt.PAGE_UP=33]="PAGE_UP",Xt[Xt.PAGE_DOWN=34]="PAGE_DOWN",Xt[Xt.END=35]="END",Xt[Xt.HOME=36]="HOME",Xt[Xt.LEFT=37]="LEFT",Xt[Xt.UP=38]="UP",Xt[Xt.RIGHT=39]="RIGHT",Xt[Xt.DOWN=40]="DOWN",Xt[Xt.INSERT=45]="INSERT",Xt[Xt.DELETE=46]="DELETE",Xt[Xt.WIN=91]="WIN",Xt[Xt.WIN_R=92]="WIN_R",Xt[Xt.MENU=93]="MENU",Xt[Xt.F1=112]="F1",Xt[Xt.F2=113]="F2",Xt[Xt.F3=114]="F3",Xt[Xt.F4=115]="F4",Xt[Xt.F5=116]="F5",Xt[Xt.F6=117]="F6",Xt[Xt.F7=118]="F7",Xt[Xt.F8=119]="F8",Xt[Xt.F9=120]="F9",Xt[Xt.F10=121]="F10",Xt[Xt.F11=122]="F11",Xt[Xt.F12=123]="F12",Xt[Xt.NUM_LOCK=144]="NUM_LOCK",Xt[Xt.SCROLL_LOCK=145]="SCROLL_LOCK",($t=jt||(jt={})).backspace="Backspace",$t.delete="Delete",(qt=Kt||(Kt={})).EN="en",qt.ZH="zh",(Jt=Zt||(Zt={}))[Jt.RANGE=0]="RANGE",Jt[Jt.SHEET=1]="SHEET",(te=Qt||(Qt={}))[te.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",te[te.PAST_YEAR=1]="PAST_YEAR",te[te.PAST_MONTH=2]="PAST_MONTH",te[te.PAST_WEEK=3]="PAST_WEEK",te[te.YESTERDAY=4]="YESTERDAY",te[te.TODAY=5]="TODAY",te[te.TOMORROW=6]="TOMORROW",(ne=ee||(ee={}))[ne.GRID=0]="GRID",ne[ne.KANBAN=1]="KANBAN",ne[ne.GANTT=2]="GANTT",(se=re||(re={}))[se.UNSPECIFIED=0]="UNSPECIFIED",se[se.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",se[se.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",(ie=oe||(oe={}))[ie.DASH=0]="DASH",ie[ie.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",ie[ie.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",ie[ie.DASHED_HEAVY=3]="DASHED_HEAVY",ie[ie.DASH_LONG=4]="DASH_LONG",ie[ie.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",ie[ie.DOT_DASH=6]="DOT_DASH",ie[ie.DOT_DOT_DASH=7]="DOT_DOT_DASH",ie[ie.DOTTED=8]="DOTTED",ie[ie.DOTTED_HEAVY=9]="DOTTED_HEAVY",ie[ie.DOUBLE=10]="DOUBLE",ie[ie.NONE=11]="NONE",ie[ie.SINGLE=12]="SINGLE",ie[ie.THICK=13]="THICK",ie[ie.WAVE=14]="WAVE",ie[ie.WAVY_DOUBLE=15]="WAVY_DOUBLE",ie[ie.WAVY_HEAVY=16]="WAVY_HEAVY",ie[ie.WORDS=17]="WORDS",(le=ae||(ae={}))[le.UNSPECIFIED=0]="UNSPECIFIED",le[le.LEFT=1]="LEFT",le[le.CENTER=2]="CENTER",le[le.RIGHT=3]="RIGHT",le[le.JUSTIFIED=4]="JUSTIFIED",(ce=he||(he={}))[ce.UNSPECIFIED=0]="UNSPECIFIED",ce[ce.TOP=1]="TOP",ce[ce.MIDDLE=2]="MIDDLE",ce[ce.BOTTOM=3]="BOTTOM",(ue=de||(de={}))[ue.UNSPECIFIED=0]="UNSPECIFIED",ue[ue.OVERFLOW=1]="OVERFLOW",ue[ue.CLIP=2]="CLIP",ue[ue.WRAP=3]="WRAP",(pe=ge||(ge={}))[pe.NORMAL=0]="NORMAL",pe[pe.ITALIC=1]="ITALIC",(me=_e||(_e={}))[me.NORMAL=0]="NORMAL",me[me.BOLD=1]="BOLD",(ve=fe||(fe={}))[ve.NORMAL=0]="NORMAL",ve[ve.SUBSCRIPT=1]="SUBSCRIPT",ve[ve.SUPERSCRIPT=2]="SUPERSCRIPT",(Ce=be||(be={}))[Ce.FALSE=0]="FALSE",Ce[Ce.TRUE=1]="TRUE",(we=Te||(Te={}))[we.STRING=0]="STRING",we[we.NUMBER=1]="NUMBER",we[we.BOOLEAN=2]="BOOLEAN",we[we.FORCE_STRING=3]="FORCE_STRING",(Ee=Se||(Se={}))[Ee.DARK1=0]="DARK1",Ee[Ee.LIGHT1=1]="LIGHT1",Ee[Ee.DARK2=2]="DARK2",Ee[Ee.LIGHT2=3]="LIGHT2",Ee[Ee.ACCENT1=4]="ACCENT1",Ee[Ee.ACCENT2=5]="ACCENT2",Ee[Ee.ACCENT3=6]="ACCENT3",Ee[Ee.ACCENT4=7]="ACCENT4",Ee[Ee.ACCENT5=8]="ACCENT5",Ee[Ee.ACCENT6=9]="ACCENT6",Ee[Ee.HYPERLINK=10]="HYPERLINK",Ee[Ee.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",(Re=ye||(ye={})).OFFICE="Office",Re.OFFICE_2007_2010="Office 2007-2010",Re.GRAYSCALE="Grayscale",Re.BLUE_WARM="Blue Warm",Re.BLUE="Blue",Re.BLUE_II="Blue II",Re.BLUE_GREEN="Blue Green",Re.GREEN="Green",Re.GREEN_YELLOW="Green Yellow",Re.YELLOW="Yellow",Re.YELLOW_ORANGE="Yellow Orange",Re.ORANGE="Orange",Re.ORANGE_RED="Orange Red",Re.RED_ORANGE="Red Orange",Re.RED="Red",Re.RED_VIOLET="Red Violet",Re.VIOLET="Violet",Re.VIOLET_II="Violet II",Re.MEDIAN="Median",Re.PAPER="Paper",Re.MARQUEE="Marquee",Re.SLIPSTREAM="Slipstream",Re.Aspect="Aspect",(Ae=Ie||(Ie={}))[Ae.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",Ae[Ae.TEXT_BOX=1]="TEXT_BOX",Ae[Ae.RECTANGLE=2]="RECTANGLE",Ae[Ae.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",Ae[Ae.ELLIPSE=4]="ELLIPSE",Ae[Ae.ARC=5]="ARC",Ae[Ae.BENT_ARROW=6]="BENT_ARROW",Ae[Ae.BENT_UP_ARROW=7]="BENT_UP_ARROW",Ae[Ae.BEVEL=8]="BEVEL",Ae[Ae.BLOCK_ARC=9]="BLOCK_ARC",Ae[Ae.BRACE_PAIR=10]="BRACE_PAIR",Ae[Ae.BRACKET_PAIR=11]="BRACKET_PAIR",Ae[Ae.CAN=12]="CAN",Ae[Ae.CHEVRON=13]="CHEVRON",Ae[Ae.CHORD=14]="CHORD",Ae[Ae.CLOUD=15]="CLOUD",Ae[Ae.CORNER=16]="CORNER",Ae[Ae.CUBE=17]="CUBE",Ae[Ae.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",Ae[Ae.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",Ae[Ae.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",Ae[Ae.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",Ae[Ae.DECAGON=22]="DECAGON",Ae[Ae.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",Ae[Ae.DIAMOND=24]="DIAMOND",Ae[Ae.DODECAGON=25]="DODECAGON",Ae[Ae.DONUT=26]="DONUT",Ae[Ae.DOUBLE_WAVE=27]="DOUBLE_WAVE",Ae[Ae.DOWN_ARROW=28]="DOWN_ARROW",Ae[Ae.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",Ae[Ae.FOLDED_CORNER=30]="FOLDED_CORNER",Ae[Ae.FRAME=31]="FRAME",Ae[Ae.HALF_FRAME=32]="HALF_FRAME",Ae[Ae.HEART=33]="HEART",Ae[Ae.HEPTAGON=34]="HEPTAGON",Ae[Ae.HEXAGON=35]="HEXAGON",Ae[Ae.HOME_PLATE=36]="HOME_PLATE",Ae[Ae.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",Ae[Ae.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",Ae[Ae.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",Ae[Ae.LEFT_ARROW=40]="LEFT_ARROW",Ae[Ae.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",Ae[Ae.LEFT_BRACE=42]="LEFT_BRACE",Ae[Ae.LEFT_BRACKET=43]="LEFT_BRACKET",Ae[Ae.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",Ae[Ae.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",Ae[Ae.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",Ae[Ae.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",Ae[Ae.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",Ae[Ae.MATH_DIVIDE=49]="MATH_DIVIDE",Ae[Ae.MATH_EQUAL=50]="MATH_EQUAL",Ae[Ae.MATH_MINUS=51]="MATH_MINUS",Ae[Ae.MATH_MULTIPLY=52]="MATH_MULTIPLY",Ae[Ae.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",Ae[Ae.MATH_PLUS=54]="MATH_PLUS",Ae[Ae.MOON=55]="MOON",Ae[Ae.NO_SMOKING=56]="NO_SMOKING",Ae[Ae.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",Ae[Ae.OCTAGON=58]="OCTAGON",Ae[Ae.PARALLELOGRAM=59]="PARALLELOGRAM",Ae[Ae.PENTAGON=60]="PENTAGON",Ae[Ae.PIE=61]="PIE",Ae[Ae.PLAQUE=62]="PLAQUE",Ae[Ae.PLUS=63]="PLUS",Ae[Ae.QUAD_ARROW=64]="QUAD_ARROW",Ae[Ae.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",Ae[Ae.RIBBON=66]="RIBBON",Ae[Ae.RIBBON_2=67]="RIBBON_2",Ae[Ae.RIGHT_ARROW=68]="RIGHT_ARROW",Ae[Ae.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",Ae[Ae.RIGHT_BRACE=70]="RIGHT_BRACE",Ae[Ae.RIGHT_BRACKET=71]="RIGHT_BRACKET",Ae[Ae.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",Ae[Ae.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",Ae[Ae.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",Ae[Ae.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",Ae[Ae.SMILEY_FACE=76]="SMILEY_FACE",Ae[Ae.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",Ae[Ae.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",Ae[Ae.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",Ae[Ae.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",Ae[Ae.STAR_10=81]="STAR_10",Ae[Ae.STAR_12=82]="STAR_12",Ae[Ae.STAR_16=83]="STAR_16",Ae[Ae.STAR_24=84]="STAR_24",Ae[Ae.STAR_32=85]="STAR_32",Ae[Ae.STAR_4=86]="STAR_4",Ae[Ae.STAR_5=87]="STAR_5",Ae[Ae.STAR_6=88]="STAR_6",Ae[Ae.STAR_7=89]="STAR_7",Ae[Ae.STAR_8=90]="STAR_8",Ae[Ae.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",Ae[Ae.SUN=92]="SUN",Ae[Ae.TRAPEZOID=93]="TRAPEZOID",Ae[Ae.TRIANGLE=94]="TRIANGLE",Ae[Ae.UP_ARROW=95]="UP_ARROW",Ae[Ae.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",Ae[Ae.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",Ae[Ae.UTURN_ARROW=98]="UTURN_ARROW",Ae[Ae.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",Ae[Ae.WAVE=100]="WAVE",Ae[Ae.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",Ae[Ae.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",Ae[Ae.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",Ae[Ae.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",Ae[Ae.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",Ae[Ae.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",Ae[Ae.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",Ae[Ae.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",Ae[Ae.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",Ae[Ae.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",Ae[Ae.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",Ae[Ae.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",Ae[Ae.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",Ae[Ae.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",Ae[Ae.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",Ae[Ae.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",Ae[Ae.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",Ae[Ae.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",Ae[Ae.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",Ae[Ae.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",Ae[Ae.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",Ae[Ae.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",Ae[Ae.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",Ae[Ae.FLOW_CHART_OR=124]="FLOW_CHART_OR",Ae[Ae.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",Ae[Ae.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",Ae[Ae.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",Ae[Ae.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",Ae[Ae.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",Ae[Ae.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",Ae[Ae.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",Ae[Ae.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",Ae[Ae.ARROW_EAST=133]="ARROW_EAST",Ae[Ae.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",Ae[Ae.ARROW_NORTH=135]="ARROW_NORTH",Ae[Ae.SPEECH=136]="SPEECH",Ae[Ae.STARBURST=137]="STARBURST",Ae[Ae.TEARDROP=138]="TEARDROP",Ae[Ae.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",Ae[Ae.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",Ae[Ae.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",Ae[Ae.CUSTOM=142]="CUSTOM";const Oe={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},Ne={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},Me={startRow:0,startColumn:0,endRow:0,endColumn:0},xe={row:0,column:0},ke={extensions:[],id:"",sheetOrder:[],socketEnable:be.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:Kt.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},De={type:ee.GRID,name:"Sheet1",id:"sheet-01",tabColor:"",hidden:be.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:be.FALSE,showGridlines:be.TRUE,rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A1"],rightToLeft:be.FALSE,pluginMeta:{}},Le={ff:"Times New Roman",fs:14,it:be.FALSE,bl:be.FALSE,ul:{s:be.FALSE},st:{s:be.FALSE},ol:{s:be.FALSE},tr:{a:0,v:be.FALSE},td:re.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:ae.UNSPECIFIED,vt:he.UNSPECIFIED,tb:de.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Pe={id:"default_doc",documentStyle:{}},Be={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var He,Fe;(Fe=He||(He={})).ARRAY_CONVERTOR="ARRAY_CONVERTOR",Fe.MATRIX_CONVERTOR="MATRIX_CONVERTOR";const Ue={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var ze,We;(We=ze||(ze={})).BASE_COMPONENT="baseComponent",We.BASE_RENDER="renderEngine",We.SPREADSHEET="spreadsheet",We.DOCUMENT="document",We.SLIDE="slide";const Ve={[ye.OFFICE]:{[Se.ACCENT1]:"#4472C4",[Se.ACCENT2]:"#ED7D31",[Se.ACCENT3]:"#A5A5A5",[Se.ACCENT4]:"#70AD47",[Se.ACCENT5]:"#5B9BD5",[Se.ACCENT6]:"#70AD47",[Se.DARK1]:"#000000",[Se.DARK2]:"#44546A",[Se.LIGHT1]:"#FFFFFF",[Se.LIGHT2]:"#E7E6E6",[Se.HYPERLINK]:"#0563C1",[Se.FOLLOWED_HYPERLINK]:"#954F72"}},Ye={namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:Me}};var Ge,Xe,je,$e,Ke,qe;(Xe=Ge||(Ge={}))[Xe.SLIDE=0]="SLIDE",Xe[Xe.MASTER=1]="MASTER",Xe[Xe.LAYOUT=2]="LAYOUT",Xe[Xe.HANDOUT_MASTER=3]="HANDOUT_MASTER",Xe[Xe.NOTES_MASTER=4]="NOTES_MASTER",($e=je||(je={}))[$e.SHAPE=0]="SHAPE",$e[$e.IMAGE=1]="IMAGE",$e[$e.TEXT=2]="TEXT",$e[$e.SPREADSHEET=3]="SPREADSHEET",$e[$e.DOCUMENT=4]="DOCUMENT",$e[$e.SLIDE=5]="SLIDE",(qe=Ke||(Ke={}))[qe.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",qe[qe.NEXT_SLIDE=1]="NEXT_SLIDE",qe[qe.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",qe[qe.FIRST_SLIDE=3]="FIRST_SLIDE",qe[qe.LAST_SLIDE=4]="LAST_SLIDE";class Ze{constructor(){this._colorType=It.UNSUPPORTED,this._themeColors=ye.OFFICE,this._themeTint=0}asRgbColor(){return new en(this._rgbValue,this)}asThemeColor(){return new rn(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case It.THEME:return this.asThemeColor();case It.RGB:return this.asRgbColor();case It.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(t){return this._colorType=It.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=It.THEME,this._themeColors=t}setThemeTint(t){this._colorType=It.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=It.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class Je{constructor(t){this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";let e=+`0x${t[0]}${t[1]}`,n=+`0x${t[2]}${t[3]}`,r=+`0x${t[4]}${t[5]}`;return(new Ze).setRgbColor(`rgb(${e},${n},${r})`).asRgbColor()}static hexToRgbString(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,n,r)=>e+e+n+n+r+r));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let n=null;if(e){n=`rgba(${parseInt(e[1],16)},${parseInt(e[2],16)},${parseInt(e[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Je(this._builder)}equals(t){return!1}}class Qe{constructor(t){const e=t.getRed()/255,n=t.getGreen()/255,r=t.getBlue()/255,s=t.getAlpha()/255,o=Math.min(e,Math.min(n,r)),i=Math.max(e,Math.max(n,r)),a=i-o;if(i===o)return this._hue=0,this._saturation=0,void(this._lightness=i);this._lightness=(o+i)/2,this._lightness<.5?this._saturation=a/(i+o):this._saturation=a/(2-i-o),e===i&&(this._hue=(n-r)/a),n===i&&(this._hue=2+(r-e)/a),r===i&&(this._hue=4+(e-n)/a),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=s}asRgbColor(){const t=new Ze;if(0===this._saturation)return t.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),t.asRgbColor();let e;e=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-e,r=this._hue/360,s=r+1/3,o=this.setColor(e,n,s),i=this.setColor(e,n,r),a=r-1/3,l=this.setColor(e,n,a);return t.setRgbColor(`rgba(${Math.round(255*o)},${Math.round(255*i)},${Math.round(255*l)},${255*this._alpha})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,e,n){let r;return n<0&&(n+=1),n>1&&(n-=1),r=6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e,r}setLightness(t){this._lightness=t}}const tn=class extends Je{constructor(t,e){super(e);let n=t.match(tn.RGBA_EXTRACT);if(n){const e=+n[1],r=+n[2],s=+n[3],o=+n[4];return this._cssString=t,this._red=e,this._green=r,this._blue=s,void(this._alpha=o)}if(n=t.match(tn.RGB_EXTRACT),n){const e=+n[1],r=+n[2],s=+n[3];return this._cssString=t,this._red=e,this._green=r,this._blue=s,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return Je.rgbColorToHexValue(this)}getRed(){let t=this._red+tn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getGreen(){let t=this._green+tn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getBlue(){let t=this._blue+tn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getAlpha(){return this._alpha}getColorType(){return It.RGB}clone(){return new tn(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(t){return t instanceof tn&&(t._red===this._red&&t._blue===this._blue&&t._green===this._green&&t._alpha===this._alpha)}getCssString(){return this._cssString}};let en=tn;en.RGB_COLOR_AMT=0,en.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),en.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const nn=class extends Je{constructor(t,e,n,r){super(r),this._themeColorType=t,this._themeTint=e,this._themeColors=n}lumValue(t,e){if(null==t)return e;let n;return n=t<0?e*(1+t):e*(1-t)+(255-255*(1-t)),n}asRgbColor(){const t=Ve[this._themeColors];if(null==t)throw new Error("not find themeColors type");const e=t.get(this._themeColorType);if(null==e)throw new Error("not find themeColors value");let n;if(nn._cacheThemeColor.has(this._themeColors)){if(n=nn._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,nn._cacheThemeColor.set(this._themeColors,n);const r=new Qe(Je.hexValueToRgbColor(e));r.setLightness(this.lumValue(this._themeTint,255*r.getLightness())/255);const s=r.asRgbColor();return n.set(this._themeColorType,s),s}clone(){return new nn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(t){return t instanceof nn&&t._themeColorType===this._themeColorType}getColorType(){return It.THEME}getThemeColorType(){return this._themeColorType}};let rn=nn;rn._cacheThemeColor=new Map;class sn{constructor(t,e){this._workSheet=t,this._columnData=new p(e)}getColumnData(){return this._columnData}getColumnDatas(t,e){const n=new p;for(let r=t;r<t+e;r++){const t=this.getColumnOrCreate(r);n.push(t)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...t){const{_workSheet:e}=this,{_columnData:n}=this,r=e.getConfig();let s=0;if(1===t.length){s=n.obtain(t[0],{hd:be.FALSE,w:r.defaultColumnWidth}).w}else if(2===t.length)for(let o=t[0];o<t[0]+t[1];o++){s+=n.obtain(o,{hd:be.FALSE,w:r.defaultColumnWidth}).w}return s}setColumnWidth(t,e){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:ft.SET_COLUMN_WIDTH_ACTION,columnIndex:t,columnWidth:e},o=new Fr({WorkBookUnit:n.getWorkBook()},s);r.invoke(o)}getColumn(t){const e=this._columnData.get(t);if(e)return e}getColumnOrCreate(t){const{_workSheet:e}=this,{_columnData:n}=this,r=e.getConfig(),s=n.get(t);if(s)return s;const o={w:r.defaultColumnWidth,hd:be.FALSE};return this._columnData.set(t,o),o}}class on{constructor(t,e){this._worksheet=t,this._rectangleList=e,Br.getCommandObservers().add((({actions:e})=>{if(!e||0===e.length)return;const n=e[0];if(t.getContext().getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;let r=e.find((t=>t instanceof Zs)),s=e.find((t=>t instanceof Ks)),o=e.find((t=>t instanceof ro)),i=e.find((t=>t instanceof to)),a=e.find((t=>t instanceof $s));if(r){const t=r.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=C.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const r=e[n],s=t.rowCount;t.rowIndex>r.endRow||(t.rowIndex>=r.startRow&&t.rowIndex<=r.endRow||(r.startRow+=s),r.endRow+=s)}this.modifyMerge(this._rectangleList,e)}}if(s){const t=s.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=C.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const r=e[n],s=t.columnCount;t.columnIndex>r.endColumn||(t.columnIndex>=r.startColumn&&t.columnIndex<=r.endColumn||(r.startColumn+=s),r.endColumn+=s)}this.modifyMerge(this._rectangleList,e)}}if(o){const t=o.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=C.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const r=e[n],s=t.rowCount;t.rowIndex>r.endRow||(t.rowIndex>=r.startRow&&t.rowIndex<=r.endRow||(r.startRow-=s),r.endRow-=s)}this.modifyMerge(this._rectangleList,e)}}if(i){const t=i.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=C.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const r=e[n],s=t.columnCount;t.columnIndex>r.endColumn||(t.columnIndex>=r.startColumn&&t.columnIndex<=r.endColumn||(r.startColumn-=s),r.endColumn-=s)}this.modifyMerge(this._rectangleList,e)}}if(a){const t=a.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=C.deepClone(this._rectangleList),n=this.getByRowColumn(t.rangeData.startRow,t.rangeData.endRow,t.rangeData.startColumn,t.rangeData.endColumn);if(n&&n.forEach((t=>{const n=new pr(t);for(let r=0;r<e.length;r++){const t=e[r];n.intersects(new pr(t))&&e.splice(r,1)}})),t.shiftDimension)for(let r=0;r<e.length;r++){const n=e[r];if(n.endRow>=t.rangeData.startRow){if(n.endColumn<t.rangeData.startColumn)continue;if(n.startColumn>t.rangeData.endColumn)continue;if(!(n.startColumn>=t.rangeData.startColumn&&n.endColumn<=t.rangeData.endColumn))return;{const e=t.rangeData.endRow-t.rangeData.startRow;n.startRow-=e,n.endRow-=e}}}else for(let r=0;r<e.length;r++){const n=e[r];if(n.startColumn>t.rangeData.endColumn){if(n.endRow<t.rangeData.startRow)continue;if(n.startRow>t.rangeData.endRow)continue;if(!(n.startRow>=t.rangeData.startRow&&n.endRow<=t.rangeData.endRow))return;{const e=t.rangeData.endColumn-t.rangeData.startColumn;n.startColumn-=e,n.endColumn-=e}}}this.modifyMerge(this._rectangleList,e)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...t){const{_rectangleList:e}=this;let n;Ar.checkup(t,Ar.NUMBER_TYPE,Ar.NUMBER_TYPE,Ar.NUMBER_TYPE,Ar.NUMBER_TYPE)?n=new pr(t[0],t[2],t[1],t[3]):Ar.checkup(t,Ar.NUMBER_TYPE,Ar.NUMBER_TYPE)&&(n=new pr(t[0],t[1],t[0],t[1]));const r=[];for(let s=0;s<e.length;s++){const t=e[s];n.intersects(new pr(t))&&r.push(t)}return r.length?r:null}remove(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),r={actionName:no.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},s=new Fr({WorkBookUnit:n.getWorkBook()},r);e.invoke(s)}size(){return this._rectangleList.length}add(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),r={actionName:no.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},s={actionName:Hs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},o=new Fr({WorkBookUnit:n.getWorkBook()},r,s);e.invoke(o)}union(t){const{_rectangleList:e}=this,{length:n}=e;let r=new pr(t);for(let s=0;s<n;s++){const t=e[s];r=r.union(new pr(t))}return r.getData()}getMergedRanges(t){const{_rectangleList:e}=this,{length:n}=e,r=[];for(let s=0;s<n;s++){const n=e[s];new pr(t).intersects(new pr(n))&&r.push(n)}return r}modifyMerge(t,e){let n=this._worksheet.getCommandManager(),r=this._worksheet.getContext(),s={actionName:no.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...t]},o={actionName:Hs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...e]},i=new Fr({WorkBookUnit:r.getWorkBook()},s,o);n.invoke(i)}}var an="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ln={exports:{}};ln.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",s="second",o="minute",i="hour",a="day",l="week",h="month",c="quarter",d="year",u="date",g="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},f=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},v={s:f,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),s=n%60;return(e<=0?"+":"-")+f(r,2,"0")+":"+f(s,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),s=e.clone().add(r,h),o=n-s<0,i=e.clone().add(r+(o?-1:1),h);return+(-(r+(n-s)/(o?s-i:i-s))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:h,y:d,w:l,d:a,D:u,h:i,m:o,s:s,ms:r,Q:c}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},b="en",C={};C[b]=m;var T=function(t){return t instanceof y},w=function t(e,n,r){var s;if(!e)return b;if("string"==typeof e){var o=e.toLowerCase();C[o]&&(s=o),n&&(C[o]=n,s=o);var i=e.split("-");if(!s&&i.length>1)return t(i[0])}else{var a=e.name;C[a]=e,s=a}return!r&&s&&(b=s),s||!r&&b},S=function(t,e){if(T(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new y(n)},E=v;E.l=w,E.i=T,E.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var y=function(){function m(t){this.$L=w(t.locale,null,!0),this.parse(t)}var f=m.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(E.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var s=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return E},f.isValid=function(){return!(this.$d.toString()===g)},f.isSame=function(t,e){var n=S(t);return this.startOf(e)<=n&&n<=this.endOf(e)},f.isAfter=function(t,e){return S(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<S(t)},f.$g=function(t,e,n){return E.u(t)?this[e]:this.set(n,t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,e){var n=this,r=!!E.u(e)||e,c=E.p(t),g=function(t,e){var s=E.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?s:s.endOf(a)},p=function(t,e){return E.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},_=this.$W,m=this.$M,f=this.$D,v="set"+(this.$u?"UTC":"");switch(c){case d:return r?g(1,0):g(31,11);case h:return r?g(1,m):g(0,m+1);case l:var b=this.$locale().weekStart||0,C=(_<b?_+7:_)-b;return g(r?f-C:f+(6-C),m);case a:case u:return p(v+"Hours",0);case i:return p(v+"Minutes",1);case o:return p(v+"Seconds",2);case s:return p(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(t,e){var n,l=E.p(t),c="set"+(this.$u?"UTC":""),g=(n={},n[a]=c+"Date",n[u]=c+"Date",n[h]=c+"Month",n[d]=c+"FullYear",n[i]=c+"Hours",n[o]=c+"Minutes",n[s]=c+"Seconds",n[r]=c+"Milliseconds",n)[l],p=l===a?this.$D+(e-this.$W):e;if(l===h||l===d){var _=this.clone().set(u,1);_.$d[g](p),_.init(),this.$d=_.set(u,Math.min(this.$D,_.daysInMonth())).$d}else g&&this.$d[g](p);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[E.p(t)]()},f.add=function(r,c){var u,g=this;r=Number(r);var p=E.p(c),_=function(t){var e=S(g);return E.w(e.date(e.date()+Math.round(t*r)),g)};if(p===h)return this.set(h,this.$M+r);if(p===d)return this.set(d,this.$y+r);if(p===a)return _(1);if(p===l)return _(7);var m=(u={},u[o]=e,u[i]=n,u[s]=t,u)[p]||1,f=this.$d.getTime()+r*m;return E.w(f,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||g;var r=t||"YYYY-MM-DDTHH:mm:ssZ",s=E.z(this),o=this.$H,i=this.$m,a=this.$M,l=n.weekdays,h=n.months,c=function(t,n,s,o){return t&&(t[n]||t(e,r))||s[n].slice(0,o)},d=function(t){return E.s(o%12||12,t,"0")},u=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:E.s(a+1,2,"0"),MMM:c(n.monthsShort,a,h,3),MMMM:c(h,a),D:this.$D,DD:E.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:E.s(o,2,"0"),h:d(1),hh:d(2),a:u(o,i,!0),A:u(o,i,!1),m:String(i),mm:E.s(i,2,"0"),s:String(this.$s),ss:E.s(this.$s,2,"0"),SSS:E.s(this.$ms,3,"0"),Z:s};return r.replace(_,(function(t,e){return e||p[t]||s.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(r,u,g){var p,_=E.p(u),m=S(r),f=(m.utcOffset()-this.utcOffset())*e,v=this-m,b=E.m(this,m);return b=(p={},p[d]=b/12,p[h]=b,p[c]=b/3,p[l]=(v-f)/6048e5,p[a]=(v-f)/864e5,p[i]=v/n,p[o]=v/e,p[s]=v/t,p)[_]||v,g?b:E.a(b)},f.daysInMonth=function(){return this.endOf(h).$D},f.$locale=function(){return C[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},f.clone=function(){return E.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},m}(),R=y.prototype;return S.prototype=R,[["$ms",r],["$s",s],["$m",o],["$H",i],["$W",a],["$M",h],["$y",d],["$D",u]].forEach((function(t){R[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),S.extend=function(t,e){return t.$i||(t(e,y,S),t.$i=!0),S},S.locale=w,S.isDayjs=T,S.unix=function(t){return S(1e3*t)},S.en=C[b],S.Ls=C,S.p={},S}();var hn=ln.exports,cn={exports:{}};
/*! @preserve
   * numeral.js
   * version : 2.0.6
   * author : Adam Draper
   * license : MIT
   * http://adamwdraper.github.com/Numeral-js/
   */
!function(t){var e,n;e=an,n=function(){var t,e,n,r,s,o={},i={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},l={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function h(t,e){this._input=t,this._value=e}return(t=function(n){var r,s,i,a;if(t.isNumeral(n))r=n.value();else if(0===n||void 0===n)r=0;else if(null===n||e.isNaN(n))r=null;else if("string"==typeof n)if(l.zeroFormat&&n===l.zeroFormat)r=0;else if(l.nullFormat&&n===l.nullFormat||!n.replace(/[^0-9]+/g,"").length)r=null;else{for(s in o)if((a="function"==typeof o[s].regexps.unformat?o[s].regexps.unformat():o[s].regexps.unformat)&&n.match(a)){i=o[s].unformat;break}r=(i=i||t._.stringToNumber)(n)}else r=Number(n)||null;return new h(n,r)}).version="2.0.6",t.isNumeral=function(t){return t instanceof h},t._=e={numberToFormat:function(e,n,r){var s,o,a,l,h,c,d,u,g=i[t.options.currentLocale],p=!1,_=!1,m="",f=1e12,v=1e9,b=1e6,C="",T=!1;if(e=e||0,a=Math.abs(e),t._.includes(n,"(")?(p=!0,n=n.replace(/[\(|\)]/g,"")):(t._.includes(n,"+")||t._.includes(n,"-"))&&(c=t._.includes(n,"+")?n.indexOf("+"):e<0?n.indexOf("-"):-1,n=n.replace(/[\+|\-]/g,"")),t._.includes(n,"a")&&(o=!!(o=n.match(/a(k|m|b|t)?/))&&o[1],t._.includes(n," a")&&(m=" "),n=n.replace(new RegExp(m+"a[kmbt]?"),""),a>=f&&!o||"t"===o?(m+=g.abbreviations.trillion,e/=f):a<f&&a>=v&&!o||"b"===o?(m+=g.abbreviations.billion,e/=v):a<v&&a>=b&&!o||"m"===o?(m+=g.abbreviations.million,e/=b):(a<b&&a>=1e3&&!o||"k"===o)&&(m+=g.abbreviations.thousand,e/=1e3)),t._.includes(n,"[.]")&&(_=!0,n=n.replace("[.]",".")),l=e.toString().split(".")[0],h=n.split(".")[1],d=n.indexOf(","),s=(n.split(".")[0].split(",")[0].match(/0/g)||[]).length,h?(t._.includes(h,"[")?(h=(h=h.replace("]","")).split("["),C=t._.toFixed(e,h[0].length+h[1].length,r,h[1].length)):C=t._.toFixed(e,h.length,r),l=C.split(".")[0],C=t._.includes(C,".")?g.delimiters.decimal+C.split(".")[1]:"",_&&0===Number(C.slice(1))&&(C="")):l=t._.toFixed(e,0,r),m&&!o&&Number(l)>=1e3&&m!==g.abbreviations.trillion)switch(l=String(Number(l)/1e3),m){case g.abbreviations.thousand:m=g.abbreviations.million;break;case g.abbreviations.million:m=g.abbreviations.billion;break;case g.abbreviations.billion:m=g.abbreviations.trillion}if(t._.includes(l,"-")&&(l=l.slice(1),T=!0),l.length<s)for(var w=s-l.length;w>0;w--)l="0"+l;return d>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+g.delimiters.thousands)),0===n.indexOf(".")&&(l=""),u=l+C+(m||""),p?u=(p&&T?"(":"")+u+(p&&T?")":""):c>=0?u=0===c?(T?"-":"+")+u:u+(T?"-":"+"):T&&(u="-"+u),u},stringToNumber:function(t){var e,n,r,s=i[l.currentLocale],o=t,a={thousand:3,million:6,billion:9,trillion:12};if(l.zeroFormat&&t===l.zeroFormat)n=0;else if(l.nullFormat&&t===l.nullFormat||!t.replace(/[^0-9]+/g,"").length)n=null;else{for(e in n=1,"."!==s.delimiters.decimal&&(t=t.replace(/\./g,"").replace(s.delimiters.decimal,".")),a)if(r=new RegExp("[^a-zA-Z]"+s.abbreviations[e]+"(?:\\)|(\\"+s.currency.symbol+")?(?:\\))?)?$"),o.match(r)){n*=Math.pow(10,a[e]);break}n*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,t=t.replace(/[^0-9\.]+/g,""),n*=Number(t)}return n},isNaN:function(t){return"number"==typeof t&&isNaN(t)},includes:function(t,e){return-1!==t.indexOf(e)},insert:function(t,e,n){return t.slice(0,n)+e+t.slice(n)},reduce:function(t,e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,r=Object(t),s=r.length>>>0,o=0;if(3===arguments.length)n=arguments[2];else{for(;o<s&&!(o in r);)o++;if(o>=s)throw new TypeError("Reduce of empty array with no initial value");n=r[o++]}for(;o<s;o++)o in r&&(n=e(n,r[o],o,r));return n},multiplier:function(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)},correctionFactor:function(){var t=Array.prototype.slice.call(arguments);return t.reduce((function(t,n){var r=e.multiplier(n);return t>r?t:r}),1)},toFixed:function(t,e,n,r){var s,o,i,a,l=t.toString().split("."),h=e-(r||0);return s=2===l.length?Math.min(Math.max(l[1].length,h),e):h,i=Math.pow(10,s),a=(n(t+"e+"+s)/i).toFixed(s),r>e-s&&(o=new RegExp("\\.?0{1,"+(r-(e-s))+"}$"),a=a.replace(o,"")),a}},t.options=l,t.formats=o,t.locales=i,t.locale=function(t){return t&&(l.currentLocale=t.toLowerCase()),l.currentLocale},t.localeData=function(t){if(!t)return i[l.currentLocale];if(t=t.toLowerCase(),!i[t])throw new Error("Unknown locale : "+t);return i[t]},t.reset=function(){for(var t in a)l[t]=a[t]},t.zeroFormat=function(t){l.zeroFormat="string"==typeof t?t:null},t.nullFormat=function(t){l.nullFormat="string"==typeof t?t:null},t.defaultFormat=function(t){l.defaultFormat="string"==typeof t?t:"0.0"},t.register=function(t,e,n){if(e=e.toLowerCase(),this[t+"s"][e])throw new TypeError(e+" "+t+" already registered.");return this[t+"s"][e]=n,n},t.validate=function(e,n){var r,s,o,i,a,l,h,c;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{h=t.localeData(n)}catch(d){h=t.localeData(t.locale())}return o=h.currency.symbol,a=h.abbreviations,r=h.delimiters.decimal,s="."===h.delimiters.thousands?"\\.":h.delimiters.thousands,!(null!==(c=e.match(/^[^\d]+/))&&(e=e.substr(1),c[0]!==o)||null!==(c=e.match(/[^\d]+$/))&&(e=e.slice(0,-1),c[0]!==a.thousand&&c[0]!==a.million&&c[0]!==a.billion&&c[0]!==a.trillion)||(l=new RegExp(s+"{2}"),e.match(/[^\d.,]/g)||(i=e.split(r)).length>2||(i.length<2?!i[0].match(/^\d+.*\d$/)||i[0].match(l):1===i[0].length?!i[0].match(/^\d+$/)||i[0].match(l)||!i[1].match(/^\d+$/):!i[0].match(/^\d+.*\d$/)||i[0].match(l)||!i[1].match(/^\d+$/))))},t.fn=h.prototype={clone:function(){return t(this)},format:function(e,n){var r,s,i,a=this._value,h=e||l.defaultFormat;if(n=n||Math.round,0===a&&null!==l.zeroFormat)s=l.zeroFormat;else if(null===a&&null!==l.nullFormat)s=l.nullFormat;else{for(r in o)if(h.match(o[r].regexps.format)){i=o[r].format;break}s=(i=i||t._.numberToFormat)(a,h,n)}return s},value:function(){return this._value},input:function(){return this._input},set:function(t){return this._value=Number(t),this},add:function(t){var n=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([this._value,t],(function(t,e,r,s){return t+Math.round(n*e)}),0)/n,this},subtract:function(t){var n=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([t],(function(t,e,r,s){return t-Math.round(n*e)}),Math.round(this._value*n))/n,this},multiply:function(t){return this._value=e.reduce([this._value,t],(function(t,n,r,s){var o=e.correctionFactor(t,n);return Math.round(t*o)*Math.round(n*o)/Math.round(o*o)}),1),this},divide:function(t){return this._value=e.reduce([this._value,t],(function(t,n,r,s){var o=e.correctionFactor(t,n);return Math.round(t*o)/Math.round(n*o)})),this},difference:function(e){return Math.abs(t(this._value).subtract(e).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(e,n,r){var s,o=t._.includes(n," BPS")?" ":"";return e*=1e4,n=n.replace(/\s?BPS/,""),s=t._.numberToFormat(e,n,r),t._.includes(s,")")?((s=s.split("")).splice(-1,0,o+"BPS"),s=s.join("")):s=s+o+"BPS",s},unformat:function(e){return+(1e-4*t._.stringToNumber(e)).toFixed(15)}}),r={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},s="("+(s=(n={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(r.suffixes.filter((function(t){return n.suffixes.indexOf(t)<0}))).join("|")).replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(s)},format:function(e,s,o){var i,a,l,h=t._.includes(s,"ib")?r:n,c=t._.includes(s," b")||t._.includes(s," ib")?" ":"";for(s=s.replace(/\s?i?b/,""),i=0;i<=h.suffixes.length;i++)if(a=Math.pow(h.base,i),l=Math.pow(h.base,i+1),null===e||0===e||e>=a&&e<l){c+=h.suffixes[i],a>0&&(e/=a);break}return t._.numberToFormat(e,s,o)+c},unformat:function(e){var s,o,i=t._.stringToNumber(e);if(i){for(s=n.suffixes.length-1;s>=0;s--){if(t._.includes(e,n.suffixes[s])){o=Math.pow(n.base,s);break}if(t._.includes(e,r.suffixes[s])){o=Math.pow(r.base,s);break}}i*=o||1}return i}}),t.register("format","currency",{regexps:{format:/(\$)/},format:function(e,n,r){var s,o,i=t.locales[t.options.currentLocale],a={before:n.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:n.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(n=n.replace(/\s?\$\s?/,""),s=t._.numberToFormat(e,n,r),e>=0?(a.before=a.before.replace(/[\-\(]/,""),a.after=a.after.replace(/[\-\)]/,"")):e<0&&!t._.includes(a.before,"-")&&!t._.includes(a.before,"(")&&(a.before="-"+a.before),o=0;o<a.before.length;o++)switch(a.before[o]){case"$":s=t._.insert(s,i.currency.symbol,o);break;case" ":s=t._.insert(s," ",o+i.currency.symbol.length-1)}for(o=a.after.length-1;o>=0;o--)switch(a.after[o]){case"$":s=o===a.after.length-1?s+i.currency.symbol:t._.insert(s,i.currency.symbol,-(a.after.length-(1+o)));break;case" ":s=o===a.after.length-1?s+" ":t._.insert(s," ",-(a.after.length-(1+o)+i.currency.symbol.length-1))}return s}}),t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(e,n,r){var s=("number"!=typeof e||t._.isNaN(e)?"0e+0":e.toExponential()).split("e");return n=n.replace(/e[\+|\-]{1}0/,""),t._.numberToFormat(Number(s[0]),n,r)+"e"+s[1]},unformat:function(e){var n=t._.includes(e,"e+")?e.split("e+"):e.split("e-"),r=Number(n[0]),s=Number(n[1]);return s=t._.includes(e,"e-")?s*=-1:s,t._.reduce([r,Math.pow(10,s)],(function(e,n,r,s){var o=t._.correctionFactor(e,n);return e*o*(n*o)/(o*o)}),1)}}),t.register("format","ordinal",{regexps:{format:/(o)/},format:function(e,n,r){var s=t.locales[t.options.currentLocale],o=t._.includes(n," o")?" ":"";return n=n.replace(/\s?o/,""),o+=s.ordinal(e),t._.numberToFormat(e,n,r)+o}}),t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(e,n,r){var s,o=t._.includes(n," %")?" ":"";return t.options.scalePercentBy100&&(e*=100),n=n.replace(/\s?\%/,""),s=t._.numberToFormat(e,n,r),t._.includes(s,")")?((s=s.split("")).splice(-1,0,o+"%"),s=s.join("")):s=s+o+"%",s},unformat:function(e){var n=t._.stringToNumber(e);return t.options.scalePercentBy100?.01*n:n}}),t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(t,e,n){var r=Math.floor(t/60/60),s=Math.floor((t-60*r*60)/60),o=Math.round(t-60*r*60-60*s);return r+":"+(s<10?"0"+s:s)+":"+(o<10?"0"+o:o)},unformat:function(t){var e=t.split(":"),n=0;return 3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1])),Number(n)}}),t},t.exports?t.exports=n():e.numeral=n()}(cn);var dn=cn.exports;const un={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function gn(t){return null!==t&&""!==t.toString().replace(/\s/g,"")&&("boolean"!=typeof t&&!Number.isNaN(t))}let pn=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(pn.getFullYear())&&(pn=new Date("2/19/17"));const _n=2017===pn.getFullYear();const mn=new Date(1900,2,1,0,0,0);function fn(t,e){let n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());const r=Date.UTC(1899,11,31,0,0,0);return e?n-=1262304e5:t>=mn&&(n+=864e5),(n-r)/864e5}function vn(t){let e=null,n={},r=t;if(null===t)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(t)){e=t,r=Number(t.split(".")[0].replace(",",""));let s="#,##0";if(t.split(".")[1]){s="#,##0.";for(let e=0;e<t.split(".")[1].length;e++)s+=0}n={fa:s,t:"n"}}else if("'"===t.toString().substr(0,1))e=t.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===t.toString().toUpperCase())e="TRUE",n={fa:"General",t:"b"},r=!0;else if("FALSE"===t.toString().toUpperCase())e="FALSE",n={fa:"General",t:"b"},r=!1;else if(function(t){let e=!1;for(const n in un)if(t===un[n]){e=!0;break}return e}(t))e=t.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(t))e=t.toString(),n={fa:"@",t:"s"};else if(gn(t)&&Math.abs(parseFloat(t))>0&&(Math.abs(parseFloat(t))>=1e11||Math.abs(parseFloat(t))<1e-9)){r=dn(t).value();const s=r.toExponential();if(s.indexOf(".")>-1){let t=s.split(".")[1].split("e")[0].length;t>5&&(t=5),n={fa:`#0.${new Array(t+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};e=bn.format(n.fa,r)}else if(t.toString().indexOf("%")>-1){const s=t.toString().indexOf("%");let o=t.toString().substr(0,s);const i=o.replace(/,/g,"");if(s===t.toString().length-1&&gn(i))if(o.indexOf(".")>-1)if(o.indexOf(".")===o.lastIndexOf(".")){const s=o.split(".")[0];let i=o.split(".")[1].length;if(i>9&&(i=9),s.indexOf(",")>-1){let o=!0,a=s.split(",");for(let t=1;t<a.length;t++)if(a[t].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(i+1).join("0")}%`,t:"n"},r=dn(t).value(),e=bn.format(n.fa,r)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(i+1).join("0")}%`,t:"n"},r=dn(t).value(),e=bn.format(n.fa,r)}else e=t.toString(),n={fa:"@",t:"s"};else if(o.indexOf(",")>-1){let s=!0,i=o.split(",");for(let t=1;t<i.length;t++)if(i[t].length<3){s=!1;break}s?(n={fa:"#,##0%",t:"n"},r=dn(t).value(),e=bn.format(n.fa,r)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},r=dn(t).value(),e=bn.format(n.fa,r);else e=t.toString(),n={fa:"@",t:"s"}}else if(t.toString().indexOf(".")>-1)if(t.toString().indexOf(".")===t.toString().lastIndexOf(".")){const s=t.toString().split(".")[0];let o=t.toString().split(".")[1],i=o.length;if(i>9&&(i=9),s.indexOf(",")>-1){let o=!0,a=s.split(",");for(let t=1;t<a.length;t++)if(!gn(a[t])||a[t].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(i+1).join("0")}`,t:"n"},r=dn(t).value(),e=bn.format(n.fa,r)):(e=t.toString(),n={fa:"@",t:"s"})}else gn(s)&&gn(o)?(n={fa:`0.${new Array(i+1).join("0")}`,t:"n"},r=dn(t).value(),e=bn.format(n.fa,r)):(e=t.toString(),n={fa:"@",t:"s"})}else e=t.toString(),n={fa:"@",t:"s"};else gn(t)?(e=t.toString(),n={fa:"General",t:"n"},r=parseFloat(t)):null===(s=t)||s.toString().length<5||!function(t){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t))return!1;const e=RegExp.$1,n=RegExp.$2,r=RegExp.$3;if(e<1900)return!1;if(n>12)return!1;if(r>31)return!1;if(2===n){if(29===new Date(e,1,29).getDate()&&r>29)return!1;if(29!==new Date(e,1,29).getDate()&&r>28)return!1}return!0}(s)||!(t.toString().indexOf(".")>-1||t.toString().indexOf(":")>-1||t.toString().length<16)?(e=t,n.fa="General",n.t="g"):(r=fn(function(t,e){const n=new Date(t);if(_n)return e>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):e<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(t instanceof Date)return t;if(1917===pn.getFullYear()&&!Number.isNaN(n.getFullYear())){const e=n.getFullYear();return t.indexOf(`${e}`)>-1||n.setFullYear(n.getFullYear()+100),n}const r=t.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}(t.toString().replace(/-/g,"/"))),r.toString().indexOf(".")>-1?t.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":t.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",e=bn.format(n.fa,r));var s;return[e,n,r]}const bn={format(t,e){}},Cn=(t,e)=>{};class Tn{static getApplyData(t,e,n,r,s){const o=this,i=[];o.applyType=r,o.direction=s;const a=Math.floor(n/e),l=n%e,h=t.number,c=[];if(h)for(let S=0;S<h.length;S++){const t=o.getLenS(h[S].index,l),i=h[S].index.length*a+t;let d;d=1===r?o.getDataByType(h[S].data,i,s,r,"number"):"2"===r?o.getDataByType(h[S].data,i,s,r):o.getDataByType(h[S].data,i,s,"0");const u=o.getDataIndex(e,n,h[S].index);c.push({data:d,index:u})}const d=t.extendNumber,u=[];if(d)for(let S=0;S<d.length;S++){const t=o.getLenS(d[S].index,l),i=d[S].index.length*a+t;let h;h="1"===r||"3"===r?o.getDataByType(d[S].data,i,s,r,"extendNumber"):"2"===r?o.getDataByType(d[S].data,i,s,r):o.getDataByType(d[S].data,i,s,"0");const c=o.getDataIndex(e,n,d[S].index);u.push({data:h,index:c})}const g=t.date,p=[];if(g)for(let S=0;S<g.length;S++){const t=o.getLenS(g[S].index,l),i=g[S].index.length*a+t;let h;h="1"===r||"3"===r?o.getDataByType(g[S].data,i,s,r,"date"):"8"===r?o.getDataByType(g[S].data,i,s,"0"):o.getDataByType(g[S].data,i,s,r);const c=o.getDataIndex(e,n,g[S].index);p.push({data:h,index:c})}const _=t.chnNumber,m=[];if(_)for(let S=0;S<_.length;S++){const t=o.getLenS(_[S].index,l),i=_[S].index.length*a+t;let h;h="1"===r||"3"===r?o.getDataByType(_[S].data,i,s,r,"chnNumber"):"2"===r||"8"===r?o.getDataByType(_[S].data,i,s,r):o.getDataByType(_[S].data,i,s,"0");const c=o.getDataIndex(e,n,_[S].index);m.push({data:h,index:c})}const f=t.chnWeek2,v=[];if(f)for(let S=0;S<f.length;S++){const t=o.getLenS(f[S].index,l),i=f[S].index.length*a+t;let h;h="1"===r||"3"===r?o.getDataByType(f[S].data,i,s,r,"chnWeek2"):"2"===r?o.getDataByType(f[S].data,i,s,r):o.getDataByType(f[S].data,i,s,"0");const c=o.getDataIndex(e,n,f[S].index);v.push({data:h,index:c})}const b=t.chnWeek3,C=[];if(b)for(let S=0;S<b.length;S++){const t=o.getLenS(b[S].index,l),i=b[S].index.length*a+t;let h;h="1"===r||"3"===r?o.getDataByType(b[S].data,i,s,r,"chnWeek3"):"2"===r?o.getDataByType(b[S].data,i,s,r):o.getDataByType(b[S].data,i,s,"0");const c=o.getDataIndex(e,n,b[S].index);C.push({data:h,index:c})}const T=t.other,w=[];if(T)for(let S=0;S<T.length;S++){const t=o.getLenS(T[S].index,l),i=T[S].index.length*a+t;let h;h="2"===r||"3"===r?o.getDataByType(T[S].data,i,s,r):o.getDataByType(T[S].data,i,s,"0");const c=o.getDataIndex(e,n,T[S].index);w.push({data:h,index:c})}for(let S=1;S<=n;S++){if(c.length>0)for(let t=0;t<c.length;t++)S in c[t].index&&i.push(c[t].data[c[t].index[S]]);if(u.length>0)for(let t=0;t<u.length;t++)S in u[t].index&&i.push(u[t].data[u[t].index[S]]);if(p.length>0)for(let t=0;t<p.length;t++)S in p[t].index&&i.push(p[t].data[p[t].index[S]]);if(m.length>0)for(let t=0;t<m.length;t++)S in m[t].index&&i.push(m[t].data[m[t].index[S]]);if(v.length>0)for(let t=0;t<v.length;t++)S in v[t].index&&i.push(v[t].data[v[t].index[S]]);if(C.length>0)for(let t=0;t<C.length;t++)S in C[t].index&&i.push(C[t].data[C[t].index[S]]);if(w.length>0)for(let t=0;t<w.length;t++)S in w[t].index&&i.push(w[t].data[w[t].index[S]])}return i}static getCopyData(t,e,n,r,s,o){const i=this,a=[];let l=0,h=0,c=0,d=0;o===Ft.BOTTOM||o===Ft.TOP?(l=r,h=s,c=e,d=n):o!==Ft.RIGHT&&o!==Ft.LEFT||(l=e,h=n,c=r,d=s);for(let u=l;u<=h;u++){const e={};let n=[],r=[],s="",o=null,l=null,h=!0;for(let a=c,u=0;a<=d;a++,u++){const g=t[u];let p;if(g&&g.v&&!g.f)if(g.fm&&g.fm.t===zt.NUMBER)p="number",o=null,l=null;else if(g.fm&&g.fm.t===zt.DATE)p="date",o=null,l=null;else if(i.isExtendNumber(g.m)[0]){p="extendNumber";const t=i.isExtendNumber(g.m);null===o||null===l?(h=!0,o=t[2],l=t[3]):t[2]!==o||t[3]!==l?(h=!1,o=t[2],l=t[3]):h=!0}else i.isChnNumber(g.m)?(p="chnNumber",o=null,l=null):i.isChnWeek2(g.m)?(p="chnWeek2",o=null,l=null):i.isChnWeek3(g.m)?(p="chnWeek3",o=null,l=null):(p="other",o=null,l=null);else p="other",o=null,l=null;"extendNumber"===p?a===c?c===d?(s=p,n.push(g),r.push(a-c+1),e[s]=[],e[s].push({data:n,index:r})):(s=p,n.push(g),r.push(a-c+1)):a===d?s===p&&h?(n.push(g),r.push(a-c+1),s in e||(e[s]=[],e[s].push({data:n,index:r}))):(s in e||(e[s]=[]),e[s].push({data:n,index:r}),s=p,n=[],n.push(g),r=[],r.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:r})):s===p&&h?(n.push(g),r.push(a-c+1)):(s in e||(e[s]=[]),e[s].push({data:n,index:r}),s=p,n=[],n.push(g),r=[],r.push(a-c+1)):a===c?c===d?(s=p,n.push(g),r.push(a-c+1),e[s]=[],e[s].push({data:n,index:r})):(s=p,n.push(g),r.push(a-c+1)):a===d?s===p?(n.push(g),r.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:r})):(s in e||(e[s]=[]),e[s].push({data:n,index:r}),s=p,n=[],n.push(g),r=[],r.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:r})):s===p?(n.push(g),r.push(a-c+1)):(s in e||(e[s]=[]),e[s].push({data:n,index:r}),s=p,n=[],n.push(g),r=[],r.push(a-c+1))}a.push(e)}return a}static ChineseToNumber(t){const e=this;let n=0,r=0,s=0,o=!1;const i=t.split("");for(let a=0;a<i.length;a++){const t=e.chnNumChar[i[a]];if(void 0!==t)s=t,a===i.length-1&&(r+=s);else{const t=e.chnNameValue[i[a]].value;o=e.chnNameValue[i[a]].secUnit,o?(r=(r+s)*t,n+=r,r=0):r+=s*t,s=0}}return n+r}static NumberToChinese(t){const e=this;let n=0,r="",s="",o=!1;if(0===t)return e.chnNumChar2[0];for(;t>0;){const i=t%1e4;o&&(s=e.chnNumChar2[0]+s),r=e.SectionToChinese(i),r+=0!==i?e.chnUnitSection[n]:e.chnUnitSection[0],s=r+s,o=i<1e3&&i>0,t=Math.floor(t/1e4),n++}return s}static SectionToChinese(t){const e=this;let n="",r="",s=0,o=!0;for(;t>0;){const i=t%10;0===i?o||(o=!0,r=e.chnNumChar2[i]+r):(o=!1,n=e.chnNumChar2[i],n+=e.chnUnitChar[s],r=n+r),s++,t=Math.floor(t/10)}return r}static getLenS(t,e){let n=0;for(let r=0;r<t.length&&t[r]<=e;r++)n++;return n}static getDataByType(t,e,n,r,s){const o=this;let i=[];if(r===bt.ALTERNATE_SERIES)n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillCopy(t,e);else if(r===bt.DEFAULT_SERIES)if("number"===s)i=o.FillSeries(t,e,n);else if("extendNumber"===s)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillExtendNumber(t,e,r)}else{const r=[];for(let e=0;e<t.length;e++){const n=t[e].m;r.push(Number(o.isExtendNumber(n)[1]))}if(n!==Ft.TOP&&n!==Ft.LEFT||(t.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillExtendNumber(t,e,n)}else i=o.FillCopy(t,e)}else if("date"===s)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillDays(t,e,r)}else{n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=o.judgeDate(t);if(r[0]&&r[3]){const n=hn(t[1].m).diff(hn(t[0].m),"months");i=o.FillMonths(t,e,n)}else if(!r[0]&&r[2]){const n=hn(t[1].m).diff(hn(t[0].m),"days");i=o.FillDays(t,e,n)}else i=o.FillCopy(t,e)}else if("chnNumber"===s)if(1===t.length)if(""===t[0].m||o.ChineseToNumber(t[0].m)<7){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillChnWeek(t,e,r)}else{let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillChnNumber(t,e,r)}else{let r=!1;for(let e=0;e<t.length;e++)if(""===t[e].m){r=!0;break}const s=[];let a=0;for(let e=0;e<t.length;e++)""===t[e].m?0===e?s.push(0):(a++,s.push(7*a)):r&&o.ChineseToNumber(t[e].m)>0&&o.ChineseToNumber(t[e].m)<7?s.push(o.ChineseToNumber(t[e].m)+7*a):s.push(o.ChineseToNumber(t[e].m));if(n!==Ft.TOP&&n!==Ft.LEFT||(t.reverse(),s.reverse()),o.isEqualDiff(s))if(r||s[s.length-1]<6&&s[0]>0||s[0]<6&&s[s.length-1]>0){const n=s[1]-s[0];i=o.FillChnWeek(t,e,n)}else{const n=s[1]-s[0];i=o.FillChnNumber(t,e,n)}else i=o.FillCopy(t,e)}else if("chnWeek2"===s)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillChnWeek2(t,e,r)}else{const r=[];let s=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);""===t[e].m?0===e?r.push(0):(s++,r.push(7*s)):r.push(o.ChineseToNumber(n)+7*s)}if(n!==Ft.TOP&&n!==Ft.LEFT||(t.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnWeek2(t,e,n)}else i=o.FillCopy(t,e)}else if("chnWeek3"===s)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillChnWeek3(t,e,r)}else{const r=[];let s=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);""===t[e].m?0===e?r.push(0):(s++,r.push(7*s)):r.push(o.ChineseToNumber(n)+7*s)}if(n!==Ft.TOP&&n!==Ft.LEFT||(t.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnWeek3(t,e,n)}else i=o.FillCopy(t,e)}else n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillCopy(t,e);else if("2"===r)n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillOnlyFormat(t,e);else if("3"===r){const r=o.getDataByType(t,e,n,"1",s);i=o.FillWithoutFormat(r)}else if("4"===r)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillDays(t,e,r)}else if(2===t.length){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"days");i=o.FillDays(t,e,r)}else{n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=o.judgeDate(t);if(r[0]&&r[3]){const n=hn(t[1].m).diff(hn(t[0].m),"months");i=o.FillMonths(t,e,n)}else if(!r[0]&&r[2]){const n=hn(t[1].m).diff(hn(t[0].m),"days");i=o.FillDays(t,e,n)}else i=o.FillCopy(t,e)}else if("5"===r)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1);const s=Math.round(1.5*e);for(let n=1;n<=s;n++){const s=__spreadValues({},t[n]),o=hn(s.m).add(n,"days").day();if(0===o||6===o)continue;const a=hn(s.m).add(r*n,"days").format("YYYY-MM-DD");if(s.m=a,s.v=vn(a)[2],i.push(s),i.length===e)break}}else if(2===t.length)if(hn(t[1].m).date()===hn(t[0].m).date()&&0!==hn(t[1].m).diff(hn(t[0].m),"months")){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=__spreadValues({},t[e]),o=hn(t[t.length-1]).add(r*n,"months").day();let a;a=0===o?hn(t[t.length-1]).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?hn(t[t.length-1]).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):hn(t[t.length-1]).add(r*n,"months").format("YYYY-MM-DD"),s.m=a,s.v=vn(a)[2],i.push(s)}}else if(Math.abs(hn(t[1].m).diff(hn(t[0].m)))>7){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"months").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").day();let h;h=0===l?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=h,o.v=vn(h)[2],i.push(o)}}else{let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=7:n!==Ft.TOP&&n!==Ft.LEFT||(r=-7,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"days").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").day();let h;h=0===l?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=h,o.v=vn(h)[2],i.push(o)}}else{const r=o.judgeDate(t);if(r[0]&&r[3]){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=__spreadValues({},t[e]),o=hn(t[t.length-1].m).add(r*n,"months").day();let a;a=0===o?hn(t[t.length-1].m).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?hn(t[t.length-1].m).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):hn(t[t.length-1].m).add(r*n,"months").format("YYYY-MM-DD"),s.m=a,s.v=vn(a)[2],i.push(s)}}else if(!r[0]&&r[2])if(Math.abs(hn(t[1].m).diff(hn(t[0].m)))>7){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"months").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").day();let h;h=0===l?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=h,o.v=vn(h)[2],i.push(o)}}else{let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=7:n!==Ft.TOP&&n!==Ft.LEFT||(r=-7,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"days").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").day();let h;h=0===l?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=h,o.v=vn(h)[2],i.push(o)}}else n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillCopy(t,e)}else if("6"===r)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillMonths(t,e,r)}else if(2===t.length)if(hn(t[1].m).date()===hn(t[0].m).date()&&0!==hn(t[1].m).diff(hn(t[0].m),"months")){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"months");i=o.FillMonths(t,e,r)}else{let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"months").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=vn(l)[2],i.push(o)}}else{const r=o.judgeDate(t);if(r[0]&&r[3]){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"months");i=o.FillMonths(t,e,r)}else if(!r[0]&&r[2]){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"months").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=vn(l)[2],i.push(o)}}else n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillCopy(t,e)}else if("7"===r)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillYears(t,e,r)}else if(2===t.length)if(hn(t[1].m).date()===hn(t[0].m).date()&&hn(t[1].m).month()===hn(t[0].m).month()&&0!==hn(t[1].m).diff(hn(t[0].m),"years")){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"years");i=o.FillYears(t,e,r)}else{let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"years").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=vn(l)[2],i.push(o)}}else{const r=o.judgeDate(t);if(r[0]&&r[1]&&r[4]){n!==Ft.TOP&&n!==Ft.LEFT||t.reverse();const r=hn(t[1].m).diff(hn(t[0].m),"years");i=o.FillYears(t,e,r)}else if(r[0]&&r[3]||r[2]){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=__spreadValues({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=hn(o.m).add(r*a,"years").diff(hn(o.m),"days"));const l=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=vn(l)[2],i.push(o)}}else n!==Ft.TOP&&n!==Ft.LEFT||t.reverse(),i=o.FillCopy(t,e)}else if("8"===r)if(1===t.length){let r=0;n===Ft.BOTTOM||n===Ft.RIGHT?r=1:n!==Ft.TOP&&n!==Ft.LEFT||(r=-1),i=o.FillChnNumber(t,e,r)}else{const r=[];for(let e=0;e<t.length;e++)r.push(o.ChineseToNumber(t[e].m));if(n!==Ft.TOP&&n!==Ft.LEFT||(t.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnNumber(t,e,n)}else i=o.FillCopy(t,e)}return i}static getDataIndex(t,e,n){const r={},s=Math.floor(e/t),o=e%t;let i=0;if(s>0){for(let e=1;e<=s;e++)for(let s=0;s<n.length;s++)r[n[s]+(e-1)*t]=i,i++;for(let e=0;e<n.length&&n[e]<=o;e++)r[n[e]+t*s]=i,i++}else for(let a=0;a<n.length&&n[a]<=o;a++)r[n[a]]=i,i++;return r}static FillCopy(t,e){const n=[];for(let r=1;r<=e;r++){const e=(r-1)%t.length,s=__spreadValues({},t[e]);n.push(s)}return n}static FillSeries(t,e,n){const r=this,s=[],o=[];for(let i=0;i<t.length;i++)o.push(Number(t[i].v));if(t.length>2&&r.isEqualRatio(o))for(let i=1;i<=e;i++){const e=(i-1)%t.length,r=__spreadValues({},t[e]);let o;n===Ft.BOTTOM||n===Ft.RIGHT?o=Number(t[t.length-1].v)*(Number(t[1].v)/Number(t[0].v))**i:n!==Ft.TOP&&n!==Ft.LEFT||(o=Number(t[0].v)/(Number(t[1].v)/Number(t[0].v))**i),r.v=o,r.m=o,s.push(r)}else{const i=r.getXArr(t.length);for(let a=1;a<=e;a++){const e=(a-1)%t.length,l=__spreadValues({},t[e]);let h;n===Ft.BOTTOM||n===Ft.RIGHT?h=r.forecast(t.length+a,o,i):n!==Ft.TOP&&n!==Ft.LEFT||(h=r.forecast(1-a,o,i)),l.v=h,l.m=h,s.push(l)}}return s}static FillExtendNumber(t,e,n){const r=[],s=/0|([1-9]+[0-9]*)/g;for(let o=1;o<=e;o++){const e=(o-1)%t.length,i=__spreadValues({},t[e]),a=t[t.length-1].m,l=a.match(s),h=l[l.length-1],c=Math.abs(Number(h)+n*o),d=a.lastIndexOf(h),u=a.substr(0,d)+c.toString()+a.substr(d+h.length);i.v=u,i.m=u,r.push(i)}return r}static FillOnlyFormat(t,e){const n=[];for(let r=1;r<=e;r++){const e=(r-1)%t.length,s=__spreadValues({},t[e]);delete s.f,delete s.m,delete s.v,n.push(s)}return n}static FillWithoutFormat(t){const e=[];for(let n=0;n<t.length;n++){const r=__spreadValues({},t[n]);let s;s=null===r.f?{m:r.v.toString(),v:r.v}:{f:r.f,m:r.v.toString(),v:r.v},e.push(s)}return e}static FillDays(t,e,n){const r=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=__spreadValues({},t[e]);let i=void o.v;i=hn(i).add(n*s,"days").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.f,void o.v),r.push(o)}return r}static FillMonths(t,e,n){const r=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=__spreadValues({},t[e]);let i=void o.v;i=hn(i).add(n*s,"months").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.f,void o.v),r.push(o)}return r}static FillYears(t,e,n){const r=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=__spreadValues({},t[e]);let i=void o.v;i=hn(i).add(n*s,"years").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.t,void o.v),r.push(o)}return r}static FillChnWeek(t,e,n){const r=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,i=__spreadValues({},t[e]);let a;a=""===t[t.length-1].m?7+n*o:r.ChineseToNumber(t[t.length-1].m)+n*o,a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(i.m="",i.v=""):1===l?(i.m="",i.v=""):2===l?(i.m="",i.v=""):3===l?(i.m="",i.v=""):4===l?(i.m="",i.v=""):5===l?(i.m="",i.v=""):6===l&&(i.m="",i.v=""),s.push(i)}return s}static FillChnWeek2(t,e,n){const r=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,i=__spreadValues({},t[e]);let a;if(""===t[t.length-1].m)a=7+n*o;else{const e=t[t.length-1].m,s=e.substr(e.length-1,1);a=r.ChineseToNumber(s)+n*o}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(i.m="",i.v=""):1===l?(i.m="",i.v=""):2===l?(i.m="",i.v=""):3===l?(i.m="",i.v=""):4===l?(i.m="",i.v=""):5===l?(i.m="",i.v=""):6===l&&(i.m="",i.v=""),s.push(i)}return s}static FillChnWeek3(t,e,n){const r=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,i=__spreadValues({},t[e]);let a;if(""===t[t.length-1].m)a=7+n*o;else{const e=t[t.length-1].m,s=e.substr(e.length-1,1);a=r.ChineseToNumber(s)+n*o}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(i.m="",i.v=""):1===l?(i.m="",i.v=""):2===l?(i.m="",i.v=""):3===l?(i.m="",i.v=""):4===l?(i.m="",i.v=""):5===l?(i.m="",i.v=""):6===l&&(i.m="",i.v=""),s.push(i)}return s}static FillChnNumber(t,e,n){const r=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,i=__spreadValues({},t[e]),a=r.ChineseToNumber(t[t.length-1].m)+n*o;let l;l=a<=0?"":r.NumberToChinese(a),i.v=l,i.m=l.toString(),s.push(i)}return s}static isEqualDiff(t){let e=!0;const n=t[1]-t[0];for(let r=1;r<t.length;r++)if(t[r]-t[r-1]!==n){e=!1;break}return e}static isChnNumber(t){const e=this;let n=!0;if(1===t.length)n=""===t||t in e.chnNumChar;else{const r=t.split("");for(let t=0;t<r.length;t++)if(!(r[t]in e.chnNumChar)&&!(r[t]in e.chnNameValue)){n=!1;break}}return n}static isExtendNumber(t){const e=/0|([1-9]+[0-9]*)/g,n=e.test(t);if(n){const r=t.match(e),s=r[r.length-1],o=t.lastIndexOf(s),i=t.substr(0,o),a=t.substr(o+s.length);return[n,Number(s),i,a]}return[n]}static isChnWeek1(t){const e=this;let n;return n=1===t.length&&(""===t||e.ChineseToNumber(t)<7),n}static isChnWeek2(t){let e;return e=2===t.length&&(""===t||""===t||""===t||""===t||""===t||""===t||""===t),e}static isChnWeek3(t){let e;return e=3===t.length&&(""===t||""===t||""===t||""===t||""===t||""===t||""===t),e}static isEqualRatio(t){let e=!0;const n=t[1]/t[0];for(let r=1;r<t.length;r++)if(t[r]/t[r-1]!==n){e=!1;break}return e}static getXArr(t){const e=[];for(let n=1;n<=t;n++)e.push(n);return e}static forecast(t,e,n){function r(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}const s=r(n),o=r(e);let i,a=0,l=0;for(let c=0;c<n.length;c++)a+=(n[c]-s)*(e[c]-o),l+=(n[c]-s)*(n[c]-s);i=0===l?1:a/l;const h=o-i*s;return Math.round(1e5*(h+i*t))/1e5}static judgeDate(t){let e=!0,n=!0,r=!0,s=!0,o=!0;const i=hn(t[0].m).date(),a=hn(t[0].m).month(),l=hn(t[1].m).diff(hn(t[0].m),"days"),h=hn(t[1].m).diff(hn(t[0].m),"months"),c=hn(t[1].m).diff(hn(t[0].m),"years");for(let d=1;d<t.length;d++)hn(t[d].m).date()!==i&&(e=!1),hn(t[d].m).month()!==a&&(n=!1),hn(t[d].m).diff(hn(t[d-1].m),"days")!==l&&(r=!1),hn(t[d].m).diff(hn(t[d-1].m),"months")!==h&&(s=!1),hn(t[d].m).diff(hn(t[d-1].m),"years")!==c&&(o=!1);return 0===l&&(r=!1),0===h&&(s=!1),0===c&&(o=!1),[e,n,r,s,o]}}class wn{constructor(t,e){this._context=t.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=t,this._rangeList=[],e.forEach((t=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(t).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(t){let{_rangeList:e,_context:n,_commandManager:r,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=e,a=new m;for(let s=n;s<=o;s++)for(let e=r;e<=i;e++)a.setValue(n,r,{m:`${t}`,v:t});return{sheetId:s.getSheetId(),actionName:Gs.NAME,cellValue:a.getData()}}));let i=new Fr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}clear(...t){const{_context:e,_worksheet:n,_commandManager:r,_rangeList:s}=this;let o={formatOnly:!0,contentsOnly:!0};Ar.checkup(t,Ar.OBJECT_TYPE)&&(o=t[0]);const i=s.map((t=>({sheetId:n.getSheetId(),actionName:Xs.NAME,options:o,rangeData:t})));let a=new Fr({WorkBookUnit:e.getWorkBook()},...i);return r.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}setBackground(t){let{_rangeList:e,_context:n,_commandManager:r,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=e;const a={bg:{rgb:t}},l=C.fillObjectMatrix(o-n+1,i-r+1,a);return{sheetId:s.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let i=new Fr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setBackgroundRGB(t,e,n){const r=`RGB(${t},${e},${n})`;let{_rangeList:s,_context:o,_commandManager:i,_worksheet:a}=this;const l=s.map((t=>{let{startRow:e,startColumn:n,endRow:s,endColumn:o}=t;const i={bg:{rgb:r}},l=C.fillObjectMatrix(s-e+1,o-n+1,i);return{sheetId:a.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let h=new Fr({WorkBookUnit:o.getWorkBook()},...l);return i.invoke(h),this}setFontColor(t){let{_rangeList:e,_context:n,_commandManager:r,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=e;const a={cl:{rgb:t}},l=C.fillObjectMatrix(o-n+1,i-r+1,a);return{sheetId:s.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let i=new Fr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setFontFamily(t){return this._setStyle(t,"ff")}setUnderline(t){const e={s:t?be.TRUE:be.FALSE};return this._setStyle(e,"ul")}setOverline(t){const e={s:t?be.TRUE:be.FALSE};return this._setStyle(e,"ol")}setStrikeThrough(t){const e={s:t?be.TRUE:be.FALSE};return this._setStyle(e,"st")}setFontSize(t){return this._setStyle(t,"fs")}setFontStyle(t){const e=t?be.TRUE:be.FALSE;return this._setStyle(e,"it")}setFontWeight(t){const e=t?be.TRUE:be.FALSE;return this._setStyle(e,"bl")}setHorizontalAlignment(t){return this._setStyle(t,"ht")}setTextDirection(t){return this._setStyle(t,"td")}setTextRotation(t){let{_rangeList:e,_context:n,_commandManager:r,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=e;const a={tr:{v:0,a:Number(t)}},l=C.fillObjectMatrix(o-n+1,i-r+1,a);return{sheetId:s.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let i=new Fr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setVerticalAlignment(t){return this._setStyle(t,"vt"),this}setVerticalText(t){let{_rangeList:e,_context:n,_commandManager:r,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=e;const a={tr:{v:t,a:0}},l=C.fillObjectMatrix(o-n+1,i-r+1,a);return{sheetId:s.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let i=new Fr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setWrap(t){return this._setStyle(t,"tb")}setWrapStrategy(t){return this._setStyle(t,"tb")}trimWhitespace(){let{_rangeList:t,_context:e,_commandManager:n,_worksheet:r}=this;const s=t.map((t=>{let{startRow:e,startColumn:n,endRow:s,endColumn:o}=t;const i=this._worksheet.getCellMatrix(),a=/\s+/g;let l=new m;for(let r=e;r<s+1;r++)for(let t=n;t<o+1;t++){const e=i.getValue(r,t).m.replace(a,"");l.setValue(r,t,e||"")}return{sheetId:r.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:l.getData(),rangeData:t}}));let o=new Fr({WorkBookUnit:e.getWorkBook()},...s);return n.invoke(o),this}_setStyle(t,e){let{_rangeList:n,_context:r,_commandManager:s,_worksheet:o}=this;const i=n.map((n=>{let{startRow:r,startColumn:s,endRow:i,endColumn:a}=n;const l={[e]:t},h=C.fillObjectMatrix(i-r+1,a-s+1,l);return{sheetId:o.getSheetId(),value:h,rangeData:n,actionName:fo.NAME}}));let a=new Fr({WorkBookUnit:r.getWorkBook()},...i);return s.invoke(a),this}}class Sn{constructor(t,e){this._workSheet=t,this._rowData=new p(e)}getRowData(){return this._rowData}getRowDatas(t,e){const n=new p;for(let r=t;r<t+e;r++){const t=this.getRowOrCreate(r);n.push(t)}return n}getRowHeight(...t){const{_workSheet:e}=this,{_rowData:n}=this,r=e.getConfig();let s=0;if(1===t.length){s=n.obtain(t[0],{hd:be.FALSE,h:r.defaultRowHeight}).h}else if(2===t.length)for(let o=t[0];o<t[0]+t[1];o++){s+=n.obtain(o,{hd:be.FALSE,h:r.defaultRowHeight}).h}return s}setRowHeight(t,e){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:Co.NAME,rowIndex:t,rowHeight:e},o=new Fr({WorkBookUnit:n.getWorkBook()},s);r.invoke(o)}getRow(t){const{_rowData:e}=this;return e.get(t)}getSize(){return this._rowData.getLength()}getRowOrCreate(t){const{_workSheet:e}=this,{_rowData:n}=this,r=n.get(t);if(r)return r;const s=e.getConfig(),o={hd:be.FALSE,h:s.defaultRowHeight};return n.set(t,o),o}}class En{constructor(...t){var e;if(C.hasLength(t,1)){t=[t[0],__spreadProps(__spreadValues({},De),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A1"],rightToLeft:be.FALSE,pluginMeta:{}})]}if(C.hasLength(t,2)){this._context=t[0],this._config=Object.assign(t[1],__spreadValues(__spreadProps(__spreadValues({},De),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A1"],rightToLeft:be.FALSE,pluginMeta:{}}),t[1]));const{columnData:n,rowData:r,cellData:s}=this._config;this._sheetId=null!=(e=this._config.id)?e:C.generateRandomId(6),this._initialized=!1,this._cellData=new m(s),this._rowManager=new Sn(this,r),this._columnManager=new sn(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===be.TRUE)return this;const{_context:t}=this,e=this.getCommandManager(),n=t.getContextObserver("onBeforeChangeActiveSheetObservable"),r=t.getContextObserver("onAfterChangeActiveSheetObservable"),s={sheetId:this._sheetId,actionName:Oo.NAME,status:be.TRUE},o=new Fr({WorkBookUnit:t.getWorkBook()},s);return n.notifyObservers({sheet:this}),e.invoke(o),r.notifyObservers({sheet:this}),this}setConfig(t){return this._config=C.commonExtend(De,t),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s=e.getContextObserver("onBeforeChangeSheetNameObservable"),o=e.getContextObserver("onAfterChangeSheetNameObservable"),i={actionName:ko.NAME,sheetName:t,sheetId:n},a=e.getWorkBook().getSheets();for(let h=0;h<a.length;h++){const e=a[h];if(e!==this&&e.getName()===t)return console.warn("Duplicate name"),this}s.notifyObservers();const l=new Fr({WorkBookUnit:e.getWorkBook()},i);return r.invoke(l),o.notifyObservers({name:t,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:t,_context:e}=this,n=C.deepClone(t);return new En(e,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._context.getCommandManager()}getSheetData(){return[]}getRange(...t){return C.hasLength(t,1)?new yn(this,t[0]):C.hasLength(t,2)?new yn(this,{row:[t[0],t[0]],column:[t[1],t[1]]}):C.hasLength(t,3)?new yn(this,{row:[t[0],t[2]],column:[t[1],t[1]]}):C.hasLength(t,4)?new yn(this,{row:[t[0],t[2]],column:[t[1],t[3]]}):void 0}getRangeList(t){return new wn(this,t)}getStatus(){const{_config:t}=this;return t.status}setStatus(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:Do.NAME,sheetId:n,sheetStatus:t},o=new Fr({WorkBookUnit:e.getWorkBook()},s);return r.invoke(o),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:Lo.NAME,zoom:t,sheetId:n},o=new Fr({WorkBookUnit:e.getWorkBook()},s);r.invoke(o);e.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:t})}getSelection(){return this._selection}copy(t){const{_config:e,_context:n}=this,r=C.deepClone(e);return r.name=t,r.status=be.FALSE,r.id=C.generateRandomId(),new En(n,r)}getConfig(){return this._config}insertRows(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]),C.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:Js.NAME,sheetId:s,rowIndex:e,rowData:m.MakeObjectMatrixSize(n).toJSON()},a={actionName:Zs.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Fr({WorkBookUnit:r.getWorkBook()},i,a);return o.invoke(l),this}insertRowAfter(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]+1),C.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:Js.NAME,sheetId:s,rowIndex:e,rowData:m.MakeObjectMatrixSize(n).toJSON()},a={actionName:Zs.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Fr({WorkBookUnit:r.getWorkBook()},i,a);return o.invoke(l),this}insertRowBefore(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]-1),C.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:Js.NAME,sheetId:s,rowIndex:e,rowData:m.MakeObjectMatrixSize(n).toJSON()},a={actionName:Zs.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Fr({WorkBookUnit:r.getWorkBook()},i,a);return o.invoke(l),this}insertColumns(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]),C.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new m;this._cellData.forEach((t=>{for(let r=e;r<e+n;r++)i.setValue(t,r-e,{})}));const a={actionName:qs.NAME,sheetId:s,columnIndex:e,columnData:i.toJSON()},l={actionName:Ks.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Fr({WorkBookUnit:r.getWorkBook()},l,a);return o.invoke(h),this}insertColumnBefore(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]-1),C.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new m;if(this._cellData.getLength())this._cellData.forEach((t=>{for(let r=e;r<e+n;r++)i.setValue(t,r-e,{})}));else for(let c=0;c<this._config.rowCount;c++)for(let t=e;t<e+n;t++)i.setValue(c,t-e,{});const a={actionName:qs.NAME,sheetId:s,columnIndex:e,columnData:i.toJSON()},l={actionName:Ks.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Fr({WorkBookUnit:r.getWorkBook()},l,a);return o.invoke(h),this}insertColumnAfter(...t){let e=0,n=1;C.hasLength(t,1)&&(e=t[0]+1),C.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new m;this._cellData.forEach((t=>{for(let r=e;r<e+n;r++)i.setValue(t,r-e,{})}));const a={actionName:qs.NAME,sheetId:s,columnIndex:e,columnData:i.toJSON()},l={actionName:Ks.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Fr({WorkBookUnit:r.getWorkBook()},a,l);return o.invoke(h),this}clear(...t){const{_context:e}=this,n=this.getCommandManager(),r={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let s={formatOnly:!0,contentsOnly:!0};Ar.checkup(t,Ar.OBJECT_TYPE)&&(s=t[0]);const o={sheetId:this._sheetId,actionName:Xs.NAME,options:s,rangeData:r},i=new Fr({WorkBookUnit:e.getWorkBook()},o);return n.invoke(i),this}setTabColor(t){const{_context:e}=this,n=this.getCommandManager(),r=e.getContextObserver("onSheetTabColorChangeObservable"),s={sheetId:this._sheetId,actionName:Io.NAME,color:t},o=new Fr({WorkBookUnit:e.getWorkBook()},s);return n.invoke(o),r.notifyObservers(),this}hideSheet(){const{_context:t}=this,e=this.getCommandManager(),n=t.getWorkBook();if(!this._config.hidden){const r=t.getContextObserver("onHideSheetObservable"),s={hidden:be.TRUE,sheetId:this._sheetId,actionName:Mo.NAME},o=new Fr({WorkBookUnit:t.getWorkBook()},s);e.invoke(o),r.notifyObservers({sheet:this});const i=n.getSheetIndex(this);null!=i&&n.activateSheetByIndex(i)}return this}showSheet(){if(!this._config.hidden)return this;const{_context:t}=this,e=this.getCommandManager(),n={hidden:be.FALSE,sheetId:this._sheetId,actionName:Mo.NAME},r=new Fr({WorkBookUnit:t.getWorkBook()},n);return e.invoke(r),t.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setActiveSelection(...t){const e=t[0];return e?this._selection.setSelection({selection:e}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:t}=this,{columnCount:e}=t;return e}getMaxRows(){const{_config:t}=this,{rowCount:e}=t;return e}getType(){const{_config:t}=this,{type:e}=t;return e}clearContents(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:eo.NAME,sheetId:n,columnCount:1,columnIndex:t},o={actionName:to.NAME,sheetId:n,columnCount:1,columnIndex:t},i=new Fr({WorkBookUnit:e.getWorkBook()},s,o);return r.invoke(i),this}deleteColumns(t,e){const{_context:n,_sheetId:r}=this,s=this.getCommandManager(),o={actionName:eo.NAME,sheetId:r,columnCount:e,columnIndex:t},i={actionName:to.NAME,sheetId:r,columnCount:e,columnIndex:t},a=new Fr({WorkBookUnit:n.getWorkBook()},o,i);return s.invoke(a),this}deleteRow(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:so.NAME,sheetId:n,rowCount:1,rowIndex:t},o={actionName:ro.NAME,sheetId:n,rowCount:1,rowIndex:t},i=new Fr({WorkBookUnit:e.getWorkBook()},s,o);return r.invoke(i),this}deleteRows(t,e){const{_context:n,_sheetId:r}=this,s=this.getCommandManager(),o={actionName:so.NAME,sheetId:r,rowCount:e,rowIndex:t},i={actionName:ro.NAME,sheetId:r,rowCount:e,rowIndex:t},a=new Fr({WorkBookUnit:n.getWorkBook()},o,i);return s.invoke(a),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(t,e,n){const{_sheetId:r}=this,s=this.getCommandManager(),o=this.getContext(),i=this.getCellMatrix(),a=o.getWorkBook(),l=a.getStyles(),h=this.getRange({startRow:t.startRow-1,startColumn:t.startColumn,endRow:t.startRow-1,endColumn:t.endColumn}),c=this.getRange({startRow:t.startRow,startColumn:t.startColumn-1,endRow:t.startRow,endColumn:t.endColumn-1}),d=this.getRange({startRow:t.endRow+1,startColumn:t.startColumn,endRow:t.endRow+1,endColumn:t.endColumn}),u=this.getRange({startRow:t.startRow,startColumn:t.endColumn+1,endRow:t.startRow,endColumn:t.endColumn+1}),g=this.getRange(t),p=new m,_=new m,f=new m,v=new m,b=new m;h.forEach(((t,e)=>{const n=i.getValue(t,e);if(n){const r=l.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.b,p.setValue(t,e,n)}}})),d.forEach(((t,e)=>{const n=i.getValue(t,e);if(n){const r=l.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.t,f.setValue(t,e,n)}}})),c.forEach(((t,e)=>{const n=i.getValue(t,e);if(n){const r=l.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.r,_.setValue(t,e,n)}}})),u.forEach(((t,e)=>{const n=i.getValue(t,e);if(n){const r=l.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.l,v.setValue(t,e,n)}}})),g.forEach(((t,n)=>{b.setValue(t,n,e)}));const T=[];if(n.includes(Ft.TOP)){const t={sheetId:r,actionName:io.NAME,styles:f.toJSON()};T.push(t)}if(n.includes(Ft.BOTTOM)){const t={sheetId:r,actionName:io.NAME,styles:p.toJSON()};T.push(t)}if(n.includes(Ft.LEFT)){const t={sheetId:r,actionName:io.NAME,styles:v.toJSON()};T.push(t)}if(n.includes(Ft.RIGHT)){const t={sheetId:r,actionName:io.NAME,styles:_.toJSON()};T.push(t)}const w={sheetId:r,actionName:io.NAME,styles:b.toJSON()};T.push(w);const S=new Fr({WorkBookUnit:a},...T);return s.invoke(S),this}setCurrentCell(t){return t.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex((t=>t&&t.getSheetId()===this._sheetId));return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(t){return this.getSelection().setSelection(t)}setActiveRangeList(t){const e=this.getSelection();return e.setSelection(t),e.getActiveRangeList()}hideRow(t){const e=t.getRangeData(),n=e.startRow,r=e.endRow-e.startRow+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),a={actionName:To.NAME,sheetId:o,rowCount:r,rowIndex:n},l=new Fr({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}hideRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:To.NAME,sheetId:s,rowCount:n,rowIndex:e},a=new Fr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(a),this}hideColumn(t){const e=t.getRangeData(),n=e.startColumn,r=e.endColumn-e.startColumn+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),a={actionName:ao.NAME,sheetId:o,columnCount:r,columnIndex:n},l=new Fr({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}hideColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:ao.NAME,sheetId:s,columnCount:n,columnIndex:e},a=new Fr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(a),this}unhideRow(t){const e=t.getRangeData(),n=e.startRow,r=e.endRow-e.startRow+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),a={actionName:wo.NAME,rowCount:r,rowIndex:n,sheetId:o},l=new Fr({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}unhideColumn(t){const e=t.getRangeData(),n=e.startColumn,r=e.endColumn-e.startColumn+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),a={actionName:lo.NAME,sheetId:o,columnCount:r,columnIndex:n},l=new Fr({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}showColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:lo.NAME,sheetId:s,columnCount:n,columnIndex:e},a=new Fr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(a),this}showRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:wo.NAME,sheetId:s,rowCount:n,rowIndex:e},a=new Fr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(a),this}hasHiddenGridlines(){const{_config:t}=this,{showGridlines:e}=t;return 0===e}getTabColor(){const{_config:t}=this,{tabColor:e}=t;return e}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this.getRowManager().getRowHeight(t)}setColumnWidth(...t){let e,n=[];if(C.hasLength(t,2)&&(e=t[0],n=[t[1]]),C.hasLength(t,3)){e=t[0];for(let e=0;e<t[1];e++)n.push(t[2])}return this.getColumnManager().setColumnWidth(e,n),this}setRowHeights(t,e,n){const r=[];for(let s=0;s<e;s++)r.push(n);return this.getRowManager().setRowHeight(t,r),this}setRowHeight(t,e){const n=[e];return this.getRowManager().setRowHeight(t,n),this}setHiddenGridlines(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:co.NAME,hideGridlines:t,sheetId:n},o=new Fr({WorkBookUnit:e.getWorkBook()},s);return r.invoke(o),this}isRightToLeft(){const{_config:t}=this,{rightToLeft:e}=t;return e}setRightToLeft(t){const{_context:e,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:bo.NAME,rightToLeft:t,sheetId:n},o=new Fr({WorkBookUnit:e.getWorkBook()},s);return r.invoke(o),this}getPluginMeta(t){return this._config.pluginMeta[t]}setPluginMeta(t,e){this._config.pluginMeta[t]=e}copyTo(t){const e=this._context.getWorkBook().getSheets()[t];if(!e)return this;const n=C.deepClone(this._config);return n.sheetId=e.getConfig().id,e.setConfig(n),e}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(t,e,n,r){return new yn(this,{startRow:t,startColumn:e,endRow:t+n-1,endColumn:e+r-1}).getValues()}getDataRange(){return new yn(this,this._cellData.getRange())}moveRows(t,e){const{startRow:n}=t.getRangeData(),{endRow:r}=t.getRangeData(),s=this._cellData.spliceRows(n,r-n+1);return this._cellData.insertRows(e,s),this}moveColumns(t,e){const n=t.getRangeData().startColumn,r=t.getRangeData().endColumn,s=this._cellData.spliceColumns(n,r-n+1);return this._cellData.insertColumns(e,s),this}_initialize(){this._merges=new on(this,this._config.mergeData)}}class yn{constructor(t,e){this._context=t.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(e).rangeData,this._worksheet=t,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(t,e){const{startRow:n,startColumn:r,endRow:s,endColumn:o}=t;for(let i=n;i<=s;i++)for(let t=r;t<=o;t++)e(i,t)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData,s=[];for(let o=t;o<=e;o++){const t=[];for(let e=n;e<=r;e++)t.push(this.getMatrix().getValue(o,e)||null);s.push(t)}return s}getMatrix(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new m;for(let i=t;i<=e;i++)for(let t=n;t<=r;t++)o.setValue(i,t,s.getValue(i,t)||null);return o}getMatrixObject(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new m;for(let i=t;i<=e;i++)for(let e=n;e<=r;e++)o.setValue(i-t,e-n,s.getValue(i,e)||{});return o}getDisplayValue(){const t=this.getValue();return t&&t.p?t.p:t&&t.m?t.m:""}getDisplayValues(){return this.getValues().map((t=>t.map((t=>t&&t.p?t.p:t&&t.m?t.m:""))))}getA1Notation(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData;let s,o;return n<r?(s=C.numToWord(n+1)+(t+1),o=C.numToWord(r+1)+(e+1)):(s=C.numToWord(r+1)+(e+1),o=C.numToWord(n+1)+(t+1)),s===o?`${s}`:`${s}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((t=>t.map((t=>{var e,n,r;const s=this._context.getWorkBook().getStyles();let o=null==(e=Le.bg)?void 0:e.rgb;return o=null==(r=null==(n=s.getStyleByCell(t))?void 0:n.bg)?void 0:r.rgb,o}))))}getCell(t,e){const{startRow:n,endRow:r,startColumn:s,endColumn:o}=this._rangeData,i={startRow:n+t,endRow:n+t,startColumn:s+e,endColumn:s+e};return new yn(this._worksheet,i)}getColumn(){return this._rangeData.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._rangeData,o=this._worksheet.getCellMatrix().getFragments(e,n,r,s).getData();if(t.isIncludeStyle){const t=this._context.getWorkBook().getStyles();for(let i=0;i<=n-e;i++)for(let e=0;e<=s-r;e++){if(!o[i][e])continue;const n=o[i][e].s;n&&(o[i][e].s=t.get(n))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((t=>t.map((t=>{var e,n;const r=this._context.getWorkBook().getStyles().getStyleByCell(t);return(null==(e=null==r?void 0:r.cl)?void 0:e.rgb)||(null==(n=Le.cl)?void 0:n.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:t,_worksheet:e}=this,{startRow:n,endRow:r}=t;let s=0;for(let o=0;o<=r-n;o++){s+=e.getRowHeight(o)}return s}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:t,endRow:e,startColumn:n,endColumn:r}).map((t=>new yn(this._worksheet,t)))}getNextDataCell(t){const{_worksheet:e}=this,{startRow:n,endRow:r,startColumn:s,endColumn:o}=this._rangeData,i=e.getMaxRows(),a=e.getMaxColumns();if(t===Ft.BOTTOM){for(let t=0;t<i-s;t++){this._worksheet.getCellMatrix().getValue(n+t,s)&&e.getRange(n+t,s,n+t,s)}return e.getRange(i,s,i,s)}if(t===Ft.TOP){for(let t=0;t<n;t++){this._worksheet.getCellMatrix().getValue(n-t,s)&&e.getRange(n-t,s,n-t,n)}return e.getRange(0,s,0,s)}if(t===Ft.RIGHT){for(let t=0;t<a-s;t++){this._worksheet.getCellMatrix().getValue(n,s+t)&&e.getRange(n,s+t,n,s+t)}return e.getRange(n,a,n,a)}if(t===Ft.LEFT){for(let t=0;t<i-s;t++){this._worksheet.getCellMatrix().getValue(n,s-t)&&e.getRange(n,s-t,n,s-t)}return e.getRange(n,0,n,0)}return e.getRange(Ne)}getNumColumns(){const{startColumn:t,endColumn:e}=this._rangeData;return e-t+1}getNumRows(){const{startRow:t,endRow:e}=this._rangeData;return e-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((t=>t.map((t=>(null==t?void 0:t.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((t=>t.map((t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:t,_worksheet:e}=this,{startColumn:n,endColumn:r}=t;let s=0;for(let o=0;o<=r-n;o++)s+=e.getColumnWidth(o);return s}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((t=>t.some((t=>""===(null==t?void 0:t.m)))))}isPartOfMerge(){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(t,e,n,r)}setBackground(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={bg:{rgb:t}},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setBackgrounds(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=new m;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-i+1;e++)l.setValue(d,e,{bg:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Fr({WorkBookUnit:e.getWorkBook()},h);return r.invoke(c),this}setBackgroundRGB(t,e,n){const{_context:r,_worksheet:s,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:l,endColumn:h}=this._rangeData,c={bg:{rgb:`RGB(${t},${e},${n})`}},d=C.fillObjectMatrix(a-i+1,h-l+1,c),u={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:d,rangeData:this._rangeData},g=new Fr({WorkBookUnit:r.getWorkBook()},u);return o.invoke(g),this}setFontColors(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=new m;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-i+1;e++)l.setValue(d,e,{cl:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Fr({WorkBookUnit:e.getWorkBook()},h);return r.invoke(c),this}setFontFamilies(t){return this._setStyles(t,"ff"),this}setUnderline(t){return this._setStyle(t,"ul"),this}setOverline(t){return this._setStyle(t,"ol"),this}setStrikeThrough(t){return this._setStyle(t,"st"),this}setUnderlines(t){return this._setStyles(t,"ul"),this}setOverlines(t){return this._setStyles(t,"ol"),this}setStrikeThroughs(t){return this._setStyles(t,"st"),this}setFontSizes(t){return this._setStyles(t,"fs"),this}setFontStyle(t){return this._setStyle(t,"it"),this}setFontStyles(t){return this._setStyles(t,"it"),this}setFontWeight(t){return this._setStyle(t,"bl"),this}setFontWeights(t){return this._setStyles(t,"bl"),this}setHorizontalAlignments(t){return this._setStyles(t,"ht"),this}setTextDirections(t){return this._setStyles(t,"td"),this}setTextRotation(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={tr:{v:0,a:Number(t)}},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setTextRotations(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=new m;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-i+1;e++)l.setValue(d,e,{tr:{v:0,a:t[d][e]}});l.getData();const h={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Fr({WorkBookUnit:e.getWorkBook()},h);return r.invoke(c),this}setTextStyle(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=__spreadValues({},t),h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setTextStyles(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=new m;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-i+1;e++)l.setValue(d,e,__spreadValues({},t[d][e]));const h={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Fr({WorkBookUnit:e.getWorkBook()},h);return r.invoke(c),this}setVerticalAlignments(t){return this._setStyles(t,"vt"),this}setVerticalText(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={tr:{v:t,a:90}},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setWrap(t){return this._setStyle(t,"tb"),this}setWrapStrategies(t){return this._setStyles(t,"tb"),this}setWraps(t){return this._setStyles(t,"tb"),this}autoFill(t,e){const{_worksheet:n,_context:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,{startRow:h,endRow:c,startColumn:d,endColumn:u}=t._rangeData;let g=Ft.BOTTOM,p=0,_=0;const f=o,v=i,b=a,C=l,T=h,w=c,S=d,E=u,y=new m;if(g=S===b&&E===C?w>v?Ft.BOTTOM:Ft.TOP:E>C?Ft.RIGHT:Ft.LEFT,g===Ft.BOTTOM||g===Ft.TOP){p=v-f+1,_=w-T+1;for(let t=0;t<=l-a;t++){const n=this.getColumnMatrix(t).toArray();Tn.getCopyData(n,f,v,b,C,g).forEach((n=>{Tn.getApplyData(n,p,_,e,g).forEach(((e,n)=>{y.setValue(n,t,e)}))}))}}else if(g===Ft.RIGHT||g===Ft.LEFT){_=E-S,p=C-b;for(let t=0;t<=i-o;t++){const n=this.getRowMatrix(t).toArray();Tn.getCopyData(n,f,v,b,C,g).forEach((t=>{Tn.getApplyData(t,p,_,e,g)}))}}const R={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:y.getData()},I=new Fr({WorkBookUnit:r.getWorkBook()},R);return s.invoke(I),this}getDataRegion(...t){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._rangeData;let o,i;const a=this._worksheet.getCellMatrix();if(!C.isNumber(t[0])){let t=e,n=e;const s=this._worksheet.getRowCount();for(let o=1;o<e;o++){if(!a.getValue(e-o,r)){t=e-o+1;break}}const l=0;for(;l<s-e;){if(!a.getValue(e+l,r)){n=e-l-1;break}}let h=e,c=e;const d=this._worksheet.getColumnCount();for(let o=1;o<e;o++){if(!a.getValue(e,r-o)){h=e-o+1;break}}const u=0;for(;u<d-r;){if(!a.getValue(e,r+u)){c=e-u-1;break}}return i=h-c,i=t-n,o=e,this._worksheet.getRange(t,h,o,i)}{const n=t[0];if(n===Bt.COLUMNS){let t=e,n=e;const s=this._worksheet.getRowCount();for(let o=1;o<e;o++){if(!a.getValue(e-o,r)){t=e-o+1;break}}const l=0;for(;l<s-e;){if(!a.getValue(e+l,r)){n=e-l-1;break}}return i=t-n,o=0,this._worksheet.getRange(e,t,o,i)}if(n===Bt.ROWS){let t=e,n=e;const s=this._worksheet.getColumnCount();for(let o=1;o<e;o++){if(!a.getValue(e,r-o)){t=e-o+1;break}}const l=0;for(;l<s-r;){if(!a.getValue(e,r+l)){n=e-l-1;break}}return i=0,o=t-n,this._worksheet.getRange(t,r,o,i)}}return this}trimWhitespace(){var t;const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),h=/\s+/g,c=new m;for(let g=0;g<=o-s;g++)for(let e=0;e<=a-i;e++){const n=null==(t=l.getValue(g,e).m)?void 0:t.replace(h,"");c.setValue(g+s,e+i,n||"")}const d={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},u=new Fr({WorkBookUnit:e.getWorkBook()},d);return r.invoke(u),this}activate(){var t;return-1===(null==(t=this._rangeData)?void 0:t.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(t){const e=this._rangeData.startRow,n=this._rangeData.endRow,r=this._rangeData.startColumn,s=this._rangeData.endColumn,o=t.getRangeData().startRow,i=t.getRangeData().endRow,a=t.getRangeData().startColumn,l=t.getRangeData().endColumn,h=Math.abs(r+s-a-l),c=Math.abs(r-s)+Math.abs(a-l),d=Math.abs(e+n-o-i),u=Math.abs(e-n)+Math.abs(o-i);return h<=c&&d<=u}setFontColor(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={cl:{rgb:t}},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}copyTo(...t){const{_context:e,_worksheet:n,_commandManager:r}=this,s=t[0],[o,i]=this._handleCopyRange(this,s),{startRow:a,startColumn:l,endRow:h,endColumn:c}=i;if(Ar.checkup(t,yn,Ar.BOOLEAN_TYPE)){const s=t[1];if(t[2],s===kt.PASTE_NORMAL){const t=new m;o.forEach(((e,n)=>e.forEach(((e,r)=>{e=e,t.setValue(n+a,r+l,e||{})}))));const s={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:t.getData()},i=new Fr({WorkBookUnit:e.getWorkBook()},s);r.invoke(i)}else if(s===kt.PASTE_FORMAT){const t=e.getWorkBook().getStyles(),s=new m;o.map(((e,n)=>e.forEach(((e,r)=>{e=e,s.setValue(n,r,t.getStyleByCell(e)||{})}))));const a={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:s.getData(),rangeData:i},l=new Fr({WorkBookUnit:e.getWorkBook()},a);r.invoke(l)}else if(s===kt.PASTE_VALUES){const t=new m;o.forEach(((e,n)=>e.forEach(((e,r)=>{e=e,t.setValue(n+a,r+l,(null==e?void 0:e.v)||"")}))));const s={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:t.getData(),rangeData:i},h=new Fr({WorkBookUnit:e.getWorkBook()},s);r.invoke(h)}else if(s===kt.PASTE_COLUMN_WIDTHS){const t=this._rangeData.startColumn;for(let e=0;e<c-t;e++){const r=n.getColumnWidth(t+e);n.setColumnWidth(t+e,r)}}}else if(Ar.checkup(t,yn,Ar.OBJECT_TYPE)){const s=t[1],i=new m;o.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,i.setValue(e+a,n+l,t||{})}))));const h={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:i.getData(),options:s},c=new Fr({WorkBookUnit:e.getWorkBook()},h);r.invoke(c)}else if(Ar.checkup(t,yn)){const t=new m;o.forEach(((e,n)=>e.forEach(((e,r)=>{e=e,t.setValue(n+a,r+l,e||{})}))));const s={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:t.getData()},i=new Fr({WorkBookUnit:e.getWorkBook()},s);r.invoke(i)}}copyFormatToRange(...t){const{_context:e,_commandManager:n}=this,r=t[1],s=t[2],o=t[3],i=t[4],a=C.isAssignableFrom(t[0],En)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:r,endRow:s,startColumn:o,endColumn:i}),c=e.getWorkBook().getStyles(),d=new m;l.map(((t,e)=>t.map(((t,n)=>(t=t,d.setValue(e,n,c.getStyleByCell(t)||{}),c.getStyleByCell(t)||{})))));const u={sheetId:a,actionName:ft.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:h},g=new Fr({WorkBookUnit:e.getWorkBook()},u);n.invoke(g)}copyValuesToRange(...t){const{_context:e,_commandManager:n}=this,r=t[1],s=t[2],o=t[3],i=t[4],a=C.isAssignableFrom(t[0],En)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:r,endRow:s,startColumn:o,endColumn:i}),c=new m;l.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,c.setValue(e+h.startRow,n+h.startColumn,(null==t?void 0:t.v)||"")}))));const d={sheetId:a,actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:h},u=new Fr({WorkBookUnit:e.getWorkBook()},d);n.invoke(u)}moveTo(t){const{_context:e,_worksheet:n,_commandManager:r,_rangeData:s}=this,o={sheetId:n.getSheetId(),actionName:ft.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:s},i=this.getMatrix(),{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData,{startRow:d,startColumn:u}=t.getRangeData(),g=new m;for(let m=a;m<=l;m++)for(let t=h;t<=c;t++)g.setValue(d+(m-a),u+(t-h),i.getValue(m,t)||{});const p={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:g.getData()},_=new Fr({WorkBookUnit:e.getWorkBook()},o,p);r.invoke(_)}offset(...t){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._rangeData,o=t[0],i=t[1],a=t[2],l=t[3],h={startRow:e+o,endRow:n+o,startColumn:r+i,endColumn:s+i};return C.isNumber(a)&&(h.endRow=h.startRow+a-1),C.isNumber(l)&&(h.endColumn=h.endColumn+l-1),new yn(this._worksheet,h)}setBorder(...t){const e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],i=t[5],a=t[6]?t[6]:"black",l=t[7]?t[7]:St.DASH_DOT,{_context:h,_worksheet:c,_commandManager:d}=this,u=h.getWorkBook(),g=this._rangeData,p=c.getSheetId(),_={startRow:g.startRow-1,startColumn:g.startColumn,endRow:g.startRow-1,endColumn:g.endColumn},f={startRow:g.startRow,startColumn:g.startColumn-1,endRow:g.endRow,endColumn:g.startColumn-1},v={startRow:g.endRow+1,startColumn:g.startColumn,endRow:g.endRow+1,endColumn:g.endColumn},b={startRow:g.startRow,startColumn:g.endColumn+1,endRow:g.endRow,endColumn:g.endColumn+1},T={startRow:g.startRow,startColumn:g.startColumn,endRow:g.startRow,endColumn:g.endColumn},w={startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.startColumn},S={startRow:g.endRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn},E={startRow:g.startRow,startColumn:g.endColumn,endRow:g.endRow,endColumn:g.endColumn},y=new yn(c,_),R=new yn(c,f),I=new yn(c,v),A=new yn(c,b),O=new yn(c,T),N=new yn(c,w),M=new yn(c,S),x=new yn(c,E),k=new m,D=new m,L=new m,P=new m,B=new m,H=[],F={s:l,cl:{rgb:a}};if(!0===e||!1===e){if(y.isValid()){y.forEach(((t,e)=>{k.setValue(t,e,{bd:{b:null}})}));const t={sheetId:p,actionName:ft.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:_};H.push(t)}O.forEach(((t,n)=>{if(!0===e){const e=C.deepMerge(B.getValue(t,n)||{},{bd:{t:C.deepClone(F)}});B.setValue(t,n,e)}else if(!1===e){const e=C.deepMerge(B.getValue(t,n)||{},{bd:{t:null}});B.setValue(t,n,e)}}))}if(!0===r||!1===r){if(I.isValid()){I.forEach(((t,e)=>{L.setValue(t,e,{bd:{t:null}})}));const t={sheetId:p,actionName:ft.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:v};H.push(t)}M.forEach(((t,e)=>{if(!0===r){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{b:C.deepClone(F)}});B.setValue(t,e,n)}else if(!1===r){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{b:null}});B.setValue(t,e,n)}}))}if(!0===n||!1===n){if(R.isValid()){R.forEach(((t,e)=>{D.setValue(t,e,{bd:{r:null}})}));const t={sheetId:p,actionName:ft.SET_RANGE_STYLE_ACTION,value:D.getArrayData(),rangeData:f};H.push(t)}N.forEach(((t,e)=>{if(!0===n){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{l:C.deepClone(F)}});B.setValue(t,e,n)}else if(!1===n){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{l:null}});B.setValue(t,e,n)}}))}if(!0===s||!1===s){if(A.isValid()){A.forEach(((t,e)=>{P.setValue(t,e,{bd:{l:null}})}));const t={sheetId:p,actionName:ft.SET_RANGE_STYLE_ACTION,value:P.getArrayData(),rangeData:b};H.push(t)}x.forEach(((t,e)=>{if(!0===s){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{r:C.deepClone(F)}});B.setValue(t,e,n)}else if(!1===s){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{r:null}});B.setValue(t,e,n)}}))}!0!==o&&!1!==o||this.forEach(((t,e)=>{if(e!==g.endColumn)if(!0===o){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{r:C.deepClone(F)}});B.setValue(t,e,n)}else if(!1===o){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{r:null}});B.setValue(t,e,n)}if(e!==g.startColumn){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{l:null}});B.setValue(t,e,n)}})),!0!==i&&!1!==i||this.forEach(((t,e)=>{if(t!==g.endRow)if(!0===i){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{b:C.deepClone(F)}});B.setValue(t,e,n)}else if(!1===i){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{b:null}});B.setValue(t,e,n)}if(t!==g.startRow){const n=C.deepMerge(B.getValue(t,e)||{},{bd:{t:null}});B.setValue(t,e,n)}}));const U={sheetId:p,actionName:ft.SET_RANGE_STYLE_ACTION,value:B.getArrayData(),rangeData:B.getDataRange()};H.push(U);const z=new Fr({WorkBookUnit:u},...H);return d.invoke(z),this}setBorderByType(t,e,n){let r=null,s=null,o=null,i=null,a=null,l=null;switch(t){case yt.TOP:r=!0;break;case yt.BOTTOM:o=!0;break;case yt.LEFT:s=!0;break;case yt.RIGHT:i=!0;break;case yt.NONE:r=!1,s=!1,o=!1,i=!1,a=!1,l=!1;break;case yt.ALL:r=!0,s=!0,o=!0,i=!0,a=!0,l=!0;break;case yt.OUTSIDE:r=!0,s=!0,o=!0,i=!0;break;case yt.INSIDE:a=!0,l=!0;break;case yt.HORIZONTAL:l=!0;break;case yt.VERTICAL:a=!0}this.setBorder(r,s,o,i,a,l,e,n)}setFontFamily(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={ff:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setFontSize(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={fs:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setHorizontalAlignment(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={ht:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setVerticalAlignment(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={vt:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setTextDirection(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={td:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setWrapStrategy(t){const{_context:e,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l={tb:t},h=C.fillObjectMatrix(o-s+1,a-i+1,l),c={sheetId:n.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Fr({WorkBookUnit:e.getWorkBook()},c);return r.invoke(d),this}setValue(t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this,{startRow:o,startColumn:i,endRow:a,endColumn:l}=e,h=new m;for(let u=o;u<=a;u++)for(let e=i;e<=l;e++)h.setValue(u,e,t);const c={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Fr({WorkBookUnit:n.getWorkBook()},c);return r.invoke(d),this}setValues(...t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this,o=t[0];if(Ar.checkup(t,Array)){const{startRow:t,startColumn:i,endRow:a,endColumn:l}=e,h=new m;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-i;n++)h.setValue(e+t,n+i,o[e][n]);const c={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Fr({WorkBookUnit:n.getWorkBook()},c);r.invoke(d)}else if(Ar.checkup(t,m)){const t={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:o,rangeData:this._rangeData},e=new Fr({WorkBookUnit:n.getWorkBook()},t);r.invoke(e)}return this}setRangeData(t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this,{startRow:o,startColumn:i}=e,a={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:{[o]:{[i]:t}}},l=new Fr({WorkBookUnit:n.getWorkBook()},a);return r.invoke(l),this}setRangeDatas(...t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this,o=t[0];if(Ar.checkup(t,Array)){const{startRow:t,startColumn:i,endRow:a,endColumn:l}=e,h=new m;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-i;n++)h.setValue(e+t,n+i,o[e][n]);const c={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:h.getData()},d=new Fr({WorkBookUnit:n.getWorkBook()},c);r.invoke(d)}else if(Ar.checkup(t,m)){const t={sheetId:s.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:o},e=new Fr({WorkBookUnit:n.getWorkBook()},t);r.invoke(e)}return this}clear(...t){const{_context:e,_worksheet:n,_commandManager:r,_rangeData:s}=this;let o={formatOnly:!0,contentsOnly:!0};Ar.checkup(t,Ar.OBJECT_TYPE)&&(o=t[0]);const i={sheetId:n.getSheetId(),actionName:ft.CLEAR_RANGE_ACTION,options:o,rangeData:s},a=new Fr({WorkBookUnit:e.getWorkBook()},i);return r.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}deleteCells(t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this,o={sheetId:s.getSheetId(),actionName:ft.DELETE_RANGE_ACTION,shiftDimension:t,rangeData:e},i=new Fr({WorkBookUnit:n.getWorkBook()},o);r.invoke(i)}insertCells(...t){const e=t[0],n=t[1],{_rangeData:r,_context:s,_commandManager:o,_worksheet:i}=this,{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData;let d=this._rangeData,u=new m;if(n){u=n.getMatrixObject();const t=n.getRangeData();d={startRow:a,endRow:a+t.endRow-t.startRow,startColumn:h,endColumn:a+t.endColumn-t.startColumn}}else for(let _=a;_<=l;_++)for(let t=h;t<=c;t++)u.setValue(_,t,{m:"",v:""});const g={sheetId:i.getSheetId(),actionName:ft.INSERT_RANGE_ACTION,shiftDimension:e,rangeData:d,cellValue:u.getData()},p=new Fr({WorkBookUnit:s.getWorkBook()},g);return o.invoke(p),this}merge(){const{_worksheet:t}=this;return t.getMerges().add(this._rangeData),this}mergeAcross(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),r=t.getSheetId(),{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=[];for(let d=s;d<=o;d++){const t={startRow:d,endRow:d,startColumn:i,endColumn:a};l.push(t)}const h={actionName:ft.ADD_MERGE_ACTION,sheetId:r,rectangles:l},c=new Fr({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}mergeVertically(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),r=t.getSheetId(),{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=[];for(let d=i;d<=a;d++){const t={startRow:s,endRow:o,startColumn:d,endColumn:d};l.push(t)}const h={actionName:ft.ADD_MERGE_ACTION,sheetId:r,rectangles:l},c=new Fr({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}breakApart(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),r=t.getSheetId(),s=this._worksheet.getMerges().getMergedRanges(this._rangeData),o={actionName:ft.REMOVE_MERGE_ACTION,sheetId:r,rectangles:s},i=new Fr({WorkBookUnit:n.getWorkBook()},o);return e.invoke(i),this}removeDuplicates(...t){const{_rangeData:e,_context:n,_commandManager:r,_worksheet:s}=this;Array.isArray(t[0])&&t[0];const o=this.getMatrix().getData(),i=[];for(let d=0;d<=e.endColumn-e.startColumn;d++){const t=[],e={},n=this.getColumnMatrix(d).getData();for(const r in n){const s=n[r][d].m;e.hasOwnProperty(s)||(e[s]=1,t.push(d))}i.push(t)}const a=Array.from(new Set(i.flat())),l={};a.forEach(((t,e)=>{l[e]=o[t]}));const h=[{sheetId:s.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:l}],c=new Fr({WorkBookUnit:n.getWorkBook()},...h);return r.invoke(c),this}getRowMatrix(t){const{startColumn:e,endColumn:n}=this._rangeData,r=this._worksheet.getCellMatrix(),s=new m;for(let o=t;o<=t;o++)for(let t=e;t<=n;t++)s.setValue(o,t,r.getValue(o,t)||{});return s}getColumnMatrix(t){const{startRow:e,endRow:n}=this._rangeData,r=this._worksheet.getCellMatrix(),s=new m;for(let o=e;o<=n;o++)for(let e=t;e<=t;e++)s.setValue(o,e,r.getValue(o,e)||{});return s}forEach(t){yn.foreach(this._rangeData,t)}randomize(){const{_context:t,_worksheet:e,_commandManager:n,_rangeData:r}=this,{startRow:s,startColumn:o}=r,i=new m;C.randSort(this.getMatrix().toArray()).forEach(((t,e)=>t.forEach(((t,n)=>{t=t,i.setValue(e+s,n+o,t||{})}))));const a={sheetId:e.getSheetId(),actionName:ft.SET_RANGE_DATA_ACTION,cellValue:i.getData()},l=new Fr({WorkBookUnit:t.getWorkBook()},a);n.invoke(l)}isValid(){return!Object.values(this._rangeData).includes(-1)}_handleCopyRange(...t){const e=t[0];let n=t[1];n=Ar.checkup(t,yn,yn)?n.getRangeData():n;const r=e._worksheet.getCellMatrix(),{startRow:s,endRow:o,startColumn:i,endColumn:a}=e.getRangeData();let{startRow:l,endRow:h,startColumn:c,endColumn:d}=n;const u=o-s+1,g=a-i+1,p=h-l+1,_=d-c+1;let m,f=[];if(p%u==0&&_%g==0){for(let t=0;t<p;t++){const e=[];for(let n=0;n<_;n++){const o=r.getValue((t+s)%u,(n+i)%g)||{};e.push(o)}f.push(e)}m=n}else f=r.getFragments(s,o,i,a).getData(),h+=u-p,d+=g-_,m={startRow:l,endRow:h,startColumn:c,endColumn:d};return[f,m]}_getStyles(t){return this.getValues().map((e=>e.map((e=>{const n=this._context.getWorkBook().getStyles(),r=n&&n.getStyleByCell(e);return r&&r[t]||Le[t]}))))}_setStyle(t,e){const{_context:n,_worksheet:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,h={[e]:t},c=C.fillObjectMatrix(i-o+1,l-a+1,h),d={sheetId:r.getSheetId(),actionName:fo.NAME,value:c,rangeData:this._rangeData},u=new Fr({WorkBookUnit:n.getWorkBook()},d);return s.invoke(u),this}_setStyles(t,e){const{_context:n,_worksheet:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,h=new m;for(let u=0;u<i-o+1;u++)for(let n=0;n<l-a+1;n++)h.setValue(u,n,{[e]:t[u][n]});const c={sheetId:r.getSheetId(),actionName:ft.SET_RANGE_STYLE_ACTION,value:h.getData(),rangeData:this._rangeData},d=new Fr({WorkBookUnit:n.getWorkBook()},c);return s.invoke(d),this}}class Rn{constructor(t={}){this._styles=t}each(t){return Object.entries(this._styles).forEach(t),this}search(t){const{_styles:e}=this;for(const n in e)if(C.diffValue(e[n],t))return n;return"-1"}get(t){return"string"!=typeof(t=String(t))?t:this._styles[t]}add(t){const e=C.generateRandomId(6);return this._styles[e]=t,e}setValue(t){if(null==t)return;const e=this.search(t);return"-1"!==e?e:this.add(t)}toJSON(){return this._styles}getStyleByCell(t){let e;return e=t&&C.isObject(t.s)?t.s:(null==t?void 0:t.s)&&this.get(t.s),e}}class In{constructor(t){this._workbook=t,this._commandManager=this._workbook.getCommandManager(),this._context=this._workbook.getContext()}addNamedRange(t){const{_workbook:e,_context:n,_commandManager:r}=this,s={actionName:zs.NAME,namedRange:t,sheetId:t.range.sheetId},o=new Fr({WorkBookUnit:e},s);r.invoke(o)}setNamedRange(t){const{_workbook:e,_commandManager:n}=this,r={actionName:ft.SET_NAMED_RANGE_ACTION,namedRange:t,sheetId:t.range.sheetId},s=new Fr({WorkBookUnit:e},r);n.invoke(s)}remove(t){const{_context:e,_workbook:n,_commandManager:r}=this,s={actionName:ft.DELETE_NAMED_RANGE_ACTION,namedRangeId:t,sheetId:n.getActiveSheet().getSheetId()},o=new Fr({WorkBookUnit:n},s);r.invoke(o)}}class An{constructor(t={},e){this._config=C.commonExtend(ke,t),this._context=e;const{styles:n}=this._config;""===this._config.id&&(this._config.id=C.generateRandomId(6)),this._unitId=this._config.id,this._styles=new Rn(n),this._worksheets=new Map,this._getDefaultWorkSheet(),this._namedRange=new In(this)}static rangeDataToRangeStringData(t){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=t;return`${C.chatAtABC(r)+(e+1)}:${C.chatAtABC(s)}${n+1}`}static isIRangeType(t){return"string"==typeof t||"startRow"in t||"row"in t}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}getNamedRang(){return this._namedRange}activateSheetByIndex(t){if(t>=0){const{sheetOrder:e}=this._config;for(let r=t;r<e.length;r++){const t=this._worksheets.get(e[r]);if(t&&!t.isSheetHidden())return t.activate(),t}if(t<e.length)for(let r=t-1;r>=0;r--){const t=this._worksheets.get(e[r]);if(t&&!t.isSheetHidden())return t.activate(),t}const n=this._worksheets.get(e[e.length-1]);return n&&n.activate(),n}}setContext(t){this._context=t}insertSheet(...t){const{_context:e}=this,n=e.getGenName(),r=this.getCommandManager(),s=e.getContextObserver("onBeforeInsertSheetObservable"),o=e.getContextObserver("onAfterInsertSheetObservable");if(C.hasLength(t,0)){const t={name:n.sheetName(),status:0,id:C.generateRandomId(6)},i=this.getSheetSize();return s.notifyObservers({index:i,sheetId:t.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:t.id,index:i,sheet:t})),o.notifyObservers({index:i,sheetId:t.id}),t.id}if(C.hasLength(t,1)){if(C.isAssignableFrom(t[0],En)){const n=t[0],i=this.getSheetSize(),a=n.getConfig();return a.id=C.generateRandomId(6),s.notifyObservers({index:i,sheetId:a.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}if(C.isNumber(t[0])){const i=t[0],a={name:n.sheetName(),status:0,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:a.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}if(C.isString(t[0])){const n=t[0],i=this.getSheetSize(),a={status:0,name:n,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:a.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}if(C.isPlainObject(t[0])){const n=t[0],i=this.getSheetSize();return s.notifyObservers({index:i,sheetId:n.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:n.id,index:i,sheet:n})),o.notifyObservers({index:i,sheetId:n.id}),n.id}}if(C.hasLength(t,2)){if(C.isString(t[0])){const n=t[0],i=t[1],a={status:0,name:n,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:a.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}if(C.isNumber(t[0])){if(C.isAssignableFrom(t[1],En)){const n=t[0],i=t[1].getConfig();return i.id=C.generateRandomId(6),s.notifyObservers({index:n,sheetId:i.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:i.id,index:n,sheet:i})),o.notifyObservers({index:n,sheetId:i.id}),i.id}if(C.isPlainObject(t[1])){const n=t[0],i=t[1];return s.notifyObservers({index:n,sheetId:i.id}),r.invoke(new Fr({WorkBookUnit:e.getWorkBook()},{actionName:Qs.NAME,sheetId:i.id,index:n,sheet:i})),o.notifyObservers({index:n,sheetId:i.id}),i.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...t){if(C.hasLength(t,1)){const{_context:e}=this,n=t[0],r=__spreadProps(__spreadValues({},De),{name:n}),s=new En(e,r);return this.insertSheet(s),s}if(C.hasLength(t,3)){const{_context:e}=this,n=t[0],r=t[1],s=t[2],o=__spreadProps(__spreadValues({},De),{name:n,rowCount:r,columnCount:s}),i=new En(e,o);return this.insertSheet(i),i}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(t){const{sheetOrder:e}=this._config;return e.findIndex((e=>e===t))}getActiveSheet(){const{sheetOrder:t}=this._config,e=t.find((t=>this._worksheets.get(t).getStatus()===be.TRUE));return e?this._worksheets.get(e):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:t}=this._config;return t.findIndex((t=>1===this._worksheets.get(t).getStatus()))}getActiveRange(){const t=this.getActiveSheet();if(t){return t.getSelection().getActiveRange()}return null}setActiveRange(t){const e=this.getActiveSheet();return e?e.setActiveSelection(t):null}setActiveRangeList(t){const e=this.getActiveSheet();if(e){const n=e.getRangeList(t);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const t=this.getActiveSheet();if(t){return t.getSelection().getActiveRangeList()}return null}getSelection(){const t=this.getActiveSheet();if(t)return t.getSelection()}getCurrentCell(){const t=this.getSelection();if(t)return t.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(t){return t.activateAsCurrentCell()}flush(){}setSheetOrder(t,e){const{_context:n}=this,r=this.getCommandManager(),s=n.getContextObserver("onSheetOrderObservable"),o={actionName:yo.NAME,sheetId:t,order:e},i=new Fr({WorkBookUnit:n.getWorkBook()},o);r.invoke(i),s.notifyObservers()}getSheets(){const{sheetOrder:t}=this._config;return t.map((t=>this._worksheets.get(t)))}getSheetIndex(t){const{sheetOrder:e}=this._config;return e.findIndex((e=>t.getSheetId()===e))}removeSheetBySheetId(t){const{_config:e}=this,{sheetOrder:n}=e,r=this.getCommandManager(),s=this.getSheetBySheetId(t);if(n.length>1&&null!=s){const e=this.getSheetIndex(s),n=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),o=this.getContext().getContextObserver("onAfterRemoveSheetObservable");n.notifyObservers({index:e}),r.invoke(new Fr({WorkBookUnit:this},{actionName:oo.NAME,sheetId:t})),o.notifyObservers({index:e,sheetId:t}),this.activateSheetByIndex(e)}}getSheetBySheetName(t){const{sheetOrder:e}=this._config,n=e.find((e=>this._worksheets.get(e).getName()===t));return this._worksheets.get(n)}getSheetBySheetId(t){return this._worksheets.get(t)}setActiveSheet(...t){let e=!1;const n=t[0];return Ar.checkup(t,En,Ar.BOOLEAN_TYPE)&&(e=t[1]),n.activate(),e&&n.setActiveSelection(),n}getCommandManager(){return this._context.getCommandManager()}getPluginMeta(t){return this._config.pluginMeta[t]}setPluginMeta(t,e){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[t]=e}transformRangeType(t){if("string"==typeof t){return this._getCellRange(t)}return"string"!=typeof t&&"row"in t?{sheetId:"",rangeData:{startRow:t.row[0],startColumn:t.column[0],endRow:t.row[1],endColumn:t.column[1]}}:"string"!=typeof t&&"startRow"in t?{sheetId:"",rangeData:t}:Oe}load(t){this._config=t}save(){return this._config}_getDefaultWorkSheet(){const{_context:t,_config:e,_worksheets:n}=this,{sheets:r,sheetOrder:s}=e,o=t.getGenName();C.isEmptyObject(r)&&(r[De.id]=Object.assign(De,{status:be.TRUE}));let i=null;for(let a in r){let e=r[a];e.name=o.sheetName(e.name);const l=new En(t,e);n.set(a,l),s.includes(a)||s.push(a),null==i&&(i=l)}i&&i.activate()}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach((t=>{t.setStatus(be.FALSE)})),this._worksheets[0].setStatus(be.TRUE))}_getCellRange(t){var e,n,r,s,o;let i="",a="";if(t.indexOf("!")>-1){const e=t.split("!");i=e[0],a=e[1],i=i.replace(/\\'/g,"'").replace(/''/g,"'"),"'"===i.substring(0,1)&&"'"===i.substring(i.length-1,1)&&(i=i.substring(1,i.length-1))}else a=t;if(-1===a.indexOf(":")){const t=parseInt(a.replace(/[^0-9]/g,""),10)-1,e=C.ABCatNum(a.replace(/[^A-Za-z]/g,""));if(!Number.isNaN(t)&&!Number.isNaN(e)){return{sheetId:i,rangeData:{startRow:t,endRow:t,startColumn:e,endColumn:e}}}return Oe}a=a.split(":");const l=[0,0],h=[0,0],c=(null==(e=this.getSheetBySheetName(i))?void 0:e.getMaxRows())||(null==(n=this.getActiveSheet())?void 0:n.getMaxRows()),d=(null==(r=this.getSheetBySheetName(i))?void 0:r.getMaxColumns())||(null==(s=this.getActiveSheet())?void 0:s.getMaxColumns());if(l[0]=parseInt(a[0].replace(/[^0-9]/g,""),10)-1,l[1]=parseInt(a[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(l[0])&&(l[0]=0),Number.isNaN(l[1])&&(l[1]=c),l[0]>l[1])return Oe;if(h[0]=C.ABCatNum(a[0].replace(/[^A-Za-z]/g,"")),h[1]=C.ABCatNum(a[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(h[0])&&(h[0]=0),Number.isNaN(h[1])&&(h[1]=d),h[0]>h[1])return Oe;return{sheetId:(null==(o=this.getSheetBySheetName(i))?void 0:o.getSheetId())||"",rangeData:{startRow:l[0],endRow:l[1],startColumn:h[0],endColumn:h[1]}}}}class On{constructor(t){this._workSheet=t,this._context=t.getContext(),this._commandManager=this._context.getCommandManager(),this._workbook=t.getContext().getWorkBook(),this._activeRangeList=this._workSheet.getRangeList([Me]),this._activeRange=this._workSheet.getRange(Me),this._currentCell=this._workSheet.getRange(Me)}static cellInRange(t,e){for(const n of t)if(n.startRow<=e.startRow&&e.endRow<=n.endRow&&n.startColumn<=e.startColumn&&e.endColumn<=n.endColumn)return n;return null}setWorkSheet(t){this._workSheet=t}setSelection({selection:t,cell:e}={}){var n;let r,s,o;if(t instanceof yn?(s=t.getRangeData(),-1===s.startRow&&console.error("Invalid selection, default set startRow -1"),r=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):t&&An.isIRangeType(t)?(s=this._workbook.transformRangeType(t).rangeData,-1===s.startRow&&console.error("Invalid selection, default set startRow -1"),r=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):t instanceof Array?(r=t.map((t=>{const e=this._workbook.transformRangeType(t).rangeData;return-1===e.startRow&&console.error("Invalid selection, default set startRow -1"),e})),s=r[r.length-1],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):(r=this._activeRangeList.getRangeList(),s=this._activeRange.getRangeData(),o=this._currentCell.getRangeData()),e){o=this._workbook.transformRangeType(e).rangeData;On.cellInRange(r,o)||(s=o,r=[s])}const{_context:i,_workSheet:a,_commandManager:l}=this,h={sheetId:a.getSheetId(),actionName:Eo.NAME,activeRangeList:r,activeRange:s,currentCell:o},c=new Fr({WorkBookUnit:i.getWorkBook()},h);l.invoke(c);const d=`${C.chatAtABC(s.startColumn)+(s.startRow+1)}:${C.chatAtABC(s.endColumn)}${s.endRow+1}`;return null==(n=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable"))||n.notifyObservers(d),this._activeRange}getSelection(){return C.deepClone(this._activeRange.getRangeData())}getActiveRange(){return this._activeRange}getActiveRangeList(){return this._activeRangeList}getActiveSheet(){return this._workbook.getActiveSheet()}getCurrentCell(){return this._currentCell}setCurrentCell(t){if(C.isAssignableFrom(t,yn)&&(t=t.getRangeData()),-1===(null==t?void 0:t.startRow))return console.error("Invalid range,default set startRow -1"),this;if(t.startRow!==t.endRow||t.startColumn!==t.endColumn)return console.error("Exception: Range must have a single cell."),this;const e=this._activeRangeList.getRangeList(),{_context:n,_workSheet:r,_commandManager:s}=this,o={sheetId:r.getSheetId(),actionName:Eo.NAME,activeRangeList:e,activeRange:t,currentCell:t},i=new Fr({WorkBookUnit:n.getWorkBook()},o);return s.invoke(i),this}setRanges(t,e,n){this._activeRangeList=this._workSheet.getRangeList(t),this._activeRange=this._workSheet.getRange(e),this._currentCell=this._workSheet.getRange(n)}getNextDataRange(t){const e=this._expandRange(t);return this.setSelection({selection:e}),this.getActiveRange()}_expandRange(t){const e=this._workSheet.getColumnCount(),n=this._workSheet.getRowCount(),r=this._activeRange.getRangeData();let s=Me;const o=this.getCurrentCell().getRangeData();if(t===Ft.RIGHT)if(o.startColumn===r.startColumn){const t=this._workSheet.getCellMatrix().getValue(o.startRow,r.endColumn);let n;if(t&&void 0===t.v)for(let s=r.endColumn+1;s<=e;s++){if(s===e){n=e;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,s);if(t&&void 0!==t.v){n=s;break}}else for(let s=r.endColumn+1;s<=e;s++){if(s===e){n=e;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,s);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(o.startRow,s-1);if(t&&void 0!==t.v){n=s-1;break}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:r.startColumn,endColumn:void 0!==n?n:r.endColumn}}else{const t=this._workSheet.getCellMatrix().getValue(o.startRow,r.startColumn);let e;if(t&&void 0===t.v)for(let n=r.startColumn+1;n<=o.startColumn;n++){if(n===o.startColumn){e=o.startColumn;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0!==t.v){e=n;break}}else for(let n=r.startColumn+1;n<=o.startColumn;n++){if(n===o.startColumn){e=o.startColumn;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(t&&void 0!==t.v){e=n-1;break}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:e||o.startColumn,endColumn:r.endColumn}}if(t===Ft.LEFT){let t,e;if(o.endColumn===r.endColumn){const e=this._workSheet.getCellMatrix().getValue(o.startRow,r.startColumn);if(e&&void 0===e.v)for(let n=r.startColumn-1;n>=0;n--){if(0===n){t=0;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0!==e.v){t=n;break}}else for(let n=r.startColumn-1;n>=0;n--){if(0===n){t=0;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(e&&void 0!==e.v){t=n-1;break}}}}else{const t=this._workSheet.getCellMatrix().getValue(o.startRow,r.endColumn);if(t&&void 0===t.v)for(let n=r.endColumn-1;n>=o.startColumn;n--){if(n===o.startColumn){e=n;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0!==t.v){e=n;break}}else for(let n=r.endColumn-1;n>=o.startColumn;n--){if(n===o.startColumn){e=n;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(t&&void 0!==t.v){e=n-1;break}}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:void 0!==t?t:r.startColumn,endColumn:void 0!==e?e:r.endColumn}}if(t===Ft.TOP){let t,e;if(o.endRow===r.endRow){const e=this._workSheet.getCellMatrix().getValue(r.startRow,o.startColumn);if(e&&void 0===e.v)for(let n=r.endRow-1;n>=0;n--){const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(e&&void 0!==e.v||0===n){t=n;break}}else for(let n=r.startRow-1;n>=0;n--){if(0===n){t=0;break}const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(n-1,o.startColumn);if(e&&void 0!==e.v){t=n-1;break}}}}else{const t=this._workSheet.getCellMatrix().getValue(r.endRow,o.startColumn);if(t&&void 0===t.v)for(let n=r.endRow-1;n>=o.startRow;n--){if(n===o.startRow){e=o.startRow;break}const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(t&&void 0!==t.v){e=n;break}}else for(let n=r.endRow-1;n>=o.startRow;n--){const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(n===o.startRow){e=o.startRow;break}if(t&&void 0===t.v&&n!==r.endRow-1){const t=this._workSheet.getCellMatrix().getValue(n+1,o.startColumn);if(t&&void 0!==t.v){e=n+1;break}}}}s={startRow:void 0!==t?t:r.startRow,endRow:void 0!==e?e:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn}}if(t===Ft.BOTTOM){let t,e;if(o.startRow===r.startRow){const t=this._workSheet.getCellMatrix().getValue(r.endRow,o.startColumn);if(t&&void 0===t.v)for(let s=r.endRow+1;s<=n;s++){if(s===n){e=n;break}const t=this._workSheet.getCellMatrix().getValue(s,o.startColumn);if(t&&void 0!==t.v){e=s;break}}else for(let s=r.endRow+1;s<=n;s++){if(s===n){e=n;break}const t=this._workSheet.getCellMatrix().getValue(s,o.startColumn);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(s+1,o.startColumn);if(t&&void 0!==t.v){e=s+1;break}}}}else{const e=this._workSheet.getCellMatrix().getValue(r.startRow+1,o.startColumn);if(e&&void 0===e.v)for(let n=r.startRow+1;n<=o.startRow;n++){if(n===o.startRow){t=o.startRow;break}const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(e&&void 0!==e.v){t=n;break}}else for(let n=r.startRow+1;n<=o.startRow;n++){if(n===o.startRow){t=o.startRow;break}const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(e&&void 0===e.v&&n!==r.startRow+1){const e=this._workSheet.getCellMatrix().getValue(n-1,o.startColumn);if(e&&void 0!==e.v){t=n-1;break}}}}s={startRow:void 0!==t?t:r.startRow,endRow:void 0!==e?e:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn}}return s}}function Nn(t){if(!t)return;let{row:e,column:n,startY:r,endY:s,startX:o,endX:i,isMerged:a,mergeInfo:l}=t,h=e,c=n,d=e,u=n;if(a&&l){const{startRow:t,startColumn:e,endRow:n,endColumn:a,startY:g,endY:p,startX:_,endX:m}=l;h=t,c=e,d=n,u=a,r=g,s=p,o=_,i=m}return{startRow:h,startColumn:c,endRow:d,endColumn:u,startY:r,endY:s,startX:o,endX:i}}function Mn(t){if(!t)return!0;return 0===((null==t?void 0:t.m)||"").length&&!t.p}function xn(t){if(t){if(t.rgb)return t.rgb;if(t.th)return(new Ze).setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function kn(t){var e;let n="";if(null==(e=t.body)?void 0:e.blockElements)for(let r in t.body.blockElements){const e=t.body.blockElements[r];if((e.blockType===I.PARAGRAPH||e.blockType===I.SECTION_BREAK)&&e.blockType===I.PARAGRAPH)for(let t in e.paragraph){const r=e.paragraph[t];for(let t in r){const e=r[t];if(e.et===B.TEXT_RUN){let t=`display:inline-block;${Dn(e.tr.ts)}`;n+=`<span id='${e.eId}' ${t.length?`style="${t}"`:""} >${e.tr.ct}</span>`}}}}return n}function Dn(t,e=!1){var n;let r="";const s=new Map([["ff",()=>{t.ff&&(r+=`font-family: ${t.ff}; `)}],["fs",()=>{if(t.fs){let e=t.fs;t.va&&(e/=2),r+=`font-size: ${e}pt; `}}],["it",()=>{t.it?r+="font-style: italic; ":r+="font-style: normal; "}],["bl",()=>{t.bl?r+="font-weight: bold; ":r+="font-weight: normal; "}],["ul",()=>{var e;(null==(e=t.ul)?void 0:e.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," underline"):r+="text-decoration-line: underline; ",t.ul.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${xn(t.ul.cl)}; `),t.ul.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${t.ul.t} `))}],["st",()=>{var e;(null==(e=t.st)?void 0:e.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," line-through"):r+="text-decoration-line: line-through; ",t.st.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${xn(t.st.cl)}; `),t.st.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${t.st.t} `))}],["ol",()=>{var e;(null==(e=t.ol)?void 0:e.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," overline"):r+="text-decoration-line: overline; ",t.ol.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${xn(t.ol.cl)}; `),t.ol.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${t.ol.t} `))}],["bg",()=>{r+=`background: ${xn(t.bg)}; `}],["bd",()=>{var e,n,s,o,i,a,l,h,c,d,u,g;(null==(e=t.bd)?void 0:e.b)&&(r+=`border-bottom: ${Ln(null==(n=t.bd)?void 0:n.b.s)} ${null!=(s=xn(t.bd.b.cl))?s:""}; `),(null==(o=t.bd)?void 0:o.t)&&(r+=`border-top: ${Ln(null==(i=t.bd)?void 0:i.t.s)} ${null!=(a=xn(t.bd.t.cl))?a:""}; `),(null==(l=t.bd)?void 0:l.r)&&(r+=`border-right: ${Ln(null==(h=t.bd)?void 0:h.r.s)} ${null!=(c=xn(t.bd.r.cl))?c:""}; `),(null==(d=t.bd)?void 0:d.l)&&(r+=`border-left: ${Ln(null==(u=t.bd)?void 0:u.l.s)} ${null!=(g=xn(t.bd.l.cl))?g:""}; `)}],["cl",()=>{r+=`color: ${xn(t.cl)}; `}],["va",()=>{t.va===fe.NORMAL?r+="vertical-align: baseline; ":t.va===fe.SUBSCRIPT?r+="vertical-align: sub; ":r+="vertical-align: super; "}],["td",()=>{t.td===re.UNSPECIFIED?r+="direction: inherit; ":t.td===re.LEFT_TO_RIGHT?r+="direction: ltr; ":r+="direction: rtl; "}],["tr",()=>{var e,n,s;r+=`data-rotate: (${null==(e=t.tr)?void 0:e.a}deg${(null==(n=t.tr)?void 0:n.v)?` ,${null==(s=t.tr)?void 0:s.v}`:""});`}],["ht",()=>{t.ht===ae.UNSPECIFIED?r+="text-align: inherit; ":t.ht===ae.LEFT?r+="text-align: left; ":t.ht===ae.RIGHT?r+="text-align: right; ":t.ht===ae.CENTER?r+="text-align: center; ":r+="text-align: justify; "}],["vt",()=>{t.vt===he.UNSPECIFIED?r+="vertical-align: inherit; ":t.vt===he.BOTTOM?r+="vertical-align: bottom; ":t.vt===he.TOP?r+="vertical-align: top; ":r+="vertical-align: middle; "}],["tb",()=>{t.tb===de.CLIP?r+="text-overflow: clip; ":t.tb===de.OVERFLOW?r+="text-break: overflow; ":t.tb===de.WRAP&&(r+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var e,n,s,o,i,a,l,h;let c=`${null==(e=t.pd)?void 0:e.b}pt`,d=`${null==(n=t.pd)?void 0:n.t}pt`,u=`${null==(s=t.pd)?void 0:s.l}pt`,g=`${null==(o=t.pd)?void 0:o.r}pt`;(null==(i=t.pd)?void 0:i.b)&&(r+=`padding-bottom: ${c}; `),(null==(a=t.pd)?void 0:a.t)&&(r+=`padding-top: ${d}; `),(null==(l=t.pd)?void 0:l.l)&&(r+=`padding-left: ${u}; `),(null==(h=t.pd)?void 0:h.r)&&(r+=`padding-right: ${g}; `)}]]),o=["bd","tr","tb"];for(let i in t)e&&o.includes(i)||null==(n=s.get(i))||n();return r}function Ln(t){let e="";return t===St.NONE?e="none":t===St.THIN?e="0.5pt solid":t===St.HAIR?e="0.5pt double":t===St.DOTTED?e="0.5pt dotted":t===St.DASHED||t===St.DASH_DOT?e="0.5pt dashed":t===St.DASH_DOT_DOT?e="0.5pt dotted":t===St.DOUBLE?e="0.5pt double":t===St.MEDIUM?e="1pt solid":t===St.MEDIUM_DASHED||t===St.MEDIUM_DASH_DOT?e="1pt dashed":t===St.MEDIUM_DASH_DOT_DOT?e="1pt dotted":t===St.SLANT_DASH_DOT?e="0.5pt dashed":t===St.THICK&&(e="1.5pt solid"),e}function Pn(t){return t instanceof FormData}const Bn=()=>{},Hn=t=>t;var Fn,Un,zn,Wn,Vn,Yn;(Un=Fn||(Fn={})).POST="POST",Un.GET="GET",Un.PUT="PUT",Un.DELETE="DELETE",(Wn=zn||(zn={}))[Wn.UNSENT=0]="UNSENT",Wn[Wn.OPENED=1]="OPENED",Wn[Wn.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",Wn[Wn.LOADING=3]="LOADING",Wn[Wn.DONE=4]="DONE",(Yn=Vn||(Vn={})).ARRAY_BUFFER="arraybuffer",Yn.BLOB="blob",Yn.TEXT="text",Yn.DOCUMENT="document",Yn.JSON="json",Yn.STREAM="stream";const Gn={type:Fn.POST,url:"",async:!0,header:{},dataType:Vn.JSON,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Bn,beforeSend:Hn,dataFilter:Hn,success:Bn,complete:Bn};function Xn(t){return new Promise(((e,n)=>{const r=function(t,...e){for(const n of e)if(n)for(const e in n)n.hasOwnProperty(e)&&null!=n[e]&&(t[e]=n[e]);return t}({},Gn,t),s=new XMLHttpRequest;switch(r.beforeSend(r),s.responseType=r.dataType,s.timeout=r.timeout,s.addEventListener("readystatechange",(t=>{if(4===s.readyState)if(200===s.status){const t=r.dataFilter(s.response);r.success(t),r.complete(),e(t)}else r.error(t),n(t)})),s.addEventListener("timeout",(t=>{r.error(t)})),s.open(r.type,r.url,r.async,r.username,r.password),Object.keys(r.header).forEach((t=>{const e=r.header[t];s.setRequestHeader(t,e)})),Pn(r.data)?s.setRequestHeader("Content-Type","multipart/form-data"):r.contentType&&s.setRequestHeader("Content-Type",r.contentType),r.type){case Fn.DELETE:case Fn.GET:s.send();break;case Fn.POST:case Fn.PUT:if((o=r.data)&&Object.getPrototypeOf(o)===Object.getPrototypeOf({}))return void s.send(JSON.stringify(r.data));if(function(t){return"[object String]"===Object.prototype.toString.apply(t)}(r.data))return void s.send(r.data);if(function(t){return"[object Array]"===Object.prototype.toString.apply(t)}(r.data))return void s.send(JSON.stringify(r.data));Pn(r.data)&&s.send(r.data)}var o}))}var jn,$n;($n=jn||(jn={})).MESSAGE="message",$n.OPEN="open",$n.CLOSE="close",$n.ERROR="error",$n.RETRY="retry",$n.DESTROY="destroy";const Kn={url:"",heartbeatTime:3e4},qn="heart_beat_message";class Zn{constructor(t){const e=Object.assign(Kn,t);if(function(t){return null==t}(n=e.url)||""===n.toString())throw new Error("url must be input");var n;this._listens=new Map,this._timer=-1,this._config=e}link(){this._create(),this._bind()}send(t){this._socket.send(t)}destroy(){const t=this._listens.get(jn.DESTROY);t&&t(),this._clear(),this._listens.clear()}on(t,e){this._listens.set(t,e)}close(){this._socket&&this._socket.close()}_create(){const{_config:t}=this;this._socket=new WebSocket(t.url)}_bind(){this._socket.addEventListener(jn.MESSAGE,this._message.bind(this)),this._socket.addEventListener(jn.OPEN,this._open.bind(this)),this._socket.addEventListener(jn.CLOSE,this._close.bind(this)),this._socket.addEventListener(jn.ERROR,this._error.bind(this))}_message(t){const e=this._listens.get(jn.MESSAGE);e&&e(t)}_open(t){const e=this._listens.get(jn.OPEN);e&&(e(t),this._heartbeat())}_error(t){const e=this._listens.get(jn.ERROR);e&&(e(t),this._retry())}_close(t){const e=this._listens.get(jn.CLOSE);e&&(e(t),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener(jn.MESSAGE,this._message.bind(this)),this._socket.removeEventListener(jn.OPEN,this._open.bind(this)),this._socket.removeEventListener(jn.CLOSE,this._close.bind(this)),this._socket.removeEventListener(jn.ERROR,this._error.bind(this))}_heartbeat(){const{_socket:t,_config:e}=this,{heartbeatTime:n}=e;this._timer=setInterval((function(){t.send(qn)}),n)}_retry(){const t=this._listens.get(jn.RETRY);t&&t(),this._clear(),this._create(),this._bind()}}const Jn=Object.keys(Ue).reduce(((t,e)=>[...t,...Ue[e]]),[]);function Qn(t){return-1===Jn.indexOf(t)}const tr={},er={};class nr{static getValue(t,e){try{return t[e]?t[e]:e.split(".").reduce(((t,e)=>t[e]),t)}catch(n){console.error("Key %s not found",e)}}initialize(t){this.options={currentLocale:t||["zh","zh-CN"].includes(C.getLanguage())?Kt.ZH:Kt.EN,locales:{zh:tr,en:er}}}get(t){if(t){const{locales:e,currentLocale:n}=this.options;return nr.getValue(e[n],t)||t}return String()}getObject(t){const{locales:e,currentLocale:n}=this.options;return nr.getValue(e[n],t)}load(t){C.deepMerge(this.options.locales,t)}change(t){this.options.currentLocale=t}getCurrentLocale(){return this.options.currentLocale}}class rr{static log(...t){console&&console.log(...t)}static info(...t){console&&console.info(...t)}static error(...t){console&&console.error(...t)}static warn(...t){console&&console.warn(...t)}static br(){rr.info("\n")}static capsule(t,e,n="",r=""){console&&console.log(`%c${n}%c${t}%c${e}%c${r}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class sr{constructor(){this._include=[],this._count=1}checked(t){return this._include.includes(t)}onlyName(t){let e=t,n=1;for(;this.checked(e);)e=t+n,n++;return this._include.push(e),e}sheetName(t="sheet1"){let e=t;for(;this.checked(e);)e=`sheet${this._count}`,this._count++;return this._include.push(e),e}}class or{static hasLength(t,e){return t.length===e}static getValueType(t){return Object.prototype.toString.apply(t)}static isObject(t){return"[object Object]"===this.getValueType(t)}static isIterable(t){return null!=t[Symbol.iterator]}static isNumber(t){return"[object Number]"===this.getValueType(t)}}const ir=Symbol("newer"),ar=Symbol("older");class lr{constructor(t){this.entry=t}[Symbol.iterator](){return this}next(){let t=this.entry;return t?(this.entry=t[ir],{done:!1,value:t.key}):{done:!0,value:void 0}}}class hr{constructor(t){this.entry=t}[Symbol.iterator](){return this}next(){let t=this.entry;return t?(this.entry=t[ir],{done:!1,value:t.value}):{done:!0,value:void 0}}}class cr{constructor(t){this.entry=t}[Symbol.iterator](){return this}next(){let t=this.entry;return t?(this.entry=t[ir],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}}}class dr{constructor(t,e){this.key=t,this.value=e,this[ir]=void 0,this[ar]=void 0}toJSON(){return{key:this.key,value:this.value}}}class ur{constructor(...t){if(or.hasLength(t,1)){if(or.isNumber(t[0])){const e=t[0];return void this._initialize(e,void 0)}if(or.isIterable(t[0])){const e=t[0];return void this._initialize(0,e)}}else if(or.hasLength(t,2)){const e=t[0],n=t[1];this._initialize(e,n)}}_initialize(t,e){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=t,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}_markEntryAsUsed(t){t!==this.newest&&(t[ir]&&(t===this.oldest&&(this.oldest=t[ir]),t[ir][ar]=t[ar]),t[ar]&&(t[ar][ir]=t[ir]),t[ir]=void 0,t[ar]=this.newest,this.newest&&(this.newest[ir]=t),this.newest=t)}assign(t){let e,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let r=t[Symbol.iterator]();for(let s=r.next();!s.done;s=r.next()){let t=new dr(s.value[0],s.value[1]);if(this._keymap.set(t.key,t),e?(e[ir]=t,t[ar]=e):this.oldest=t,e=t,0==n--)throw new Error("overflow")}this.newest=e,this.size=this._keymap.size}set(t,e){let n=this._keymap.get(t);return n?(n.value=e,this._markEntryAsUsed(n),this):(this._keymap.set(t,n=new dr(t,e)),this.newest?(this.newest[ir]=n,n[ar]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let t=this.oldest;if(t)return this.oldest&&this.oldest[ir]?(this.oldest=this.oldest[ir],this.oldest[ar]=void 0):(this.oldest=void 0,this.newest=void 0),t[ir]=t[ar]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]}get(t){const e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value}has(t){return this._keymap.has(t)}find(t){let e=this._keymap.get(t);return e?e.value:void 0}delete(t){let e=this._keymap.get(t);if(e)return this._keymap.delete(e.key),e[ir]&&e[ar]?(e[ar][ir]=e[ir],e[ir][ar]=e[ar]):e[ir]?(e[ir][ar]=void 0,this.oldest=e[ir]):e[ar]?(e[ar][ir]=void 0,this.newest=e[ar]):this.oldest=this.newest=void 0,this.size--,e.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new lr(this.oldest)}values(){return new hr(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new cr(this.oldest)}forEach(t,e){"object"!=typeof e&&(e=this);let n=this.oldest;for(;n;)t.call(e,n.value,n.key,this),n=n[ir]}toJSON(){let t=new Array(this.size),e=0,n=this.oldest;for(;n;)t[e++]={key:n.key,value:n.value},n=n[ir];return t}toString(){let t=String(),e=this.oldest;for(;e;)t+=`${String(e.key)}:${e.value}`,e=e[ir],e&&(t+=" < ");return t}}function gr(t,e){var n,r,s,o,i,a,l,h,c,d,u,g,p,_,m,f,v,b,C,T,w,S,E,y,R,I,A,O,N,M,x,k,D,L,P,B,H,F,U,z,W,V,Y,G,X,j,$,K,q,Z,J,Q,tt,et,nt,rt,st,ot,it,at,lt,ht,ct,dt,ut,gt;t.cellData={};for(let pt of e.config.borderInfo)if("cell"===pt.rangeType){const e=pt.value.row_index,p=pt.value.col_index;t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(p)]||(t.cellData[String(e)][String(p)]={}),t.cellData[String(e)][String(p)].s||(t.cellData[String(e)][String(p)].s={});const _={};pt.value.l&&(_.l={s:pt.value.l.style,cl:{rgb:pt.value.l.color}},t.cellData[String(e)]&&(null==(s=null==(r=null==(n=t.cellData[String(e)][String(p-1)])?void 0:n.s)?void 0:r.bd)?void 0:s.r)&&delete t.cellData[String(e)][String(p-1)].s.bd.r),pt.value.r&&(_.r={s:pt.value.r.style,cl:{rgb:pt.value.r.color}},t.cellData[String(e)]&&(null==(a=null==(i=null==(o=t.cellData[String(e)][String(Number(p)+1)])?void 0:o.s)?void 0:i.bd)?void 0:a.l)&&delete t.cellData[String(e)][String(p-1)].s.bd.l),pt.value.t&&(_.t={s:pt.value.t.style,cl:{rgb:pt.value.t.color}},t.cellData[String(e-1)]&&(null==(c=null==(h=null==(l=t.cellData[String(e)][String(p)])?void 0:l.s)?void 0:h.bd)?void 0:c.b)&&delete t.cellData[String(e)][String(p-1)].s.bd.b),pt.value.b&&(_.b={s:pt.value.b.style,cl:{rgb:pt.value.b.color}},t.cellData[String(Number(e)+1)]&&(null==(g=null==(u=null==(d=t.cellData[String(e)][String(p)])?void 0:d.s)?void 0:u.bd)?void 0:g.t)&&delete t.cellData[String(e)][String(p-1)].s.bd.t),t.cellData[String(e)][String(p)].s.bd=Object.assign(t.cellData[String(e)][String(p)].s.bd||{},_)}else if("range"===pt.rangeType)for(const e of pt.range){const n=e.row[0],r=e.row[1],s=e.column[0],o=e.column[1];switch(pt.borderType){case"border-left":for(let e=n;e<=r;e++)for(let n=s;n<s+1;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.l={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=n;e<=r;e++)for(let n=s-1;n<s;n++)t.cellData[String(e)]&&(null==(m=null==(_=null==(p=t.cellData[String(e)][String(n)])?void 0:p.s)?void 0:_.bd)?void 0:m.r)&&delete t.cellData[String(e)][String(n)].s.bd.r;break;case"border-right":for(let e=n;e<=r;e++)for(let n=o;n<o+1;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.r={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=n;e<=r;e++)for(let n=o+1;n<o+2;n++)t.cellData[String(e)]&&(null==(b=null==(v=null==(f=t.cellData[String(e)][String(n)])?void 0:f.s)?void 0:v.bd)?void 0:b.l)&&delete t.cellData[String(e)][String(n)].s.bd.l;break;case"border-top":for(let e=n;e<n+1;e++)for(let n=s;n<=o;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.t={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=n-1;e<n;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(w=null==(T=null==(C=t.cellData[String(e)][String(n)])?void 0:C.s)?void 0:T.bd)?void 0:w.b)&&delete t.cellData[String(e)][String(n)].s.bd.b;break;case"border-bottom":for(let e=r;e<r+1;e++)for(let n=s;n<=o;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.b={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=r+1;e<r+2;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(y=null==(E=null==(S=t.cellData[String(e)][String(n)])?void 0:S.s)?void 0:E.bd)?void 0:y.t)&&delete t.cellData[String(e)][String(n)].s.bd.t;break;case"border-all":for(let e=n;e<=r;e++)for(let n=s;n<=o;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const s={};s.l={s:pt.style,cl:{rgb:pt.color}},s.t={s:pt.style,cl:{rgb:pt.color}},n===o&&(s.r={s:pt.style,cl:{rgb:pt.color}}),e===r&&(s.b={s:pt.style,cl:{rgb:pt.color}}),t.cellData[String(e)][String(n)].s.bd=s}for(let e=n;e<=r;e++)for(let n=s-1;n<s;n++)t.cellData[String(e)]&&(null==(A=null==(I=null==(R=t.cellData[String(e)][String(n)])?void 0:R.s)?void 0:I.bd)?void 0:A.r)&&delete t.cellData[String(e)][String(n)].s.bd.r;for(let e=n;e<=r;e++)for(let n=o+1;n<o+2;n++)t.cellData[String(e)]&&(null==(M=null==(N=null==(O=t.cellData[String(e)][String(n)])?void 0:O.s)?void 0:N.bd)?void 0:M.l)&&delete t.cellData[String(e)][String(n)].s.bd.l;for(let e=n-1;e<n;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(D=null==(k=null==(x=t.cellData[String(e)][String(n)])?void 0:x.s)?void 0:k.bd)?void 0:D.b)&&delete t.cellData[String(e)][String(n)].s.bd.b;for(let e=r+1;e<r+2;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(B=null==(P=null==(L=t.cellData[String(e)][String(n)])?void 0:L.s)?void 0:P.bd)?void 0:B.t)&&delete t.cellData[String(e)][String(n)].s.bd.t;break;case"border-outside":for(let e=n;e<=r;e++)for(let i=s;i<=o;i++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(i)]||(t.cellData[String(e)][String(i)]={}),t.cellData[String(e)][String(i)].s||(t.cellData[String(e)][String(i)].s={});const a={};e===n&&(a.t={s:pt.style,cl:{rgb:pt.color}}),e===r&&(a.b={s:pt.style,cl:{rgb:pt.color}}),i===s&&(a.l={s:pt.style,cl:{rgb:pt.color}}),i===o&&(a.r={s:pt.style,cl:{rgb:pt.color}}),t.cellData[String(e)][String(i)].s.bd=Object.assign(t.cellData[String(e)][String(i)].s.bd||{},a)}for(let e=n;e<=r;e++)for(let n=s-1;n<s;n++)t.cellData[String(e)]&&(null==(U=null==(F=null==(H=t.cellData[String(e)][String(n)])?void 0:H.s)?void 0:F.bd)?void 0:U.r)&&delete t.cellData[String(e)][String(n)].s.bd.r;for(let e=n;e<=r;e++)for(let n=o+1;n<o+2;n++)t.cellData[String(e)]&&(null==(V=null==(W=null==(z=t.cellData[String(e)][String(n)])?void 0:z.s)?void 0:W.bd)?void 0:V.l)&&delete t.cellData[String(e)][String(n)].s.bd.l;for(let e=n-1;e<n;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(X=null==(G=null==(Y=t.cellData[String(e)][String(n)])?void 0:Y.s)?void 0:G.bd)?void 0:X.b)&&delete t.cellData[String(e)][String(n)].s.bd.b;for(let e=r+1;e<r+2;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(K=null==($=null==(j=t.cellData[String(e)][String(n)])?void 0:j.s)?void 0:$.bd)?void 0:K.t)&&delete t.cellData[String(e)][String(n)].s.bd.t;break;case"border-inside":for(let e=n;e<=r;e++)for(let r=s;r<=o;r++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(r)]||(t.cellData[String(e)][String(r)]={}),t.cellData[String(e)][String(r)].s||(t.cellData[String(e)][String(r)].s={});const o={};e===n&&r===s||(e===n?o.l={s:pt.style,cl:{rgb:pt.color}}:(r===s||(o.l={s:pt.style,cl:{rgb:pt.color}}),o.t={s:pt.style,cl:{rgb:pt.color}}),t.cellData[String(e)][String(r)].s.bd=o)}break;case"border-horizontal":for(let e=n;e<r;e++)for(let n=s;n<=o;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.b={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=n+1;e<=r;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(J=null==(Z=null==(q=t.cellData[String(e)][String(n)])?void 0:q.s)?void 0:Z.bd)?void 0:J.t)&&delete t.cellData[String(e)][String(n)].s.bd.t;break;case"border-vertical":for(let e=n;e<=r;e++)for(let n=s;n<o;n++){t.cellData[String(e)]||(t.cellData[String(e)]={}),t.cellData[String(e)][String(n)]||(t.cellData[String(e)][String(n)]={}),t.cellData[String(e)][String(n)].s||(t.cellData[String(e)][String(n)].s={});const r={};r.r={s:pt.style,cl:{rgb:pt.color}},t.cellData[String(e)][String(n)].s.bd=Object.assign(t.cellData[String(e)][String(n)].s.bd||{},r)}for(let e=n;e<=r;e++)for(let n=s+1;n<=o;n++)t.cellData[String(e)]&&(null==(et=null==(tt=null==(Q=t.cellData[String(e)][String(n)])?void 0:Q.s)?void 0:tt.bd)?void 0:et.l)&&delete t.cellData[String(e)][String(n)].s.bd.l;break;case"border-none":for(let e=n;e<=r;e++)for(let n=s;n<=o;n++){if(!t.cellData[String(e)])continue;if(!t.cellData[String(e)][String(n)])continue;if(!t.cellData[String(e)][String(n)].s)continue;const r={};t.cellData[String(e)][String(n)].s.bd=r}for(let e=n;e<=r;e++)for(let n=s-1;n<s;n++)t.cellData[String(e)]&&(null==(st=null==(rt=null==(nt=t.cellData[String(e)][String(n)])?void 0:nt.s)?void 0:rt.bd)?void 0:st.r)&&delete t.cellData[String(e)][String(n)].s.bd.r;for(let e=n;e<=r;e++)for(let n=o+1;n<o+2;n++)t.cellData[String(e)]&&(null==(at=null==(it=null==(ot=t.cellData[String(e)][String(n)])?void 0:ot.s)?void 0:it.bd)?void 0:at.l)&&delete t.cellData[String(e)][String(n)].s.bd.l;for(let e=n-1;e<n;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(ct=null==(ht=null==(lt=t.cellData[String(e)][String(n)])?void 0:lt.s)?void 0:ht.bd)?void 0:ct.b)&&delete t.cellData[String(e)][String(n)].s.bd.b;for(let e=r+1;e<r+2;e++)for(let n=s;n<=o;n++)t.cellData[String(e)]&&(null==(gt=null==(ut=null==(dt=t.cellData[String(e)][String(n)])?void 0:dt.s)?void 0:ut.bd)?void 0:gt.t)&&delete t.cellData[String(e)][String(n)].s.bd.t}}}class pr{constructor(...t){if(C.hasLength(t,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(C.hasLength(t,1)){const e=t[0];return this.startRow=e.startRow,this.startColumn=e.startColumn,this.endRow=e.endRow,void(this.endColumn=e.endColumn)}if(C.hasLength(t,4)){const e=t[0],n=t[1],r=t[2],s=t[3];this.startRow=e,this.startColumn=n,this.endRow=r,this.endColumn=s}}static equals(t,e){return t.endRow===e.endRow&&t.endColumn===e.endColumn&&t.startRow===e.startRow&&t.startColumn===e.startColumn}static intersects(t,e){const n=t.startRow,r=t.endRow,s=t.startColumn,o=t.endColumn,i=e.startRow,a=e.endRow,l=e.startColumn,h=e.endColumn,c=Math.abs(s+o-l-h),d=Math.abs(s-o)+Math.abs(l-h),u=Math.abs(n+r-i-a),g=Math.abs(n-r)+Math.abs(i-a);return c<=d&&u<=g}intersects(t){return pr.intersects(this,t)}union(t){const{startRow:e,startColumn:n,endRow:r,endColumn:s}=this;return new pr(t.startRow<this.startRow?t.startRow:e,t.startColumn<n?t.startColumn:n,t.endRow>r?t.endRow:r,t.endColumn>s?t.endColumn:s)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(t){return pr.equals(this,t)}}const _r=/[^0-9]/g,mr=/[^A-Za-z]/g;function fr(t){return{row:parseInt(t.replace(_r,""))-1,column:C.ABCatNum(t.replace(mr,""))}}const vr="A".charCodeAt(0),br="Z".charCodeAt(0),Cr="a".charCodeAt(0);function Tr(t){const e=br-vr+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+vr)+n,t=Math.floor(t/e)-1;return n}function wr(t,e){let n="";for(;e>0;)n+=t,e--;return n}function Sr(t,e=!1){const n=br-vr+1;let r=Cr;e&&(r=vr);return wr(String.fromCharCode(t%n+r),Math.floor(t/n)+1)}class Er{static fromSequence(t){if(C.isObject(t)&&Er.requiredNewInstance(this)){return this.newInstance(t)}if(C.isArray(t)&&Er.requiredNewInstance(this)){const e=this;return t.map((t=>e.newInstance(t)))}return[]}toSequence(){return{className:C.getClassName(this)}}}function yr(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function Rr(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}(Er||(Er={})).requiredNewInstance=function(t){if(C.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")};const Ir=class{static checkup(t,...e){if(t.length!==e.length)return!1;const n=t.length;for(let r=0;r<n;r++){const n=t[r],s=e[r];switch(s){case Ir.BOOLEAN_TYPE:if(!C.isBoolean(n))return!1;break;case Ir.NUMBER_TYPE:if(!C.isNumber(n))return!1;break;case Ir.STRING_TYPE:if(!C.isString(n))return!1;break;case Ir.FUNCTION_TYPE:if(!C.isFunction(n))return!1;break;case Ir.OBJECT_TYPE:if(!C.isPlainObject(n))return!1;break;default:if(!C.isAssignableFrom(n,s))return!1}}return!0}};let Ar=Ir;Ar.STRING_TYPE=1,Ar.NUMBER_TYPE=2,Ar.BOOLEAN_TYPE=3,Ar.FUNCTION_TYPE=4,Ar.OBJECT_TYPE=5;class Or{static GetClass(t){return this.RegisteredTypes&&this.RegisteredTypes[t]?this.RegisteredTypes[t]:null}}Or.RegisteredTypes={};class Nr{constructor(t,e,n){this.path=t,this.namespace=e,this.observable=n}}class Mr{constructor(){this._observableArray=[]}hasObserver(t,e){return null!=this.getObserver(t,e)}getObserver(...t){if(1===t.length){const e=t[0],n=this._observableArray.find((t=>t.path===e));return n?n.observable:null}if(2===t.length){const e=t[0],n=t[1],r=this._observableArray.find((t=>t.path===e&&t.namespace===n));return r?r.observable:null}}requiredObserver(...t){if(C.hasLength(t,1)){const e=t[0],n=this.getObserver(e);if(null==n)throw new Error(`not found observable ${e}`);return n}if(C.hasLength(t,2)){const e=t[0],n=t[1],r=this.getObserver(e,n);if(null==r)throw new Error(`not found observable ${e}`);return r}throw new Error("requiredObserver arguments error")}removeObserver(...t){if(C.hasLength(t,1)){const e=t[0],n=this._observableArray.findIndex((t=>t.path===e));n>-1&&this._observableArray.splice(n,1)}else if(C.hasLength(t,2)){const e=t[0],n=t[1],r=this._observableArray.findIndex((t=>t.path===e&&t.namespace===n));r>-1&&this._observableArray.splice(r,1)}}addObserver(...t){if(1===t.length){const e=t[0],n=t[1];return this.hasObserver(e,e)&&this.removeObserver(e),void this._observableArray.push(new Nr(e,e,n))}if(3===t.length){const e=t[0],n=t[1],r=t[2];this.hasObserver(e,e)&&this.removeObserver(e,n),this._observableArray.push(new Nr(e,n,r))}}}var xr,kr;(kr=xr||(xr={}))[kr.REDO=0]="REDO",kr[kr.UNDO=1]="UNDO";class Dr extends i{}class Lr extends i{}class Pr extends i{}class Br{constructor(t){this._undoManager=t.getUndoManager(),this._actionExtensionManager=new zr}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new Dr,this._commandObservers=new Pr,this._commandInjectorObservers=new Lr}static getAction(t){return this._actionClass[t]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(t,e){this._actionClass[t]=e}static getCommandInjectorObservers(){return this._commandInjectorObservers}getActionExtensionManager(){return this._actionExtensionManager}undo(){const{_undoManager:t}=this,e=t.undo();e&&e.undo()}redo(){const{_undoManager:t}=this,e=t.redo();e&&e.redo()}invoke(t){const{_undoManager:e}=this,{_actionDataList:n,_unit:r,_actionList:s}=t;this._actionExtensionManager.handle(n),n.forEach((t=>{const e=Br.getAction(t.actionName),n=Br.getActionObservers(),o=new e(t,r,n);s.push(o)})),t.invoke(),e.push(t)}}Br.staticInitialize();class Hr extends r{constructor(t,e,n){if(super(t,n),null==e.WorkBookUnit)throw new Error("action workbook domain can not be null!");this._commandUnit=e,this._workbook=e.WorkBookUnit}getWorkSheet(){const{_workbook:t,_doActionData:e}=this,{sheetId:n}=e;return t.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class Fr{constructor(t,...e){this._unit=t,this._actionDataList=e,this._actionList=[]}getDoData(){return this._actionList.map((t=>t.getDoActionData()))}getOldData(){return this._actionList.map((t=>t.getOldActionData()))}getInjector(){const t=this;return new class{injectAction(e){t._actionList.push(e)}getActions(){return t._actionList.concat([])}include(e){for(let n=0;n<t._actionList.length;n++)if(t._actionList[n]instanceof e)return t._actionList[n];return null}}}redo(){this._actionList.forEach((t=>{jr.hasUndo(t.getDoActionData())&&t.redo()})),Br.getCommandObservers().notifyObservers({type:xr.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach((t=>{jr.hasUndo(t.getOldActionData())&&t.undo()})),Br.getCommandObservers().notifyObservers({type:xr.UNDO,actions:this._actionList})}invoke(){Br.getCommandInjectorObservers().notifyObservers(this.getInjector()),Br.getCommandObservers().notifyObservers({type:xr.REDO,actions:this._actionList})}}class Ur{constructor(){this._undoStack=[],this._redoStack=[]}push(t){this._redoStack.push(t)}undo(){const t=this._redoStack.pop();if(t)return this._undoStack.push(t),t}redo(){const t=this._undoStack.pop();if(t)return this._redoStack.push(t),t}}class zr{constructor(){this._register=new Xr,this._register.initialize()}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.actionExtensionFactoryList;n&&(this._actionExtensionFactoryList=n,0!==t.length&&this._checkExtension(t))}_checkExtension(t){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach((e=>{const n=e.check(t);!1!==n&&n.execute()}))}}class Wr{constructor(t,e){this.actionDataList=t,this._plugin=e}getActionDataList(){return this.actionDataList}push(t){this.actionDataList.push(t)}setValue(){}execute(){}}class Vr{constructor(t){this._plugin=t}get zIndex(){return 0}create(t){return new Wr(t,this._plugin)}check(t){return this.create(t)}}class Yr{constructor(){this._data=[]}static create(){return new Yr}add(t){this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const Gr=Yr.create();class Xr{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...t){this._actionExtensionFactoryList.push(...t),this._actionExtensionFactoryList.sort(yr)}delete(t){const e=this._actionExtensionFactoryList.indexOf(t);this._actionExtensionFactoryList.splice(e,1)}_initExtensions(){this._actionExtensionFactoryList.push(...Gr.getData().sort(yr))}}class jr{constructor(t){this._action=t}static hasObserver(t){return!t.operation||(t.operation&e.OBSERVER_ACTION)===e.OBSERVER_ACTION}static hasUndo(t){return!t.operation||(t.operation&e.UNDO_ACTION)===e.UNDO_ACTION}static hasCollaboration(t){return!t.operation||(t.operation&e.SERVER_ACTION)===e.SERVER_ACTION}static hasExtension(t){return!t.operation||(t.operation&e.EXTENSION_ACTION)===e.EXTENSION_ACTION}static make(t){return t.operation=e.DEFAULT_ACTION,new jr(t)}removeObserver(){return this._action.operation&&(this._action.operation&=~e.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~e.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~e.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~e.EXTENSION_ACTION),this}getAction(){return this._action}}function $r(t,e){var n;let r=null==(n=null==t?void 0:t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId);if(r){let t=r.getConfig().mergeData,n=e.rectangles;for(let e=0;e<n.length;e++)t.push(n[e]);return n}return[]}function Kr(t,e){var n;const r=null==(n=t.WorkBookUnit)?void 0:n.getConfig().namedRanges;null==r||r.push(e.namedRange)}function qr(t,e){var n;const r=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),s=null==r?void 0:r.getCellMatrix(),{startRow:o,endRow:i,startColumn:a,endColumn:l}=e.rangeData,h=new m;for(let c=o;c<=i;c++)for(let t=a;t<=l;t++){const n=null==s?void 0:s.getValue(c,t);h.setValue(c,t,C.deepClone(n)),n&&(e.options.formatOnly&&delete n.s,e.options.contentsOnly&&(n.v="",n.m=""),null==s||s.setValue(c,t,C.deepClone(n)))}return h.getData()}function Zr(t,e){const n=t.WorkBookUnit,r=null==n?void 0:n.getConfig().namedRanges;return null==r?void 0:r.find(((t,n)=>t.namedRangeId===e.namedRangeId?(r.splice(n,1),t):null))}function Jr(t,e){var n,r,s;const o=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),i=null==o?void 0:o.getCellMatrix(),a={rowCount:null==o?void 0:o.getConfig().rowCount,columnCount:null==o?void 0:o.getConfig().columnCount},{startRow:l,endRow:h,startColumn:c,endColumn:d}=e.rangeData,u=h-l+1,g=d-c+1,p=null!=(r=a.rowCount)?r:0,_=null!=(s=a.columnCount)?s:0,f=new m;if(e.shiftDimension===Bt.ROWS)for(let m=l;m<=p;m++)for(let t=c;t<=d;t++){if(m<=h){const e=null==i?void 0:i.getValue(m,t);f.setValue(m,t,e)}const e=null==i?void 0:i.getValue(m+u,t);if(e)null==i||i.setValue(m,t,C.deepClone(e));else{(null==i?void 0:i.getValue(m,t))&&(null==i||i.deleteValue(m,t),t--)}}else if(e.shiftDimension===Bt.COLUMNS)for(let m=l;m<=h;m++)for(let t=c;t<=_;t++){if(t<=d){const e=null==i?void 0:i.getValue(m,t);f.setValue(m,t,e)}else for(let n=0;n<=d;n++){const e=null==i?void 0:i.getValue(m,t);f.setValue(m,t+n,e)}const e=null==i?void 0:i.getValue(m,t+g);if(e)null==i||i.setValue(m,t,C.deepClone(e));else{if(null==i?void 0:i.getValue(m,t)){for(let e=0;e<=d;e++)null==i||i.deleteValue(m,t);break}}}return f.getData()}function Qr(t,e){const n=t.getConfig(),r=n.hidden;return n.hidden=e,r}function ts(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON();new p(n).inserts(e.columnIndex,new p(e.columnCount))}function es(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new m(n).insertColumns(e.columnIndex,new m(e.columnData))}function ns(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new m(n).insertRows(e.rowIndex,new m(e.rowData))}function rs(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=n.getLastRow(),s=n.getLastColumn(),o=n.getCellMatrix(),{startRow:i,endRow:a,startColumn:l,endColumn:h}=e.rangeData,c=a-i+1,d=h-l+1,u=r,g=s;if(e.shiftDimension===Bt.ROWS){for(let t=u;t>=i;t--)for(let e=l;e<=h;e++){const n=o.getValue(t,e);o.setValue(t+c,e,n)}for(let t=a;t>=i;t--)for(let n=l;n<=h;n++)o.setValue(t,n,e.cellValue[t-i][n-l])}else if(e.shiftDimension===Bt.COLUMNS){for(let t=i;t<=a;t++)for(let e=g;e>=l;e--){const n=o.getValue(t,e);o.setValue(t,e+d,n)}for(let t=i;t<=a;t++)for(let n=h;n>=l;n--)o.setValue(t,n,e.cellValue[t-i][n-l])}}function ss(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON();new p(n).inserts(e.rowIndex,new p(e.rowCount))}function os(t,e){t.WorkBookUnit.getSheetBySheetId(e.sheetId);const n=e.index,r=e.sheet,s=t.WorkBookUnit.getWorksheets(),o=t.WorkBookUnit.getConfig(),{sheets:i,sheetOrder:a}=o;if(i[r.id])throw new Error(`Insert Sheet fail ${r.id} is already exist`);return i[r.id]=r,a.splice(n,0,r.id),s.set(r.id,new En(t.WorkBookUnit.getContext(),r)),r.id}function is(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON(),r=new p(n),s=new p,o=e.columnIndex,i=e.columnIndex+e.columnCount;for(let a=o;a<i;a++){const t=r.splice(e.columnIndex,1);t.getLength()&&s.set(a,t.first())}return s.getLength()}function as(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new m(n).spliceColumns(e.columnIndex,e.columnCount).toJSON()}function ls(t,e){let n=t.WorkBookUnit.getSheetBySheetId(e.sheetId);if(n){let t=[],r=n.getConfig().mergeData,s=e.rectangles;for(let e=0;e<s.length;e++)for(let n=r.length-1;n>=0;n--){let o=r[n],i=s[e];pr.intersects(o,i)&&t.push(r.splice(n,1)[0])}return t}return[]}function hs(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON(),r=new p(n),s=new p,o=e.rowIndex,i=e.rowIndex+e.rowCount;for(let a=o;a<i;a++){const t=r.splice(e.rowIndex,1);t.getLength()&&s.set(a,t.first())}return s.getLength()}function cs(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new m(n).spliceRows(e.rowIndex,e.rowCount).toJSON()}function ds(t,e){let n=t.WorkBookUnit,r=e.sheetId;const s=n.getWorksheets(),o=n.getConfig(),{sheets:i}=o;if(null==i[r])throw new Error(`Remove Sheet fail ${r} is not exist`);const a=i[r],l=o.sheetOrder.findIndex((t=>t===r));return delete i[r],o.sheetOrder.splice(l,1),s.delete(r),{index:l,sheet:a}}function us(t,e){const n=t.WorkBookUnit,r=n.getSheetBySheetId(e.sheetId),s=n.getStyles(),o=r.getCellMatrix(),i=new m(e.styles),a=new m;return i.forValue(((t,e,n)=>{const r=o.getValue(t,e);if(r){const o=s.get(r.s);o&&a.setValue(t,e,o),r.s=s.setValue(n)}})),a.toJSON()}function gs(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.columnIndex,s=e.columnCount,o=n.getColumnManager();for(let i=r;i<r+s;i++){o.getColumnOrCreate(i).hd=1}}function ps(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager();for(let r=0;r<0;r++){const t=n.getColumn(r);t&&(t.hd=0)}}function _s(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.columnIndex,s=e.columnWidth,o=n.getColumnManager(),i=[];for(let a=r;a<r+s.length;a++){const t=o.getColumnOrCreate(a);i[a-r]=t.w,t.w=s[a-r]}return i}function ms(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.hideGridlines,s=n.getConfig(),o=0===s.showGridlines;return s.showGridlines=r?0:1,o}function fs(t=0,e,n){for(let r=t;r<t+e;r++){const t=n.getRowOrCreate(r);t&&(t.hd=1)}}function vs(t,e){const n=t.WorkBookUnit;n.getSheetBySheetId(e.sheetId);const r=e.namedRange,s=n.getConfig().namedRanges;return s.find(((t,e)=>t.namedRangeId===r.namedRangeId?(s[e]=r,t):null))}function bs(t,e,n,r){const{startRow:s,endRow:o,startColumn:i,endColumn:a}=n,l=new m;for(let h=s;h<=o;h++)for(let n=i;n<=a;n++){const o=t.getValue(h,n)||{},a=r.getStyleByCell(o);null==a&&delete o.s;const c=Ss(a,e[h-s][n-i]);c&&C.removeNull(c),C.isEmptyObject(c)?delete o.s:o.s=r.setValue(c),o.p&&Es(o.p,e[h-s][n-i]),t.setValue(h,n,o),l.setValue(h-s,n-i,Cs(a,e[h-s][n-i]))}return l.getData()}function Cs(t,e){return Ts(t,e)}function Ts(t,e){if(!e||!Object.keys(e).length)return t;const n=C.deepClone(t)||{};for(const r in e)"bd"===r?n[r]=ws(n[r]||{},e[r]):r in n||(n[r]=null);return n}function ws(t,e){if(!e||!Object.keys(e).length)return t;for(const n in e)n in t||(t[n]=null);return t}function Ss(t,e,n=!1){if(null===e)return e;if(void 0===e)return t;const r=C.deepClone(t)||{};for(const s in e)n&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in r&&"bd"===s?r[s]=Object.assign(r[s],e[s]):(r[s]=e[s],"cl"in r&&["ul","ol","st"].includes(s)&&(r[s].cl=r.cl)));return r}function Es(t,e){var n;null==(n=t.body)||n.blockElements.forEach((t=>{if(0===t.blockType){const n=t.paragraph;null==n||n.elements.forEach((t=>{t.tr||(t.tr={});const n=t.tr;n.ts||(n.ts={});const r=Ss(n.ts,e,!0);r&&C.removeNull(r),C.isEmptyObject(r)?delete n.ts:n.ts=r}))}}))}function ys(t,e){const n=t.WorkBookUnit,r=n.getSheetBySheetId(e.sheetId).getCellMatrix(),s=e.options,o=e.cellValue,i=n.getStyles(),a=new m(o),l=new m;return s?(a.forValue(((t,e,n)=>{const o=r.getValue(t,e),i={};s.contentsOnly&&(i.m=null==o?void 0:o.m,i.v=null==o?void 0:o.v),s.formatOnly&&(i.v=null==o?void 0:o.v,i.m=null==o?void 0:o.m),l.setValue(t,e,i||{}),r.setValue(t,e,n||{})})),l.getData()):(a.forValue(((t,e,n)=>{const s=r.getValue(t,e)||{};if(n){const o=i.getStyleByCell(s),a=Cs(o,null==n?void 0:n.s),h=C.deepClone(s);h.s=a,l.setValue(t,e,h),null==o&&delete s.s;const c=Ss(o,null==n?void 0:n.s);c&&C.removeNull(c),C.isEmptyObject(c)?delete s.s:s.s=i.setValue(c),null!=n.v&&(s.v=n.v),null!=n.m?s.m=n.m:s.m=String(s.v),null!=n.t&&(s.t=n.t),r.setValue(t,e,s)}else r.setValue(t,e,n),l.setValue(t,e,s)})),l.getData())}function Rs(t,e,n){const r=new m(e),s=new m;for(let o=n.startRow;o<=n.endRow;o++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=r.getValue(o,e),s=t.getValue(o,e),i=C.deepClone(s||{});i.n=n,t.setValue(o,e,i||{})}return s.getData()}function Is(t,e,n){const r=new m(e),s=new m;for(let o=n.startRow;o<=n.endRow;o++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=r.getValue(o,e),i=t.getValue(o,e);s.setValue(o,e,i&&i.v||"");const a=C.deepClone(i||{});a.v=n,a.m=`${n}`,t.setValue(o,e,a||{})}return s.getData()}function As(t,e){const n=t.getConfig(),r=n.rightToLeft;return n.rightToLeft=e,r}function Os(t=0,e,n){const r=[];for(let s=t;s<t+e.length;s++){const o=n.getRowOrCreate(s);r[s-t]=o.h,o.h=e[s-t]}return r}function Ns(t,e,n,r){var s,o,i;const a=t.getSelection(),l=null==(s=a.getActiveRangeList())?void 0:s.getRangeList(),h=null==(o=a.getActiveRange())?void 0:o.getRangeData(),c=null==(i=a.getCurrentCell())?void 0:i.getRangeData();return a.setRanges(e,n,r),{activeRangeList:l,activeRange:h,currentCell:c}}function Ms(t,e,n){const r=t.getConfig(),s=r.sheetOrder.findIndex((t=>t===e)),o=r.sheetOrder.filter((t=>t!==e));return o.splice(n,0,e),r.sheetOrder=o,s}function xs(t=0,e,n){for(let r=t;r<t+e;r++){const t=n.getRow(r);t&&(t.hd=0)}}function ks(t,e){const n=t.getConfig(),r=n.tabColor;return n.tabColor=e,r}function Ds(t,e){const n=t.getContext().getWorkBook().getActiveSheet();let r="";const s=be.FALSE;n&&(r=n.getSheetId());const o=t.getContext().getWorkBook().getSheets(),i=t.getSheetId();return o.forEach((t=>{const e=t.getSheetId();t.getConfig().status=e===i?be.TRUE:be.FALSE})),{oldSheetId:r,status:s}}function Ls(t,e){const n=t.getConfig(),r=n.name;return n.name=e,r}function Ps(t,e){const n=t.getConfig(),r=n.status;return n.status=e,r}function Bs(t,e,n){const r=t.getSheetBySheetId(e);if(r){const t=r.getConfig().zoomRatio;return r.getConfig().zoomRatio=n,t}return 1}class Hs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rectangles:this.do()}),this.validate()}do(){return $r(this._commandUnit,this._doActionData)}redo(){this.do()}undo(){ls(this._commandUnit,this._oldActionData)}validate(){return!1}}Hs.NAME="AddMergeAction",Br.register(Hs.NAME,Hs);class Fs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData={actionName:zs.NAME,sheetId:t.sheetId,namedRange:this.do()},this.validate()}do(){const t=Zr(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:zs.NAME,namedRange:this.do()}}undo(){Kr(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Fs.NAME="DeleteNamedRangeAction",Br.register(Fs.NAME,Fs);const Us=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData={actionName:Fs.NAME,sheetId:t.sheetId,namedRangeId:t.namedRange.namedRangeId},this.validate()}do(){Kr(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const{sheetId:t}=this._oldActionData;this._doActionData={actionName:Us.NAME,sheetId:t,namedRange:Zr(this._commandUnit,this._oldActionData)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let zs=Us;var Ws,Vs;zs.NAME="AddNamedRangeAction",Br.register(zs.NAME,zs),(Vs=Ws||(Ws={})).DEFAULT="default",Vs.PASTE="paste";const Ys=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{cellValue:this.do()}),this.validate()}do(){const t=ys(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,options:e}=this._doActionData;this._oldActionData={actionName:Ys.NAME,sheetId:t,cellValue:this.do(),options:e}}undo(){const{sheetId:t,cellValue:e,options:n}=this._oldActionData,r=this.getWorkSheet();this._workbook.getStyles(),r&&(this._doActionData={actionName:Ys.NAME,sheetId:t,cellValue:ys(this._commandUnit,this._oldActionData),options:n},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let Gs=Ys;Gs.NAME="SetRangeDataAction",Br.register(Gs.NAME,Gs);class Xs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{cellValue:this.do()}),this.validate()}do(){const t=qr(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:Gs.NAME,sheetId:t,cellValue:this.do()}}undo(){this.getWorkSheet()&&(ys(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Xs.NAME="ClearRangeAction",Br.register(Xs.NAME,Xs);class js extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){this.getWorkSheet()&&(rs(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:t,sheetId:e,shiftDimension:n}=this._oldActionData;this.getWorkSheet()&&(this._doActionData={actionName:Gs.NAME,sheetId:e,cellValue:Jr(this._commandUnit,this._oldActionData),rangeData:t,shiftDimension:n},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}js.NAME="InsertRangeAction",Br.register(js.NAME,js);class $s extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{cellValue:this.do()}),this.validate()}do(){const t=Jr(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:t,actionName:js.NAME,shiftDimension:n,rangeData:e,cellValue:this.do()}}undo(){this.getWorkSheet()&&(rs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}$s.NAME="DeleteRangeAction",Br.register($s.NAME,$s);class Ks extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){ts(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){is(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ks.NAME="InsertColumnAction",Br.register(Ks.NAME,Ks);class qs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadProps(__spreadValues({},t),{columnCount:p.getMaxLength(t.columnData[0])}),this.validate()}do(){es(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){as(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}qs.NAME="InsertColumnDataAction",Br.register(qs.NAME,qs);class Zs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){ss(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){hs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Zs.NAME="InsertRowAction",Br.register(Zs.NAME,Zs);class Js extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadProps(__spreadValues({},t),{rowCount:p.getMaxLength(t.rowData[0])}),this.validate()}do(){ns(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){cs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Js.NAME="InsertRowDataAction",Br.register(Js.NAME,Js);class Qs extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{sheetId:this.do()})}do(){const t=os(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){ds(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}Qs.NAME="InsertSheetAction",Br.register(Qs.NAME,Qs);class to extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{columnCount:this.do()}),this.validate()}do(){const t=is(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){ts(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}to.NAME="RemoveColumnAction",Br.register(to.NAME,to);class eo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{columnData:this.do()}),this.validate()}do(){const t=as(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){es(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}eo.NAME="RemoveColumnDataAction",Br.register(eo.NAME,eo);class no extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rectangles:this.do()}),this.validate()}do(){const t=ls(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){$r(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}no.NAME="RemoveMergeAction",Br.register(no.NAME,no);class ro extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rowCount:this.do()}),this.validate()}do(){const t=hs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){ss(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ro.NAME="RemoveRowAction",Br.register(ro.NAME,ro);class so extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rowData:this.do()}),this.validate()}do(){const t=cs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){ns(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}so.NAME="RemoveRowDataAction",Br.register(so.NAME,so);class oo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadValues(__spreadValues({},t),this.do())}do(){return this.redo()}redo(){const t=ds(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}undo(){this.getWorkBook(),os(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}oo.NAME="RemoveSheetAction",Br.register(oo.NAME,oo);class io extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{styles:this.do()}),this.validate()}do(){const t=us(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){us(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}io.NAME="SetBorderAction",Br.register(io.NAME,io);class ao extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){gs(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){ps(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ao.NAME="SetColumnHideAction",Br.register(ao.NAME,ao);class lo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){ps(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){gs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}lo.NAME="SetColumnShowAction",Br.register(lo.NAME,lo);class ho extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{columnWidth:this.do()}),this.validate()}do(){const t=_s(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const t=_s(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}ho.NAME="SetColumnWidthAction",Br.register(ho.NAME,ho);class co extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{hideGridlines:this.do()}),this.validate()}do(){const t=ms(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){ms(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}co.NAME="SetHiddenGridlinesAction",Br.register(co.NAME,co);const uo=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData={actionName:uo.NAME,namedRange:this.do(),sheetId:t.sheetId},this.validate()}do(){const t=vs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:uo.NAME,sheetId:t,namedRange:this.do()}}undo(){const{sheetId:t}=this._oldActionData;this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:uo.NAME,sheetId:t,namedRange:vs(this._commandUnit,this._oldActionData)}}validate(){return!1}};let go=uo;go.NAME="SetNamedRangeAction",Br.register(go.NAME,go);const po=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{cellNote:this.do()}),this.validate()}do(){const t=Rs(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:po.NAME,sheetId:t,cellNote:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellNote:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:po.NAME,sheetId:e,cellNote:Rs(r.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let _o=po;_o.NAME="SetRangeNoteAction",Br.register(_o.NAME,_o);const mo=class extends Hr{constructor(t,e,n){super(t,e,n),this._oldActionData=__spreadProps(__spreadValues({},t),{value:this.do()}),this.validate()}do(){const{value:t,rangeData:e}=this._doActionData,n=this._workbook.getStyles(),r=bs(this.getWorkSheet().getCellMatrix(),t,e,n);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:mo.NAME,sheetId:t,value:this.do(),rangeData:e}}undo(){const{value:t,rangeData:e,sheetId:n}=this._oldActionData,r=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:mo.NAME,sheetId:n,value:bs(s,t,e,r),rangeData:e},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let fo=mo;fo.NAME="SetRangeStyleAction",Br.register(fo.NAME,fo);class vo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{cellValue:this.do()}),this.validate()}do(){const t=Is(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:Gs.NAME,sheetId:t,cellValue:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellValue:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Gs.NAME,sheetId:e,cellValue:Is(r.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}vo.NAME="SetRangeFormattedValueAction",Br.register(vo.NAME,vo);class bo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rightToLeft:this.do()}),this.validate()}do(){const t=As(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;As(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}bo.NAME="SetRightToLeftAction",Br.register(bo.NAME,bo);class Co extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{rowHeight:this.do()}),this.validate()}do(){const t=this.getWorkSheet(),e=Os(this._doActionData.rowIndex,this._doActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){const t=this.getWorkSheet(),e=Os(this._oldActionData.rowIndex,this._oldActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this}),e}validate(){return!1}}Co.NAME="SetRowHeightAction",Br.register(Co.NAME,Co);class To extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){const t=this.getWorkSheet();fs(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();xs(this._oldActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}To.NAME="SetRowHideAction",Br.register(To.NAME,To);class wo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this.do(),this._oldActionData=__spreadValues({},t),this.validate()}do(){const t=this.getWorkSheet();xs(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();fs(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}wo.NAME="SetRowShowAction",Br.register(wo.NAME,wo);const So=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t);const{activeRangeList:r,activeRange:s,currentCell:o}=this.do();this._oldActionData=__spreadProps(__spreadValues({},t),{activeRangeList:r,activeRange:s,currentCell:o}),this.validate()}do(){const{activeRangeList:t,activeRange:e,currentCell:n}=this._doActionData,r=Ns(this.getWorkSheet(),t,e,n);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:t}=this._doActionData,{activeRangeList:e,activeRange:n,currentCell:r}=this.do();this._oldActionData={actionName:So.NAME,sheetId:t,activeRangeList:e,activeRange:n,currentCell:r}}undo(){const{activeRangeList:t,activeRange:e,currentCell:n,sheetId:r}=this._oldActionData,s=Ns(this.getWorkSheet(),t,e,n);this._doActionData={actionName:So.NAME,sheetId:r,activeRangeList:s.activeRangeList,activeRange:s.activeRange,currentCell:s.currentCell},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Eo=So;Eo.NAME="SetSelectionActivateAction",Br.register(Eo.NAME,Eo);class yo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{order:this.do()}),this.validate()}do(){const t=Ms(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Ms(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}yo.NAME="SetSheetOrderAction",Br.register(yo.NAME,yo);const Ro=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{color:this.do()}),this.validate()}do(){const t=ks(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:Ro.NAME,color:this.do()}}undo(){const{color:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ro.NAME,sheetId:e,color:ks(n,t)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Io=Ro;Io.NAME="SetTabColorAction",Br.register(Io.NAME,Io);const Ao=class extends Hr{constructor(t,n,r){super(t,n,r),this._doActionData=__spreadValues({},t);const{oldSheetId:s,status:o}=this.do();this._oldActionData=__spreadProps(__spreadValues({},t),{sheetId:s,status:o}),this.validate(),this.removeOperation(e.SERVER_ACTION)}do(){const{sheetId:t,status:e}=this._doActionData,n=Ds(this._workbook.getSheetBySheetId(t));return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:t,status:e}=this.do();this._oldActionData={actionName:Ao.NAME,sheetId:t,status:e}}undo(){const{sheetId:t}=this._oldActionData;this._oldActionData.status;const e=this._workbook.getSheetBySheetId(t);if(e){const{oldSheetId:t,status:n}=Ds(e);this._doActionData={actionName:Ao.NAME,sheetId:t,status:n},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}};let Oo=Ao;Oo.NAME="SetWorkSheetActivateAction",Br.register(Oo.NAME,Oo);const No=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{hidden:this.do()}),this.validate()}do(){const t=Qr(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:No.NAME,hidden:this.do()}}undo(){const{hidden:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:No.NAME,sheetId:e,hidden:Qr(n,t)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Mo=No;Mo.NAME="SetWorkSheetHideAction",Br.register(Mo.NAME,Mo);const xo=class extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{sheetName:this.do()}),this.validate()}do(){const t=Ls(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:xo.NAME,sheetName:this.do()}}undo(){const{sheetName:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:xo.NAME,sheetId:e,sheetName:Ls(n,t)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let ko=xo;ko.NAME="SetWorkSheetNameAction",Br.register(ko.NAME,ko);class Do extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{sheetStatus:this.do()}),this.validate()}do(){const t=Ps(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:ft.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:ft.SET_WORKSHEET_STATUS_ACTION,sheetId:e,sheetStatus:Ps(n,t)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Do.NAME="SetWorkSheetStatusAction",Br.register(Do.NAME,Do);class Lo extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t),this._oldActionData=__spreadProps(__spreadValues({},t),{zoom:this.do()}),this.validate()}redo(){const t=Bs(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),t}do(){return this.redo()}undo(){Bs(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:xr.REDO,data:this._oldActionData,action:this})}validate(){return!1}}Lo.NAME="SetZoomRatioAction",Br.register(Lo.NAME,Lo);class Po{constructor(t){this._name=t,this._observeNames=[]}onCreate(t){this.context=t}load(t){}save(){return Object()}onMounted(t){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getGlobalContext(){return this.context.getUniver().getGlobalContext()}getLocale(){return this.getGlobalContext().getLocale()}getUniver(){return this.context.getUniver()}getObserver(t){return this.context.getObserverManager().getObserver(t,this._name)}getPluginByName(t){return this.context.getPluginManager().getPluginByName(t)}pushToObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{this._observeNames.includes(t)||this._observeNames.push(t),e.addObserver(t,this._name,new i)}))}deleteObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{e.removeObserver(t,this._name)}))}}class Bo{constructor(t,e=[]){this._context=t,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(e),this._initialize()}install(t){const{_plugins:e}=this;e.push(t),t.onCreate(this._context),t.onMounted(this._context)}uninstall(t){const{_plugins:e}=this,n=e.findIndex((e=>e.getPluginName()===t));if(n>-1){const t=e.splice(n,1)[0];t&&t.onDestroy()}}setContext(t){this._context=t}getRequirePluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];throw new Error(`not found plugin ${t}`)}getPlugins(){return this._plugins}getPluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];return null}_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach((t=>{t.onCreate(this._context),t.onMounted(this._context)})))}}class Ho{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class Fo{constructor(){this._hooksManager=new l,this._pluginManager=new Bo(this),this._environment=new Ho,this._observerManager=new Mr,this._initialize()}onUniver(t){const e=t.getGlobalContext();this._univer=t,this._undoManager=e.getUndoManager(),this._commandManager=e.getCommandManager()}getHook(t){return this._hooksManager.getHooks(t)}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}getUniver(){return this._univer}_initialize(){this._undoManager=new Ur,this._commandManager=new Br(this)}}var Uo,zo;function Wo(t,e){let n=t.body;if(e){const{headers:r,footers:s}=t;(null==r?void 0:r[e])?n=r[e].body:(null==s?void 0:s[e])&&(n=s[e].body)}return n}(zo=Uo||(Uo={})).INSERT_TEXT_ACTION_NAME="InsertTextAction",zo.DELETE_TEXT_ACTION_NAME="DeleteTextAction",zo.CLEAR_TEXT_STYLE_ACTION_NAME="ClearTextStyleAction",zo.DELETE_PARAGRAPH_ACTION_NAME="DeleteParagraphAction",zo.INSERT_PARAGRAPH_ACTION_NAME="InsertParagraphAction",zo.MERGE_PARAGRAPH_ACTION_NAME="MergeParagraphAction",zo.MOVE_PARAGRAPH_ACTION_NAME="MoveParagraphAction",zo.SET_TEXT_STYLE_ACTION_NAME="SetTextStyleAction",zo.SPLIT_PARAGRAPH_ACTION_NAME="SplitParagraphAction",zo.UPDATE_DOCUMENT_STYLE_ACTION_NAME="UpdateDocumentAction",zo.UPDATE_PARAGRAPH_STYLE_ACTION_NAME="UpdateParagraphAction",zo.UPDATE_SECTION_ACTION_NAME="UpdateSectionAction",zo.DELETE_BULLET_ACTION_NAME="DeleteBulletAction",zo.DELETE_PARAGRAPH_BULLET_ACTION_NAME="DeleteParagraphBulletAction",zo.DELETE_SECTION_ACTION_NAME="DeleteSectionAction",zo.INSERT_BULLET_ACTION_NAME="InsertBulletAction",zo.INSERT_PARAGRAPH_BULLET_ACTION_NAME="InsertParagraphBulletAction",zo.INSERT_SECTION_ACTION_NAME="InsertSectionAction",zo.UPDATE_BULLET_ACTION_NAME="UpdateBulletAction",zo.UPDATE_PARAGRAPH_BULLET_ACTION_NAME="UpdateParagraphBulletAction",zo.TEXT_INDEX_ADJUST_ACTION_NAME="TextIndexAdjustAction";class Vo{constructor(t,e){var n;this._context=e,this._snapshot=__spreadValues(__spreadValues({},Pe),t),this._unitId=null!=(n=this._snapshot.id)?n:C.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}insertText(t,e,n){const{_context:r}=this,s=r.getCommandManager(),o=__spreadProps(__spreadValues({actionName:Uo.INSERT_TEXT_ACTION_NAME},e),{text:t,length:t.length,segmentId:n}),i=new Fr({DocumentUnit:this},o);return s.invoke(i),this}deleteText(t,e){const{_context:n}=this,r=n.getCommandManager(),s=this._getDeleteTextAction(t,e),o=new Fr({DocumentUnit:this},...s);return r.invoke(o),this}updateText(t,e,n,r){const{_context:s}=this,o=s.getCommandManager(),i={actionName:Uo.DELETE_TEXT_ACTION_NAME,text:e,start:n+e.length,length:e.length,segmentId:r},a={actionName:Uo.INSERT_TEXT_ACTION_NAME,text:t,start:n,length:t.length,segmentId:r},l=new Fr({DocumentUnit:this},i,a);return o.invoke(l),this}_getDeleteTextAction(t,e){const{cursorStart:n,cursorEnd:r,isCollapse:s,isEndBack:o,isStartBack:i}=t;let a=[];return a=s?this._getDeleteTextActionCollapse(t,e):this._getDeleteTextActionRange(t,e),0===a.length?[]:(a.push({actionName:Uo.TEXT_INDEX_ADJUST_ACTION_NAME,cursorStart:n,cursorEnd:r,isCollapse:s,isEndBack:o,isStartBack:i,segmentId:e}),a)}_getDeleteTextActionCollapse(t,e){var n;const r=Wo(this._snapshot,e);if(null==r)return[];const{blockElements:s}=r,{cursorStart:o,isCollapse:i,isStartBack:a}=t,l=[];let h=null,c=null,d=null;for(let u of s){if(null==u)continue;const{blockType:t,st:r,ed:s,blockId:i}=u;if(t===I.PARAGRAPH){if(o>s||o<r)continue;o===r&&a?(null==(n=u.paragraph)?void 0:n.bullet)?l.push({actionName:Uo.DELETE_BULLET_ACTION_NAME,blockId:i,blockElement:u,segmentId:e}):(h=d,c=i):l.push({actionName:Uo.DELETE_TEXT_ACTION_NAME,cursorStart:o,cursorEnd:o,isCollapse:!0,isEndBack:a,isStartBack:a,segmentId:e})}d=i}return null!=h&&null!=c&&h!==c&&l.push({actionName:Uo.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:h,endBlockId:c,segmentId:e,cursorStart:o,isStartBack:a}),l}_getDeleteTextActionRange(t,e){const n=Wo(this._snapshot,e);if(null==n)return[];const{blockElements:r}=n,{cursorStart:s,cursorEnd:o,isCollapse:i,isEndBack:a,isStartBack:l}=t,h=[];let c=null,d=null;for(let u of r){if(null==u)continue;const{blockType:t,st:n,ed:r,blockId:g}=u;if(t===I.PARAGRAPH){if(s>r||o<n)continue;let t=n,p=r,_=l,m=a;n<=s&&r>=s?(c=g,t=s):_=!0,n<=o&&r>=o?(d=g,p=o):m=!1,(s<n||s===n&&l)&&(o>r||o===r&&!a)&&!i?h.push({actionName:Uo.DELETE_PARAGRAPH_ACTION_NAME,cursorStart:n,cursorEnd:r,isCollapse:!1,isEndBack:!1,isStartBack:!0,blockId:g,blockElement:u,segmentId:e}):h.push({actionName:Uo.DELETE_TEXT_ACTION_NAME,cursorStart:t,cursorEnd:p,isCollapse:i,isEndBack:m,isStartBack:_,segmentId:e})}}return null!=c&&null!=d&&c!==d&&h.push({actionName:Uo.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:c,endBlockId:d,segmentId:e,cursorStart:s,isStartBack:l}),h}}class Yo extends Fo{constructor(t={}){super(),this._document=new Vo(t,this)}getDocument(){return this._document}_setObserver(){}}class Go{constructor(){this._data=[]}static create(){return new Go}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}class Xo{constructor(){this._data=new Map}static create(){return new Xo}add(t,e){this._data.has(t)||this._data.set(t,e)}delete(t){this._data.delete(t)}getData(){return this._data}}class jo{install(t){t.addObserver("onAfterSetSelectionObservable","core",new i),t.addObserver("onBeforeChangeNameObservable","core",new i),t.addObserver("onAfterChangeNameObservable","core",new i),t.addObserver("onBeforeChangeActiveSheetObservable","core",new i),t.addObserver("onAfterChangeActiveSheetObservable","core",new i),t.addObserver("onBeforeChangeSheetNameObservable","core",new i),t.addObserver("onAfterChangeSheetNameObservable","core",new i),t.addObserver("onBeforeInsertSheetObservable","core",new i),t.addObserver("onAfterInsertSheetObservable","core",new i),t.addObserver("onBeforeRemoveSheetObservable","core",new i),t.addObserver("onAfterRemoveSheetObservable","core",new i),t.addObserver("onBeforeChangeSheetColorObservable","core",new i),t.addObserver("onAfterChangeSheetColorObservable","core",new i),t.addObserver("onBeforeChangeSheetDataObservable","core",new i),t.addObserver("onAfterChangeSheetDataObservable","core",new i),t.addObserver("onSheetBarDidMountObservable","core",new i),t.addObserver("onInfoBarDidMountObservable","core",new i),t.addObserver("onRightMenuDidMountObservable","core",new i),t.addObserver("onAfterChangeSheetScrollObservable","core",new i),t.addObserver("onSheetRenderDidMountObservable","core",new i),t.addObserver("onHideSheetObservable","core",new i),t.addObserver("onShowSheetObservable","core",new i),t.addObserver("onSheetTabColorChangeObservable","core",new i),t.addObserver("onSheetOrderObservable","core",new i),t.addObserver("onZoomRatioSheetObservable","core",new i)}}class $o extends Fo{constructor(t={}){super(),this._setObserver(),this._genname=new sr,this._workbook=new An(t,this)}getWorkBook(){return this._workbook}getGenName(){return this._genname}getContextObserver(t){return this.getObserverManager().requiredObserver(t,"core")}refreshWorkbook(t={}){this._workbook=new An(t,this)}_setObserver(){const t=this.getObserverManager();(new jo).install(t)}_initialize(){}}class Ko{constructor(t,e){var n;this._context=e,this._snapshot=__spreadValues(__spreadValues({},Be),t),this._unitId=null!=(n=this._snapshot.id)?n:C.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var t;return null==(t=this._snapshot.body)?void 0:t.pages}getPageOrder(){var t;return null==(t=this._snapshot.body)?void 0:t.pageOrder}getPage(t){const e=this.getPages();return null==e?void 0:e[t]}getElementsByPage(t){var e;return null==(e=this.getPage(t))?void 0:e.pageElements}getElement(t,e){var n;return null==(n=this.getElementsByPage(t))?void 0:n[e]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:Ge.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}}class qo extends Fo{constructor(t={}){super(),this._slide=new Ko(t,this)}getSlide(){return this._slide}_setObserver(){}}const Zo="dev",Jo="0.0.1";class Qo{constructor(t={}){this.univerDocConfig=t,this._context=new Yo(t)}get context(){return this._context}static newInstance(t={}){return rr.capsule(Zo,Jo,"powered by :: UniverDoc :: "),new Qo(t)}static get(t){return Xn(__spreadProps(__spreadValues({},t),{type:"GET"}))}static post(t){return Xn(__spreadProps(__spreadValues({},t),{type:"POST"}))}getUnitId(){return this._context.getDocument().getUnitId()}installPlugin(t){this._context.getPluginManager().install(t)}uninstallPlugin(t){this._context.getPluginManager().uninstall(t)}}class ti{constructor(t={}){this.univerSheetConfig=t,this._context=new $o(t)}get context(){return this._context}static newInstance(t={}){return rr.capsule(Zo,Jo,"powered by :: universheet :: "),new ti(t)}static get(t){return Xn(__spreadProps(__spreadValues({},t),{type:"GET"}))}static post(t){return Xn(__spreadProps(__spreadValues({},t),{type:"POST"}))}static load(t,e){t.getWorkBook().load(e.workbookConfig),t.context.getPluginManager().getPlugins().forEach((t=>{t.load(e[`${t.getPluginName()}Config`])}))}static newColor(){return new Ze}static toJson(t){const e=t.getWorkBook().save(),n={};return t.context.getPluginManager().getPlugins().forEach((t=>{n[`${t.getPluginName()}Config`]=t.save()})),__spreadValues({workbookConfig:e},n)}getUnitId(){return this.getWorkBook().getUnitId()}installPlugin(t){this._context.getPluginManager().install(t)}uninstallPlugin(t){this._context.getPluginManager().uninstall(t)}getWorkBook(){return this._context.getWorkBook()}refreshWorkbook(t={}){this._context.refreshWorkbook(t)}}class ei{constructor(t={}){this.UniverSlideConfig=t,this._context=new qo(t)}get context(){return this._context}static newInstance(t={}){return rr.capsule(Zo,Jo,"powered by :: UniverSlide :: "),new ei(t)}static get(t){return Xn(__spreadProps(__spreadValues({},t),{type:"GET"}))}static post(t){return Xn(__spreadProps(__spreadValues({},t),{type:"POST"}))}static newColor(){return new Ze}installPlugin(t){this._context.getPluginManager().install(t)}uninstallPlugin(t){this._context.getPluginManager().uninstall(t)}}class ni extends Fo{constructor(t={}){super(),this._locale=new nr,this._locale.initialize()}getLocale(){return this._locale}_setObserver(){}}class ri{constructor(){this._univerSheets=[],this._univerDocs=[],this._univerSlides=[],this._context=new ni,this._context.onUniver(this)}addUniverSheet(t){t.context.onUniver(this),this._univerSheets.push(t)}addUniverDoc(t){t.context.onUniver(this),this._univerDocs.push(t)}addUniverSlide(t){t.context.onUniver(this),this._univerSlides.push(t)}getUniverSheetInstance(t){return this._univerSheets.find((e=>e.getUnitId()===t))}getUniverDocInstance(t){return this._univerDocs.find((e=>e.getUnitId()===t))}getUniverSlideInstance(t){return null}getAllUniverSheetsInstance(){return this._univerSheets}getAllUniverDocsInstance(){return this._univerDocs}getAllUniverSlidesInstance(){return this._univerSlides}getCurrentUniverSheetInstance(){return this._univerSheets[0]}getCurrentUniverDocInstance(){return this._univerDocs[0]}getCurrentUniverSlideInstance(){return this._univerSlides[0]}getGlobalContext(){return this._context}install(t){this._context.getPluginManager().install(t)}uninstall(t){this._context.getPluginManager().uninstall(t)}}
/*! *****************************************************************************
      Copyright (C) Microsoft. All rights reserved.
      Licensed under the Apache License, Version 2.0 (the "License"); you may not use
      this file except in compliance with the License. You may obtain a copy of the
      License at http://www.apache.org/licenses/LICENSE-2.0
  
      THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
      KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
      WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
      MERCHANTABLITY OR NON-INFRINGEMENT.
  
      See the Apache Version 2.0 License for specific language governing permissions
      and limitations under the License.
      ***************************************************************************** */var si,oi;function ii(t){return"function"==typeof t}function ai(t){return null!=t}function li(t){return null==t}oi=si||(si={}),function(t){var e="object"==typeof an?an:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=r(oi);function r(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===e.Reflect?e.Reflect=oi:n=r(e.Reflect,n),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,i={__proto__:[]}instanceof Array,a=!o&&!i,l={create:o?function(){return rt(Object.create(null))}:i?function(){return rt({__proto__:null})}:function(){return rt({})},has:a?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:a?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},h=Object.getPrototypeOf(Function),c="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=c||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?tt():Map,u=c||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?et():Set,g=new(c||"function"!=typeof WeakMap?nt():WeakMap);function p(t,e,n,r){if(L(n)){if(!Y(t))throw new TypeError;if(!X(e))throw new TypeError;return E(t,e)}if(!Y(t))throw new TypeError;if(!H(e))throw new TypeError;if(!H(r)&&!L(r)&&!P(r))throw new TypeError;return P(r)&&(r=void 0),y(t,e,n=V(n),r)}function _(t,e){function n(n,r){if(!H(n))throw new TypeError;if(!L(r)&&!j(r))throw new TypeError;M(t,e,n,r)}return n}function m(t,e,n,r){if(!H(n))throw new TypeError;return L(r)||(r=V(r)),M(t,e,n,r)}function f(t,e,n){if(!H(e))throw new TypeError;return L(n)||(n=V(n)),I(t,e,n)}function v(t,e,n){if(!H(e))throw new TypeError;return L(n)||(n=V(n)),A(t,e,n)}function b(t,e,n){if(!H(e))throw new TypeError;return L(n)||(n=V(n)),O(t,e,n)}function C(t,e,n){if(!H(e))throw new TypeError;return L(n)||(n=V(n)),N(t,e,n)}function T(t,e){if(!H(t))throw new TypeError;return L(e)||(e=V(e)),x(t,e)}function w(t,e){if(!H(t))throw new TypeError;return L(e)||(e=V(e)),k(t,e)}function S(t,e,n){if(!H(e))throw new TypeError;L(n)||(n=V(n));var r=R(e,n,!1);if(L(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var s=g.get(e);return s.delete(n),s.size>0||g.delete(e),!0}function E(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!L(r)&&!P(r)){if(!X(r))throw new TypeError;e=r}}return e}function y(t,e,n,r){for(var s=t.length-1;s>=0;--s){var o=(0,t[s])(e,n,r);if(!L(o)&&!P(o)){if(!H(o))throw new TypeError;r=o}}return r}function R(t,e,n){var r=g.get(t);if(L(r)){if(!n)return;r=new d,g.set(t,r)}var s=r.get(e);if(L(s)){if(!n)return;s=new d,r.set(e,s)}return s}function I(t,e,n){if(A(t,e,n))return!0;var r=Q(e);return!P(r)&&I(t,r,n)}function A(t,e,n){var r=R(e,n,!1);return!L(r)&&z(r.has(t))}function O(t,e,n){if(A(t,e,n))return N(t,e,n);var r=Q(e);return P(r)?void 0:O(t,r,n)}function N(t,e,n){var r=R(e,n,!1);if(!L(r))return r.get(t)}function M(t,e,n,r){R(n,r,!0).set(t,e)}function x(t,e){var n=k(t,e),r=Q(t);if(null===r)return n;var s=x(r,e);if(s.length<=0)return n;if(n.length<=0)return s;for(var o=new u,i=[],a=0,l=n;a<l.length;a++){var h=l[a];o.has(h)||(o.add(h),i.push(h))}for(var c=0,d=s;c<d.length;c++)h=d[c],o.has(h)||(o.add(h),i.push(h));return i}function k(t,e){var n=[],r=R(t,e,!1);if(L(r))return n;for(var s=K(r.keys()),o=0;;){var i=Z(s);if(!i)return n.length=o,n;var a=q(i);try{n[o]=a}catch(l){try{J(s)}finally{throw l}}o++}}function D(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function L(t){return void 0===t}function P(t){return null===t}function B(t){return"symbol"==typeof t}function H(t){return"object"==typeof t?null!==t:"function"==typeof t}function F(t,e){switch(D(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",s=$(t,r);if(void 0!==s){var o=s.call(t,n);if(H(o))throw new TypeError;return o}return U(t,"default"===n?"number":n)}function U(t,e){if("string"===e){var n=t.toString;if(G(n)&&!H(s=n.call(t)))return s;if(G(r=t.valueOf)&&!H(s=r.call(t)))return s}else{var r;if(G(r=t.valueOf)&&!H(s=r.call(t)))return s;var s,o=t.toString;if(G(o)&&!H(s=o.call(t)))return s}throw new TypeError}function z(t){return!!t}function W(t){return""+t}function V(t){var e=F(t,3);return B(e)?e:W(e)}function Y(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function G(t){return"function"==typeof t}function X(t){return"function"==typeof t}function j(t){switch(D(t)){case 3:case 4:return!0;default:return!1}}function $(t,e){var n=t[e];if(null!=n){if(!G(n))throw new TypeError;return n}}function K(t){var e=$(t,s);if(!G(e))throw new TypeError;var n=e.call(t);if(!H(n))throw new TypeError;return n}function q(t){return t.value}function Z(t){var e=t.next();return!e.done&&e}function J(t){var e=t.return;e&&e.call(t)}function Q(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===h)return e;if(e!==h)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var s=r.constructor;return"function"!=typeof s||s===t?e:s}function tt(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[s]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,s=n+1;s<r;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,o)},e.prototype.entries=function(){return new n(this._keys,this._values,i)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[s]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function o(t,e){return e}function i(t,e){return[t,e]}}function et(){return function(){function t(){this._map=new d}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[s]=function(){return this.keys()},t}()}function nt(){var t=16,n=l.create(),r=s();return function(){function t(){this._key=s()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&l.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?l.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=s()},t}();function s(){var t;do{t="@@WeakMap@@"+h()}while(l.has(n,t));return n[t]=!0,t}function o(t,n){if(!e.call(t,r)){if(!n)return;Object.defineProperty(t,r,{value:l.create()})}return t[r]}function i(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):i(new Uint8Array(t),t):i(new Array(t),t)}function h(){var e=a(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<t;++r){var s=e[r];4!==r&&6!==r&&8!==r||(n+="-"),s<16&&(n+="0"),n+=s.toString(16).toLowerCase()}return n}}function rt(t){return t.__=void 0,delete t.__,t}t("decorate",p),t("metadata",_),t("defineMetadata",m),t("hasMetadata",f),t("hasOwnMetadata",v),t("getMetadata",b),t("getOwnMetadata",C),t("getMetadataKeys",T),t("getOwnMetadataKeys",w),t("deleteMetadata",S)}(n)}();const hi=class{static register(t,e){let n=hi.sMap.get(t);n?n.push(e):(n=new Array,n.push(e),hi.sMap.set(t,n))}static getTable(t){var e;let n=new Array,r=t;for(;null!=r;){const t=null!=(e=hi.sMap.get(r))?e:[];n=n.concat(t),r=Object.getPrototypeOf(r)}return n}};let ci=hi;ci.sMap=new Map;class di{constructor(t={}){this._config=t,this._value=t.value}getValue(){return this._value}setValue(t){this._value=t}}class ui{constructor(t={}){this._mappings=new Map,this._instance=new Map,this._configure=new Map,this._attribute=t instanceof di?t:new di(t),this._circulate=[]}static postDestroy(t){if(t){const e=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(e);for(const r of n){if(ai(Reflect.getMetadata("PreDestroy",e,r))){const n=e[r];ii(n)&&n.apply(t)}}}}static postConstruct(t,e){if(t){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const s of r){if(ai(Reflect.getMetadata("PostConstruct",n,s))){const r=n[s];ii(r)&&r.apply(t,e)}}}}inject(t){if(t){const e=[[t,[]]];this._inject(t,e),this._clearCirculate();for(const t of e.reverse())ui.postConstruct(t[0],t[1])}}getAttribute(){return this._attribute}getInstance(t,...e){const n=[],r=this._getInstance(t,n,gi.prototype,e);this._clearCirculate();for(const s of n.reverse())ui.postConstruct(s[0],s[1]);return r}getSingleton(t,...e){const n=[],r=this._getInstance(t,n,gi.singleton,e);this._clearCirculate();for(const s of n.reverse())ui.postConstruct(s[0],s[1]);return r}getBaseClassByInstance(t){if("object"==typeof t){const{constructor:e}=t,n=this._mappings.entries();for(const[t,r]of n)if(e===r)return t}}removeMapping(t){this._mappings.delete(t);const e=this._instance.get(t),n=t=>{const e=Object.keys(t);for(const r of e){const e=t[r];this.getBaseClassByInstance(e)&&(n(e),ui.postDestroy(t))}ui.postDestroy(t)};ai(e)&&n(e),this._instance.delete(t)}addMapping(t,e,n){this._mappings.set(t,e),ai(n)&&this._configure.set(t,n)}addSingletonMapping(t,e){return this.addMapping(t,e,{scope:gi.singleton})}addClass(t,e){this.addMapping(t.name,t,e)}removeClass(t){this.removeMapping(t.name)}addSingletonClass(t){this.addSingletonMapping(t.name,t)}_inject(t,e){const n=Object.getPrototypeOf(t),r=ci.getTable(n);for(const s of r){const r=Reflect.getMetadata("Container",n,s),o=Reflect.getMetadata("Inject",n,s),i=Reflect.getMetadata("Attribute",n,s),a=Reflect.getMetadata("AttributeValue",n,s);switch(typeof o){case"string":t[s]=this._getInstance(o,e,gi.nothing,[]);break;case"object":{const n=o,{mapping:r}=n,{scope:i}=n,{argument:a}=n;t[s]=this._getInstance(r,e,i,a)}}if(r){t[s]=this}if(i){t[s]=this._attribute}if(a){t[s]=this._attribute.getValue()}}}_getInstance(t,e,n,r){const s=this._mappings.get(t);if(s){if(n===gi.nothing){const e=this._configure.get(t);n=e?e.scope:gi.prototype}switch(n){case gi.singleton:{const o=this._instance.get(t);if(ai(o))return o;const i=ai(r)?new s(...r):new s;return this._instance.set(t,i),this._addCirculate(t,n),this._inject(i,e),this._popCirculate(),e.push([i,r]),i}case gi.prototype:{const o=ai(r)?new s(...r):new s;return this._addCirculate(t,n),this._inject(o,e),this._popCirculate(),e.push([o,r]),o}}}}_printCirculate(){let t="The dependencies of some of the instance in the application context form a cycle";return t+="\n",this._circulate.reverse().forEach((e=>{const{baseClass:n}=e,r=this._mappings.get(n),{name:s}=r;t+="\n",t+=`Class: ${s} Field: ${n}`})),t}_clearCirculate(){this._circulate=[]}_addCirculate(t,e){this._circulate.forEach((n=>{if(n.baseClass===t&&n.scope===e&&e===gi.prototype)throw this._circulate.push({baseClass:t,scope:e}),new Error(this._printCirculate())})),this._circulate.push({baseClass:t,scope:e})}_popCirculate(){this._circulate.pop()}}var gi,pi;function _i(){return(t,e,n)=>{ci.register(t,e),Reflect.defineMetadata("PostConstruct",n,t,e)}}function mi(){return(t,e)=>{ci.register(t,e),Reflect.defineMetadata("AttributeValue",{},t,e)}}(pi=gi||(gi={}))[pi.singleton=0]="singleton",pi[pi.prototype=1]="prototype",pi[pi.nothing=2]="nothing";const fi="MessageQueue";class vi{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(t){this._messages.push(t),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const t=JSON.stringify(this._messages);localStorage.setItem(fi,t)}load(){const t=localStorage.getItem(fi);t&&(this._messages=JSON.parse(t))}}var bi;(bi||(bi={})).MESSAGE_RESPONSE="message_response";class Ci{static isMessageResponseReceive(t){return t.type===bi.MESSAGE_RESPONSE}packMessage(t){return{changed:t,version:C.generateRandomId(6)}}}var Ti,wi,Si=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,yi=(t,e,n,r)=>{for(var s,o=r>1?void 0:r?Ei(e,n):e,i=t.length-1;i>=0;i--)(s=t[i])&&(o=(r?s(e,n,o):s(o))||o);return r&&o&&Si(e,n,o),o};(wi=Ti||(Ti={})).WAIT="wait",wi.WORK="work";const Ri=class extends Ci{initialize(){this.messageQueue=new vi,this.status=Ti.WAIT,this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Zn({url:this.config.socketUrl}),this.socket.on(jn.MESSAGE,(t=>{this.checkupReceiveMessage(t.data)})),this.socket.on(jn.ERROR,(()=>{})),this.socket.on(jn.OPEN,(()=>{})),this.socket.on(jn.CLOSE,(()=>{})),this.socket.on(jn.RETRY,(()=>{})),this.socket.on(jn.DESTROY,(()=>{})),this.socket.link())}pushMessageQueue(t){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(t)),this.sendMessageQueue())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var t;const e=this.getTopMessage();return null!=(t=JSON.stringify(e))?t:""}checkupReceiveMessage(t){Ri.isMessageResponseReceive(t)&&this.getTopMessage().version===t.message.version&&(this.popTopMessage(),this.globalSendResolve())}async sendTopMessage(){const t=this.serializeTopMessage();return this.socket.send(t),new Promise((t=>this.globalSendResolve=t))}async sendMessageQueue(){const{messageQueue:t,status:e}=this;if(e===Ti.WAIT){for(this.status=Ti.WORK;t.hasMessage();)await this.sendTopMessage();this.status=Ti.WAIT}return this.status}};let Ii=Ri;yi([mi()],Ii.prototype,"config",2),yi([_i()],Ii.prototype,"initialize",1);var Ai=Object.freeze(Object.defineProperty({__proto__:null,get ActionOperationType(){return e},ActionBase:r,get ActionType(){return xr},ActionObservers:Dr,CommandInjectorObservers:Lr,CommandObservers:Pr,CommandManager:Br,SheetActionBase:Hr,CommandUnit:class{},Command:Fr,UndoManager:Ur,ActionExtensionManager:zr,BaseActionExtension:Wr,BaseActionExtensionFactory:Vr,REGISTRY_ACTION_FACTORY:Gr,ActionExtensionRegister:Xr,ActionOperation:jr,ContextBase:Fo,DocContext:Yo,Environment:Ho,Registry:Go,RegistryAsMap:Xo,SheetContext:$o,SlideContext:qo,UniverDoc:Qo,UniverSheet:ti,UniverSlide:ei,Univer:ri,VersionEnv:Zo,VersionCode:Jo,WorkBookObserverImpl:jo,get ACTION_NAMES(){return ft},DEFAULT_RANGE_ARRAY:Oe,DEFAULT_RANGE:Ne,DEFAULT_SELECTION:Me,DEFAULT_CELL:xe,DEFAULT_WORKBOOK:ke,DEFAULT_WORKSHEET:De,DEFAULT_STYLES:Le,DEFAULT_DOC:Pe,DEFAULT_SLIDE:Be,get EXTENSION_NAMES(){return He},KEYBOARD_KEYS:Ue,get PLUGIN_NAMES(){return ze},THEME_COLORS:Ve,AddMergeAction:Hs,AddNamedRangeAction:zs,ClearRangeAction:Xs,DeleteNamedRangeAction:Fs,DeleteRangeAction:$s,InsertColumnAction:Ks,InsertColumnDataAction:qs,InsertRangeAction:js,InsertRowAction:Zs,InsertRowDataAction:Js,InsertSheetAction:Qs,RemoveColumnAction:to,RemoveColumnDataAction:eo,RemoveMergeAction:no,RemoveRowAction:ro,RemoveRowDataAction:so,RemoveSheetAction:oo,SetBorderAction:io,SetColumnHideAction:ao,SetColumnShowAction:lo,SetColumnWidthAction:ho,SetHiddenGridlinesAction:co,SetNamedRangeAction:go,SetRangeDataAction:Gs,SetRangeNoteAction:_o,SetRangeStyleAction:fo,SetRangeFormattedValueAction:vo,SetRightToLeftAction:bo,SetRowHeightAction:Co,SetRowHideAction:To,SetRowShowAction:wo,SetSelectionActivateAction:Eo,SetSheetOrderAction:yo,SetTabColorAction:Io,SetWorkSheetActivateAction:Oo,SetWorkSheetHideAction:Mo,SetWorkSheetNameAction:ko,SetWorkSheetStatusAction:Do,SetZoomRatioAction:Lo,Color:Je,HLSColor:Qe,RgbColor:en,ThemeColor:rn,ColorBuilder:Ze,ColumnManager:sn,Merges:on,Range:yn,RangeList:wn,RowManager:Sn,Selection:On,Styles:Rn,Workbook:An,Worksheet:En,addMerge:function(t,e){for(let n=0;n<e.length;n++)t.add(e[n]);return[]},addMergeApply:$r,AddNamedRange:function(t,e){t.push(e)},AddNamedRangeApply:Kr,ClearRangeApply:qr,DeleteNamedRange:function(t,e){return t.find(((n,r)=>n.namedRangeId===e?(t.splice(r,1),n):null))},DeleteNamedRangeApply:Zr,DeleteRange:function(t,e,n,r){const{startRow:s,endRow:o,startColumn:i,endColumn:a}=r,l=o-s+1,h=a-i+1,c=t.rowCount,d=t.columnCount,u=new m;if(n===Bt.ROWS)for(let g=s;g<=c;g++)for(let t=i;t<=a;t++){if(g<=o){const n=e.getValue(g,t);u.setValue(g,t,n)}const n=e.getValue(g+l,t);if(n)e.setValue(g,t,C.deepClone(n));else{e.getValue(g,t)&&(e.deleteValue(g,t),t--)}}else if(n===Bt.COLUMNS)for(let g=s;g<=o;g++)for(let t=i;t<=d;t++){if(t<=a){const n=e.getValue(g,t);u.setValue(g,t,n)}else for(let r=0;r<=a;r++){const n=e.getValue(g,t);u.setValue(g,t+r,n)}const n=e.getValue(g,t+h);if(n)e.setValue(g,t,C.deepClone(n));else{if(e.getValue(g,t)){for(let n=0;n<=a;n++)e.deleteValue(g,t);break}}}return u.getData()},DeleteRangeApply:Jr,SetWorkSheetHideService:Qr,SetWorkSheetHideServiceApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getConfig(),r=n.hidden;return n.hidden=e.hidden,r},InsertColumn:function(t=0,e=1,n){new p(n).inserts(t,new p(e))},InsertColumnApply:ts,InsertDataColumn:function(t,e,n){new m(n).insertColumns(t,new m(e))},InsertDataColumnApply:es,InsertDataRow:function(t,e,n){new m(n).insertRows(t,new m(e))},InsertDataRowApply:ns,InsertRange:function(t,e,n,r,s){const{startRow:o,endRow:i,startColumn:a,endColumn:l}=r,h=i-o+1,c=l-a+1,d=t.rowCount,u=t.columnCount;if(n===Bt.ROWS){for(let t=d;t>=o;t--)for(let n=a;n<=l;n++){const r=e.getValue(t,n);e.setValue(t+h,n,r)}for(let t=i;t>=o;t--)for(let n=a;n<=l;n++)e.setValue(t,n,s[t-o][n-a])}else if(n===Bt.COLUMNS){for(let t=o;t<=i;t++)for(let n=u;n>=a;n--){const r=e.getValue(t,n);e.setValue(t,n+c,r)}for(let t=o;t<=i;t++)for(let n=l;n>=a;n--)e.setValue(t,n,s[t-o][n-a])}},InsertRangeApply:rs,InsertRow:function(t=0,e=1,n){new p(n).inserts(t,new p(e))},InsertRowApply:ss,InsertSheet:function(t,e,n){const r=t.getWorksheets(),s=t.getConfig(),{sheets:o,sheetOrder:i}=s;if(o[n.id])throw new Error(`Insert Sheet fail ${n.id} is already exist`);return o[n.id]=n,i.splice(e,0,n.id),r.set(n.id,new En(t.getContext(),n)),n.id},InsertSheetApply:os,RemoveColumn:function(t,e,n){const r=new p(n),s=new p,o=t+e;for(let i=t;i<o;i++){const e=r.splice(t,1);e.getLength()&&s.set(i,e.first())}return s.getLength()},RemoveColumnApply:is,RemoveColumnData:function(t,e,n){return new m(n).spliceColumns(t,e).toJSON()},RemoveColumnDataApply:as,RemoveMergeApply:ls,RemoveRow:function(t,e,n){const r=new p(n),s=new p,o=t+e;for(let i=t;i<o;i++){const e=r.splice(t,1);e.getLength()&&s.set(i,e.first())}return s.getLength()},RemoveRowApply:hs,RemoveRowData:function(t,e,n){return new m(n).spliceRows(t,e).toJSON()},RemoveRowDataApply:cs,RemoveSheet:function(t,e){const n=t.getWorksheets(),r=t.getConfig(),{sheets:s}=r;if(null==s[e])throw new Error(`Remove Sheet fail ${e} is not exist`);const o=s[e],i=r.sheetOrder.findIndex((t=>t===e));return delete s[e],r.sheetOrder.splice(i,1),n.delete(e),{index:i,sheet:o}},RemoveSheetApply:ds,SetBorder:function(t,e,n){const r=new m(n),s=new m;return r.forValue(((n,r,o)=>{const i=t.getValue(n,r);if(i){const t=e.get(i.s);t&&s.setValue(n,r,t),i.s=e.setValue(o)}})),s.toJSON()},SetBorderApply:us,SetColumnHide:function(t=0,e,n){for(let r=t;r<t+e;r++){n.getColumnOrCreate(r).hd=1}},SetColumnHideApply:gs,SetColumnShow:function(t=0,e,n){for(let r=t;r<t+e;r++){const t=n.getColumn(r);t&&(t.hd=0)}},SetColumnShowApply:ps,SetColumnWidth:function(t=0,e,n){const r=[];for(let s=t;s<t+e.length;s++){const o=n.getColumnOrCreate(s);r[s-t]=o.w,o.w=e[s-t]}return r},SetColumnWidthApply:_s,SetHiddenGridlines:function(t,e){const n=t.getConfig(),r=0===n.showGridlines;return n.showGridlines=e?0:1,r},SetHiddenGridlinesApply:ms,SetHideRow:fs,SetHideRowApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.rowIndex,s=e.rowCount,o=n.getRowManager();for(let i=r;i<r+s;i++){const t=o.getRowOrCreate(i);t&&(t.hd=1)}},SetNamedRange:function(t,e){return t.find(((n,r)=>n.namedRangeId===e.namedRangeId?(t[r]=e,n):null))},SetNamedRangeApply:vs,SetRangeDataApply:ys,SetRangeNote:Rs,SetRangeNoteApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix(),r=e.cellNote,s=e.rangeData,o=new m(r),i=new m;for(let a=s.startRow;a<=s.endRow;a++)for(let t=s.startColumn;t<=s.endColumn;t++){const e=o.getValue(a,t),r=n.getValue(a,t),s=C.deepClone(r||{});s.n=e,n.setValue(a,t,s||{})}return i.getData()},SetRangeStyle:bs,transformStyle:Cs,transformNormalKey:Ts,transformBorders:ws,mergeStyle:Ss,mergeRichTextStyle:Es,SetRangeFormattedValue:Is,SetRangeFormattedValueApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix(),r=e.cellValue,s=e.rangeData,o=new m(r),i=new m;for(let a=s.startRow;a<=s.endRow;a++)for(let t=s.startColumn;t<=s.endColumn;t++){const e=o.getValue(a,t),r=n.getValue(a,t);i.setValue(a,t,r&&r.v||"");const s=C.deepClone(r||{});s.v=e,s.m=`${e}`,n.setValue(a,t,s||{})}return i.getData()},SetRightToLeft:As,SetRightToLeftApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.rightToLeft,s=n.getConfig(),o=s.rightToLeft;return s.rightToLeft=r,o},SetRowHeight:Os,SetRowHeightApply:function(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),r=e.rowIndex,s=e.rowHeight,o=n.getRowManager(),i=[];for(let a=r;a<r+s.length;a++){const t=o.getRowOrCreate(a);i[a-r]=t.h,t.h=s[a-r]}return i},SetSelectionActivate:Ns,SetSheetOrder:Ms,SetShowRow:xs,SetTabColor:ks,SetWorkSheetActivate:Ds,SetWorkSheetName:Ls,SetWorkSheetNameApply:function(){},SetWorkSheetStatus:Ps,SetZoomRatio:Bs,DocumentModel:Vo,SlideModel:Ko,get AutoFillSeries(){return bt},get BooleanCriteria(){return Tt},get BorderStyleTypes(){return St},get BorderType(){return yt},get ColorType(){return It},get CommonHideTypes(){return Ot},get ConditionType(){return Mt},get CopyPasteType(){return kt},get DeveloperMetadataVisibility(){return Lt},get Dimension(){return Bt},get Direction(){return Ft},get FormatType(){return zt},get InterpolationPointType(){return Vt},get KeyCode(){return Gt},get KeyboardKeyType(){return jt},get LocaleType(){return Kt},get ProtectionType(){return Zt},get RelativeDate(){return Qt},get SheetTypes(){return ee},get TextDirection(){return re},get TextDecoration(){return oe},get HorizontalAlign(){return ae},get VerticalAlign(){return he},get WrapStrategy(){return de},get FontItalic(){return ge},get FontWeight(){return _e},get BaselineOffset(){return fe},get BooleanNumber(){return be},get CellValueType(){return Te},get ThemeColorType(){return Se},get ThemeColors(){return ye},get ShapeType(){return Ie},get FollowNumberWithType(){return T},get GlyphType(){return S},get BulletAlignment(){return y},get BlockType(){return I},get GridType(){return O},get SectionType(){return M},get ColumnSeparatorType(){return k},get TextDirectionType(){return L},get ParagraphElementType(){return B},get WrapTextType(){return F},get PositionedObjectLayoutType(){return z},get NamedStyleType(){return V},get SpacingRule(){return G},get DashStyleType(){return j},get TabStopAlignment(){return K},get WidthType(){return Z},get ContentAlignment(){return Q},get FontStyleType(){return et},get ObjectRelativeFromH(){return rt},get ObjectRelativeFromV(){return ot},get NumberUnitType(){return at},get AlignTypeH(){return ht},get AlignTypeV(){return dt},get characterSpacingControlType(){return gt},get PageOrientType(){return _t},DEFAULT_NAMED_RANGE:Ye,get PageType(){return Ge},get PageElementType(){return je},get RelativeSlideLink(){return Ke},AttributeMap:ci,IOCAttribute:di,IOCContainer:ui,get IOCScope(){return gi},PostConstruct:_i,PreDestroy:function(){return(t,e,n)=>{ci.register(t,e),Reflect.defineMetadata("PreDestroy",n,t,e)}},Inject:function(t){return(e,n)=>{(ci.register(e,n),"string"!=typeof t)?ai(t)&&(li(t.argument)&&(t.argument=[]),li(t.scope)&&(t.scope=1),Reflect.defineMetadata("Inject",t,e,n)):Reflect.defineMetadata("Inject",t,e,n)}},Attribute:function(){return(t,e)=>{ci.register(t,e),Reflect.defineMetadata("Attribute",{},t,e)}},Container:function(){return(t,e)=>{ci.register(t,e),Reflect.defineMetadata("Container",{},t,e)}},AttributeValue:mi,EventState:s,Observer:o,Observable:i,ObservableHooks:class extends i{add(t){if(!t)return null;const e=new o(t);return this._observers=[e],this._onObserverAdded&&this._onObserverAdded(e),e}makeObserverTopPriority(){}makeObserverBottomPriority(){}},PathObservableHooks:a,HooksManager:l,PathObservable:Nr,ObserverManager:Mr,Plugin:Po,PluginManager:Bo,MessageQueue:vi,get ServerReceiveType(){return bi},ServerBase:Ci,ServerHttp:class extends Ci{pushMessageQueue(t){throw new Error("Method not implemented.")}},get MessageQueueStatus(){return Ti},ServerSocket:Ii,binarySearchArray:h,orderSearchArray:c,searchArray:d,makeCellToSelection:Nn,isEmptyCell:Mn,getColorStyle:xn,isFormulaString:function(t){return C.isString(t)&&0===t.indexOf("=")&&t.length>1},handleJsonToDom:kn,handleStyleToString:Dn,DateTime:class{},DropCell:Tn,ExcelDateTime:class{},error:un,datenum_local:fn,generate:vn,update:Cn,get IOHttpRequestType(){return Fn},get IOHttpReadyState(){return zn},get IOHttpResponseType(){return Vn},IOHttp:Xn,Post:function(t,e={},n=Bn){return Xn({url:t,type:Fn.POST,data:e,success:n})},Get:function(t,e={},n=Bn){return Xn({url:t+=function(t){if(null==t)return"";let e="";for(const n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&null!==t[n]&&(e+=`${n}=${t[n]}&`);return e=e.substring(0,e.length-1),e?`?${encodeURI(e)}`:""}(e),type:Fn.GET,success:n})},get IOSocketListenType(){return jn},HEART_BEAT_MESSAGE:qn,IOSocket:Zn,isKeyPrintable:Qn,Locale:nr,Logger:rr,GenName:sr,LRUHelper:or,KeyIterator:lr,ValueIterator:hr,EntryIterator:cr,Entry:dr,LRUMap:ur,migrate:function(t){var e;const n={styles:{}};if(t.hasOwnProperty("lang")&&(n.locale=t.lang),t.hasOwnProperty("data")){n.sheets={};for(let r of t.data){const t={};if(t.id=C.generateRandomId(6),r.hasOwnProperty("zoomRatio")&&(t.zoomRatio=r.zoomRatio),r.hasOwnProperty("row")&&(t.rowCount=r.row),r.hasOwnProperty("column")&&(t.columnCount=r.column),r.hasOwnProperty("status")&&(t.status=parseInt(r.status)),r.hasOwnProperty("name")&&(t.name=r.name),r.hasOwnProperty("universheet_select_save")&&(t.selections=[],r.universheet_select_save.forEach((e=>{var n;null==(n=t.selections)||n.push({startRow:e.row[0],endRow:e.row[1],startColumn:e.column[0],endColumn:e.column[1]})}))),r.hasOwnProperty("scrollLeft")&&(t.scrollLeft=r.scrollLeft),r.hasOwnProperty("scrollTop")&&(t.scrollTop=r.scrollTop),r.hasOwnProperty("config")){if(r.config.merge){t.mergeData=[];for(const e of Object.keys(r.config.merge)){const n=r.config.merge[e],s={startRow:n.r,endRow:n.r+n.rs-1,startColumn:n.c,endColumn:n.c+n.cs-1};t.mergeData.push(s)}}if(r.config.borderInfo&&gr(t,r),r.config.rowlen){t.rowData={};for(const[e,n]of Object.entries(r.config.rowlen))t.rowData[String(e)]={h:n,hd:0}}if(r.config.columnlen){t.columnData={};for(const[e,n]of Object.entries(r.config.columnlen))t.columnData[String(e)]={w:n,hd:0}}if(r.config.rowhidden){t.rowData||(t.rowData={});for(const[e,n]of Object.entries(r.config.rowhidden))t.rowData[String(e)]||(t.rowData[String(e)]={}),t.rowData[String(e)].hd=n}if(r.config.colhidden){t.columnData||(t.columnData={});for(const[e,n]of Object.entries(r.config.colhidden))t.columnData[String(e)]||(t.columnData[String(e)]={}),t.columnData[String(e)].hd=n}}if(r.hasOwnProperty("celldata")){t.cellData||(t.cellData={});for(const n of r.celldata){t.cellData[n.r]||(t.cellData[n.r]={}),t.cellData[n.r][n.c]||(t.cellData[n.r][n.c]={});const r=n.v,s=t.cellData[n.r][n.c];if("inlineStr"===(null==(e=null==r?void 0:r.ct)?void 0:e.t)){const t=[];r.ct.s.forEach((e=>{const n={};e.hasOwnProperty("bg")&&(n.bg={rgb:e.fc}),e.hasOwnProperty("ff")&&(n.ff=e.ff),e.hasOwnProperty("fc")&&(n.cl={rgb:e.fc}),e.hasOwnProperty("fs")&&(n.fs=e.fs),e.hasOwnProperty("bl")&&(n.bl=e.bl),e.hasOwnProperty("it")&&(n.it=e.it),e.hasOwnProperty("cl")&&(n.st={s:1}),e.hasOwnProperty("un")&&(n.ul={s:e.un});const r=C.generateRandomId(6);t.push({eId:r,st:0,ed:e.v.length-1,et:0,tr:{ct:e.v,ts:n}})})),s.p={id:C.generateRandomId(6),body:{blockElements:[{blockId:"p1",st:0,ed:r.ct.s.length-1,blockType:0,paragraph:{elements:t}}]},documentStyle:{}}}else{r.hasOwnProperty("v")&&(s.v=r.v),r.hasOwnProperty("m")?s.m=r.m:s.m=String(r.v||"");const t={};r.hasOwnProperty("bg")&&(t.bg={rgb:r.bg}),r.hasOwnProperty("ff")&&(t.ff=r.ff),r.hasOwnProperty("fc")&&(t.cl={rgb:r.fc}),r.hasOwnProperty("fs")&&(t.fs=r.fs),r.hasOwnProperty("bl")&&(t.bl=r.bl),r.hasOwnProperty("it")&&(t.it=r.it),r.hasOwnProperty("cl")&&(t.st={s:r.cl}),r.hasOwnProperty("un")&&(t.ul={s:r.un});const e={0:2,1:1,2:3};if(r.hasOwnProperty("vt")&&(t.vt=e[String(r.vt)]),r.hasOwnProperty("ht")&&(t.ht=e[String(r.ht)]),r.hasOwnProperty("tr"))switch(r.tr){case"0":t.tr={a:0,v:0};break;case"1":t.tr={a:45,v:0};break;case"2":t.tr={a:-45,v:0};break;case"3":t.tr={a:0,v:1};break;case"4":t.tr={a:90,v:0};break;case"5":t.tr={a:-90,v:0}}r.hasOwnProperty("rt")&&(t.tr={a:r.tr,v:0}),r.hasOwnProperty("tb")&&(t.tb=e[String(r.tb)]),s.s=Object.assign(s.s||{},t)}}}n.sheets[t.id]=t}}return n},ObjectArray:p,ObjectArrayIterableIterator:_,ObjectMatrix:m,Rectangle:pr,referenceToGrid:function(t){const e=t.indexOf("!");let n="",r="";e>-1?(n=t.substring(0,e),r=t.substring(e)):r=t;let s=r.indexOf(":");if(-1===s){const t=fr(r),e=t.row,s=t.column;return{sheetName:n,rangeData:{startRow:e,startColumn:s,endRow:e,endColumn:s}}}const o=r.substring(0,s),i=r.substring(s+1),a=fr(o),l=fr(i);return{sheetName:n,rangeData:{startRow:a.row,startColumn:a.column,endRow:l.row,endColumn:l.column}}},ABCToNumber:function(t){if(null==t||0===t.length)return NaN;let e=t.toLowerCase().split(""),n=e.length,r=0,s=0;for(let o=0;o<n;o++)s=e[o].charCodeAt(0)-96,r+=s*26**(n-o-1);return 0===r?NaN:r-1},numberToABC:Tr,repeatStringNumTimes:wr,numberToListABC:Sr,SerializeManager:class{constructor(){this._storage=new Map}addSerializer(...t){if(C.hasLength(t,1)){const e=t[0];this._storage.set(e.name,e)}else if(C.hasLength(t,2)){const e=t[0],n=t[1];this._storage.set(n,e)}}fromSequence(t){if(C.isObject(t)){return this._storage.get(t.className).fromSequence(t)}if(C.isArray(t)){let e=new Array;for(let n of t)e.push(this.fromSequence(n));return e}return[]}toSequence(t){if(C.isObject(t))return t.toSequence();if(C.isArray(t)){let e=new Array;for(let n of t)e.push(this.toSequence(n));return e}return[]}fromStringifyParse(t){return this.fromSequence(JSON.parse(t))}},get Serializer(){return Er},sortRules:yr,sortRulesByDesc:Rr,Tools:C,Tuples:Ar,TypeStoreBase:Or,hashAlgorithm:function(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+(e<<6)+(e<<16)-e;return e>>>0}},Symbol.toStringTag,{value:"Module"})),Oi={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],defaultFontSize:14,unit:"pt"}},Ni={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const Mi={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var xi,ki,Di,Li,Pi;(xi||(xi={})).rect="rect",(Di=ki||(ki={})).PointerMove="PointerMove",Di.PointerDown="PointerDown",Di.PointerUp="PointerUp",Di.PointerOut="PointerOut",Di.PointerLeave="PointerLeave",Di.PointerOver="PointerOver",Di.PointerEnter="PointerEnter",Di.wheel="MouseWheel",Di.KeyDown="KeyDown",Di.KeyUp="KeyUp",(Pi=Li||(Li={}))[Pi.XY=0]="XY",Pi[Pi.X=1]="X",Pi[Pi.Y=2]="Y";const Bi='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',Hi={lines:[],drawings:new Map,height:0,st:0,ed:0,marginLeft:0},Fi=__spreadProps(__spreadValues({},Hi),{marginTop:20}),Ui=__spreadProps(__spreadValues({},Hi),{marginBottom:20}),zi=14;var Wi,Vi,Yi,Gi;(Vi=Wi||(Wi={})).DEFAULT="default",Vi.AUTO="auto",Vi.CROSSHAIR="crosshair",Vi.POINTER="pointer",Vi.MOVE="move",Vi.EAST_RESIZE="e-resize",Vi.NORTH_EAST_RESIZE="ne-resize",Vi.NORTH_WEST_RESIZE="nw-resize",Vi.NORTH_RESIZE="n-resize",Vi.SOUTH_EAST_RESIZE="se-resize",Vi.SOUTH_WEST_RESIZE="sw-resize",Vi.SOUTH_RESIZE="s-resize",Vi.WEST_RESIZE="w-resize",Vi.TEXT="text",Vi.WAIT="wait",Vi.HELP="help",Vi.CELL="cell",Vi.NONE="none",Vi.VERTICAL_TEXT="vertical-text",Vi.NO_DROP="no-drop",Vi.GRAB="grab",Vi.GRABBING="grabbing",Vi.ALL_SCROLL="all-scroll",Vi.COLUMN_RESIZE="col-resize",Vi.ROW_RESIZE="row-resize",Vi.PROGRESS="progress",Vi.NOT_ALLOWED="not-allowed",Vi.ZOOM_IN="zoom-in",Vi.ZOOM_OUT="zoom-out",(Gi=Yi||(Yi={}))[Gi.noClip=0]="noClip",Gi[Gi.DOC_SIZE=1]="DOC_SIZE",Gi[Gi.CONTENT_SIZE_LEFT=2]="CONTENT_SIZE_LEFT",Gi[Gi.CONTENT_SIZE_CENTER=3]="CONTENT_SIZE_CENTER",Gi[Gi.CONTENT_SIZE_Right=4]="CONTENT_SIZE_Right";const Xi="rgb(0,0,0)";var ji,$i,Ki,qi,Zi,Ji;($i=ji||(ji={})).TOP="t",$i.BOTTOM="b",$i.LEFT="l",$i.RIGHT="r",(qi=Ki||(Ki={}))[qi.UP=0]="UP",qi[qi.DOWN=1]="DOWN",(Ji=Zi||(Zi={})).ENGINE="Engine",Ji.SCENE="Scene",Ji.BASE_OBJECT="BaseObject",Ji.SCENE_VIEWER="SceneViewer",Ji.CANVAS="Canvas",Ji.VIEWPORT="Viewport",Ji.LAYER="Layer",Ji.GROUP="Group";const Qi=t=>({sbr:.5,sbo:t,spr:.5,spo:t});class ta{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(t,e,n){this._globalFontMeasureCache.has(t)||(this._globalFontMeasureCache[t]=new Map),this._globalFontMeasureCache[t][e]=n}static clearFontMeasureCache(t){var e;const n=t.split("/");if(1===n.length){const t=n[0];this._globalFontMeasureCache.delete(t)}else{if(2!==n.length)return!1;{const t=n[0],r=n[1];null==(e=this._globalFontMeasureCache.get(t))||e.delete(r)}}return!0}static getFontMeasureCache(t,e){var n;return null==(n=this._globalFontMeasureCache[t])?void 0:n[e]}static autoCleanFontMeasureCache(t=1e6){let e=0,n=!1;for(let r of this._globalFontMeasureCache){const[,s]=r;if(e+=s.size,e>t){n=!0;break}}if(n){let e=0;for(let n of this._globalFontMeasureCache){const[r,s]=n;if(e+=s.size,e>t/2){const n=e-t/2;this._clearMeasureCache(n,s);break}this._globalFontMeasureCache.delete(r)}return!0}return!1}static getBaselineOffsetInfo(t,e){if(0===this._fontDataMap.size)return Qi(e);const n=t.split(",");for(let r of n){r=r.replace(/'/g,"");const t=this._fontDataMap.get(r);if(!t)continue;const{subscriptSizeRatio:n,subscriptOffset:s,superscriptSizeRatio:o,superscriptOffset:i}=t;return{sbr:n,sbo:s*e,spr:o,spo:i*e}}return Qi(e)}static getTextSizeByDom(t,e){if(e in this._getTextHeightCache)return this._getTextHeightCache[e];let n=document.getElementById("universheetTextSizeTest");n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;;${e}`,n.innerText=t;const r=n.getBoundingClientRect(),s={width:r.width,height:r.height};return this._getTextHeightCache[e]=s,s}static getTextSize(t,e){const{fontString:n,fontSize:r,fontFamily:s}=e;let o=this._getBoundingBoxByFont(s,r);if(!o){const e=this.getMeasureText(t,n);o=this._calculateBoundingBoxByMeasureText(e,r)}return o}static getMeasureText(t,e){if(!this._context){const t=document.createElement("canvas");this._context=t.getContext("2d")}const n=this._context,r=this.getFontMeasureCache(e,t);if(null!=r)return r;n.font=e;const s=n.measureText(t),{width:o,fontBoundingBoxAscent:i,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h}=s,c={width:o,fontBoundingBoxAscent:i,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h};if(null==i||null==a||Number.isNaN(i)||Number.isNaN(a)){let t=this.getTextSizeByDom("0",e)[1];"top"===n.textBaseline?(c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t,c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0):"middle"===n.textBaseline?(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=t/2,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t/2):(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t)}return this.setFontMeasureCache(e,t,c),c}static _clearMeasureCache(t,e){let n=0;for(let r of e){const[s]=r;if(n>t)break;e.delete(s),n++}return!0}static _getBoundingBoxByFont(t,e=28,n=""){const r=this._fontDataMap.get(t);if(!r)return;const{notDefWidth:s,ascender:o,descender:i,typoAscender:a,typoDescender:l,strikeoutPosition:h,subscriptSizeRatio:c,subscriptOffset:d,superscriptSizeRatio:u,superscriptOffset:g,hdmxData:p,glyphHorizonMap:_}=r,m=null==p?void 0:p.indexOf(Math.floor(e)),f=_.get(n.charCodeAt(0));let v=s;if(f){const{width:t,pixelsPerEm:e=[]}=f;v=m?e[m]:t}return{width:v*e,ba:o*e,bd:i*e,aba:a*e,abd:l*e,sp:h*e,sbr:c,sbo:d*e,spr:u,spo:g*e}}static _calculateBoundingBoxByMeasureText(t,e){const{width:n,fontBoundingBoxAscent:r,fontBoundingBoxDescent:s,actualBoundingBoxAscent:o,actualBoundingBoxDescent:i}=t;return{width:n,ba:r,bd:s,aba:o,abd:i,sp:(r+s)/2,sbr:.5,sbo:e,spr:.5,spo:e}}}var ea,na,ra,sa,oa,ia,aa,la,ha,ca,da,ua,ga,pa,_a,ma,fa,va;ta._getTextHeightCache={},ta._fontDataMap=new Map,ta._globalFontMeasureCache=new Map,(na=ea||(ea={}))[na.SPAN=0]="SPAN",na[na.DIVIDE=1]="DIVIDE",na[na.LINE=2]="LINE",na[na.COLUMN=3]="COLUMN",na[na.SECTION=4]="SECTION",na[na.PAGE=5]="PAGE",na[na.DRAWING=6]="DRAWING",na[na.BULLET=7]="BULLET",na[na.HEADER=8]="HEADER",na[na.FOOTER=9]="FOOTER",na[na.ALL=10]="ALL",(sa=ra||(ra={}))[sa.SECTION=0]="SECTION",sa[sa.PAGE=1]="PAGE",sa[sa.COLUMN=2]="COLUMN",(ia=oa||(oa={}))[ia.PARAGRAPH=0]="PARAGRAPH",ia[ia.BLOCK=1]="BLOCK",(la=aa||(aa={}))[la.LETTER=0]="LETTER",la[la.WORD=1]="WORD",la[la.LIST=2]="LIST",la[la.TAB=3]="TAB",la[la.IMAGE=4]="IMAGE",la[la.AT=5]="AT",la[la.MATH=6]="MATH",la[la.MULTI_LINE=7]="MULTI_LINE",la[la.CUSTOM=8]="CUSTOM",(ca=ha||(ha={}))[ca.VERTICAL=0]="VERTICAL",ca[ca.HORIZONTAL=1]="HORIZONTAL",ca[ca.AUTO=2]="AUTO",(ua=da||(da={}))[ua.PointerMove=0]="PointerMove",ua[ua.PointerDown=1]="PointerDown",ua[ua.PointerUp=2]="PointerUp";class ba{}ba.DOM_DELTA_PIXEL=0,ba.DOM_DELTA_LINE=1,ba.DOM_DELTA_PAGE=2,(pa=ga||(ga={}))[pa.Generic=0]="Generic",pa[pa.Keyboard=1]="Keyboard",pa[pa.Mouse=2]="Mouse",pa[pa.Touch=3]="Touch",(ma=_a||(_a={}))[ma.Horizontal=0]="Horizontal",ma[ma.Vertical=1]="Vertical",ma[ma.LeftClick=2]="LeftClick",ma[ma.MiddleClick=3]="MiddleClick",ma[ma.RightClick=4]="RightClick",ma[ma.BrowserBack=5]="BrowserBack",ma[ma.BrowserForward=6]="BrowserForward",ma[ma.MouseWheelX=7]="MouseWheelX",ma[ma.MouseWheelY=8]="MouseWheelY",ma[ma.MouseWheelZ=9]="MouseWheelZ",ma[ma.DeltaHorizontal=10]="DeltaHorizontal",ma[ma.DeltaVertical=11]="DeltaVertical",ma[ma.FakeMove=12]="FakeMove",(va=fa||(fa={}))[va.translate=0]="translate",va[va.resize=1]="resize",va[va.scale=2]="scale",va[va.skew=3]="skew",va[va.flip=4]="flip",va[va.all=5]="all";class Ca{constructor(t=30){this._enabled=!0,this._rollingFrameTime=new Ta(t)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let t=this._rollingFrameTime.history(0);return 0===t?0:1e3/t}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(t=this.Now()){if(this._enabled){if(null!=this._lastFrameTimeMs){let e=t-this._lastFrameTimeMs;this._rollingFrameTime.add(e)}this._lastFrameTimeMs=t}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class Ta{constructor(t){this._samples=new Array(t),this.reset()}add(t){let e;if(this.isSaturated()){let t=this._samples[this._pos];e=t-this.average,this.average-=e/(this._sampleCount-1),this._m2-=e*(t-this.average)}else this._sampleCount++;e=t-this.average,this.average+=e/this._sampleCount,this._m2+=e*(t-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=t,this._pos++,this._pos%=this._samples.length}history(t){if(t>=this._sampleCount||t>=this._samples.length)return 0;let e=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(e-t)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(t){let e=this._samples.length;return(t%e+e)%e}}const wa=Math.PI/180,Sa=180/Math.PI,Ea="rgb(",ya=(t,e)=>t?null!=e?`${"rgba("+t.join(",")},${e})`:`${Ea+t.join(",")})`:"rgb(0,0,0)",Ra=(t,e)=>{if(C.isNumber(t))return t;if(e&&t&&C.isString(t)&&"%"===t.substr(t.length-1,1)){return e*(parseFloat(t)/100)}return 0},Ia=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):window.setTimeout(t,16)),Aa=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(t):e.requestAnimationFrame?e.cancelAnimationFrame(t):e.msRequestAnimationFrame?e.msCancelAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(t):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(t):e.oRequestAnimationFrame?e.oCancelAnimationFrame(t):window.clearTimeout(t)),Oa=()=>{let t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){console.error(e)}return t},Na=t=>t*Sa,Ma=t=>t*wa,xa=()=>{let t="pointer";return"undefined"==typeof window||window.PointerEvent||"undefined"==typeof navigator||navigator.pointerEnabled||(t="mouse"),!C.isTablet()||C.isIPhone()||document&&"ontouchend"in document||(t="mouse"),t},ka=()=>"safari"===C.getBrowserType(),Da=(t="obj",e=4)=>{let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),r="";for(let s=0;s<e;s++)r+=n[Math.round(Math.random()*(n.length-1))];return`${t}_${r}_${(new Date).getTime()}`};function La(t){return Object.prototype.toString.apply(t)}function Pa(t){return"[object Function]"===La(t)}function Ba(t){return"[object String]"===La(t)}function Ha(t,e){return e=10**e,Math.round(t*e)/e}function Fa(t,e){return Math.round(t*e)/e}function Ua(t,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:n,defaultFontSize:r}=e;if(!t)return{fontString:`${r}px  ${n[0]}`,fontSize:r,fontFamily:n[0]};let s=et.ITALIC;0!==t.it&&void 0!==t.it||(s=et.NORMAL);let o=et.BOLD;0!==t.bl&&void 0!==t.bl||(o=et.NORMAL);let i=r;t.fs&&(i=Math.ceil(t.fs));let a=n[0];if(t.ff){let e=t.ff;e=e.replace(/"/g,"").replace(/'/g,""),e.indexOf(" ")>-1&&(e=`"${e}"`),null==e&&(e=n[0]),a=e}const{va:l}=t;if(l===fe.SUBSCRIPT||l===fe.SUPERSCRIPT){const t=ta.getBaselineOffsetInfo(a,i),{sbr:e,spr:n}=t;i*=l===fe.SUBSCRIPT?e:n}return{fontString:`${s} ${o} ${i}px ${a}, ${Bi} `,fontSize:i,fontFamily:a}}function za(t){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(t)}function Wa(t){return!!/[-]+|[-]+|[-]+|[a-zA-Z0-9]+|[---]+|[]+/giu.exec(t)}function Va(t){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(t)}function Ya(t){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(t)}function Ga(t){return!!/[\u0180-\u024F]/gi.exec(t)}function Xa(t){return!!/\s+|\t+/g.exec(t)}let ja;function $a(){if(ja)return ja;let t=56;for(;t<2e3;t++)if(!0===matchMedia(`(max-resolution: ${t}dpi)`).matches)return t;return ja=t,setTimeout((()=>{ja=null}),1e3),t}function Ka(t){return t*(72/$a())}function qa(t){const{scaleX:e=1,scaleY:n=1}=t;return Math.max(e,n)}function Za(t,e,n,r){const s=e-1;return{startY:n[t-1]||0,endY:n[t],startX:r[s]||0,endX:r[e]}}function Ja(t,e,n,r,s){let{startY:o,endY:i,startX:a,endX:l}=Za(t,e,n,r);const{isMerged:h,isMergedMainCell:c,newEndRow:d,newEndColumn:u,mergeRow:g,mergeColumn:p}=Qa(t,e,s);let _={startRow:g,startColumn:p,endRow:d,endColumn:u,startY:0,endY:0,startX:0,endX:0};if(h&&-1!==g&&-1!==p){let t=n[g-1]||0,e=n[d],s=r[p-1]||0,o=r[u];_=__spreadProps(__spreadValues({},_),{startY:t,endY:e,startX:s,endX:o})}else h||-1===d||-1===u||(i=n[d]||0,l=r[u]||0);return{isMerged:h,isMergedMainCell:c,row:t,column:e,startY:o,endY:i,startX:a,endX:l,mergeInfo:_}}function Qa(t,e,n){let r=!1,s=!1,o=-1,i=-1,a=-1,l=-1;return null==n||n.forEach(((n,h)=>{let c=!1;if(null==h||h.forEach(((n,h)=>{const{startRow:d,endRow:u,startColumn:g,endColumn:p}=h;return t===d&&e===g?(o=u,i=p,a=d,l=g,c=!0,s=!0,!1):t>=d&&t<=u&&e>=g&&e<=p?(o=u,i=p,a=d,l=g,c=!0,r=!0,!1):void 0})),c)return!1})),{isMergedMainCell:s,isMerged:r,newEndRow:o,newEndColumn:i,mergeRow:a,mergeColumn:l}}function tl(t,e,n,r,s){const{startY:o,endY:i,startX:a,endX:l}=t;return t.startY=Fa(o+n,s),t.endY=Fa(i+n,s),t.startX=Fa(a+e,r),t.endX=Fa(l+e,r),__spreadValues({},t)}function el(t,e){return!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)}function nl(t){const e=document.createElement("style");document.head.appendChild(e);const n=e.sheet;for(let r of t)null==n||n.insertRule(r,n.cssRules.length)}function rl(t){for(let e=0,n=document.head.childNodes.length;e<n;e++){const n=document.head.childNodes[e];if("STYLE"===n.nodeName&&n.textContent&&n.textContent.indexOf(t)>-1)return!0}return!1}function sl(t){return Number(t.replace(/px/gi,""))}function ol(t){const e=getComputedStyle(t),{borderTopWidth:n,borderLeftWidth:r,borderRightWidth:s,borderBottomWidth:o,width:i,height:a}=e;return{top:sl(n),left:sl(r),right:sl(s),bottom:sl(o),width:sl(i),height:sl(a)}}class il{constructor(t=0,e=0){this.x=t,this.y=e}static Zero(){return new il(0,0)}static One(){return new il(1,1)}static FromArray(t,e=0){return new il(t[e],t[e+1])}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1]}static CatmullRom(t,e,n,r,s){let o=s*s,i=s*o,a=.5*(2*e.x+(-t.x+n.x)*s+(2*t.x-5*e.x+4*n.x-r.x)*o+(-t.x+3*e.x-3*n.x+r.x)*i),l=.5*(2*e.y+(-t.y+n.y)*s+(2*t.y-5*e.y+4*n.y-r.y)*o+(-t.y+3*e.y-3*n.y+r.y)*i);return new il(a,l)}static Clamp(t,e,n){let r=t.x;r=r>n.x?n.x:r,r=r<e.x?e.x:r;let s=t.y;return s=s>n.y?n.y:s,s=s<e.y?e.y:s,new il(r,s)}static Hermite(t,e,n,r,s){let o=s*s,i=s*o,a=2*i-3*o+1,l=-2*i+3*o,h=i-2*o+s,c=i-o,d=t.x*a+n.x*l+e.x*h+r.x*c,u=t.y*a+n.y*l+e.y*h+r.y*c;return new il(d,u)}static Hermite1stDerivative(t,e,n,r,s){let o=il.Zero();return this.Hermite1stDerivativeToRef(t,e,n,r,s,o),o}static Hermite1stDerivativeToRef(t,e,n,r,s,o){const i=s*s;o.x=6*(i-s)*t.x+(3*i-4*s+1)*e.x+6*(-i+s)*n.x+(3*i-2*s)*r.x,o.y=6*(i-s)*t.y+(3*i-4*s+1)*e.y+6*(-i+s)*n.y+(3*i-2*s)*r.y}static Lerp(t,e,n){let r=t.x+(e.x-t.x)*n,s=t.y+(e.y-t.y)*n;return new il(r,s)}static Dot(t,e){return t.x*e.x+t.y*e.y}static Normalize(t){let e=il.Zero();return this.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){let n=t.length();0!==n&&(e.x=t.x/n,e.y=t.y/n)}static Minimize(t,e){let n=t.x<e.x?t.x:e.x,r=t.y<e.y?t.y:e.y;return new il(n,r)}static Maximize(t,e){let n=t.x>e.x?t.x:e.x,r=t.y>e.y?t.y:e.y;return new il(n,r)}static Transform(t,e,n=!1){const r=e,s=t;return n?new il(r[0]*s.x+r[2]*s.y,r[1]*s.x+r[3]*s.y):new il(r[0]*s.x+r[2]*s.y+r[4],r[1]*s.x+r[3]*s.y+r[5])}static PointInTriangle(t,e,n,r){let s=.5*(-n.y*r.x+e.y*(-n.x+r.x)+e.x*(n.y-r.y)+n.x*r.y),o=s<0?-1:1,i=(e.y*r.x-e.x*r.y+(r.y-e.y)*t.x+(e.x-r.x)*t.y)*o,a=(e.x*n.y-e.y*n.x+(e.y-n.y)*t.x+(n.x-e.x)*t.y)*o;return i>0&&a>0&&i+a<2*s*o}static Distance(t,e){return Math.sqrt(il.DistanceSquared(t,e))}static DistanceSquared(t,e){let n=t.x-e.x,r=t.y-e.y;return n*n+r*r}static Center(t,e){return il.CenterToRef(t,e,il.Zero())}static CenterToRef(t,e,n){return n.copyFromFloats((t.x+e.x)/2,(t.y+e.y)/2)}static DistanceOfPointFromSegment(t,e,n){let r=il.DistanceSquared(e,n);if(0===r)return il.Distance(t,e);let s=n.subtract(e),o=Math.max(0,Math.min(1,il.Dot(t.subtract(e),s)/r)),i=e.add(s.multiplyByFloats(o,o));return il.Distance(t,i)}static create(t,e){return new il(t,e)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let t=0|this.x;return t=397*t^(0|this.y),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,this}fromArray(t,e=0){return il.FromArrayToRef(t,e,this),this}asArray(){let t=new Array;return this.toArray(t,0),t}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,e){return this.x=t,this.y=e,this}set(t,e){return this.copyFromFloats(t,e)}add(t){return new il(this.x+t.x,this.y+t.y)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this}addByPoint(t,e){return new il(this.x+t,this.y+e)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return new il(this.x-t.x,this.y-t.y)}subtractByPoint(t,e){return new il(this.x-t,this.y-e)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new il(this.x*t.x,this.y*t.y)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this}multiplyByFloats(t,e){return new il(this.x*t,this.y*e)}divide(t){return new il(this.x/t.x,this.y/t.y)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this}divideInPlace(t){return this.divideToRef(t,this)}negate(){return new il(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(t){return t.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){let e=new il(0,0);return this.scaleToRef(t,e),e}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y}floor(){return new il(Math.floor(this.x),Math.floor(this.y))}fract(){return new il(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,s=n*this.x+e*this.y;return this.x=r,this.y=s,this}rotateToRef(t,e){const n=Math.cos(t),r=Math.sin(t);return e.x=n*this.x-r*this.y,e.y=r*this.x+n*this.y,this}rotateByPoint(t,e=il.create(0,0)){const n=Math.cos(t),r=Math.sin(t),s=e.x+(this.x-e.x)*n-(this.y-e.y)*r,o=e.y+(this.x-e.x)*r+(this.y-e.y)*n;return this.x=s,this.y=o,this}transformCoordinateOnRotate(t){const e=Math.sqrt(this.x**2+this.y**2),n=-t+Math.atan2(this.y,this.x);return this.x=e*Math.cos(n),this.y=e*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return il.NormalizeToRef(this,this),this}clone(){return new il(this.x,this.y)}}const al=[1,0,0,1,0,0];class ll{constructor(t=al){this.dirty=!1,this._m=t&&t.slice()||al}static create(t=al){return new this(t)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new ll(this._m)}copyInto(t){t._m[0]=this._m[0],t._m[1]=this._m[1],t._m[2]=this._m[2],t._m[3]=this._m[3],t._m[4]=this._m[4],t._m[5]=this._m[5]}applyPoint(t,e=!1){const n=this._m;let r=n[0]*t.x+n[2]*t.y,s=n[1]*t.x+n[3]*t.y;return e?new il(r,s):new il(r+n[4],s+n[5])}translate(t,e){return this._m[4]+=this._m[0]*t+this._m[2]*e,this._m[5]+=this._m[1]*t+this._m[3]*e,this}scale(t,e){return this._m[0]*=t,this._m[1]*=t,this._m[2]*=e,this._m[3]*=e,this}rotate(t){const e=Ma(t);let n=Math.cos(e),r=Math.sin(e),s=this._m[0]*n+this._m[2]*r,o=this._m[1]*n+this._m[3]*r,i=this._m[0]*-r+this._m[2]*n,a=this._m[1]*-r+this._m[3]*n;return this._m[0]=s,this._m[1]=o,this._m[2]=i,this._m[3]=a,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(t,e){let n=this._m[0]+this._m[2]*e,r=this._m[1]+this._m[3]*e,s=this._m[2]+this._m[0]*t,o=this._m[3]+this._m[1]*t;return this._m[0]=n,this._m[1]=r,this._m[2]=s,this._m[3]=o,this}multiply(t){let e=this._m[0]*t._m[0]+this._m[2]*t._m[1],n=this._m[1]*t._m[0]+this._m[3]*t._m[1],r=this._m[0]*t._m[2]+this._m[2]*t._m[3],s=this._m[1]*t._m[2]+this._m[3]*t._m[3],o=this._m[0]*t._m[4]+this._m[2]*t._m[5]+this._m[4],i=this._m[1]*t._m[4]+this._m[3]*t._m[5]+this._m[5];return this._m[0]=e,this._m[1]=n,this._m[2]=r,this._m[3]=s,this._m[4]=o,this._m[5]=i,this}invert(){let t=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),e=this._m[3]*t,n=-this._m[1]*t,r=-this._m[2]*t,s=this._m[0]*t,o=t*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),i=t*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=e,this._m[1]=n,this._m[2]=r,this._m[3]=s,this._m[4]=o,this._m[5]=i,this}getMatrix(){return this._m}getMatrixByAccurate(t=3){return this._m.map((e=>Ha(e,t)))}setAbsolutePosition(t){let e=this._m[0],n=this._m[1],r=this._m[2],s=this._m[3],o=this._m[4],i=this._m[5],a=(e*(t.y-i)-n*(t.x-o))/(e*s-n*r),l=(t.x-o-r*a)/e;return this.translate(l,a)}decompose(){let t=this._m[0],e=this._m[1],n=this._m[2],r=this._m[3],s=t*r-e*n,o={x:this._m[4],y:this._m[5],angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let i=Math.sqrt(t*t+e*e);o.angle=e>0?Math.acos(t/i):-Math.acos(t/i),o.scaleX=i,o.scaleY=s/i,o.skewX=(t*n+e*r)/s,o.skewY=0}else if(0!==n||0!==r){let i=Math.sqrt(n*n+r*r);o.angle=Math.PI/2-(r>0?Math.acos(-n/i):-Math.acos(n/i)),o.scaleX=s/i,o.scaleY=i,o.skewX=0,o.skewY=(t*n+e*r)/s}return o.angle=Na(o.angle),o}makeBoundingBoxFromPoints(t){if(this)for(let i=0;i<t.length;i++)t[i]=this.applyPoint(t[i]);const e=[t[0].x,t[1].x,t[2].x,t[3].x],n=Math.min(...e),r=Math.max(...e)-n,s=[t[0].y,t[1].y,t[2].y,t[3].y],o=Math.min(...s);return{left:n,top:o,width:r,height:Math.max(...s)-o,points:t}}composeMatrix(t){const e=new ll([1,0,0,1,t.left||0,t.top||0]);return t.angle&&e.rotate(t.angle),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&e.multiply(this._calcDimensionsMatrix(t)),this._m=e.getMatrix(),this}clone(){return new ll([...this._m])}_calcDimensionsMatrix(t){var e,n;const r=null!=(e=t.scaleX)?e:1,s=null!=(n=t.scaleY)?n:1,o=new ll([t.flipX?-r:r,0,0,t.flipY?-s:s,0,0]);return t.skewX&&o.multiply(new ll([1,0,Math.tan(Ma(t.skewX)),1,0,0])),t.skewY&&o.multiply(new ll([1,Math.tan(Ma(t.skewY)),0,1,0,0])),o}}function hl(t,e,n){let r=0,s=0,o=0,i=0;const{startX:a,startY:l,endX:h,endY:c}=n;e===ji.TOP?(r=a,s=l,o=h,i=l):e===ji.BOTTOM?(r=a,s=c,o=h,i=c):e===ji.LEFT?(r=a,s=l,o=a,i=c):e===ji.RIGHT&&(r=h,s=l,o=h,i=c),t.beginPath(),t.moveTo(r,s),t.lineTo(o,i),t.stroke()}function cl(t,e){e===St.HAIR?t.setLineDash([1,2]):e===St.DASH_DOT_DOT||e===St.MEDIUM_DASH_DOT_DOT?t.setLineDash([2,2,5,2,2]):e===St.DASH_DOT||e===St.MEDIUM_DASH_DOT||e===St.SLANT_DASH_DOT?t.setLineDash([2,5,2]):e===St.DOTTED?t.setLineDash([2]):e===St.DASHED||e===St.MEDIUM_DASHED?t.setLineDash([3]):t.setLineDash([0])}function dl(t){let e=1;return t===St.MEDIUM||t===St.MEDIUM_DASH_DOT||t===St.MEDIUM_DASHED||t===St.MEDIUM_DASH_DOT_DOT?e=2:t===St.THICK&&(e=3),e}function ul(t,e,n,r,s=il.create(0,0)){const o=t.add(e).rotateByPoint(r),i=r-n;return o.subtract(e).rotateByPoint(i,o).add(s).transformCoordinateOnRotate(i)}function gl(t){return t>0?Ki.DOWN:Ki.UP}function pl(t,e,n){const r=[];let s=0,o=0,i=0,a=0,l=0;const h=gl(n),c=t.length;n=Math.abs(n);const d=Math.tan(n),u=Math.sin(n),g=Math.cos(n);if(h===Ki.UP){let n=0;for(let s=0;s<c;s++){const a=t[s],{lineHeight:h=0}=a;n+=0===s?0:h;const c=(h/d+e)*u;r.push(n/d),c>o&&(o=c),0===s&&(i+=h*u,l+=h*g)}i+=n/u+e*g,l-=o}else{let n=0,l=-1;const h=[];for(let r=c-1;r>=0;r--){const s=t[r],{lineHeight:a=0}=s,p=a/d,_=(e+p)*u;h.unshift(a/d),_>o&&(o=_,n=p,l=r),i+=0===r?a*u:r===c-1?e*g+a/u:a/u}let p=t[l].lineHeight||0,_=0;for(let e=l+1;e<=c-1;e++){const n=t[e],{lineHeight:s=0}=n;p+=s,_+=h[e]||0,r[e]=-_}_=0;for(let e=l-1;e>=0;e--){const n=t[e],{lineHeight:o=0}=n;_+=h[e+1]||0,r[e]=_,s+=o}r[l]=0,1===c&&(i+=e*g),a=p/u-n*g}return{rotateTranslateXList:r,rotatedHeight:o,rotatedWidth:i,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:s}}const _l=[new il(0,0),new il(1,1)];class ml{constructor(t=_l){this._lines=t}intersection(t){if(this._lines.length<1||t.length<1)return;const e=[];for(let n=1;n<this._lines.length;n++){const r=this._lines[n-1],s=this._lines[n];for(let o=1;o<t.length;o++){const t=this._lines[n-1],o=this._lines[n],i=this._intersection({from:r,to:s},{from:t,to:o});i&&e.push(i)}}return e}_intersection(t,e){const n=t.from,r=t.to,s=e.from,o=e.to;let i=(n.x-s.x)*(r.y-s.y)-(n.y-s.y)*(r.x-s.x),a=(n.x-o.x)*(r.y-o.y)-(n.y-o.y)*(r.x-o.x);if(i*a>=0)return!1;let l=(s.x-n.x)*(o.y-n.y)-(s.y-n.y)*(o.x-n.x);if(l*(l+i-a)>=0)return!1;let h=l/(a-i),c=h*(r.x-n.x),d=h*(r.y-n.y);return new il(n.x+c,n.y+d)}}function fl(t,e,n,r,s,o){if(!o)return[];const i=o.getPluginManager().getPluginByName("documentCustomBlock");return i?i.dealWidthCustomBlock(t,e,n,r,s):[]}function vl(t,e,n,r){if(!r)return"";const s=r.getPluginManager().getPluginByName("documentCustomBullet");return s?s.dealWidthCustomBulletOrderedSymbol(t,e,n):""}const bl=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class Cl{constructor(t){this.isInGroup=!1,this.onTransformChangeObservable=new i,this.onPointerDownObserver=new i,this.onPointerMoveObserver=new i,this.onPointerUpObserver=new i,this.onDblclickObserver=new i,this.onMouseWheelObserver=new i,this.onPointerOutObserver=new i,this.onPointerLeaveObserver=new i,this.onPointerOverObserver=new i,this.onPointerEnterObserver=new i,this.onIsAddedToParentObserver=new i,this.onDisposeObserver=new i,this._dirty=!0,this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new ll,this._cursor=Wi.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this._oKey=t||Da()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return Zi.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}set transform(t){this._transform=t}set zIndex(t){this._zIndex=t}set parent(t){this._parent=t}set evented(t){this._evented=t}set debounceParentDirty(t){this._debounceParentDirty=t}set isTransformer(t){this._isTransformer=t}set cursor(t){this.setCursor(t)}set top(t){var e;this._topOrigin=t,this._top=Ra(t,null==(e=this._parent)?void 0:e.height)}set left(t){var e;this._leftOrigin=t,this._left=Ra(t,null==(e=this._parent)?void 0:e.width)}set width(t){var e;this._widthOrigin=t,this._width=Ra(t,null==(e=this._parent)?void 0:e.width)}set height(t){var e;this._heightOrigin=t,this._height=Ra(t,null==(e=this._parent)?void 0:e.height)}set strokeWidth(t){this._strokeWidth=t}set angle(t){this._angle=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}set skewX(t){this._skewX=t}set flipY(t){this._flipY=t}set flipX(t){this._flipX=t}set skewY(t){this._skewY=t}makeDirty(t=!0){return this._dirty=t,t&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout((()=>{var e;null==(e=this.parent)||e.makeDirty(t)}),0)),this}makeDirtyNoDebounce(t=!0){var e;return this._dirty=t,t&&(null==(e=this.parent)||e.makeDirty(t)),this}isDirty(){return this._dirty}translate(t,e){const n=this.top;void 0!==e&&(this.top=e);const r=this.left;return void 0!==t&&(this.left=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:r}}),this}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const r=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:r}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const r=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:r}}),this}skew(t,e){const n=t;void 0!==t&&(this.skewX=t);const r=e;return void 0!==e&&(this.skewY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:r}}),this}flip(t,e){const n=t;void 0!==t&&(this.flipX=t);const r=e;return void 0!==e&&(this.flipY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:r}}),this}transformByState(t){const e=Object.keys(t),n={};if(0!==e.length)return e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.all,value:t,preValue:n}),this}isRender(t){return!this._forceRender&&(t&&!this.isInGroup)}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(t,e){}isHit(t){const e=this._getInverseCoord(t);return e.x>=-this.strokeWidth/2&&e.x<=this.width+this.strokeWidth/2&&e.y>=-this.strokeWidth/2&&e.y<=this.height+this.strokeWidth/2}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}clear(t){this[`on${t}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(t){var e,n;return!!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerPointerDown(t){var e,n;return!!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerUp(t){var e,n;return!!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerDblclick(t){var e,n;return!!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerMouseWheel(t){var e,n;return!!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerOut(t){var e,n;return!!(null==(e=this.onPointerOutObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e,n;return!!(null==(e=this.onPointerLeaveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return!!this.onPointerOverObserver.notifyObservers(t)||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e,n;return!!(null==(e=this.onPointerEnterObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerEnter(t),!1)}dispose(){var t;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),null==(t=this.parent)||t.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const t={};return bl.forEach((e=>{this[e]&&(t[e]=this[e])})),t}getScene(){let t=this.parent;if(null!=t){if(t.classType===Zi.SCENE)return t;for(;t;){if(t.classType===Zi.SCENE)return t;t=t.getParent()}}}resetCursor(){this.setCursor(Wi.DEFAULT)}setCursor(t){var e;this._cursor=t,null==(e=this.getScene())||e.setCursor(t)}getEngine(){let t=this.getParent();for(;null!=t;){if(t===Zi.ENGINE)return t;t=t.getParent()}return null}_getInverseCoord(t){return this._transform.clone().invert().applyPoint(t)}_setTransForm(){const t=ll.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=t,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}function Tl(t){const e=t.getScene(),n=t.getViewportByCoord(e);if(!n)return{scrollX:0,scrollY:0};const r=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:r.x,scrollY:r.y}}function wl(t,e){const n=t.transform.clone().invert().applyPoint(e.tl),r=t.transform.clone().invert().applyPoint(e.tr),s=t.transform.clone().invert().applyPoint(e.bl),o=t.transform.clone().invert().applyPoint(e.br),i=[n.x,r.x,s.x,o.x],a=[n.y,r.y,s.y,o.y],l=Math.max(...i),h=Math.min(...i),c=Math.max(...a);return{minX:h,maxX:l,minY:Math.min(...a),maxY:c}}function Sl(){let t=1,e=Oa().getContext("2d");return t=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),t<1?1:Math.ceil(10*t)/10}class El{constructor(t){this.isCache=!1,this._pixelRatio=1,this._width=0,this._height=0,t=t||{},this._canvasEle=Oa(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(t.width,t.height,t.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(t,e,n){this._pixelRatio=n||Sl(),t&&(this._width=t,this._canvasEle.width=t*this._pixelRatio,this._canvasEle.style.width=`${t}px`),e&&(this._height=e,this._canvasEle.height=e*this._pixelRatio,this._canvasEle.style.height=`${e}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(t){0!==this._width&&0!==this._height&&(t<1&&(t=1),this.setSize(this._width,this._height,t))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(t,e){try{return this._canvasEle.toDataURL(t,e)}catch(n){try{return this._canvasEle.toDataURL()}catch(r){const{message:t}=r;return console.error(`Unable to get data URL. ${t} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class yl{constructor(t=100,e=100){this.onInputChangedObservable=new i,this.renderEvenInBackground=!0,this.onBeginFrameObservable=new i,this.onEndFrameObservable=new i,this.onTransformChangeObservable=new i,this._canvas=new El,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this._usingSafari=ka(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Ca,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=-1!==navigator.userAgent.indexOf("Firefox"),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(t,e),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return Zi.ENGINE}get activeScene(){return this._activeScene}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(t){return this._scenes[t]}hasScene(t){return t in this._scenes}addScene(t){const e=t.sceneKey;return this.hasScene(e)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[e]=t,t}setActiveScene(t){const e=this.getScene(t);return e&&(this._activeScene=e),e}hasActiveScene(){return null!=this._activeScene}setContainer(t){this._container=t,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:t,height:e}=ol(this._container);this.resizeBySize(t,e)}resizeBySize(t,e){const n=this.width,r=this.height;this._canvas.setSize(t,e),this.onTransformChangeObservable.notifyObservers({type:fa.resize,value:{width:t,height:e},preValue:{width:n,height:r}})}dispose(){const t=this.getScenes();Object.keys(t).forEach((e=>{t[e].dispose()}));const e=xa();this._canvasEle.removeEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(t){const e=this.getScenes();if(e[t]){const n=e[t];return delete e[t],n}}runRenderLoop(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Ia(this._renderFunction)))}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}}_renderLoop(){let t=!0;this.renderEvenInBackground||(t=!1),t&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Ia(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){this._canvasEle.addEventListener("keydown",(t=>{let e=t;e.deviceType=ga.Keyboard,e.inputIndex=t.keyCode,e.previousState=0,e.currentState=1,this.onInputChangedObservable.notifyObservers(e)})),this._canvasEle.addEventListener("keyup",(t=>{let e=t;e.deviceType=ga.Keyboard,e.inputIndex=t.keyCode,e.previousState=1,e.currentState=0,this.onInputChangedObservable.notifyObservers(e)}))}_handlePointerAction(){const t=xa();this._pointerMoveEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[_a.Horizontal],r=this.__pointer[_a.Vertical],s=this.__pointer[_a.DeltaHorizontal],o=this.__pointer[_a.DeltaVertical];this.__pointer[_a.Horizontal]=t.clientX,this.__pointer[_a.Vertical]=t.clientY,this.__pointer[_a.DeltaHorizontal]=t.movementX,this.__pointer[_a.DeltaVertical]=t.movementY;let i=t;i.deviceType=e,n!==t.clientX&&(i.inputIndex=_a.Horizontal,i.previousState=n,i.currentState=this.__pointer[_a.Horizontal],this.onInputChangedObservable.notifyObservers(i)),r!==t.clientY&&(i.inputIndex=_a.Vertical,i.previousState=r,i.currentState=this.__pointer[_a.Vertical],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[_a.DeltaHorizontal]&&(i.inputIndex=_a.DeltaHorizontal,i.previousState=s,i.currentState=this.__pointer[_a.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[_a.DeltaVertical]&&(i.inputIndex=_a.DeltaVertical,i.previousState=o,i.currentState=this.__pointer[_a.DeltaVertical],this.onInputChangedObservable.notifyObservers(i)),this._usingSafari||-1===t.button||(i.inputIndex=t.button+2,i.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,i.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(i))},this._pointerDownEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[_a.Horizontal],r=this.__pointer[_a.Vertical],s=this.__pointer[t.button+2];e===ga.Mouse?(-1===this.__mouseId&&(void 0===t.pointerId?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[_a.Horizontal]=t.clientX,this.__pointer[_a.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let o=t;o.deviceType=e,n!==t.clientX&&(o.inputIndex=_a.Horizontal,o.previousState=n,o.currentState=this.__pointer[_a.Horizontal],this.onInputChangedObservable.notifyObservers(o)),r!==t.clientY&&(o.inputIndex=_a.Vertical,o.previousState=r,o.currentState=this.__pointer[_a.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=t.button+2,o.previousState=s,o.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(o)},this._pointerUpEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[_a.Horizontal],r=this.__pointer[_a.Vertical],s=this.__pointer[t.button+2];this.__pointer[_a.Horizontal]=t.clientX,this.__pointer[_a.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let o=t;o.deviceType=e,n!==t.clientX&&(o.inputIndex=_a.Horizontal,o.previousState=n,o.currentState=this.__pointer[_a.Horizontal],this.onInputChangedObservable.notifyObservers(o)),r!==t.clientY&&(o.inputIndex=_a.Vertical,o.previousState=r,o.currentState=this.__pointer[_a.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=t.button+2,o.previousState=s,o.currentState=this.__pointer[t.button+2],e===ga.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(o),e!==ga.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const e=ga.Mouse;let n=this.__pointer[_a.MouseWheelX],r=this.__pointer[_a.MouseWheelY],s=this.__pointer[_a.MouseWheelZ];this.__pointer[_a.MouseWheelX]=t.deltaX||0,this.__pointer[_a.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[_a.MouseWheelZ]=t.deltaZ||0;let o=t;o.deviceType=e,0!==this.__pointer[_a.MouseWheelX]&&(o.inputIndex=_a.MouseWheelX,o.previousState=n,o.currentState=this.__pointer[_a.MouseWheelX],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[_a.MouseWheelY]&&(o.inputIndex=_a.MouseWheelY,o.previousState=r,o.currentState=this.__pointer[_a.MouseWheelY],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[_a.MouseWheelZ]&&(o.inputIndex=_a.MouseWheelZ,o.previousState=s,o.currentState=this.__pointer[_a.MouseWheelZ],this.onInputChangedObservable.notifyObservers(o))},this._canvasEle.addEventListener(`${t}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${t}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${t}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,!!this._getPassive()&&{passive:!1})}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}_getPassive(){let t=!1;const e=()=>{};try{const n={passive:{get(){t=!0}}};this._canvasEle.addEventListener("test",e,n),this._canvasEle.removeEventListener("test",e,n)}catch(n){}return t}__getPointerType(t){let e=ga.Mouse;return("touch"===t.pointerType||"pen"===t.pointerType||t.touches)&&(e=ga.Touch),e}}class Rl{constructor(t,e=[],n=1){this._scene=t,this._zIndex=n,this._objects=[],this.addObjects(e)}get scene(){return this._scene}get zIndex(){return this._zIndex}static create(t,e=[],n=1e3){return new this(t,e,n)}getObjectsByOrder(){const t=[];this._objects.sort(yr);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjectsByOrderForPick(){const t=[];this._objects.sort(yr);for(let e of this._objects)e.classType!==Zi.GROUP&&e.visible&&t.push(e);return t}getObjects(){return this._objects}addObject(t){if(t.classType===Zi.GROUP){const e=t.getObjects();for(let t of e)this.scene.getObject(t.oKey)||(this._objects.push(t),this.scene.setObjectBehavior(t))}return this._objects.push(t),this.scene.setObjectBehavior(t),this.scene.applyTransformer(t),this}removeObject(t){const e=this.getObjects(),n=e.length;if(t instanceof Cl)for(let r=0;r<n;r++){if(e[r]===t)return void e.splice(r,1)}else for(let r=0;r<n;r++){if(e[r].oKey===t)return void e.splice(r,1)}}addObjects(t){return t.forEach((t=>{this.addObject(t)})),this}removeObjects(t){const e=this.getObjects();for(let n=e.length-1;n>=0;n--){let r=e[n];const s=t.length;if(0===s)break;for(let o=0;o<s;o++){const s=t[o];if(r=s instanceof Cl?r:r.oKey,r===s){e.splice(n,1);break}}}}clear(){this._objects=[]}dispose(){this.getObjects().forEach((t=>{t.dispose()})),this.clear()}}const Il=class{constructor(t){this._alreadyAttached=!1,this._startingPosition=new il(1/0,1/0),this._doubleClickOccurred=0,this._scene=t}mouseLeaveEnterHandler(t,e){var n;if(null==t)null==(n=this._currentMouseEnterPicked)||n.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(t!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=t,null==n||n.triggerPointerLeave(e),null==t||t.triggerPointerEnter(e)}}attachControl(t=!0,e=!0,n=!0,r=!0){const s=this._scene.getEngine();s&&(this._onPointerMove=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerMove(t);this.mouseLeaveEnterHandler(e,t),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(t)},this._onPointerDown=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerDown(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(t)},this._onPointerUp=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerUp(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(t),this._prePointerDoubleClick(t)},this._onMouseWheel=t=>{const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerMouseWheel(t);this._scene.getViewports().forEach((e=>{e.onMouseWheelObserver.hasObservers()&&e.onMouseWheelObserver.notifyObservers(t)})),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(t)},this._onKeyDown=t=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(t)},this._onKeyUp=t=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(t)},this._onInputObserver=s.onInputChangedObservable.add((s=>{const o=s;s.deviceType===ga.Keyboard&&(1===s.currentState&&this._onKeyDown(o),0===s.currentState&&this._onKeyUp(o)),s.deviceType!==ga.Mouse&&s.deviceType!==ga.Touch||(t&&s.inputIndex>=_a.LeftClick&&s.inputIndex<=_a.RightClick&&1===s.currentState&&this._onPointerDown(o),e&&s.inputIndex>=_a.LeftClick&&s.inputIndex<=_a.RightClick&&0===s.currentState&&this._onPointerUp(o),!n||s.inputIndex!==_a.Horizontal&&s.inputIndex!==_a.Vertical&&s.inputIndex!==_a.DeltaHorizontal&&s.inputIndex!==_a.DeltaVertical?!r||s.inputIndex!==_a.MouseWheelX&&s.inputIndex!==_a.MouseWheelY&&s.inputIndex!==_a.MouseWheelZ||this._onMouseWheel(o):this._onPointerMove(o))})),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const t=this._scene.getEngine();t&&(t.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(t,e){var n;return null==(n=this._scene)?void 0:n.pick(il.FromArray([t,e]))}_checkDirectSceneEventTrigger(t,e){let n=!1;null==e&&(n=!0);let r=!0;if(e&&e.classType===Zi.BASE_OBJECT){const t=e.getScene();if(t){r=t.getParent().classType!==Zi.SCENE_VIEWER}}return!this._scene.evented&&t&&r||n}_isPointerSwiping(t,e){return Math.abs(this._startingPosition.x-t)>Il.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>Il.DragMovementThreshold}_prePointerDoubleClick(t){var e,n;const{clientX:r,clientY:s}=t;if(0===this._doubleClickOccurred&&(this._startingPosition.x=r,this._startingPosition.y=s),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout((()=>{this._resetDoubleClickParam()}),Il.DoubleClickDelay),this._doubleClickOccurred<2)return;this._isPointerSwiping(r,s)?this._resetDoubleClickParam():(null==(n=null==(e=this._scene)?void 0:e.pick(il.FromArray([t.offsetX,t.offsetY])))||n.triggerDblclick(t),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(t),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",t))}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let Al=Il;Al.DragMovementThreshold=10,Al.LongPressDelay=500,Al.DoubleClickDelay=300,Al.ExclusiveDoubleClickMode=!1;class Ol extends Cl{constructor(t,...e){super(t),this._objects=[],this.addObjects(...e)}get classType(){return Zi.GROUP}set cursor(t){this.setCursor(t)}addObjects(...t){for(const e of t)this.addObject(e)}addObject(t){let e=t;if(Ba(t)){const n=this.getScene();if(e=null==n?void 0:n.getObject(t),!e)return void console.info("No object be added");e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}else t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}removeObject(t){const e=this.getObjects(),n=e.length;if(Ba(t))for(let r=0;r<n;r++){const n=e[r];if(n.oKey===t)return e.splice(r,1),void this.parent.removeObject(n)}else for(let r=0;r<n;r++){const n=e[r];if(n===t)return e.splice(r,1),void this.parent.removeObject(n)}}getObjectsByOrder(){const t=[];this._objects.sort(yr);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjects(){return this._objects}render(t,e){t.save();const n=this.transform.getMatrix();t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(yr);for(let r of this._objects)r.render(t,this._transformBounds(e));t.restore()}resize(t,e){return this}scale(t,e){return this}skew(t,e){return this}flip(t,e){return this}isHit(t){return!0}pick(t){}dispose(){this.getObjects().forEach((t=>{t.dispose()})),super.dispose()}_transformBounds(t){return t}}class Nl{constructor(t,e,n=.05,r=.05){this._scene=t,this._padding=e,this._smoothRatioX=n,this._smoothRatioY=r,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:60})}static create(t,e){return new Nl(t,e)}startScroll(t,e){this._offsetX=t,this._offsetY=e,this._moveX=t,this._moveY=e,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(t){const e=(null==t?void 0:t.top)||0,n=e+((null==t?void 0:t.height)||0),r=(null==t?void 0:t.left)||0,s=r+((null==t?void 0:t.width)||0),{t:o=0,b:i=0,r:a=0,l:l=0}=this._padding;let h=0,c=0;this._moveX<r+l&&(h=(this._moveX-r-l)*this._smoothRatioX),this._moveX>s-a&&(h=(this._moveX-s+a)*this._smoothRatioX),this._moveY<e+o&&(c=(this._moveY-e-o)*this._smoothRatioY),this._moveY>n-i&&(c=(this._moveY-n+i)*this._smoothRatioY);const d=null==t?void 0:t.scrollBy({x:h,y:c}),u=null==t?void 0:t.getActualScroll(h,c);if(this._scrollX=(null==u?void 0:u.x)||0,this._scrollY=(null==u?void 0:u.y)||0,d){const e=this._findAncestorScene(null==t?void 0:t.scene),n=this.getViewportByCoord(e);n&&this._scroll(n)}}scrolling(t,e,n){this._moveX=t,this._moveY=e,this._scrollFunction=n}stopScroll(){Aa(this._requestNewFrameNumber)}getViewportByCoord(t){return null==t?void 0:t.getActiveViewportByRelativeCoord(il.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Ia(this._runRenderLoop.bind(this))}_findAncestorScene(t){let e=null==t?void 0:t.getParent();for(;e;){if(e.classType===Zi.SCENE)return e;e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent())}}}const Ml=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class xl extends Cl{constructor(t,e){super(t),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new El,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._initialProps(e)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(t,e){}static _renderPaintInOrder(t,e){"stroke"===e.paintFirst?(this._renderStroke(t,e),this._renderFill(t,e)):(this._renderFill(t,e),this._renderStroke(t,e))}static _renderFill(t,e){e.fill&&(t.save(),this.__setFillStyles(t,e),"evenodd"===e.fillRule?t.fill("evenodd"):t.fill(),t.restore())}static _renderStroke(t,e){let{stroke:n,strokeWidth:r,shadowEnabled:s,shadowForStrokeEnabled:o,strokeScaleEnabled:i,scaleX:a,scaleY:l,parent:h}=e;if(n&&0!==r){if(s&&!o&&this.__removeShadow(t),t.save(),i&&h){let e=this.__getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else i&&(a=null!=a?a:1,l=null!=l?l:1,t.scale(1/a,1/l));this.__setLineDash(t),this.__setStrokeStyles(t,e),t.stroke(),t.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(t){}static __setFillStyles(t,e){t.fillStyle=e.fill}static __setStrokeStyles(t,e){const{strokeWidth:n,strokeLineCap:r,strokeDashOffset:s,strokeLineJoin:o,strokeMiterLimit:i,stroke:a}=e;t.lineWidth=n,t.lineCap=r,t.lineDashOffset=s,t.lineJoin=o,t.miterLimit=i,t.strokeStyle=a}static __setLineDash(t){}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:t,maxX:n,minY:r,maxY:s}=wl(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();if(t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const t=this._cacheCanvas.getContext();this._cacheCanvas.clear(),t.save(),t.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(t),t.restore()}this._applyCache(t)}else this._draw(t);return t.restore(),this.makeDirty(!1),this}setProps(t){if(!t)return;const e=Object.keys(t);return 0!==e.length?(e.forEach((e=>{if(void 0===t[e])return!0;-1===bl.indexOf(e)&&(this[`_${e}`]=t[e])})),this.makeDirty(!0),this):void 0}resizeCacheCanvas(){var t;null==(t=this._cacheCanvas)||t.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var t,e,n;let r=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1,s=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1;null==(n=this._cacheCanvas)||n.setPixelRatio(Math.max(r,s)*Sl()),this.makeDirty(!0)}toJson(){const t={};return Ml.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}_applyCache(t){if(!t||!this._cacheCanvas)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,r=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}_draw(t){}_initialProps(t){if(!t)return;const e=Object.keys(t);if(0===e.length)return;const n={};let r=!1;e.forEach((e=>{if(void 0===t[e])return!0;bl.indexOf(e)>-1?(n[e]=t[e],r=!0):this[`_${e}`]=t[e]})),r&&this.transformByState(n),this.makeDirty(!0)}}const kl=["radius"];class Dl extends xl{constructor(t,e){super(t,e),(null==e?void 0:e.radius)&&(this._radius=null==e?void 0:e.radius)}get radius(){return this._radius}static drawWith(t,e){let{radius:n,width:r,height:s}=e;if(n=null!=n?n:0,r=null!=r?r:30,s=null!=s?s:30,t.beginPath(),e.strokeDashArray&&t.setLineDash(e.strokeDashArray),n){let e=0,o=0,i=0,a=0;e=o=i=a=Math.min(n,r/2,s/2),t.moveTo(e,0),t.lineTo(r-o,0),t.arc(r-o,o,o,3*Math.PI/2,0,!1),t.lineTo(r,s-a),t.arc(r-a,s-a,a,0,Math.PI/2,!1),t.lineTo(i,s),t.arc(i,s-i,i,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,r,s);t.closePath(),this._renderPaintInOrder(t,e)}toJson(){const t={};return kl.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}_draw(t){Dl.drawWith(t,this)}}const Ll=["pointsGroup"];class Pl extends xl{constructor(t,e){super(t,e),this._pointsGroup=(null==e?void 0:e.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:r}=t;e!==fa.resize&&e!==fa.all||this.resizePolygon(r)}))}get pointsGroup(){return this._pointsGroup}static drawWith(t,e){let{pointsGroup:n}=e;n=null!=n?n:[[]],e.strokeDashArray&&t.setLineDash(e.strokeDashArray),t.beginPath();for(let r of n){t.moveTo(r[0].x,r[0].y);for(let e=1;e<r.length;e++){const n=r[e];t.lineTo(n.x,n.y)}}t.closePath(),this._renderPaintInOrder(t,e)}updatePointGroup(t){this._pointsGroup=t,this._setFixBoundingBox()}resizePolygon(t){const{left:e,top:n,width:r,height:s}=this._getSelfRect(),{width:o,height:i}=t;let a,l;a=o?this.width-o:0,l=i?this.height-i:0;const h=a/r,c=l/s;this.scaleX+=h,this.scaleY+=c,this.left=this.left-e*h,this.top=this.top-n*c,this._setTransForm()}toJson(){const t={};return Ll.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}getState(){const{left:t,top:e,width:n,height:r}=this.getRect();return{left:t,top:e,width:n,height:r,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:t,top:e,width:n,height:r}=this._getSelfRect();return{left:t*this.scaleX+this.left,top:e*this.scaleY+this.top,width:n*this.scaleX,height:r*this.scaleY}}_draw(t){Pl.drawWith(t,this)}_setFixBoundingBox(){const{width:t,height:e,left:n,top:r}=this._getSelfRect();this.left=this.left+n,this.top=this.top+r,this.width=t,this.height=e;const s=this.pointsGroup;for(let o of s)for(let t of o)t.x-=n,t.y-=r;this._setTransForm()}_getSelfRect(){const t=this.pointsGroup;let e=t[0][0].x,n=t[0][0].x,r=t[0][0].y,s=t[0][0].y;for(let o of t)for(let t of o)e=Math.min(e,t.x),n=Math.max(n,t.x),r=Math.min(r,t.y),s=Math.max(s,t.y);return{left:e,top:r,width:n-e,height:s-r}}}const Bl=17;class Hl{constructor(t,e){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=ya(Mi.black,.2),this._thumbHoverBackgroundColor=ya(Mi.black,.35),this._thumbActiveBackgroundColor=ya(Mi.black,.4),this._barSize=14,this._barBackgroundColor=ya(Mi.white),this._barBorder=1,this._barBorderColor=ya([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,t||console.warn("Missing viewport"),this._view=t,this.setProps(e),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}get ratioScrollX(){return void 0===this._horizontalThumbWidth||void 0===this._horizontalBarWidth?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return void 0===this._verticalThumbHeight||void 0===this._verticalBarHeight?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}static attachTo(t,e){return new Hl(t,e)}setProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{void 0!==t[e]&&(this[`_${e}`]=t[e])}))}render(t,e=0,n=0){let{scrollX:r,scrollY:s}=this._view;t.save();const o=new ll([1,0,0,1,e,n]).getMatrix();t.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._horizonBarRect.render(t),this._horizonThumbRect.translate(r).render(t),this._verticalBarRect.render(t),this._verticalThumbRect.translate(void 0,s).render(t),this._placeholderBarRect.render(t),t.restore()}resize(t=0,e=0,n=0,r=0){var s,o,i,a,l,h,c,d,u,g,p;0===t&&0===t||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=t-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<Bl&&(this._horizontalMinusMiniThumb=Bl-this._horizontalThumbWidth,this._horizontalThumbWidth=Bl),null==(s=this._horizonBarRect)||s.transformByState({left:0,top:e-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=t?null==(o=this._horizonThumbRect)||o.setProps({visible:!1}):((null==(i=this._horizonThumbRect)?void 0:i.visible)||null==(a=this._horizonThumbRect)||a.setProps({visible:!0}),null==(l=this._horizonThumbRect)||l.transformByState({left:this._view.scrollX,top:e-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-2*this._thumbMargin}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=e-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/r*this._thumbLengthRatio,this._verticalThumbHeight<Bl&&(this._verticalMinusMiniThumb=Bl-this._verticalThumbHeight,this._verticalThumbHeight=Bl),null==(h=this._verticalBarRect)||h.transformByState({left:t-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=e?null==(c=this._verticalThumbRect)||c.setProps({visible:!1}):((null==(d=this._verticalThumbRect)?void 0:d.visible)||null==(u=this._verticalThumbRect)||u.setProps({visible:!0}),null==(g=this._verticalThumbRect)||g.transformByState({left:t-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-2*this._thumbMargin,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&(null==(p=this._placeholderBarRect)||p.transformByState({left:t-this._barSize,top:e-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}makeDirty(t){var e,n,r,s,o;null==(e=this._horizonBarRect)||e.makeDirty(t),null==(n=this._horizonThumbRect)||n.makeDirty(t),null==(r=this._verticalBarRect)||r.makeDirty(t),null==(s=this._verticalThumbRect)||s.makeDirty(t),null==(o=this._placeholderBarRect)||o.makeDirty(t),this.makeViewDirty(t)}makeViewDirty(t){this._view.makeDirty(t);const e=this._view.scene.getParent();e.classType===Zi.SCENE_VIEWER&&e.makeDirty(!0)}pick(t){var e,n,r,s;return(null==(e=this._horizonThumbRect)?void 0:e.isHit(t))?this._horizonThumbRect:(null==(n=this._verticalThumbRect)?void 0:n.isHit(t))?this._verticalThumbRect:(null==(r=this._horizonBarRect)?void 0:r.isHit(t))?this._horizonBarRect:(null==(s=this._verticalBarRect)?void 0:s.isHit(t))?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Dl("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Dl("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Dl("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Dl("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Dl("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const t=this._mainScene||this._view.scene,e=(t,e)=>(n,r)=>{if(this._isHorizonMove||this._isVerticalMove)return;e.setProps({fill:t}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(ki.PointerEnter,e(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(ki.PointerLeave,e(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(ki.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({x:n.offsetX-this._view.left-this._horizontalThumbWidth/2}),e.stopPropagation()})),this._horizonThumbRect.on(ki.PointerDown,((e,n)=>{const r=e;this._isHorizonMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),t.disableEvent(),n.stopPropagation()})),t.on(ki.PointerMove,((t,e)=>{const n=t;this._isHorizonMove&&(this._view.scrollBy({x:n.offsetX-this._lastX}),this._lastX=n.offsetX)})),t.on(ki.PointerUp,((e,n)=>{const r=this._horizonThumbRect;this._isHorizonMove=!1,t.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))),this._enableVertical&&(this._verticalThumbRect.on(ki.PointerEnter,e(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(ki.PointerLeave,e(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(ki.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({y:n.offsetY-this._view.top-this._verticalThumbHeight/2}),e.stopPropagation()})),this._verticalThumbRect.on(ki.PointerDown,((e,n)=>{const r=e,s=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,s.setProps({fill:this._thumbActiveBackgroundColor}),t.disableEvent(),this.makeViewDirty(!0),n.stopPropagation()})),t.on(ki.PointerMove,((t,e)=>{const n=t;this._isVerticalMove&&(this._view.scrollBy({y:n.offsetY-this._lastY}),this._lastY=n.offsetY)})),t.on(ki.PointerUp,((e,n)=>{const r=this._verticalThumbRect;this._isVerticalMove=!1,t.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})))}}class Fl extends xl{constructor(t,e){super(t,e),this._props=__spreadValues({autoWidth:!1,autoHeight:!1},e),e.image?(this._native=e.image,this._init()):e.url&&(this._native=document.createElement("img"),this._native.src=e.url,this._native.onload=()=>{var t;null==(t=e.success)||t.call(e),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{e.fail?e.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(t,e){if(e._native.complete){const{width:r,height:s}=e;try{t.drawImage(e._native,0,0,r,s)}catch(n){console.error(n)}}}static create(t,e,n){return new Fl(t,{url:e,success:n})}_draw(t){Fl.drawWith(t,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const Ul=["dataArray"];class zl extends xl{constructor(t,e){super(t,e),this.pathLength=0,this._reCalculateCache=!0,(null==e?void 0:e.data)?this._dataArray=zl.parsePathData(e.data):(null==e?void 0:e.dataArray)&&(this._dataArray=e.dataArray);for(let n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:r}=t;if(e===fa.resize||e===fa.all){this._reCalculateCache=!0;const{left:t,top:e,width:n,height:s}=this._getSelfRect(),{width:o,height:i}=r;let a,l;a=o?this.width-o:0,l=i?this.height-i:0;const h=a/n,c=l/s;this.scaleX+=h,this.scaleY+=c,this.left=this.left-t*h,this.top=this.top-e*c,this._setTransForm()}}))}get dataArray(){return this._dataArray}static drawWith(t,e){const n=e.dataArray;if(n){t.beginPath();for(let e=0;e<n.length;e++){let r=n[e].command,s=n[e].points;switch(r){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":{const e=s[0],n=s[1],r=s[2],o=s[3],i=s[4],a=s[5],l=s[6],h=s[7],c=r>o?r:o,d=r>o?1:r/o,u=r>o?o/r:1;t.translate(e,n),t.rotate(l),t.scale(d,u),t.arc(0,0,c,i,i+a,!!(1-h)),t.scale(1/d,1/u),t.rotate(-l),t.translate(-e,-n);break}case"z":t.closePath()}}this._renderPaintInOrder(t,e)}}static getLineLength(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))}static getPointOnLine(t,e,n,r,s,o,i){void 0===o&&(o=e),void 0===i&&(i=n);let a=(s-n)/(r-e+1e-8),l=Math.sqrt(t*t/(1+a*a));r<e&&(l*=-1);let h,c=a*l;if(r===e)h={x:o,y:i+c};else if((i-n)/(o-e+1e-8)===a)h={x:o+l,y:i+c};else{let d,u,g=this.getLineLength(e,n,r,s),p=(o-e)*(r-e)+(i-n)*(s-n);p/=g*g,d=e+p*(r-e),u=n+p*(s-n);let _=this.getLineLength(o,i,d,u),m=Math.sqrt(t*t-_*_);l=Math.sqrt(m*m/(1+a*a)),r<e&&(l*=-1),c=a*l,h={x:d+l,y:u+c}}return h}static getPointOnCubicBezier(t,e,n,r,s,o,i,a,l){function h(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function u(t){return(1-t)*(1-t)*(1-t)}return{x:a*h(t)+o*c(t)+r*d(t)+e*u(t),y:l*h(t)+i*c(t)+s*d(t)+n*u(t)}}static getPointOnQuadraticBezier(t,e,n,r,s,o,i){function a(t){return t*t}function l(t){return 2*t*(1-t)}function h(t){return(1-t)*(1-t)}return{x:o*a(t)+r*l(t)+e*h(t),y:i*a(t)+s*l(t)+n*h(t)}}static getPointOnEllipticalArc(t,e,n,r,s,o){let i=Math.cos(o),a=Math.sin(o),l=n*Math.cos(s),h=r*Math.sin(s);return{x:t+(l*i-h*a),y:e+(l*a+h*i)}}static parsePathData(t){if(!t)return[];let e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let c=0,d=n.length;c<d;c++)e=e.replace(new RegExp(n[c],"g"),`|${n[c]}`);let r,s=e.split("|"),o=[],i=[],a=0,l=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(let c=1,d=s.length;c<d;c++){let t=s[c],e=t.charAt(0);for(t=t.slice(1),i.length=0;r=h.exec(t);)i.push(r[0]);let n=[];for(let r=0,s=i.length;r<s;r++){if("00"===i[r]){n.push(0,0);continue}let t=parseFloat(i[r]);isNaN(t)?n.push(0):n.push(t)}for(;n.length>0&&!isNaN(n[0]);){let t,r,s,i,h,c,d,u,g,p,_,m=[],f=a,v=l;switch(e){case"l":a+=n.shift()||0,l+=n.shift()||0,t="L",m.push(a,l);break;case"L":a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"m":{let r=n.shift()||0,s=n.shift()||0;if(a+=r,l+=s,t="M",o.length>2&&"z"===o[o.length-1].command)for(let t=o.length-2;t>=0;t--)if("M"===o[t].command){a=o[t].points[0]+r,l=o[t].points[1]+s;break}m.push(a,l),e="l";break}case"M":a=n.shift()||0,l=n.shift()||0,t="M",m.push(a,l),e="L";break;case"h":a+=n.shift()||0,t="L",m.push(a,l);break;case"H":a=n.shift()||0,t="L",m.push(a,l);break;case"v":l+=n.shift()||0,t="L",m.push(a,l);break;case"V":l=n.shift()||0,t="L",m.push(a,l);break;case"C":m.push(n.shift()||0,n.shift()||0,n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"c":m.push(a+(n.shift()||0),l+(n.shift()||0),a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="C",m.push(a,l);break;case"S":s=a,i=l,r=o[o.length-1],"C"===r.command&&(s=a+(a-r.points[2]),i=l+(l-r.points[3])),m.push(s,i,n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,t="C",m.push(a,l);break;case"s":s=a,i=l,r=o[o.length-1],"C"===r.command&&(s=a+(a-r.points[2]),i=l+(l-r.points[3])),m.push(s,i,a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="C",m.push(a,l);break;case"Q":m.push(n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"q":m.push(a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="Q",m.push(a,l);break;case"T":s=a,i=l,r=o[o.length-1],"Q"===r.command&&(s=a+(a-r.points[0]),i=l+(l-r.points[1])),a=n.shift()||0,l=n.shift()||0,t="Q",m.push(s,i,a,l);break;case"t":s=a,i=l,r=o[o.length-1],"Q"===r.command&&(s=a+(a-r.points[0]),i=l+(l-r.points[1])),a+=n.shift()||0,l+=n.shift()||0,t="Q",m.push(s,i,a,l);break;case"A":h=n.shift()||0,c=n.shift()||0,d=n.shift()||0,u=n.shift()||0,g=n.shift()||0,p=a,_=l,a=n.shift()||0,l=n.shift()||0,t="A",m=this.convertEndpointToCenterParameterization(p,_,a,l,u,g,h,c,d);break;case"a":h=n.shift()||0,c=n.shift()||0,d=n.shift()||0,u=n.shift()||0,g=n.shift()||0,p=a,_=l,a+=n.shift()||0,l+=n.shift()||0,t="A",m=this.convertEndpointToCenterParameterization(p,_,a,l,u,g,h,c,d)}o.push({command:t||e,points:m,start:{x:f,y:v},pathLength:this.calcLength(f,v,t||e,m)})}"z"!==e&&"Z"!==e||o.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return o}static calcLength(t,e,n,r){let s,o,i,a,l=zl;switch(n){case"L":return l.getLineLength(t,e,r[0],r[1]);case"C":for(s=0,o=l.getPointOnCubicBezier(0,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),a=.01;a<=1;a+=.01)i=l.getPointOnCubicBezier(a,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),s+=l.getLineLength(o.x,o.y,i.x,i.y),o=i;return s;case"Q":for(s=0,o=l.getPointOnQuadraticBezier(0,t,e,r[0],r[1],r[2],r[3]),a=.01;a<=1;a+=.01)i=l.getPointOnQuadraticBezier(a,t,e,r[0],r[1],r[2],r[3]),s+=l.getLineLength(o.x,o.y,i.x,i.y),o=i;return s;case"A":{s=0;let t=r[4],e=r[5],n=r[4]+e,h=Math.PI/180;if(Math.abs(t-n)<h&&(h=Math.abs(t-n)),o=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],t,0),e<0)for(a=t-h;a>n;a-=h)i=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],a,0),s+=l.getLineLength(o.x,o.y,i.x,i.y),o=i;else for(a=t+h;a<n;a+=h)i=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],a,0),s+=l.getLineLength(o.x,o.y,i.x,i.y),o=i;return i=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],n,0),s+=l.getLineLength(o.x,o.y,i.x,i.y),s}}return 0}static convertEndpointToCenterParameterization(t,e,n,r,s,o,i,a,l){let h=l*(Math.PI/180),c=Math.cos(h)*(t-n)/2+Math.sin(h)*(e-r)/2,d=-1*Math.sin(h)*(t-n)/2+Math.cos(h)*(e-r)/2,u=c*c/(i*i)+d*d/(a*a);u>1&&(i*=Math.sqrt(u),a*=Math.sqrt(u));let g=Math.sqrt((i*i*(a*a)-i*i*(d*d)-a*a*(c*c))/(i*i*(d*d)+a*a*(c*c)));s===o&&(g*=-1),isNaN(g)&&(g=0);let p=g*i*d/a,_=g*-a*c/i,m=(t+n)/2+Math.cos(h)*p-Math.sin(h)*_,f=(e+r)/2+Math.sin(h)*p+Math.cos(h)*_,v=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),b=(t,e)=>(t[0]*e[0]+t[1]*e[1])/(v(t)*v(e)),C=(t,e)=>(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(b(t,e)),T=C([1,0],[(c-p)/i,(d-_)/a]),w=[(c-p)/i,(d-_)/a],S=[(-1*c-p)/i,(-1*d-_)/a],E=C(w,S);return b(w,S)<=-1&&(E=Math.PI),b(w,S)>=1&&(E=0),0===o&&E>0&&(E-=2*Math.PI),1===o&&E<0&&(E+=2*Math.PI),[m,f,i,a,T,E,h,o]}toJson(){const t={};return Ul.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}getState(){const{left:t,top:e,width:n,height:r}=this.getRect();return{left:t,top:e,width:n,height:r,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:t,top:e,width:n,height:r}=this._getSelfRect();return{left:t*this.scaleX+this.left,top:e*this.scaleY+this.top,width:n*this.scaleX,height:r*this.scaleY}}getLength(){return this.pathLength}getPointAtLength(t){let e,n=0,r=this.dataArray.length;if(!r)return null;for(;n<r&&t>this.dataArray[n].pathLength;)t-=this.dataArray[n].pathLength,++n;if(n===r)return e=this.dataArray[n-1].points.slice(-2),{x:e[0],y:e[1]};if(t<.01)return e=this.dataArray[n].points.slice(0,2),{x:e[0],y:e[1]};let s=this.dataArray[n],o=s.points;switch(s.command){case"L":return zl.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return zl.getPointOnCubicBezier(t/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return zl.getPointOnQuadraticBezier(t/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":{let e=o[0],n=o[1],r=o[2],i=o[3],a=o[4],l=o[5],h=o[6];return a+=l*t/s.pathLength,zl.getPointOnEllipticalArc(e,n,r,i,a,h)}}return null}_draw(t){zl.drawWith(t,this)}_setFixBoundingBox(){const{left:t,top:e,width:n,height:r}=this._getSelfRect(),s=this.width/n,o=this.height/r;this.left=this.left-t*s,this.top=this.top-e*o,this.scaleX=s,this.scaleY=o,this.width=n,this.height=r,this._setTransForm()}_getSelfRect(){if(!this._reCalculateCache)return this._selfRectCache;let t=[];this.dataArray.forEach((e=>{if("A"===e.command){let n=e.points[4],r=e.points[5],s=e.points[4]+r,o=Math.PI/180;if(Math.abs(n-s)<o&&(o=Math.abs(n-s)),r<0)for(let i=n-o;i>s;i-=o){const n=zl.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],i,0);t.push(n.x,n.y)}else for(let i=n+o;i<s;i+=o){const n=zl.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],i,0);t.push(n.x,n.y)}}else if("C"===e.command)for(let n=0;n<=1;n+=.01){const r=zl.getPointOnCubicBezier(n,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(r.x,r.y)}else t=t.concat(e.points)}));let e,n,r=t[0],s=t[0],o=t[1],i=t[1];for(let l=0;l<t.length/2;l++)e=t[2*l],n=t[2*l+1],isNaN(e)||(r=Math.min(r,e),s=Math.max(s,e)),isNaN(n)||(o=Math.min(o,n),i=Math.max(i,n));const a={left:r,top:o,width:s-r,height:i-o};return this._selfRectCache=a,a}}const Wl=["radius"];class Vl extends xl{constructor(t,e){super(t,e),this._radius=(null==e?void 0:e.radius)||10,this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:r}=t;if(e===fa.resize||e===fa.all){const t=Math.min(this.width,this.height);this._radius=t/2,this.width=t,this.height=t,this._setTransForm()}}))}get radius(){return this._radius}static drawWith(t,e){let{radius:n}=e;n=null!=n?n:10,t.beginPath(),e.strokeDashArray&&t.setLineDash(e.strokeDashArray),t.beginPath(),t.arc(n,n,n||0,0,2*Math.PI,!1),t.closePath(),this._renderPaintInOrder(t,e)}toJson(){const t={};return Wl.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}_draw(t){Vl.drawWith(t,this)}_setFixBoundingBox(){this.transformByState({width:2*this._radius,height:2*this._radius})}}function Yl(t){return null==t?void 0:t[t.length-1]}function Gl(t){var e;return null==(e=null==t?void 0:t.sections)?void 0:e[t.sections.length-1]}function Xl(t){var e;const n=null==(e=ql(t))?void 0:e.column.lines;return null==n?void 0:n[n.length-1]}function jl(t){return t.lines[t.lines.length-1]}function $l(t){const{width:e,marginLeft:n,marginRight:r}=t;return e-n-r}function Kl(t){var e;const n=null==(e=t.parent)?void 0:e.parent;if(n)return n}function ql(t){const e=Gl(t);for(let n=0;n<e.columns.length;n++){const t=e.columns[n];if(!t.isFull)return{column:t,isLast:n===e.columns.length-1,index:n}}}function Zl(t){const e=Xl(t);if(e)for(let n=0;n<e.divides.length;n++){const t=e.divides[n];if(!t.isFull)return{divide:t,isLast:n===e.divides.length-1,index:n}}}function Jl(t){const e=Gl(t),n=e.columns.length;for(let r=0;r<n;r++){if(!e.columns[r].isFull)return!1}return!0}function Ql(t){if(t.sections.length>1)return!1;const e=Gl(t),n=e.columns.length;for(let r=0;r<n;r++){if(!th(e.columns[r]))return!1}return!0}function th(t){const e=t.lines;if(e.length>1)return!1;return function(t){if(!t)return!0;for(let e=0;e<t.divides.length;e++){const n=t.divides[e].spanGroup.length;if(n>1)return!1;if(1===n){const n=t.divides[e].spanGroup[0],{spanType:r}=n;if(r!==aa.TAB&&r!==aa.LIST)return!1}}return!0}(e[e.length-1])}function eh(t,e){if(t instanceof Object){const{v:n,u:r}=t;return r===at.POINT?n:n*e}return t}function nh(t=0,e,n=O.LINES,r=be.TRUE){let s=1;return rh(n,r)&&(s=t),s*=e,s}function rh(t=O.LINES,e=be.FALSE){return e===be.TRUE&&(t===O.LINES_AND_CHARS||t===O.SNAP_TO_CHARS)}function sh(t,e){const{paragraphStyle:n={}}=e,{linePitch:r=15.6,gridType:s=O.LINES,paragraphLineGapDefault:o=0}=t,{lineSpacing:i=1,spacingRule:a=G.AUTO,snapToGrid:l=be.TRUE}=n;return{paragraphLineGapDefault:o,linePitch:r,gridType:s,lineSpacing:i,spacingRule:a,snapToGrid:l}}function oh(t,e){const{paragraphStyle:n={}}=e,{charSpace:r=0,gridType:s=O.LINES,defaultTabStop:o=36,documentTextStyle:i={}}=t,{fs:a=zi}=i,{snapToGrid:l=be.TRUE}=n;return{charSpace:r,documentFontSize:a,defaultTabStop:o,gridType:s,snapToGrid:l}}function ih(t,e=-1){t[0];let n=e;for(let r of t){const{sections:t}=r;let e=n,s=e,o=-1/0,i=0;for(let n of t){const{columns:t}=n;let e=s,r=e,a=-1/0;for(let n of t){const{lines:t}=n;let e=r,s=e,i=0,l=-1/0,h=null;for(let n of t){const{divides:t,lineHeight:e}=n;let r=s,o=r,a=0,c=0;i+=e;const d=t.length;for(let n=0;n<d;n++){const e=t[n],{spanGroup:r}=e;if(0===r.length)continue;let s=o,i=s;for(let t of r){i+=t.spanType===aa.LIST?0:t.count||1;const r=t.bBox,{ba:s}=r;c=Math.max(c,s),n===d-1&&e.width===1/0&&(a+=t.width)}n===d-1&&(e.width===1/0?e.width=a:a+=e.width,a+=e.left),e.st=0===s?0:s+1,e.ed=i>=e.st?i:e.st,o=e.ed}n.st=0===r?0:r+1,n.ed=o>=n.st?o:n.st,n.width=a,n.asc=c,l=Math.max(l,a),n.top=((null==h?void 0:h.top)||0)+((null==h?void 0:h.lineHeight)||0),h=n,s=n.ed}n.st=0===e?0:e+1,n.ed=s>=n.st?s:n.st,n.height=i,n.width===1/0&&(n.width=l),o=Math.max(o,l),a=Math.max(a,n.height),r=n.ed}n.st=0===e?0:e+1,n.ed=r>=n.st?r:n.st,n.height=a,i+=a,s=n.ed}r.st=0===e?0:e+1,r.ed=s>=r.st?s:r.st,r.height=i,r.width=o,n=r.ed}}function ah(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t){const{lines:t}=n;for(let n of t)e&&Pa(e)&&e(n)}}}}function lh(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t)e&&Pa(e)&&e(n)}}}function hh(t,e,n,r,s=!1){const{relativeFrom:o,align:i,posOffset:a,percent:l}=t;if(null!=i)if(i===ht.INSIDE||i===ht.OUTSIDE)o===rt.MARGIN||rt.PAGE;else{if(o===rt.COLUMN){const{width:t,left:n}=e;let s=0;return i===ht.LEFT?s=n:i===ht.RIGHT?s=n+t-r:i===ht.CENTER&&(s=n+t/2-r/2),s}if(o===rt.LEFT_MARGIN);else if(o===rt.MARGIN);else if(o===rt.RIGHT_MARGIN);else if(o===rt.INSIDE_MARGIN);else if(o===rt.OUTSIDE_MARGIN);else if(o===rt.PAGE){const{width:t}=n;let e=0;return i===ht.RIGHT?e=t-r:i===ht.CENTER&&(e=t/2-r/2),e}}else{if(a){const{width:t,marginLeft:i,marginRight:l}=n,h=t-l;let c=0;return o===rt.COLUMN?c=(s?0:(null==e?void 0:e.left)||0)+a:o===rt.LEFT_MARGIN||(o===rt.MARGIN?c=a+i:o===rt.RIGHT_MARGIN||o===rt.INSIDE_MARGIN||o===rt.OUTSIDE_MARGIN||o===rt.PAGE&&(c=a)),c+r>h&&(c=h-r),c}if(l){const{width:t,marginLeft:e,marginRight:r}=n;if(o===rt.LEFT_MARGIN);else if(o===rt.MARGIN);else if(o===rt.RIGHT_MARGIN);else if(o===rt.INSIDE_MARGIN);else if(o===rt.OUTSIDE_MARGIN);else if(o===rt.PAGE)return l*t}}}function ch(t,e,n,r,s,o,i=!1){const{relativeFrom:a,align:l,posOffset:h,percent:c}=t;if(null!=l){if(a===ot.LINE){let t=0;return l===dt.BOTTOM?t=n+r-s:l===dt.TOP?t=n:l===dt.CENTER&&(t=n+r/2-s/2),t}if(a===ot.TOP_MARGIN);else if(a===ot.MARGIN);else if(a===ot.BOTTOM_MARGIN);else if(a===ot.INSIDE_MARGIN);else if(a===ot.OUTSIDE_MARGIN);else if(a===ot.PAGE){const{height:t}=e;let n=0;return l===dt.BOTTOM?n=t-s:l===dt.CENTER&&(n=t/2-s/2),n}}else{if(h){let t=0;return a===ot.LINE?t=n||0+h:a===ot.TOP_MARGIN||a===ot.MARGIN||a===ot.BOTTOM_MARGIN||a===ot.INSIDE_MARGIN||a===ot.OUTSIDE_MARGIN||(a===ot.PAGE?t=h:a===ot.PARAGRAPH&&(t=(i?0:null==o?n:o)+h)),t}if(c){const{height:t,marginBottom:n,marginTop:r}=e;if(a===ot.TOP_MARGIN);else if(a===ot.MARGIN);else if(a===ot.BOTTOM_MARGIN);else if(a===ot.INSIDE_MARGIN);else if(a===ot.OUTSIDE_MARGIN);else if(a===ot.PAGE)return c*t}}}function dh(t){const e=t.spanGroup;let n=0;for(let r of e)n+=r.width;return n}function uh(t=[],e=k.NONE,n=0,r=0,s=1/0,o=1/0){const i=[];let a=0,l=0;if(0===t.length)i.push(ph(r,s,0,k.NONE));else for(let c=0;c<t.length;c++){const{width:n,paddingEnd:o}=t[c];l=o,a=n,i.push(ph(r,a,l,e)),r+=a+l,c===t.length-1&&(a=s!==1/0?s-a:n,l=0,i.push(ph(r,a,l,e)))}const h={columns:i,colCount:(null==t?void 0:t.length)||1,height:o,top:n,st:0,ed:0};return i.forEach((t=>{t.parent=h})),h}function gh(t,e){t.isFull=e}function ph(t,e,n,r){return{lines:[],left:t,width:e,height:0,spaceWidth:n,separator:r,st:0,ed:0,drawingLRIds:[],isFull:!1}}function _h(t,e,n,r){return n in S?function(t,e,n){if(n===S.DECIMAL)return mh(t,e);if(n===S.ZERO_DECIMAL)return function(t,e){const n=t+e;if(n<10)return`0${n}`;return n.toString()}(t,e);if(n===S.UPPER_ALPHA)return function(t,e){return Sr(t+e-1,!0)}(t,e);if(n===S.ALPHA)return function(t,e){return Sr(t+e-1,!1)}(t,e);if(n===S.UPPER_ROMAN)return function(t,e){return fh(t+e,!0)}(t,e);if(n===S.ROMAN)return function(t,e){return fh(t+e,!1)}(t,e);return mh(t,e)}(t,e,n):vl(t,e,n,r)}function mh(t,e){return(t+e).toString()}function fh(t,e=!1){let n={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1});let r="";for(let s in n)for(;t>=n[s];)r+=s,t-=n[s];return r}function vh(t,e,n,r,s){var o,i;if(!t||!e)return;const{listId:a,nestingLevel:l=0,textStyle:h}=t,c=e[a];if(!c||!c.nestingLevel)return bh(a,null==(o=null==n?void 0:n[l])?void 0:o.startIndexItem,r);if(!c.nestingLevel[l])return bh(a,null==(i=null==n?void 0:n[l])?void 0:i.startIndexItem,r);return function(t,e,n,r,s,o,i){var a,l;const h=n[e],{bulletAlignment:c,glyphFormat:d,textStyle:u,startNumber:g,glyphType:p,glyphSymbol:_,indentFirstLine:m,hanging:f,indentStart:v}=h,b=__spreadValues(__spreadValues({},s),u),C=Ua(b,o);let T;T=_||function(t,e,n,r,s){var o;const i=t.split("%"),a=[i[0]];for(let l=1;l<i.length;l++){const t=i[l],{level:h,suffix:c}=Th(t);let d=(null==(o=null==r?void 0:r[h])?void 0:o.startIndexItem)||1;h!==e&&null!==(null==r?void 0:r[h])&&(d-=1);const u=Ch(d,n[h],s);a.push(u,c)}return a.join("")}(d,e,n,r,i);const w=ta.getTextSize(T,C),S=null!=(l=null==(a=null==r?void 0:r[e])?void 0:a.startIndexItem)?l:1;return{listId:t,symbol:T,ts:b,fontStyle:C,startIndexItem:S+1,bBox:w,nestingLevel:h,bulletAlign:c,bulletType:!_&&!!p,indentFirstLine:m,hanging:f,indentStart:v}}(a,l,c.nestingLevel,n,h,r,s)}function bh(t,e=1,n){return{listId:t,symbol:"",ts:{ff:(null==n?void 0:n.fontList[0])||"Arial",fs:(null==n?void 0:n.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function Ch(t=1,e,n){const{startNumber:r,glyphType:s,glyphSymbol:o}=e;return o||(s?_h(t,r,s,n):"")}function Th(t){if(""===t)return{level:0,suffix:""};const e=t.split("");let n="",r="",s=!1;const o=/[0-9]/g;return e.forEach((t=>{!s&&o.test(`${n}${t}`)?n+=t:(s=!0,r+=t)})),{level:parseInt(n)-1,suffix:r}}function wh(t,e,n){return yh(aa.WORD,t,e,n)}function Sh(t,e,n){return yh(aa.LETTER,t,e,n)}function Eh(t,e){return yh(aa.TAB," ",t,e)}function yh(t,e,n,r){const{fontStyle:s,textStyle:o,charSpace:i=1,gridType:a=O.LINES,snapToGrid:l=be.FALSE}=n,h=ta.getTextSize(e,s),{width:c=0}=h;let d=null!=r?r:c,u=0;if(rh(a,l)){d=Math.ceil(c/i)*i,a===O.LINES_AND_CHARS&&(u=(d-c)/2)}return{content:e,ts:o,fontStyle:s,width:d,bBox:h,paddingLeft:u,left:0,spanType:t}}function Rh(t,e,n){const{bBox:r,symbol:s,ts:o,fontStyle:i,bulletAlign:a=y.START,bulletType:l=!1}=e,h=r.width,c=Math.ceil(h/n);let d=(c<2?2:c)*n,u=0;l&&(a===y.CENTER?(u=-h/2,d-=u):a===y.END&&(u=-h,d-=u));return{content:s,ts:o,fontStyle:i,width:d,paddingLeft:0,bBox:function(t,e){const{ba:n,bd:r}=t.bBox,{ba:s,bd:o}=e.bBox;if(n+r>s+o)return t.bBox;return e.bBox}(t,e),left:u,spanType:aa.LIST}}function Ih(t,e=0){const n=t.length;let r;for(let s=0;s<n;s++){const n=t[s];n.left=r?r.left+r.width:e,r=n}}function Ah(t,e,n,r){return Ya(t)?function(t,e,n,r){const s=[t];let o=e;for(let i=e+1;i<n.length;i++){const t=n[i];if(!Ya(t))break;s.unshift(t),o=i}return{charIndex:o,spanGroup:[Sh(s.join(""),r)]}}(t,e,n,r):Ga(t)?function(t,e,n,r){const s=[t];let o=e;for(let i=e+1;i<n.length;i++){const t=n[i];if(!Ga(t))break;s.push(t),o=i}return{charIndex:o,spanGroup:[wh(s.join(""),r)]}}(t,e,n,r):Va(t)?void 0:function(t,e,n,r){const{pageWidth:s=1/0}=r,o=Sh(t,r),i=[o];let a=o.width,l=e;for(let h=e+1;h<n.length;h++){const t=n[h];if(Va(t)||Xa(t))break;{const e=Sh(t,r),n=e.width;if(a+n>s)break;i.push(e),a+=n,l=h}}return{charIndex:l,spanGroup:i}}(t,e,n,r)}var Oh,Nh,Mh,xh,kh,Dh;function Lh(t,e,n,r,s=0,o=0,i=!1,a,l,h){const{lineHeight:c=15.6,lineTop:d=0,contentHeight:u=0,paddingLeft:g=0,paddingRight:p=0,paddingTop:_=0,paddingBottom:m=0,marginTop:f=0,spaceBelowApply:v=0}=n,b=function(t,e){return{blockId:e,type:t,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}(e,t);b.lineIndex=s,b.paragraphStart=Yh(o,i),b.contentHeight=u,b.top=d,b.lineHeight=c,b.paddingTop=_,b.paddingBottom=m,b.marginTop=f,b.spaceBelowApply=v,b.divides=function(t,e,n,r,s,o,i,a){const l=[];return l.push({left:0,width:r},{left:n-s,width:s}),null==i||i.forEach(((r,s)=>{const o=Fh(r,t,e,n);o&&l.push(o)})),null==a||a.forEach(((r,s)=>{const o=Fh(r,t,e,n);o&&l.push(o)})),null==o||o.forEach(((r,s)=>{const o=Fh(r,t,e,n);o&&l.push(o)})),function(t,e){e.sort(((t,e)=>t.left>e.left?1:-1));const n=[];let r=0;const s=e.length;for(let o=0;o<s;o++){const i=e[o],{left:a,width:l}=i;if(a>r){let e=a-r;e=e<t?e:t-r;const s=Vh(r,e);n.push(s)}if(r=Math.max(a+l,r),o===s-1&&a+l<t){const e=Vh(a+l,t-a-l);n.push(e)}}return n}(n,l)}(c,d,r,g,p,a,l,h);for(let C of b.divides)C.parent=b;return b}function Ph(t=15.6,e=0,n=0,r,s,o){let i=e;return null==s||s.forEach((n=>{const r=Bh(n,t,e);r&&(i=Math.max(i,r))})),null==o||o.forEach((n=>{const r=Bh(n,t,e);r&&(i=Math.max(i,r))})),null==r||r.forEach((n=>{const r=Bh(n,t,e);r&&(i=Math.max(i,r))})),i}function Bh(t,e,n,r){const{aTop:s,height:o,aLeft:i,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c,distT:d=0,distB:u=0}=h;if(c!==z.WRAP_TOP_AND_BOTTOM)return;if(0===l){const t=s-d;if(t+(o+u)<n||t>e+n)return;return t+o}let{top:g=0,height:p=0}=Uh(l,i,a,s,o);return g-=d,p+=u,g+p<n||g>e+n?void 0:g+p}function Hh(t,e){t.isFull=e}function Fh(t,e,n,r){const{aTop:s,height:o,aLeft:i,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c}=h;if(c===z.WRAP_NONE||c===z.WRAP_TOP_AND_BOTTOM)return;if(c===z.WRAP_POLYGON){const{start:t=[0,0],lineTo:s}=h;if(!s)return;let o=[];o.push(new il(t[0],t[1]));for(let e=0;e<s.length;e++){const t=s[e];o.push(new il(t[0],t[1]))}if(0!==l){const t=(new ll).rotate(l);for(let e=0;e<o.length;e++){const n=o[e];o[e]=t.applyPoint(n)}}return zh(o,n,e,r)}if(0===l)return Wh(s,o,i,a,n,e,r,h);const d=Uh(l,i,a,s,o);if(c===z.WRAP_SQUARE){const{left:t,width:s,top:o,height:i}=d;return Wh(o,i,t,s,n,e,r,h)}return zh(d.points,n,e,r)}function Uh(t,e,n,r,s){const o=(new ll).rotate(t),i=new il(e,r),a=new il(e,r+s),l=new il(e+n,r),h=new il(e+n,r+s);return o.makeBoundingBoxFromPoints([i,a,l,h])}function zh(t,e,n,r){const s=new ml(t),o=s.intersection([new il(0,e),new il(r,e)]),i=s.intersection([new il(0,e+n),new il(r,e+n)]);if(!o&&!i)return;const a=function(t,e=0){const n=[];for(let r=0;r<t.length;r++){const s=t[r];0===e?n.push(s.x):n.push(s.y)}return{max:Math.max(...n),min:Math.min(...n)}}([...t,...o||[],...i||[]]);return{left:a.min,width:a.max}}function Wh(t,e,n,r,s,o,i,a){const{layoutType:l,wrapText:h=F.BOTH_SIDES,distL:c=0,distR:d=0,distT:u=0,distB:g=0}=a,p=t-(l===z.WRAP_SQUARE?u:0);if(p+(e+(l===z.WRAP_SQUARE?g:0))<s||p>o+s)return;let _=n-c,m=r+d,f=function(t,e,n,r){let s=0;t===F.LEFT?s=1:t===F.RIGHT?s=2:t===F.LARGEST&&(s=e>r-e-n?1:2);return s}(h,_,m,i);return 1===f?m=i-_:2===f&&(_=0,m=n+r+d),{left:_,width:m}}function Vh(t,e){return{spanGroup:[],width:e,left:t,paddingLeft:0,isFull:!1,st:0,ed:0}}function Yh(t,e){return 0===t&&!0===e}function Gh(t,e,n,r){if(r)if(r.has(t)){const n=r.get(t);null==n||n.elements.push(e)}else r.set(t,{elements:[e],blockId:t,top:n})}function Xh(t,e){const n=t.parent;if(null!=n){const t=null==n.divides[0].spanGroup[0],r=e[0],s=r.content||" ";if(t&&" "===s){const t=r.width;r.width=0;for(let n of e)n!==r&&(n.left-=t)}}t.spanGroup.push(...e)}function jh(t,e,n,r,s=0,o=!1){if(Yh(s,o))if(r.bulletSkeleton){const{bulletSkeleton:i,paragraphStyle:a={}}=r,{gridType:l=O.LINES,charSpace:h=0,defaultTabStop:c=1}=n,{snapToGrid:d=be.TRUE}=a,u=nh(h,c,l,d);!function(t,e,n){const{hanging:r,indentStart:s}=t,{hanging:o,indentStart:i}=e;void 0===r&&(t.hanging=o);void 0===s&&(t.indentStart=eh(i||0,n)-eh(o||0,n))}(a,i,u);Kh([Rh(t[0],i,u),...t],e,n,r,s,o)}else Kh(t,e,n,r,s,o);else $h(t,e,n,r,s,o);return[...e]}function $h(t,e,n,r,s=0,o=!1,i){var a,l;const h=Yl(e),c=Zl(h);if(c){const d=function(t){const e=t.length;let n=0;for(let r=0;r<e;r++){n+=t[r].width}return n}(t),u=c.divide,g=null==(a=null==u?void 0:u.spanGroup)?void 0:a[u.spanGroup.length-1],p=(null==g?void 0:g.width)||0,_=(null==g?void 0:g.left)||0,m=$l(h);if(p+_+d>u.width){Hh(u,!0);const a=Kl(u);d>m?Ql(h)?(Xh(u,t),function(t=[]){for(let e=0;e<t.length;e++){gh(t[e],!0)}}(null==(l=null==a?void 0:a.parent)?void 0:l.columns)):Zh(t,e,n,r,s,o,i):a&&d>a.width?(gh(a,!0),th(a)?(console.log(t),Xh(u,t)):qh(t,e,n,r,s,o,i)):c.isLast?Kh(t,e,n,r,s,o,i):$h(t,e,n,r,s,o,i)}else{const i=u.parent,a=function(t){const e=t.length;let n,r=-1/0;for(let s=0;s<e;s++){const e=t[s],{ba:o,bd:i}=e.bBox;r<o+i&&(n={boundingBoxAscent:o,boundingBoxDescent:i}),r=o+i}return n}(t);if(i&&a){const{paragraphLineGapDefault:l,linePitch:h,lineSpacing:c,spacingRule:d,snapToGrid:u,gridType:g}=sh(n,r),{boundingBoxAscent:p,boundingBoxDescent:_}=a,m=p+_,{contentHeight:f}=Jh(m,l,h,g,c,d,u);if(i.contentHeight<f){const a=function(t){const e=t.divides,n=e.length,r=[];for(let s=0;s<n;s++){const t=e[s];r.push(...t.spanGroup)}return r}(i),l=a.length;let h=[],c=1;a[0].spanType===aa.LIST&&l>2?(h=[a[0],a[1]],c=2):h=[a[0]];const d=i.parent;null==d||d.lines.pop(),Kh(h,e,n,r,s,o,p+_);for(let t=c;t<a.length;t++)$h([a[t]],e,n,r,s,o);return void $h(t,e,n,r,s,o)}}Ih(t,p+_);for(let e of t)e.parent=u;Xh(u,t)}}else Kh(t,e,n,r,s,o,i)}function Kh(t,e,n,r,s=0,o=!1,i){var a,l,h,c,d;let u=Yl(e),g=ql(u);if(g&&g.column||(Zh(t,e,n,r,s),u=Yl(e),g=ql(u)),!g)return;const p=g.column,_=jl(p),{ba:m,bd:f}=t[0].bBox,v=i||m+f,{paragraphStyle:b={},paragraphAffectSkeDrawings:C,skeHeaders:T,skeFooters:w,blockAnchor:S,blockId:E}=r,{namedStyleType:y=V.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:R=ae.UNSPECIFIED,direction:I,spaceAbove:A=0,spaceBelow:O=0,borderBetween:N,borderTop:M,borderBottom:x,borderLeft:k,borderRight:D,indentFirstLine:L=0,hanging:P=0,indentStart:B=0,indentEnd:H=0,tabStops:F=[],keepLines:U=be.FALSE,keepNext:z=be.FALSE,wordWrap:W=be.FALSE,widowControl:Y=be.FALSE,shading:G}=b,{paragraphLineGapDefault:X,linePitch:j,lineSpacing:$,spacingRule:K,snapToGrid:q,gridType:Z}=sh(n,r),J=Yh(s,o),{paddingTop:Q,paddingBottom:tt,contentHeight:et,lineSpacingApply:nt}=Jh(v,X,j,Z,$,K,q),{marginTop:rt,spaceBelowApply:st}=function(t=0,e=0,n=0,r,s){let o=0,i=0;if(!r)return{marginTop:o,spaceBelowApply:i};if(o=eh(e,t),i=eh(n,t),s){const{spaceBelowApply:t}=s;t>o&&(o=0,s.lineHeight+=t,s.marginBottom=t)}return{marginTop:o,spaceBelowApply:i}}(nt,A,O,J,_),ot=rt+Q+et+tt;let it=p.parent;it||(it=Gl(u));const at=((null==_?void 0:_.lineHeight)||0)+((null==_?void 0:_.top)||0),{width:lt,headerId:ht,footerId:ct}=u,dt=null==(l=null==(a=null==T?void 0:T.get(ht))?void 0:a.get(lt))?void 0:l.skeDrawings,ut=null==(c=null==(h=null==w?void 0:w.get(ct))?void 0:h.get(lt))?void 0:c.skeDrawings;!function(t,e,n,r,s){var o;if(!s)return;const i=null==(o=n.parent)?void 0:o.parent;if(!i)return;const a=new Map,l=function(t){const e=t.parent;if(!e)return!1;const n=null==e?void 0:e.columns;if(!n)return!1;for(let r=n.length-1;r>=0;r--){const t=n[r].lines,e=t.length;if(!(e<=0))for(let n=e-1;n>=0;n--){if(t[n].paragraphStart)return!1}}return!0}(n);s.forEach((s=>{if(!s)return;const{initialState:o,drawingOrigin:h}=s;if(o||!h)return;const{objectProperties:c}=h,{positionH:d,positionV:u,size:g,angle:p}=c,{width:_=0,height:m=0}=g;s.aLeft=hh(d,n,i,_,l)||0,s.aTop=ch(u,i,t,e,m,r,l)||0,s.width=_,s.height=m,s.angle=p,s.initialState=!0,a.set(s.objectId,s)})),i.skeDrawings=new Map([...i.skeDrawings,...a])}(at,ot,p,null==(d=null==S?void 0:S.get(E))?void 0:d.top,C);const gt=Ph(ot,at,s,u.skeDrawings,dt,ut);if(ot+gt>it.height&&p.lines.length>0&&u.sections.length>0)return gh(p,!0),void qh(t,e,n,r,s,o,i);const pt=_?_.lineIndex+1:0,{charSpace:_t,defaultTabStop:mt}=oh(n,r),ft=nh(_t,mt,Z,q),{paddingLeft:vt,paddingRight:bt,changeBulletWidth:Ct}=function(t,e=0,n=0,r=0,s=0,o){const{spanType:i=aa.LETTER,bBox:a}=t;let l=eh(e,o),h=eh(n,o),c=eh(r,o),d=eh(s,o),u=c,g=d,p={state:!1,hangingNumber:0};if(i===aa.LIST){const{width:t}=a;l>0?u+=l:h>0&&h>t&&(p.state=!0,p.hangingNumber=h)}else u+=h;return{paddingLeft:u,paddingRight:g,changeBulletWidth:p}}(t[0],L,P,B,H,ft);Ct.state&&(t[0].width=Ct.hangingNumber);const Tt=Lh(E,oa.PARAGRAPH,{lineHeight:ot,contentHeight:et,lineTop:gt,paddingLeft:vt,paddingRight:bt,paddingTop:Q,paddingBottom:tt,marginTop:rt,spaceBelowApply:st},p.width,pt,s,o,u.skeDrawings,dt,ut);p.lines.push(Tt),Tt.parent=p,Gh(E,Tt,at,S),$h(t,e,n,r,s,o,i)}function qh(t,e,n,r,s=0,o=!1,i){!0===Jl(Yl(e))?Zh(t,e,n,r,s,o,i):Kh(t,e,n,r,s,o,i)}function Zh(t,e,n,r,s=0,o=!1,i){const a=Yl(e),{skeHeaders:l,skeFooters:h}=r;e.push(oc(n,{skeHeaders:l,skeFooters:h},null==a?void 0:a.pageNumber)),qh(t,e,n,r,s,o,i)}function Jh(t,e,n,r,s,o,i){let a=e,l=e;if(r===O.DEFAULT||i===be.FALSE)return o===G.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:s*t,lineSpacingApply:t}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(s,t),lineSpacingApply:s};let h=0;return h=o===G.AUTO?s*n:s,t+2*e<h&&(a=l=(h-t)/2),{paddingTop:a,paddingBottom:l,contentHeight:t,lineSpacingApply:h}}function Qh(t,e=0,n,r,s,o){const{ct:i="",ts:a={},tab:l=!1}=t,h=Ua(a,o),{paragraphStyle:c={}}=s,{gridType:d=O.LINES,charSpace:u=0,documentTextStyle:g={},defaultTabStop:p=10.5,pageSize:_={width:1/0,height:1/0},marginLeft:m=0,marginRight:f=0}=n,{namedStyleType:v=V.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:b=ae.UNSPECIFIED,lineSpacing:C=1,spacingRule:T=G.AUTO,snapToGrid:w=be.TRUE,direction:S,spaceAbove:E=0,spaceBelow:y=0,borderBetween:R,borderTop:I,borderBottom:A,borderLeft:N,borderRight:M,indentFirstLine:x=0,hanging:k=0,indentStart:D=0,indentEnd:L=0,tabStops:P=[],keepLines:B=be.FALSE,keepNext:H=be.FALSE,wordWrap:F=be.FALSE,widowControl:U=be.FALSE,shading:z}=c;let W=[r];const Y=_.width||1/0-m-f,X={fontStyle:h,textStyle:__spreadValues(__spreadValues({},g),a),charSpace:u,gridType:d,snapToGrid:w,pageWidth:Y};if(l){return W=jh([Eh(X,nh(u,p,d,w))],W,n,s,e,!0),W}const j=i.split("");for(let O=0;O<j.length;O++){const t=j[O],r=0===O,o=Ah(t,O,j,X);let i=[];if(o){const{charIndex:t,spanGroup:e}=o;O=t,i=e}else{const e=wh(t,X);i.push(e)}W=jh(i,W,n,s,e,r)}return ah(W,(t=>{!function(t,e){if(e===ae.UNSPECIFIED||e===ae.LEFT)return;const{divides:n}=t,r=n.length;for(let s=0;s<r;s++){const t=n[s],{width:r,spanGroup:o}=t,i=dh(t);r!==1/0&&(e===ae.CENTER?t.paddingLeft=(r-i)/2:e===ae.RIGHT?t.paddingLeft=r-i:ae.JUSTIFIED)}}(t,b)})),W}function tc(t,e,n,r,s,o){const{pageNumberStart:i,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:h=0,columnProperties:c=[],columnSeparatorType:d=k.NONE,contentDirection:u,sectionType:g,sectionTypeNext:p,textDirection:_,lists:m,drawings:f={},fontLocale:v}=r,{elements:b,paragraphStyle:C={},bullet:T}=e,{skeHeaders:w,skeFooters:S,skeListLevel:E,blockAnchor:y}=s,R={blockId:t,paragraphStyle:C,skeHeaders:w,skeFooters:S,blockAnchor:y},I=[n];let A=n;const O=new Map,N=vh(T,m,function(t,e){if(!t||!e)return;const{listId:n,nestingLevel:r}=t,s=null==e?void 0:e.get(n);let o=r;o<0&&(o=0);const i=[];for(let a=o;a>=0;a--){const t=null==s?void 0:s[a];i[a]=t||null}return i}(T,E),v,o);return function(t,e,n){if(!t||!e)return;const{listId:r,nestingLevel:s}=t,o=[...(null==n?void 0:n.get(r))||[]];o[s]=e,o.splice(s+1),null==n||n.set(r,o)}(T,N,E),R.bulletSkeleton=N,b.forEach(((t,e)=>{const{eId:n,et:r}=t;if(r===B.DRAWING){const t=f[n];t.layoutType===z.INLINE||O.set(n,function(t){return{objectId:t.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:t}}(t))}})),b.forEach(((t,e)=>{const{eId:n,et:o}=t;let i=[];if(o===B.TEXT_RUN){const{tr:n,st:s,ed:o}=t;if(!n)return!1;i=Qh(n,e,r,A,__spreadProps(__spreadValues({},R),{paragraphAffectSkeDrawings:O}),v)}else if(o===B.PAGE_BREAK)i=[oc(r,s,ec(A),ra.PAGE)],O.clear();else if(o===B.COLUMN_BREAK){const t=ql(A);t&&!t.isLast?gh(t.column,!0):i=[oc(r,s,ec(A),ra.COLUMN)]}A=function(t,e){const n=t.slice(-1)[0],r=e[0];if(n===r){if(1===e.length)return n;e.shift()}return t.push(...e),t.slice(-1)[0]}(I,i)})),I}function ec(t){return t.pageNumber+1}(Nh=Oh||(Oh={}))[Nh.BOTH=0]="BOTH",Nh[Nh.LEFT=1]="LEFT",Nh[Nh.RIGHT=2]="RIGHT",(xh=Mh||(Mh={}))[xh.X=0]="X",xh[xh.Y=1]="Y";function nc(){return[]}function rc(t,e,n,r,s,o){const i=[],a=new Map;for(let l of t){const{paragraph:t,table:h,tableOfContents:c,blockType:d,customBlock:u,blockId:g}=l;if(null==s?void 0:s.get(g))continue;let p=[],_=e;i.length>0&&(_=i[i.length-1]),d===I.PARAGRAPH&&t?p=tc(l.blockId,t,_,n,r,o):d===I.TABLE&&h||d===I.SECTION_BREAK&&c||d===I.CUSTOM&&(p=fl(l.blockId,u,_,n,r,o)),0===p.length&&(p=[]),sc(i,p),a.set(g,!0)}return{pages:i,renderedBlockIdMap:a}}function sc(t,e){t[t.length-1]===e[0]&&e.splice(0,1),t.push(...e)}function oc(t,e,n=1,r=ra.SECTION){var s,o,i,a;const l={sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:_t.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:ra.SECTION,st:0,ed:0,skeDrawings:new Map},{pageNumberStart:h=1,pageSize:c={width:1/0,height:1/0},pageOrient:d=_t.PORTRAIT,headerIds:u={},footerIds:g={},useFirstPageHeaderFooter:p,useEvenPageHeaderFooter:_,footers:m,headers:f,columnProperties:v=[],columnSeparatorType:b,marginTop:C=0,marginBottom:T=0,marginHeader:w=0,marginFooter:S=0,marginLeft:E=0,marginRight:y=0,renderConfig:R={}}=t,{skeHeaders:I,skeFooters:A}=e,{width:O=1/0,height:N=1/0}=c;l.pageNumber=n,l.pageNumberStart=h,l.renderConfig=R,l.marginLeft=E,l.marginRight=y,l.breakType=r,l.width=l.pageWidth=O,l.height=l.pageHeight=N,l.pageOrient=d;const{defaultHeaderId:M,evenPageHeaderId:x,firstPageHeaderId:k}=u,{defaultFooterId:D,evenPageFooterId:L,firstPageFooterId:P}=g;let B,H,F=null!=M?M:"",U=null!=D?D:"";n===h&&p?(F=null!=k?k:"",U=null!=P?P:""):n%2==0&&_&&(F=null!=x?x:"",U=null!=L?L:""),F&&((null==(s=I.get(F))?void 0:s.has(O))?B=null==(o=I.get(F))?void 0:o.get(O):f&&(B=ic(f[F],t,e),I.set(F,new Map([[O,B]]))),l.headerId=F),U&&((null==(i=A.get(U))?void 0:i.has(O))?H=null==(a=A.get(U))?void 0:a.get(O):m&&(H=ic(m[U],t,e),A.set(F,new Map([[O,H]]))),l.footerId=U),l.marginTop=ac(C,w,B),l.marginBottom=ac(T,S,H);const z=l.sections,W=z[z.length-1],{marginTop:V,marginBottom:Y,marginLeft:G,marginRight:X}=l,j=O-G-X,$=N-V-Y;let K=0;W&&(K=W.top+W.height);const q=uh(v,b,K,0,j,$-K);return q.parent=l,z.push(q),l}function ic(t,e,n,r=!0){const{body:s}=t,{lists:o,headers:i,footers:a,fontLocale:l,pageSize:h,marginLeft:c=0,marginRight:d=0,drawings:u,marginTop:g=0,marginBottom:p=0,marginHeader:_=0,marginFooter:m=0}=e,f={lists:o,headers:i,footers:a,pageSize:{width:((null==h?void 0:h.width)||1/0)-c-d,height:1/0},fontLocale:l,drawings:u},{blockElements:v}=s,b=[];v.forEach((t=>{b.push(t)}));const C=oc(f,n),T=rc(b,C,f,n).pages[0];ih([T]);const w=T.sections[0].columns[0],S=w.height||0,{skeDrawings:E,st:y,ed:R}=T,I={lines:w.lines,skeDrawings:E,height:S,st:y,ed:R,marginLeft:c,marginRight:d};return __spreadProps(__spreadValues({},I),r?{marginTop:lc(g,_,S)}:{marginBottom:hc(p,m,S)})}function ac(t,e,n){return n&&0!==n.lines.length?Math.max(t,e,(null==n?void 0:n.height)||0):t}function lc(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}function hc(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}class cc{constructor(t){this._dirty=!0,this._context=t,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(t){this._dirty=t}_localeInitial(){if(!this._context)return;const t=this._context.getUniver().getGlobalContext().getLocale(),e=t.getObject("renderFont");e||t.load({en:Ni,zh:Oi}),this._fontLocale=e}}(Dh=kh||(kh={})).PENDING="pending",Dh.CALCULATING="calculating",Dh.READY="ready",Dh.INVALID="invalid";class dc extends cc{constructor(t,e){super(e),this.onRecalculateChangeObservable=new i,this._renderedBlockIdMap=new Map,this._documentData=t}static create(t,e){return new dc(t,e)}updateDrawing(t,e){const n=this._documentData.drawings;if(!n)return;const r=n[t];if(!r)return;const s=r.objectProperties;s.size.width=e.width,s.size.height=e.height,s.positionH.posOffset=e.left,s.positionV.posOffset=e.top}calculate(t){this.dirty&&(this._skeletonData=this._createSkeleton(t),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(t,e){const n=this._documentData.documentStyle;if(!n.pageSize)return t=null!=t?t:1/0,e=null!=e?e:1/0,void(n.pageSize={width:t,height:e});void 0!==t&&(n.pageSize.width=t),void 0!==e&&(n.pageSize.height=e)}__getContentMapArr(){const{body:t}=this._documentData;if(!t)return[];const{blockElements:e}=t;if(0===e.length)return[];const n=[];let r={blockElements:[],sectionBreak:void 0};return e.forEach((t=>{const{sectionBreak:e}=t;e?(r.sectionBreak=e,n.push(r),r={blockElements:[],sectionBreak:void 0}):r.blockElements.push(t)})),r.sectionBreak||(r.sectionBreak={columnProperties:[],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED},r.blockElements.length>0&&n.push(r)),n}_createSkeleton(t){var e;const n=this.__getContentMapArr(),r={width:1/0,height:1/0},{documentStyle:s,footers:o,headers:i,lists:a,drawings:l}=this._documentData,{pageNumberStart:h=1,pageSize:c=r,pageOrient:d=_t.PORTRAIT,defaultHeaderId:u,defaultFooterId:g,evenPageHeaderId:p,evenPageFooterId:_,firstPageHeaderId:m,firstPageFooterId:f,useFirstPageHeaderFooter:v,useEvenPageHeaderFooter:b,marginTop:C=0,marginBottom:T=0,marginRight:w=0,marginLeft:S=0,marginHeader:E=0,marginFooter:y=0,charSpace:R=0,linePitch:I=15.6,gridType:A=O.LINES,paragraphLineGapDefault:N=0,defaultTabStop:x=10.5,textStyle:D={fs:14},renderConfig:L={horizontalAlign:ae.UNSPECIFIED,verticalAlign:he.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:de.UNSPECIFIED}}=s,P=this.__getNullSke();if(0===n.length)return P;const B={footers:o,headers:i,lists:a,drawings:l,charSpace:R,linePitch:I,gridType:A,fontLocale:this.getFontLocale(),paragraphLineGapDefault:N,defaultTabStop:x,documentTextStyle:D},{skeHeaders:H,skeFooters:F,skeListLevel:U,blockAnchor:z}=P,W={skeHeaders:H,skeFooters:F,skeListLevel:U,blockAnchor:z},V=[];P.pages=V;for(let O=0;O<n.length;O++){const t=n[O];if(!t.sectionBreak)continue;const{pageNumberStart:r=h,pageSize:s=c,pageOrient:o=d,marginTop:i=C,marginBottom:a=T,marginRight:l=w,marginLeft:R=S,marginHeader:I=E,marginFooter:A=y,defaultHeaderId:N=u,defaultFooterId:x=g,evenPageHeaderId:D=p,evenPageFooterId:P=_,firstPageHeaderId:H=m,firstPageFooterId:F=f,useFirstPageHeaderFooter:U=v,useEvenPageHeaderFooter:z=b,columnProperties:Y=[],columnSeparatorType:G=k.NONE,contentDirection:X,sectionType:j,textDirection:$,renderConfig:K=L}=t.sectionBreak,q=n[O+1],Z=null==(e=null==q?void 0:q.sectionBreak)?void 0:e.sectionType,J={defaultHeaderId:N,evenPageHeaderId:D,firstPageHeaderId:H},Q={defaultFooterId:x,evenPageFooterId:P,firstPageFooterId:F};null===s.width&&(s.width=1/0),null===s.height&&(s.height=1/0);const tt=__spreadValues({pageNumberStart:r,pageSize:s,pageOrient:o,marginTop:i,marginBottom:a,marginRight:l,marginLeft:R,marginHeader:I,marginFooter:A,headerIds:J,footerIds:Q,useFirstPageHeaderFooter:U,useEvenPageHeaderFooter:z,columnProperties:Y,columnSeparatorType:G,contentDirection:X,sectionType:j,sectionTypeNext:Z,textDirection:$,renderConfig:K},B);let et=Yl(V),nt=!1;j===M.CONTINUOUS?(ih(V),this.__addNewSectionByContinuous(et,Y,G),nt=!0):et=oc(tt,W,null==et?void 0:et.pageNumber);const rt=this.getContext(),st=rc(t.blockElements,et,tt,W,this._renderedBlockIdMap,rt);Z===M.CONTINUOUS&&Y.length;const{pages:ot,renderedBlockIdMap:it}=st;nt&&ot.splice(0,1),V.push(...ot)}return ih(V),P}__addNewSectionByContinuous(t,e,n){const r=t.sections,s=r[r.length-1],{pageWidth:o,pageHeight:i,marginTop:a,marginBottom:l,marginLeft:h,marginRight:c}=t,d=o-h-c,u=i-a-l,g=((null==s?void 0:s.top)||0)+((null==s?void 0:s.height)||0),p=uh(e,n,g,0,d,u-g);p.parent=t,r.push(p)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}}class uc extends Cl{constructor(){super(...arguments),this._extensions=new Map}get extensions(){return this._extensions}register(...t){for(let e of t)e.parent=this,this._extensions.set(e.uKey,e)}unRegister(...t){for(let e of t)this._extensions.delete(e)}getExtensionsByOrder(){const t=Array.from(this._extensions.values());return t.sort(yr),t}getExtensionByKey(t){return this._extensions.get(t)}draw(t,e){}}class gc extends uc{constructor(t,e,n=!1){super(t),this._skeleton=e,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new El),this.onIsAddedToParentObserver.add((t=>{var e;null==(e=null==t?void 0:t.getEngine())||e.onTransformChangeObservable.add((t=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas()}))}getSkeleton(){return this._skeleton}setSkeleton(t){this._skeleton=t}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(t,e),t.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:t=1,scaleY:e=1}=this.parent;return this.parent.classType===Zi.SCENE&&(t=this.parent.ancestorScaleX||1,e=this.parent.ancestorScaleY||1),{scaleX:t,scaleY:e}}_getBounding(t){}_draw(t,e){}}class pc{constructor(){this.translateX=0,this.translateY=0}draw(t,e,n){}clearCache(){}_getScale(t){return qa(t)}}const _c=Go.create(),mc=Go.create(),fc=Go.create(),vc=Go.create();var bc,Cc;(Cc=bc||(bc={}))[Cc.SPAN=0]="SPAN",Cc[Cc.LINE=1]="LINE";class Tc extends pc{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}vc.add(new class extends Tc{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(t,e,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:s,content:o,fontStyle:i,bBox:a}=n;let{spanPointWithFont:l=il.create(0,0)}=this.extensionOffset;if(!s)return void(null!=o&&t.fillText(o,l.x,l.y));if(null==o)return;this._preFontString!==(null==i?void 0:i.fontString)&&(t.font=this._preFontString=(null==i?void 0:i.fontString)||"");const{cl:h,va:c}=s,d=xn(h)||Xi;if(d&&this._preFontColor!==d&&(t.fillStyle=d),c===fe.SUBSCRIPT||c===fe.SUPERSCRIPT){let t=a.spo;c===fe.SUPERSCRIPT&&(t=-a.sbo),l.y+=t}t.fillText(o,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});vc.add(new class extends Tc{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(t,e,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{lineHeight:o=0}=s,{ts:i,width:a,content:l}=n;if(!i)return;const{bg:h}=i;if(!h)return;const c=xn(h),{spanStartPoint:d=il.create(0,0)}=this.extensionOffset;c&&(t.fillStyle=c,t.fillRect(d.x-.5,d.y,a+1,o))}clearCache(){this._preBackgroundColor=""}});vc.add(new class extends Tc{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(t,e,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:a,left:l,width:h,bBox:c}=n;if(!a)return;const{sp:d}=c,u=qa(e),{ul:g,st:p,ol:_}=a,{originTranslate:m=il.create(0,0),centerPoint:f=il.create(0,0),alignOffset:v=il.create(0,0),renderConfig:b={}}=this.extensionOffset,{centerAngle:C=0,vertexAngle:T=0}=b;if(g){const{s:e,cl:n,t:r}=g;if(e===be.TRUE){t.beginPath();const e=xn(n)||Xi;t.strokeStyle=e,this._setLineType(t,r||oe.SINGLE);const s=Fa(i+1-.5,u),o=ul(m.addByPoint(l,s),f,C,T,v),a=ul(m.addByPoint(l+h,s),f,C,T,v);t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke()}}if(p){const{s:e,cl:n,t:r}=p;if(e===be.TRUE){t.beginPath();const e=xn(n)||Xi;t.strokeStyle=e,this._setLineType(t,r||oe.SINGLE);const s=Fa(d-.5,u),o=ul(m.addByPoint(l,s),f,C,T,v),i=ul(m.addByPoint(l+h,s),f,C,T,v);t.moveTo(o.x,o.y),t.lineTo(i.x,i.y),t.stroke()}}if(_){const{s:e,cl:n,t:r}=_;if(e===be.TRUE){t.beginPath();const e=xn(n)||Xi;t.strokeStyle=e,this._setLineType(t,r||oe.SINGLE);const s=Fa(-1.5,u),o=ul(m.addByPoint(l,s),f,C,T,v),i=ul(m.addByPoint(l+h,s),f,C,T,v);t.moveTo(o.x,o.y),t.lineTo(i.x,i.y),t.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(t,e){e===oe.DASH_DOT_DOT_HEAVY||e===oe.DOT_DOT_DASH?t.setLineDash([2,2,5,2,2]):e===oe.DASH_DOT_HEAVY||e===oe.DOT_DASH?t.setLineDash([2,5,2]):e===oe.DOTTED||e===oe.DOTTED_HEAVY?t.setLineDash([2]):e===oe.DASH||e===oe.DASHED_HEAVY?t.setLineDash([3]):e===oe.DASH_LONG||e===oe.DASH_LONG_HEAVY?t.setLineDash([6]):t.setLineDash([0])}_getLineWidth(t){let e=1;return t===oe.WAVY_HEAVY||t===oe.DASHED_HEAVY||t===oe.DOTTED_HEAVY||t===oe.DASH_DOT_HEAVY||t===oe.DASH_LONG_HEAVY||t===oe.DASH_DOT_DOT_HEAVY?e=2:t===oe.THICK&&(e=3),e}});vc.add(new class extends Tc{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(t,e,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:a,left:l,width:h}=n;if(!a)return;const{bd:c}=a;if(!c)return;const d=this._getScale(e),u=this._createBorderCache(c),{spanStartPoint:g=il.create(0,0)}=this.extensionOffset;for(let p of u.keys()){const e=u.get(p);if(!e)continue;const{s:n,cl:r}=e,s=xn(r)||Xi;n!==this._preBorderStyle&&(cl(t,n),t.lineWidth=dl(n)/d,this._preBorderStyle=n),s!==this._preBorderColor&&(t.strokeStyle=s||Xi,this._preBorderColor=s),hl(t,p,{startX:g.x,startY:g.y,endX:g.x+h,endY:g.y+i})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(t){const{t:e,b:n,l:r,r:s}=t,o=new Map;return e&&o.set(ji.TOP,e),n&&o.set(ji.BOTTOM,n),r&&o.set(ji.LEFT,r),s&&o.set(ji.RIGHT,s),o}});class wc{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(t=0,e=0){this._translateX=t,this._translateY=e}translate(t=0,e=0){this._translateX+=t,this._translateY+=e}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const t=this._translateSaveList.pop();t&&(this._translateX=t.x,this._translateY=t.y)}translatePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:r=0,marginRight:s=0}=t;this.translate(r,e)}restorePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:r=0,marginRight:s=0}=t;this.translate(-r,-e)}translatePage(t,e=ha.VERTICAL,n=0,r=0,s=0,o=0){const{sections:i,marginTop:a=0,marginBottom:l=0,marginLeft:h=0,marginRight:c=0,pageWidth:d,pageHeight:u,width:g,height:p,pageNumber:_=1,renderConfig:m={}}=t;let f=0,v=0;return e===ha.VERTICAL?f=u+r:e===ha.HORIZONTAL&&(v=d+n),this.translate(v,f),{x:v,y:f}}translateSection(t){const{top:e=0}=t;return this.translate(0,e),{x:0,y:e}}translateColumn(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}translateLine(t,e=!1){const{top:n,marginBottom:r=0,marginTop:s=0,paddingTop:o=0,paddingBottom:i=0}=t,a=n+(!0===e?s:0)+o;return this.translate(0,a),{x:0,y:a}}translateDivide(t){const{left:e,paddingLeft:n}=t,r=e+n;return this.translate(r,0),{x:r,y:0}}translateSpan(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}}var Sc,Ec,yc,Rc;(Ec=Sc||(Sc={}))[Ec.NORMAL=0]="NORMAL",Ec[Ec.START=1]="START",Ec[Ec.END=2]="END",(Rc=yc||(yc={}))[Rc.page=0]="page",Rc[Rc.section=1]="section",Rc[Rc.column=2]="column",Rc[Rc.line=3]="line",Rc[Rc.divide=4]="divide",Rc[Rc.span=5]="span";const Ic={page:0,section:1,column:2,line:3,divide:4,span:5};class Ac{constructor(t,e,n,r){this._scene=t,this.startNodePosition=e,this.endNodePosition=n,this.segmentId=r,this._current=!1,this._Liquid=new wc,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}getRange(){const t=this._rangeList,e=t[0],n=t[t.length-1];let r=1===t.length&&e.isCollapse;return{cursorStart:e.cursorStart,cursorEnd:n.cursorEnd,isStartBack:e.isStartBack,isEndBack:n.isEndBack,isCollapse:r}}getRangeList(){return this._rangeList}getAnchor(){return this._anchorShape}activeStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:ya(Mi.black,1)})}deactivateStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:ya(Mi.black,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return null==this.startNodePosition&&null==this.endNodePosition}isCollapsed(){return null!=this.startNodePosition&&null==this.endNodePosition||!!this.isSamePosition()}isRange(){const t=this.startNodePosition,e=this.endNodePosition;return null!=t&&null!=e&&!this.isSamePosition()}dispose(){var t,e;null==(t=this._rangeShape)||t.dispose(),this._rangeShape=null,null==(e=this._anchorShape)||e.dispose(),this._anchorShape=null}isIntersection(t){const e=this.getRange(),n=t.getRange(),r=this._getCursorPosition(e.cursorStart,e.isStartBack),s=this._getCursorPosition(e.cursorEnd,e.isEndBack),o=this._getCursorPosition(n.cursorStart,n.isStartBack);return!(r>this._getCursorPosition(n.cursorEnd,n.isEndBack)||s<o)}refresh(t){var e,n;const r=this.startNodePosition,s=this.endNodePosition;if(null==(e=this._anchorShape)||e.hide(),null==(n=this._rangeShape)||n.hide(),this.isEmpty())return;if(this.isCollapsed()){const e=this._getRangePointData(r,r,t),{pointGroup:n,cursorList:s}=e;return this._setRangeList(s),void(n.length>0&&this._createAndUpdateAnchor(n,t.left,t.top))}const o=this._getRangePointData(r,s,t),{pointGroup:i,cursorList:a}=o;this._setRangeList(a),i.length>0&&this._createAndUpdateRange(i,t.left,t.top)}getStart(){if(null==this.startNodePosition)return this.endNodePosition;if(null==this.endNodePosition)return this.startNodePosition;const{start:t}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return t}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(t,e){return!(t.page>e.page)&&(t.page<e.page||!(t.section>e.section)&&(t.section<e.section||!(t.column>e.column)&&(t.column<e.column||!(t.line>e.line)&&(t.line<e.line||!(t.divide>e.divide)&&(t.divide<e.divide||!(t.span>e.span)&&(t.span,e.span,!0))))))}_compareNodePosition(t,e){return this._compareNodePositionLogic(t,e)?{start:t,end:e}:{start:e,end:t}}_setNodePositionState(t=0,e,n,r){this._currentStartState[t]=r===e?1:0,this._currentEndState[t]=r===n?2:0}_checkPreviousNodePositionState(t,e=!0){let n,r=t;for(;r>=0;){const t=yc[r];let s;if(s=e?this._currentStartState[t]:this._currentEndState[t],void 0===s)return;if(void 0===n&&(n=s),s!==n)return 0;r--}return n}_getSelectionRuler(t,e,n,r,s){let o=0,i=r;const a=yc[t],l=yc[t+1];if(null===l||null===a)return{start_next:o,end_next:i};const h=e[a],c=n[a];this._setNodePositionState(a,h,c,s);const d=this._checkPreviousNodePositionState(t),u=this._checkPreviousNodePositionState(t,!1);return 1===d&&(o=e[l]),2===u&&(i=n[l]),{start_next:o,end_next:i}}_pushToPoints(t){const{startX:e,startY:n,endX:r,endY:s}=t,o=[];return o.push({x:e,y:n}),o.push({x:r,y:n}),o.push({x:r,y:s}),o.push({x:e,y:s}),o.push({x:e,y:n}),o}isSamePosition(){const t=this.startNodePosition,e=this.endNodePosition;if(null==t||null==e)return!1;const n=Object.keys(Ic);for(let r of n){if(t[r]!==e[r])return!1}return t.isBack===e.isBack}_createAndUpdateRange(t,e,n){if(this._rangeShape)return this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),void this._rangeShape.show();const r=new Pl("__TestSelectionRange__"+C.generateRandomId(6),{pointsGroup:t,fill:ya(Mi.black,.2),left:e,top:n,evented:!1});this._rangeShape=r,this._scene.addObject(r,2)}_getAnchorBounding(t){const e=t[0],n=e[0],r=e[2],{x:s,y:o}=n,{x:i,y:a}=r;return{left:s,top:o,width:i-s,height:a-o}}_createAndUpdateAnchor(t,e,n){const r=this._getAnchorBounding(t),{left:s,top:o,width:i,height:a}=r;if(this._anchorShape)return this._anchorShape.transformByState({left:s+e,top:o+n,height:a}),void this._anchorShape.show();const l=new Dl("__TestSelectionAnchor__"+C.generateRandomId(6),{left:s+e,top:o+n,height:a,strokeWidth:1,stroke:ya(Mi.black),evented:!1});this._anchorShape=l,this._scene.addObject(l,2)}_getRangePointData(t,e,n){const r=[],s=[];if(null==t||null==e)return{pointGroup:r,cursorList:s};const{start:o,end:i}=this._compareNodePosition(t,e);return this._selectionIterator(o,i,n,((t,e,n,a,l,h)=>{var c;const{lineHeight:d}=h,{spanGroup:u,st:g}=l,{x:p,y:_}=this._Liquid;let m;const f=u[t],v=u[e],b=(null==f?void 0:f.left)||0,C=(null==f?void 0:f.width)||0,T=(null==v?void 0:v.left)||0,w=(null==v?void 0:v.width)||0;let S=(null==f?void 0:f.spanType)===aa.LIST,E=(null==(c=u[0])?void 0:c.spanType)===aa.LIST,y=t+g,R=e+g;const I=o.span!==t||!n||o.isBack,A=!(i.span!==e||!a)&&i.isBack,O=o===i;if(0===t&&e===u.length-1)R-=E?1:0,m={startX:p+b+(S?C:0),startY:_,endX:p+T+w,endY:_+d};else{y-=E&&!S?1:0,R-=E&&!S?1:0,m={startX:p+b+(I&&!S?0:C),startY:_,endX:p+T+(A?0:w),endY:_+d}}r.push(this._pushToPoints(m)),s.push({isStartBack:I,isEndBack:A,cursorStart:y,cursorEnd:R,isCollapse:O})})),{pointGroup:r,cursorList:s}}_selectionIterator(t,e,n,r){const s=n.getSkeleton();if(!s)return[];this._Liquid.reset();const o=s.getSkeletonData().pages,{page:i}=t,{page:a}=e;this._resetCurrentNodePositionState();for(let l=0;l<=i-1;l++){const t=o[l];this._Liquid.translatePage(t,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let l=i;l<=a;l++){const s=o[l],h=s.sections,{start_next:c,end_next:d}=this._getSelectionRuler(Ic.page,t,e,h.length-1,l);this._Liquid.translateSave(),this._Liquid.translatePagePadding(s);for(let n=c;n<=d;n++){const o=h[n],u=o.columns,{start_next:g,end_next:p}=this._getSelectionRuler(Ic.section,t,e,u.length-1,n);this._Liquid.translateSection(o);for(let h=g;h<=p;h++){const _=u[h],m=_.lines,{start_next:f,end_next:v}=this._getSelectionRuler(Ic.column,t,e,m.length-1,h);this._Liquid.translateColumn(_);for(let u=f;u<=v;u++){const b=m[u],{divides:C,type:T,lineHeight:w=0}=b,{start_next:S,end_next:E}=this._getSelectionRuler(Ic.line,t,e,C.length-1,u);this._Liquid.translateSave(),this._Liquid.translateLine(b);for(let m=S;m<=E;m++){const T=C[m];this._Liquid.translateSave(),this._Liquid.translateDivide(T);const w=T.spanGroup,{start_next:y,end_next:R}=this._getSelectionRuler(Ic.divide,t,e,w.length-1,m);let I=!1,A=!1;l===i&&n===c&&h===g&&u===f&&m===S&&(I=!0),l===a&&n===d&&h===p&&u===v&&m===E&&(A=!0),r&&r(y,R,I,A,T,b,_,o,s),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}this._Liquid.translateRestore(),this._Liquid.translatePage(s,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}}_setRangeList(t){0!==t.length&&(this._rangeList=t)}_getCursorPosition(t,e){return t-(!0===e?1:0)}}class Oc{constructor(t){var e;this._documents=t,this.onKeydownObservable=new i,this.onInputObservable=new i,this.onCompositionstartObservable=new i,this.onCompositionupdateObservable=new i,this.onCompositionendObservable=new i,this._textSelectionList=[],this._viewPortObserverMap=new Map,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=null==(e=this._documents)?void 0:e.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}set activeViewport(t){this._attachScrollEvent(t),this._activeViewport=t}static create(t){return new Oc(t)}getActiveTextSelection(){const t=this._textSelectionList;for(let e of t)if(e.isActive())return e}getTextSelectionList(){return this._textSelectionList}add(t){this._addTextSelection(t)}remain(){const t=this.getActiveTextSelection();if(null==t)return;const e=this._textSelectionList.indexOf(t);return this._textSelectionList.splice(e,1)[0]}sync(){this._syncDomToSelection()}active(t,e){this._container.style.left=`${t}px`,this._container.style.top=`${e}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout((()=>{this._input.focus()}),0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(t){var e;this._documents&&this._detachEvent(this._documents),this._documents=t,this._skeletonObserver=null==(e=t.getSkeleton())?void 0:e.onRecalculateChangeObservable.add((t=>{this._deleteAllTextSelection()})),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}_initialDom(){const t=document.createElement("div");t.style.position="absolute",t.style.position="absolute",t.style.left="0px",t.style.top="0px";const e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");e.appendChild(n),t.appendChild(e),t.appendChild(r),this._container=t,this._inputParent=e,this._input=n,this._cursor=r,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(t)}_initialInput(){this._inputParent.style.cssText="\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        ",this._input.contentEditable="true",this._input.style.cssText="\n            position: absolute; \n            overflow: hidden; \n            opacity: 1; \n            background: #000; \n            color: transparent; \n            outline: none; \n            z-index: -2; \n            caret-color: transparent; \n            white-space: pre-wrap; \n            user-select: text;\n        "}_initialCursorDom(){if(this._cursor.style.cssText="\n            visibility: visible;\n            position: absolute;\n            background: #000;\n            left: 0;\n            top: 0;\n            width: 1px;\n            height: 20px;\n            opacity: 0;\n            z-index: 0;\n            pointer-events: none;\n            display: none\n        ",!rl("keyframes univer_cursor_blinkStyle")){nl(["\n                @-webkit-keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            ","\n                @keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            "])}}_getSkeletonData(){var t,e;return null==(e=null==(t=this._documents)?void 0:t.getSkeleton())?void 0:e.getSkeletonData()}_getNodePosition(t){var e;if(!1===t)return;const{node:n,ratioX:r,ratioY:s}=t,o=null==(e=this._documents)?void 0:e.findPositionBySpan(n);return null!=o?__spreadProps(__spreadValues({},o),{isBack:r<.5}):void 0}_interactTextSelection(t){const e=[];let n=!1;this._textSelectionList.forEach((r=>{if(r===t)return!0;t.isIntersection(r)?(n=!0,r.dispose()):e.push(r)})),n&&(e.push(t),this._textSelectionList=e)}_deleteAllTextSelection(){this._textSelectionList.forEach((t=>{t.dispose()})),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach((t=>{t.deactivate()}))}_addTextSelection(t){this._deactivateTextSelection(),t.activate(),this._textSelectionList.push(t)}_updateTextSelection(t){if(!this._documents)return;let e=this._textSelectionList.pop();e||(e=new Ac(this._documents.getScene(),t)),this._deleteAllTextSelection(),e.activate(),e.startNodePosition=t,e.endNodePosition=null,this._textSelectionList=[e]}_isEmptyTextSelection(){return 0===this._textSelectionList.length}_getCanvasOffset(){var t,e;const n=null==(t=this._documents)?void 0:t.getEngine(),r=null==(e=null==n?void 0:n.getCanvas())?void 0:e.getCanvasEle();if(!r)return{left:0,top:0};const{top:s,left:o}=function(t){let e=t.getBoundingClientRect(),n=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||n.scrollTop,o=window.pageXOffset||r.scrollLeft||n.scrollLeft,i=r.clientTop||n.clientTop,a=r.clientLeft||n.clientLeft;return{top:e.top+s-i,left:e.left+o-a}}(r);return{left:o,top:s}}_syncDomToSelection(){var t;const e=this.getActiveTextSelection(),n=null==e?void 0:e.getAnchor();if(!n||n&&!n.visible)return;const{height:r,left:s,top:o}=n,i=null==(t=this._activeViewport)?void 0:t.getAbsoluteVector(il.FromArray([s,o]));this._cursor.style.height=`${r}px`;let{left:a,top:l}=this._getCanvasOffset();a+=(null==i?void 0:i.x)||0,l+=(null==i?void 0:i.y)||0,this.active(a,l)}_moving(t,e,n){const{scrollX:r,scrollY:s}=Tl(n);if(!this._documents)return;const o=this._documents.findNodeByCoord(t,e),i=this._getNodePosition(o);if(console.log("endNode",o,i,{moveOffsetX:t,moveOffsetY:e,_viewportScrollY:this._viewportScrollY,scrollX:r}),!i)return;const a=this.getActiveTextSelection();a&&(a.endNodePosition=i,a.refresh(this._documents),this._interactTextSelection(a))}_attachScrollEvent(t){if(!t)return;const e=t.viewPortKey;if(this._viewPortObserverMap.has(e))return;const n=t.onScrollBeforeObserver.add((t=>{if(!t.viewport)return;const e=this.getActiveTextSelection();null==e||e.activeStatic(),this._cursor.style.display="none"})),r=t.onScrollStopObserver.add((t=>{const e=t.viewport;if(!e)return;const n=e.getBounding(),r=this.getActiveTextSelection(),s=null==r?void 0:r.getAnchor();if(s&&(!s||s.visible)){if(n){const{minX:t,maxX:e,minY:r,maxY:o}=wl(s,n);if(s.strokeWidth<t||e<0||s.strokeWidth<r||o<0)return}this._syncDomToSelection(),null==r||r.deactivateStatic(),this._cursor.style.display="revert"}}));this._viewPortObserverMap.set(e,{scrollBefore:n,scrollStop:r})}_attachInputEvent(){this._input.addEventListener("keydown",(t=>{if(this._isIMEInputApply)return;const e=this.getActiveTextSelection(),n=this.getTextSelectionList();null!=this._documents&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:t,content:"",document:this._documents,activeSelection:e,selectionList:n}))})),this._input.addEventListener("input",(t=>{if(this._isIMEInputApply)return;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onInputObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionstart",(t=>{this._isIMEInputApply=!0;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionstartObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionend",(t=>{this._isIMEInputApply=!1;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionendObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionupdate",(t=>{const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionupdateObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:r})}))}_attachSelectionEvent(t){this._moveInObserver=t.onPointerEnterObserver.add((()=>{t.cursor=Wi.TEXT})),this._moveOutObserver=t.onPointerLeaveObserver.add((()=>{t.cursor=Wi.DEFAULT,e.resetCursor()}));const e=t.getScene();this._downObserver=t.onPointerDownObserver.add(((t,n)=>{const{offsetX:r,offsetY:s}=t;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(r,s);const o=this._documents.findNodeByCoord(r,s),i=this._getNodePosition(o);if(console.log("startNode",o,i,r,s),!i)return void this._deleteAllTextSelection();if(t.ctrlKey||this._isEmptyTextSelection()){const t=new Ac(this._documents.getScene(),i);this._addTextSelection(t)}else this._updateTextSelection(i);this._activeSelectionRefresh(),this._syncDomToSelection(),e.disableEvent();const a=Nl.create(e);a.startScroll(r,s);const{scrollX:l,scrollY:h}=Tl(a);this._viewportScrollX=l,this._viewportScrollY=h,this._moveObserver=e.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:r}=t;this._moving(n,r,a),a.scrolling(n,r,(()=>{this._moving(n,r,a)})),e.setCursor(Wi.TEXT)})),this._upObserver=e.onPointerUpObserver.add((t=>{e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent(),a.stopScroll()}))}))}_detachEvent(t){var e;t.onPointerEnterObserver.remove(this._moveInObserver),t.onPointerLeaveObserver.remove(this._moveOutObserver),t.onPointerDownObserver.remove(this._downObserver),null==(e=t.getSkeleton())||e.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const t=this.getActiveTextSelection();null==t||t.refresh(this._documents)}}class Nc extends gc{constructor(t,e,n){super(t,e,null==n?void 0:n.allowCache),this.isCalculateSkeleton=!0,this.onPageRenderObservable=new i,this._hasEditor=!1,void 0===(null==n?void 0:n.pageMarginLeft)?this.pageMarginLeft=17:this.pageMarginLeft=null==n?void 0:n.pageMarginLeft,void 0===(null==n?void 0:n.pageMarginTop)?this.pageMarginTop=14:this.pageMarginTop=null==n?void 0:n.pageMarginTop,this.pageLayoutType=(null==n?void 0:n.pageLayoutType)||ha.VERTICAL,this._drawLiquid=new wc,this._findLiquid=new wc,this._hasEditor=(null==n?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(e),this.makeDirty(!0)}get hasEditor(){return this._hasEditor}static create(t,e,n){return new Nc(t,e,n)}calculatePagePosition(){const t=this.getScene();let e=null==t?void 0:t.getParent();const{width:n,height:r,pageMarginLeft:s,pageMarginTop:o}=this;if(null==e)return;const{width:i,height:a}=e;let l=0,h=0,c=0,d=0;i>n?(l=i/2-n/2,c=i-30):(l=s,c=n+2*s),a>r?(h=a/2-r/2,d=a-30):(h=o,d=r+2*o),t.resize(c,d+200),this.translate(l,h)}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(t,e){return this.getScene().getActiveViewportByCoord(il.FromArray([t,e]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=Oc.create(this),this._hasEditor=!0)}disableEditor(){var t;null==(t=this._editor)||t.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:r,onKeydownObservable:s}=this._editor;return{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:r,onKeydownObservable:s}}remainActiveSelection(){if(this._hasEditor)return this._editor.remain()}addSelection(t){if(this._hasEditor)return this._editor.add(t)}syncSelection(){if(this._hasEditor)return this._editor.sync()}draw(t,e){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const r=n.getSkeletonData(),{pages:s}=r,o=this.getParentScale(),i=this.getExtensionsByOrder(),a=qa(o);for(let c of i)c.clearCache();let l=0,h=0;for(let c=0,d=s.length;c<d;c++){const e=s[c],{sections:n,marginTop:r=0,marginBottom:d=0,marginLeft:u=0,marginRight:g=0,width:p,height:_,renderConfig:m={}}=e,{verticalAlign:f=he.TOP,horizontalAlign:v=ae.LEFT,centerAngle:b=0,vertexAngle:C=0,wrapStrategy:T=de.UNSPECIFIED,isRotateNonEastAsian:w=be.FALSE}=m,S=this._horizontalHandler(p,u,g,v),E=this._verticalHandler(_,r,d,f),y=il.create(S,E),R=Ma(b),I=Ma(C),A=I-R;this.onPageRenderObservable.notifyObservers({page:e,pageLeft:h,pageTop:l,ctx:t}),this._startRotation(t,A);for(let s of n){const{columns:e}=s;this._drawLiquid.translateSection(s);for(let n of e){const{lines:e,width:s}=n;this._drawLiquid.translateColumn(n);const l=e.length;let h,c=null;if(0!==I){const{rotateTranslateXList:t,rotatedHeight:n,rotatedWidth:o,fixOffsetX:i,fixOffsetY:a,rotateTranslateY:l}=pl(e,s,I);let p=o;n>this.height&&T!==de.WRAP&&(T===de.OVERFLOW||I>0)&&(p=this.height/Math.tan(Math.abs(I)));const _=this._horizontalHandler(p,u,g,v);let m=this._verticalHandler(n,r,d,f)-a;n>this.height&&(m=I<0?this.height-(n+a):-a),h=il.create(_+i,m),this._drawLiquid.translate(0,-l),c=t}else h=y;for(let n=0;n<l;n++){const r=e[n],{divides:s,asc:l=0,type:d,lineHeight:u=0}=r;let g=l;const p=g*Math.sin(R),_=g*Math.cos(R);if(d===oa.BLOCK)for(let e of i)e.type===bc.LINE&&(e.extensionOffset={alignOffset:h,renderConfig:m},e.draw(t,o,r));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(r,!0),c&&this._drawLiquid.translate(c[n]);const e=s.length;for(let n=0;n<e;n++){const e=s[n],{spanGroup:r}=e;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(e);for(let n of r){if(!n.content||0===n.content.length)continue;const{width:e,left:r}=n,{x:s,y:l}=this._drawLiquid,c=il.create(Fa(s,a),Fa(l,a)),d=il.create(Fa(e/2,a),Fa(u/2,a)),g=ul(c.addByPoint(Fa(r,a),0),d,R,I,h),f=ul(c.addByPoint(Fa(r+p,a),Fa(_,a)),d,R,I,h),v={originTranslate:c,spanStartPoint:g,spanPointWithFont:f,centerPoint:d,alignOffset:h,renderConfig:m};for(let a of i)a.type===bc.SPAN&&(a.extensionOffset=v,a.draw(t,o,n))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(t,A);const{x:O,y:N}=this._drawLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);h+=O,l+=N}}changeSkeleton(t){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(t),this._addSkeletonChangeObserver(t),this}findPositionBySpan(t){var e;const n=t.parent,r=null==n?void 0:n.parent,s=null==r?void 0:r.parent,o=null==s?void 0:s.parent,i=null==o?void 0:o.parent,a=null==(e=this.getSkeleton())?void 0:e.getSkeletonData();if(!(n&&s&&o&&i&&a))return;return{span:n.spanGroup.indexOf(t),divide:r.divides.indexOf(n),line:s.lines.indexOf(r),column:o.columns.indexOf(s),section:i.sections.indexOf(o),page:a.pages.indexOf(i)}}findNodeByCharIndex(t){const e=this.getSkeleton();if(!e)return;const n=e.getSkeletonData().pages;for(let r of n){const{sections:e,st:n,ed:s}=r;if(!(t<n||t>s))for(let r of e){const{columns:e,st:n,ed:s}=r;if(!(t<n||t>s))for(let r of e){const{lines:e,st:n,ed:s}=r;if(!(t<n||t>s))for(let r of e){const{divides:e,lineHeight:n,st:s,ed:o}=r,i=e.length;if(!(t<s||t>o))for(let r=0;r<i;r++){const n=e[r],{spanGroup:s,st:o,ed:i}=n;if(t<o||t>i)continue;const a=s[t-o];if(a)return a}}}}}}findNodeByCoord(t,e){const n=this.getScene().transformToSceneCoord(il.FromArray([t,e]));if(!n)return!1;const r=this._getInverseCoord(n);let{x:s,y:o}=r;const i=this.getSkeleton();if(!i)return!1;this._findLiquid.reset();const a=i.getSkeletonData().pages;for(let l=0,h=a.length;l<h;l++){const t=a[l],{startX:e,startY:n,endX:r,endY:i}=this._getPageBoundingBox(t);if(!(s>=e&&s<=r&&o>=n&&o<=i)){this._translatePage(t);continue}this._findLiquid.translatePagePadding(t);const h=t.sections;for(let a of h){const{columns:t,height:e}=a;this._findLiquid.translateSection(a);const{y:n}=this._findLiquid;if(o>=n&&o<=n+e)for(let r of t){const{lines:t,width:e}=r;this._findLiquid.translateColumn(r);const{x:n}=this._findLiquid;if(!(s>=n&&s<=n+e))continue;const i=t.length;for(let r=0;r<i;r++){const e=t[r],{divides:n,type:i,lineHeight:a=0}=e;if(i!==oa.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(e);const{y:t}=this._findLiquid,r=t,i=t+a;if(!(o>=r&&o<=i)){this._findLiquid.translateRestore();continue}const l=n.length;for(let e=0;e<l;e++){const t=n[e],{spanGroup:a,width:l}=t;this._findLiquid.translateSave(),this._findLiquid.translateDivide(t);const{x:h}=this._findLiquid;if(s>=h&&s<=h+l){for(let t of a){if(!t.content||0===t.content.length)continue;const{width:e,left:n}=t,a=h+n,l=h+n+e;if(s>=a&&s<=l)return{node:t,ratioX:s/(a+l),ratioY:o/(r+i)}}this._findLiquid.translateRestore()}else this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(t),this._translatePage(t)}return!1}_draw(t,e){this.draw(t,e)}_horizontalHandler(t,e,n,r){let s=0;return s=r===ae.CENTER?(this.width-t)/2:r===ae.RIGHT?this.width-t-n:e,s}_verticalHandler(t,e,n,r){let s=0;return s=r===he.MIDDLE?(this.height-t)/2:r===he.BOTTOM?this.height-t-n:e,s}_startRotation(t,e){t.rotate(e||0)}_resetRotation(t,e){t.rotate(-e||0)}_initialDefaultExtension(){vc.getData().forEach((t=>{this.register(t)}))}_addSkeletonChangeObserver(t){t&&(this._skeletonObserver=t.onRecalculateChangeObservable.add((t=>{const e=t.pages;let n=0,r=0;for(let s=0,o=e.length;s<o;s++){const t=e[s],{pageWidth:i,pageHeight:a}=t;this.pageLayoutType===ha.VERTICAL?(r+=a,s!==o-1&&(r+=this.pageMarginTop),n=Math.max(n,i)):this.pageLayoutType===ha.HORIZONTAL&&(n+=i,s!==o-1&&(n+=this.pageMarginLeft),r=Math.max(r,a))}this.resize(n,r),this.calculatePagePosition()})))}_disposeSkeletonChangeObserver(t){t&&t.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(t){const{pageWidth:e,pageHeight:n}=t;let{x:r,y:s}=this._findLiquid,o=-1,i=-1;return this.pageLayoutType===ha.VERTICAL?(o=e,i=s+n):this.pageLayoutType===ha.HORIZONTAL&&(o=r+e,i=n),{startX:r,startY:s,endX:o,endY:i}}_translatePage(t){this._findLiquid.translatePage(t,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}}const Mc=["text","richText"];var xc,kc;(kc=xc||(xc={})).RESIZE_LT="__SpreadsheetTransformerResizeLT__",kc.RESIZE_CT="__SpreadsheetTransformerResizeCT__",kc.RESIZE_RT="__SpreadsheetTransformerResizeRT__",kc.RESIZE_LM="__SpreadsheetTransformerResizeLM__",kc.RESIZE_RM="__SpreadsheetTransformerResizeRM__",kc.RESIZE_LB="__SpreadsheetTransformerResizeLB__",kc.RESIZE_CB="__SpreadsheetTransformerResizeCB__",kc.RESIZE_RB="__SpreadsheetTransformerResizeRB__",kc.OUTLINE="__SpreadsheetTransformerOutline__",kc.ROTATE_LINE="__SpreadsheetTransformerRotateLine__",kc.ROTATE="__SpreadsheetTransformerRotate__",kc.GROUP="__SpreadsheetTransformer__";const Dc=[xc.RESIZE_LT,xc.RESIZE_CT,xc.RESIZE_RT,xc.RESIZE_LM,xc.RESIZE_RM,xc.RESIZE_LB,xc.RESIZE_CB,xc.RESIZE_RB];var Lc,Pc,Bc,Hc,Fc,Uc,zc,Wc;(Pc=Lc||(Lc={}))[Pc.MOVE_START=0]="MOVE_START",Pc[Pc.MOVING=1]="MOVING",Pc[Pc.MOVE_END=2]="MOVE_END";class Vc{constructor(t,e){this._scene=t,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this.onChangeStartObservable=new i,this.onChangingObservable=new i,this.onChangeEndObservable=new i,this.onClearControlObservable=new i,this.onCreateControlObservable=new i,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this._initialProps(e)}getScene(){return this._scene}attachTo(t){if(t.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&t.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&t.onPointerLeaveObserver.add(this.hoverLeaveFunc)),t.onPointerDownObserver.add(((e,n)=>{const{offsetX:r,offsetY:s}=e;this._startOffsetX=r,this._startOffsetY=s;const o=this._getTopScene();if(!o)return;this._addCancelObserver(o),o.disableEvent();const i=Nl.create(o);i.startScroll(r,s);const{scrollX:a,scrollY:l}=Tl(i);this._viewportScrollX=a,this._viewportScrollY=l,this._updateActiveObjectList(t,e),this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:e,offsetY:n}=t;this._moving(e,n,i),this._hiddenControl(),i.scrolling(e,n,(()=>{this._moving(e,n,i)}))})),this._upObserver=o.onPointerUpObserver.add((t=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),this._updateControl(),i.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})})),n.stopPropagation()})),t}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach((t=>{t.dispose()})),this._selectedObjectMap.forEach((t=>{t.dispose()})),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{if(void 0===t[e])return!0;this[e]=t[e]}))}_updateControlChildren(){this._updateControlIterator(((t,e)=>{const{left:n,top:r,width:s,height:o,scaleX:i,scaleY:a}=e.getState();t.getObjects().forEach((t=>{const e=t.oKey,n=this._checkTransformerType(e);if(!n)return!0;if(n===xc.OUTLINE)t.transformByState(this._getOutlinePosition(s,o,i,a));else{const{left:e,top:r}=this._getRotateAnchorPosition(n,o,s,i,a);t.transformByState({left:e,top:r})}})),t.transformByState({left:n,top:r})}))}_anchorMoving(t,e,n,r){const{scrollX:s,scrollY:o}=Tl(r),i=e-this._viewportScrollX+s,a=n-this._viewportScrollY+o,l=i-this._startOffsetX,h=a-this._startOffsetY;this._selectedObjectMap.forEach((e=>{const{left:n,top:r,width:s,height:o}=e,i={};switch(t){case xc.RESIZE_LT:i.left=n+l,i.top=r+h,i.width=s-l,i.height=o-h;break;case xc.RESIZE_CT:i.top=r+h,i.height=o-h;break;case xc.RESIZE_RT:i.top=r+h,i.width=s+l,i.height=o-h;break;case xc.RESIZE_LM:i.left=n+l,i.width=s-l;break;case xc.RESIZE_RM:i.width=l+s;break;case xc.RESIZE_LB:i.left=n+l,i.width=s-l,i.height=o+h;break;case xc.RESIZE_CB:i.height=h+o;break;case xc.RESIZE_RB:i.width=l+s,i.height=h+o}e.transformByState(i)})),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:h,type:1}),this._startOffsetX=i,this._startOffsetY=a}_attachEventToAnchor(t,e=xc.RESIZE_LT){t.onPointerDownObserver.add(((t,n)=>{const{offsetX:r,offsetY:s}=t;this._startOffsetX=r,this._startOffsetY=s;const o=this._getTopScene();if(null==o)return;o.disableEvent();const i=Nl.create(o);i.startScroll(r,s);const{scrollX:a,scrollY:l}=Tl(i);this._viewportScrollX=a,this._viewportScrollY=l;const h=this._getRotateAnchorCursor(e);this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:r}=t;this._anchorMoving(e,n,r,i),i.scrolling(n,r,(()=>{this._anchorMoving(e,n,r,i)})),o.setCursor(h)})),this._upObserver=o.onPointerUpObserver.add((t=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),o.resetCursor(),i.stopScroll()})),n.stopPropagation()}))}_attachEventToRotate(t){t.onPointerDownObserver.add(((t,e)=>{const{offsetX:n,offsetY:r}=t;this._startOffsetX=n,this._startOffsetY=r;const s=this._getTopScene();null!=s&&(s.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=s.onPointerMoveObserver.add((t=>{})),this._upObserver=s.onPointerUpObserver.add((t=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent()})),e.stopPropagation())}))}_getOutlinePosition(t,e,n,r){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:t+2*this.borderSpacing,height:e+2*this.borderSpacing}}_getRotateAnchorCursor(t){let e=Wi.NORTH_WEST_RESIZE;switch(t){case xc.ROTATE:case xc.ROTATE_LINE:e=Wi.MOVE;break;case xc.RESIZE_LT:break;case xc.RESIZE_CT:e=Wi.NORTH_RESIZE;break;case xc.RESIZE_RT:e=Wi.NORTH_EAST_RESIZE;break;case xc.RESIZE_LM:e=Wi.WEST_RESIZE;break;case xc.RESIZE_RM:e=Wi.EAST_RESIZE;break;case xc.RESIZE_LB:e=Wi.SOUTH_WEST_RESIZE;break;case xc.RESIZE_CB:e=Wi.SOUTH_RESIZE;break;case xc.RESIZE_RB:e=Wi.SOUTH_EAST_RESIZE}return e}_getRotateAnchorPosition(t,e,n,r,s){let o=-this.anchorSize/2,i=-this.anchorSize/2;switch(t){case xc.ROTATE:o=n/2-this.rotateSize/2,i=-this.rotateAnchorOffset-this.borderSpacing-2*this.borderStrokeWidth-this.rotateSize;break;case xc.ROTATE_LINE:o=n/2,i=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_LT:o+=-this.borderSpacing-this.borderStrokeWidth,i+=-this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_CT:o+=n/2,i+=-this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_RT:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=-this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_LM:o+=-this.borderSpacing-this.borderStrokeWidth,i+=e/2;break;case xc.RESIZE_RM:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=e/2;break;case xc.RESIZE_LB:o+=-this.borderSpacing-this.borderStrokeWidth,i+=e+this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_CB:o+=n/2,i+=e+this.borderSpacing-this.borderStrokeWidth;break;case xc.RESIZE_RB:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=e+this.borderSpacing-this.borderStrokeWidth}return{left:o,top:i}}_createResizeAnchor(t,e,n){let{height:r,width:s,scaleX:o,scaleY:i}=e.getState();const{left:a,top:l}=this._getRotateAnchorPosition(t,r,s,o,i),h=this._getRotateAnchorCursor(t),c=new Dl(`${t}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:a,top:l});return this._attachHover(c,h,Wi.DEFAULT),c}_checkTransformerType(t){return t.indexOf(xc.OUTLINE)>-1?xc.OUTLINE:t.indexOf(xc.ROTATE)>-1?xc.ROTATE:t.indexOf(xc.ROTATE_LINE)>-1?xc.ROTATE_LINE:t.indexOf(xc.RESIZE_LT)>-1?xc.RESIZE_LT:t.indexOf(xc.RESIZE_CT)>-1?xc.RESIZE_CT:t.indexOf(xc.RESIZE_RT)>-1?xc.RESIZE_RT:t.indexOf(xc.RESIZE_LM)>-1?xc.RESIZE_LM:t.indexOf(xc.RESIZE_RM)>-1?xc.RESIZE_RM:t.indexOf(xc.RESIZE_LB)>-1?xc.RESIZE_LB:t.indexOf(xc.RESIZE_CB)>-1?xc.RESIZE_CB:t.indexOf(xc.RESIZE_RB)>-1?xc.RESIZE_RB:void 0}_updateControlIterator(t){this._transformerControlMap.forEach(((e,n)=>{const r=this._selectedObjectMap.get(n);if(!r)return!0;t(e,r)}))}_updateControl(){this._updateControlIterator(((t,e)=>{const{left:n,top:r}=e.getState();t.transformByState({left:n,top:r}),t.show(),t.makeDirty(!0)}))}_hiddenControl(){this._transformerControlMap.forEach((t=>{t.hide(),t.makeDirty(!0)}))}_attachHover(t,e,n){t.onPointerEnterObserver.add((()=>{t.cursor=e})),t.onPointerLeaveObserver.add((()=>{t.cursor=n}))}_clearControl(){this._transformerControlMap.forEach((t=>{t.dispose()})),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(t){let{left:e,top:n,height:r,width:s,angle:o,scaleX:i,scaleY:a,skewX:l,skewY:h,flipX:c,flipY:d}=t.getState();const u=t.oKey,g=this._selectedObjectMap.size,p=[];if(this.borderEnabled){const t=new Dl(`${xc.OUTLINE}_${g}`,__spreadValues({zIndex:g-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke},this._getOutlinePosition(s,r,i,a)));p.push(t)}if(this.resizeEnabled){const{left:t,top:e}=this._getRotateAnchorPosition(xc.ROTATE_LINE,r,s,i,a),n=new Dl(`${xc.ROTATE_LINE}_${g}`,{zIndex:g-1,evented:!1,left:t,top:e,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:o,top:l}=this._getRotateAnchorPosition(xc.ROTATE,r,s,i,a),h=this._getRotateAnchorCursor(xc.ROTATE),c=new Dl(`${xc.ROTATE}_${g}`,{zIndex:g-1,left:o,top:l,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:2*this.borderStrokeWidth,stroke:this.borderStroke});this._attachEventToRotate(c),this._attachHover(c,h,Wi.DEFAULT),p.push(n,c)}if(this.resizeEnabled)for(let f=0,v=this.enabledAnchors.length;f<v;f++){if(1!==this.enabledAnchors[f])continue;const e=Dc[f],n=this._createResizeAnchor(e,t,g);this._attachEventToAnchor(n,e),p.push(n)}const _=new Ol(`${xc.GROUP}_${g}`,...p);_.zIndex=g,_.evented=!1,_.transformByState({left:e,top:n});const m=this.getScene();return m.addObject(_,2),console.log(m,t),this._transformerControlMap.set(u,_),this.onCreateControlObservable.notifyObservers(_),_}_getTopScene(){var t;return null==(t=this.getScene().getEngine())?void 0:t.activeScene}_moving(t,e,n){const{scrollX:r,scrollY:s}=Tl(n),o=t-this._viewportScrollX+r,i=e-this._viewportScrollY+s,a=o-this._startOffsetX,l=i-this._startOffsetY;this._selectedObjectMap.forEach((t=>{t.translate(a+t.left,l+t.top)})),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:a,moveY:l,type:1}),this._startOffsetX=o,this._startOffsetY=i}_updateActiveObjectList(t,e){this._selectedObjectMap.has(t.oKey)||(e.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(t.oKey,t),this._createControl(t))}_addCancelObserver(t){t.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=t.onPointerDownObserver.add((e=>{this._selectedObjectMap.clear(),this._clearControl(),t.onPointerDownObserver.remove(this._cancelFocusObserver)}))}}class Yc{constructor(t,e,n){var r;if(this._parent=e,this.onPointerDownObserver=new i,this.onPointerMoveObserver=new i,this.onPointerUpObserver=new i,this.onDblclickObserver=new i,this.onMouseWheelObserver=new i,this.onKeyDownObservable=new i,this.onKeyUpObservable=new i,this.onTransformChangeObservable=new i,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new ll,this._isFirstDirty=!0,this._evented=!0,this._cursor=Wi.DEFAULT,this._transformerOpenState=!1,this._sceneKey=t,n&&this.transformByState(n),this._parent.classType===Zi.ENGINE){const e=this._parent;e.addScene(this),e.hasActiveScene()||e.setActiveScene(t),this._inputManager=new Al(this)}else if(this._parent.classType===Zi.SCENE_VIEWER){this._parent.addSubScene(this)}null==(r=this._parent)||r.onTransformChangeObservable.add((t=>{this._resetViewportSize(),this._setTransForm()}))}get classType(){return Zi.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const t=this.getParent();let e=1;return t.classType===Zi.SCENE_VIEWER&&(e=t.ancestorScaleX),this._scaleX*e}get ancestorScaleY(){const t=this.getParent();let e=1;return t.classType===Zi.SCENE_VIEWER&&(e=t.ancestorScaleY),this._scaleY*e}get cursor(){return this._cursor}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(t){this._transform=t}set cursor(t){this.setCursor(t)}set width(t){this._width=t}set height(t){this._height=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}attachControl(t=!0,e=!0,n=!0,r=!0){var s;if(this._parent.classType===Zi.ENGINE)return null==(s=this._inputManager)||s.attachControl(t,e,n,r),this}detachControl(){var t;return null==(t=this._inputManager)||t.detachControl(),this}makeDirty(t=!0){var e;return this._viewports.forEach((e=>{e.makeDirty(t)})),this._parent.classType===Zi.SCENE_VIEWER&&(null==(e=this._parent)||e.makeDirty(t)),this}makeDirtyNoParent(t=!0){return this._viewports.forEach((e=>{e.makeDirty(t)})),this}isDirty(){for(let t=0;t<this._viewports.length;t++){if(!0===this._viewports[t].isDirty())return!0}return!1}resetCursor(){this.setCursor(Wi.DEFAULT)}setCursor(t){this._cursor=t;const e=this.getEngine();if(!e)return;e.getCanvas().getCanvasEle().style.cursor=t}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const r=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:r}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const r=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:r}}),this}scaleBy(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX+=t);const r=this.scaleY;return void 0!==e&&(this.scaleY+=e),this.scaleX=Ha(this.scaleX,1),this.scaleY=Ha(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:r}}),this}transformByState(t){const e=Object.keys(t),n={};0!==e.length&&(e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:fa.all,value:t,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===Zi.ENGINE)return this._parent;let t=this._parent;for(;t;){if(t.classType===Zi.ENGINE)return t;t=null==t?void 0:t.getParent()}return null}getLayers(){return this._layers}getLayer(t=1){for(let e of this._layers)if(e.zIndex===t)return e;return this._createDefaultLayer(t)}getLayerMaxZIndex(){let t=Number.MIN_VALUE;for(let e=0;e<this._layers.length;e++){const n=this._layers[e];n.zIndex>=t&&(t=n.zIndex)}return t}addLayer(...t){this._layers.push(...t)}addObject(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObject(t),this}setObjectBehavior(t){t.parent||(t.parent=this),this.onTransformChangeObservable.add((e=>{t.scaleCacheCanvas()})),t.onIsAddedToParentObserver.notifyObservers(this)}addObjects(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObjects(t),this}removeObject(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObject(t);return this}removeObjects(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObjects(t);return this}getAllObjects(){const t=[];this._layers.sort(yr);for(let e of this._layers)t.push(...e.getObjectsByOrder());return t}getAllObjectsByOrder(t=!1){const e=[],n=t?Rr:yr;this._layers.sort(n);for(let r of this._layers)e.push(...r.getObjectsByOrder().sort(n));return e}getAllObjectsByOrderForPick(t=!1){const e=[],n=t?Rr:yr;this._layers.sort(n);for(let r of this._layers)e.push(...r.getObjectsByOrderForPick().sort(n));return e}getObject(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)if(e.oKey===t)return e}}fuzzyMathObjects(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)e.oKey.indexOf(t)>-1&&n.push(e)}return[]}addViewport(...t){return this._viewports.push(...t),this}removeViewport(){}getViewports(){return this._viewports}getViewport(t){for(let e of this._viewports)if(e.viewPortKey===t)return e}changeObjectOrder(){}renderObjects(t,e){return this.getAllObjectsByOrder().forEach((n=>{n.render(t,e)})),this}render(t){var e,n;this.isDirty()&&(!t&&(null==(e=this.getEngine())||e.getCanvas().clear()),null==(n=this.getViewports())||n.forEach((e=>e.render(t))))}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}async requestRender(t){return new Promise(((e,n)=>{this.render(t),Ia(e)}))}openTransformer(t){this._transformer||(this._transformer=new Vc(this,t)),this._transformerOpenState=!0}closeTransformer(t=!1){t&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(t){var e;this._transformerOpenState&&(null==(e=this._transformer)||e.attachTo(t))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(t){return this._viewports.find((e=>e.isHit(t)))}getActiveViewportByCoord(t){return t=this.getRelativeCoord(t),this.getActiveViewportByRelativeCoord(t)}getRelativeCoord(t){let e=this.getParent();const n=[];for(;e;)e.classType!==Zi.SCENE&&e.classType!==Zi.SCENE_VIEWER||n.push(e),e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent());n.reverse();for(let r of n)if(r.classType===Zi.SCENE){const e=r.getActiveViewportByCoord(t);if(e){const n=e.actualScrollX||0,r=e.actualScrollY||0;t=t.addByPoint(n,r)}}else if(r.classType===Zi.SCENE_VIEWER){t=r.transform.clone().invert().applyPoint(t)}return t}transformToSceneCoord(t){const e=this.getActiveViewportByCoord(t);return null==e?void 0:e.getRelativeVector(t)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var t;this.getLayers().forEach((t=>{t.dispose()})),this.getViewports().forEach((t=>{t.dispose()})),this.clearLayer(),this.clearViewports(),this.detachControl(),null==(t=this._transformer)||t.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(t){let e=this.getActiveViewportByCoord(t);if(e||(e=this._viewports[0]),!this._evented||!e)return;const n=e.pickScrollBar(t);if(n)return n;const r=e.getRelativeVector(t);let s=null;const o=this.getAllObjectsByOrderForPick().reverse(),i=o.length;for(let a=0;a<i;a++){const t=o[a];if(!t.visible||!t.evented||t.classType===Zi.GROUP)continue;let e=r;if(t.isInGroup&&t.parent.classType===Zi.GROUP){const{cumLeft:n,cumTop:r}=this._getGroupCumLeftRight(t);e=e.clone().add(il.FromArray([-n,-r]))}if(t.isHit(e)){if(t.classType===Zi.SCENE_VIEWER){const n=t.pick(e);s=n||t.getActiveSubScene()}else s=t;break}if(t.classType===Zi.SCENE_VIEWER&&t.allowSelectedClipElement()){const n=t.pick(e);if(n){s=n;break}}}return s||this._parent.classType!==Zi.ENGINE?s:this}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}remove(t){this[`on${t}Observer`].clear()}triggerKeyDown(t){this.onKeyDownObservable.notifyObservers(t)}triggerKeyUp(t){this.onKeyUpObservable.notifyObservers(t)}triggerPointerUp(t){var e,n;return!(!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Zi.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerMouseWheel(t){var e,n;return!(!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Zi.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerMove(t){var e,n;return!(!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Zi.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerDblclick(t){var e,n;return!(!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Zi.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerPointerDown(t){var e,n;return!(!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Zi.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerOut(t){var e;return this._parent.classType!==Zi.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e;return this._parent.classType!==Zi.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return this._parent.classType!==Zi.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e;return this._parent.classType!==Zi.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerEnter(t),!1)}_createDefaultLayer(t=1){const e=Rl.create(this,[],t);return this.addLayer(e),e}_resetViewportSize(){this.getViewports().forEach((t=>{t.resetSize()}))}_setTransForm(){const t=ll.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=t,this.getViewports().forEach((t=>{t.resizeScrollBar()})),this.makeDirty(!0)}_getGroupCumLeftRight(t){let e=t.parent,n=0,r=0;for(;e.classType===Zi.GROUP;){const{left:t,top:s}=e;n+=t,r+=s,e=e.parent}return{cumLeft:n,cumTop:r}}}class Gc extends Cl{constructor(t,e){super(t),this._subScenes=new Map,this._allowSelectedClipElement=!1,this._initialProps(e)}get classType(){return Zi.SCENE_VIEWER}render(t,e){var n;if(!this.visible)return this.makeDirty(!1),this;if(e){const{minX:t,maxX:n,minY:r,maxY:s}=wl(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<r||s<0)return this}const r=this.transform.getMatrix();return t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),null==(n=this._activeSubScene)||n.makeDirtyNoParent(!0).render(t),t.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(t){for(let[e,n]of this._subScenes)if(e===t)return n}addSubScene(t){this._activeSubScene=t,this._subScenes.set(t.sceneKey,t),this.makeDirty()}removeSubScene(t){const e=this._subScenes.get(t);this._subScenes.delete(t),this._activeSubScene===e&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(t){if(null==t)return;const e=this._subScenes.get(t);this._activeSubScene!==e&&(this._activeSubScene=e,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(t){var e;if(void 0===this._activeSubScene)return;const n=this.transform.clone().invert().applyPoint(t);return null==(e=this._activeSubScene)?void 0:e.pick(n)}dispose(){super.dispose(),this._subScenes.forEach((t=>{t.dispose()}))}_initialProps(t){if(!t)return;const e=Object.keys(t);if(0===e.length)return;const n={};let r=!1;e.forEach((e=>{if(void 0===t[e])return!0;n[e]=t[e],r=!0})),r&&this.transformByState(n),this.makeDirty(!0)}}(Hc=Bc||(Bc={}))[Hc.scrollTo=0]="scrollTo",Hc[Hc.scrollBy=1]="scrollBy";class Xc{constructor(t,e,n){var r;this.scrollX=0,this.scrollY=0,this.onMouseWheelObserver=new i,this.onScrollAfterObserver=new i,this.onScrollBeforeObserver=new i,this.onScrollStopObserver=new i,this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this._viewPortKey=t,this._scene=e,this.top=(null==n?void 0:n.top)||0,this.left=(null==n?void 0:n.left)||0,this.bottom=(null==n?void 0:n.bottom)||0,this.right=(null==n?void 0:n.right)||0,(null==n?void 0:n.width)&&(this.width=null==n?void 0:n.width,this._widthOrigin=this.width),(null==n?void 0:n.height)&&(this.height=null==n?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new El),this._isWheelPreventDefaultX=(null==n?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(null==n?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),null==(r=this._scene)||r.getParent().onTransformChangeObservable.add((()=>{this._resizeCacheCanvasAndScrollBar()}))}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}set width(t){this._width=t}set height(t){this._height=t}set top(t){var e,n;this._topOrigin=t,this._top=Ra(t,null==(n=null==(e=this._scene)?void 0:e.getParent())?void 0:n.height)}set left(t){var e;this._leftOrigin=t,this._left=Ra(t,null==(e=this.scene.getParent())?void 0:e.width)}set bottom(t){var e;this._bottomOrigin=t,this._bottom=Ra(t,null==(e=this.scene.getParent())?void 0:e.height)}set right(t){var e;this._rightOrigin=t,this._right=Ra(t,null==(e=this.scene.getParent())?void 0:e.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(t){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=t,this._resizeCacheCanvasAndScrollBar()}resize(t){const e=Object.keys(t);0!==e.length&&(this._width=void 0,this._height=void 0,e.forEach((e=>{void 0!==t[e]&&(this[e]=t[e])})),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}makeDirty(t=!0){this._dirty=t}isDirty(){return this._dirty}scrollTo(t){return this._scroll(0,t)}scrollBy(t){return this._scroll(1,t)}getBarScroll(t,e){let n=t,r=e;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,r*=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)*t,r=Math.round(r)*e}else void 0!==this.scrollX&&(n=this.scrollX),void 0!==this.scrollY&&(r=this.scrollY);return{x:n,y:r}}getActualScroll(t,e){let n=t,r=e;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,r/=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)/t,r=Math.round(r)/e}else void 0!==this.actualScrollX&&(n=this.actualScrollX),void 0!==this.actualScrollY&&(r=this.actualScrollY);return{x:n,y:r}}transformScroll(){let t=this.scrollX,e=this.scrollY;return this.getActualScroll(t,e)}getScrollBar(){return this._scrollBar}updateScroll(t){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:e,scrollY:n,actualScrollX:r,actualScrollY:s}=t;return void 0!==e&&(this.scrollX=e),void 0!==n&&(this.scrollY=n),void 0!==r&&(this.actualScrollX=r),void 0!==s&&(this.actualScrollY=s),this}getScrollBarTransForm(t=!1){const e=ll.create();return!t&&this._allowCache||e.multiply(ll.create([1,0,0,1,this._left,this._top])),e}render(t){var e;const n=t||(null==(e=this._scene.getEngine())?void 0:e.getCanvas().getContext());if(!this.isDirty()&&this._allowCache)return void this._applyCache(n);let r=this._scene.transform.clone();r.multiply(ll.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=n;if(!s)return;const o=this._getApplyCanvasState();o&&(r.multiply(ll.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const i=r.getMatrix(),a=this.getScrollBarTransForm().getMatrix();s.save(),!o&&this._renderClipState&&(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(s),s.restore()),o&&this._applyCache(n),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(t){const e=this.scene.transform.clone().invert(),n=this.transformScroll();return e.applyPoint(t).add(il.FromArray([n.x,n.y]))}getAbsoluteVector(t){const e=this.scene.transform.clone(),n=this.transformScroll();return e.applyPoint(t).subtract(il.FromArray([n.x,n.y]))}onMouseWheel(t,e){if(!this._scrollBar)return;let n;if(t.inputIndex===_a.MouseWheelX){const r=Math.abs(t.deltaX),s=this._scene.width;let o=(this.width||1)/s*r;n=t.deltaX>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===Zi.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()}if(t.inputIndex===_a.MouseWheelY){const r=Math.abs(t.deltaY),s=this._scene.height;let o=(this.height||1)/s*r;t.shiftKey?(n=t.deltaY>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===Zi.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()):(n=t.deltaY>0?this.scrollBy({y:o}):this.scrollBy({y:-o}),this._scene.getParent().classType===Zi.SCENE_VIEWER?(null==n?void 0:n.isLimitedY)||e.stopPropagation():this._isWheelPreventDefaultY?t.preventDefault():(null==n?void 0:n.isLimitedY)||t.preventDefault())}t.inputIndex,_a.MouseWheelZ}isHit(t){const{width:e,height:n}=this._getViewPortSize();return t.x>=this.left&&t.x<=this.left+e&&t.y>=this.top&&t.y<=this.top+n}pickScrollBar(t){if(!this._scrollBar)return;const e=this.getScrollBarTransForm(!0).invert().applyPoint(t);return this._scrollBar.pick(e)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var t;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),null==(t=this._scrollBar)||t.dispose()}_resizeCacheCanvasAndScrollBar(t=!1){var e;const{width:n,height:r}=this._getViewPortSize(t);this.width=n,this.height=r;const s=this._scene.width*this._scene.scaleX,o=this._scene.height*this._scene.scaleY;null==(e=this._scrollBar)||e.resize(n,r,s,o),this.makeDirty(!0)}_getViewPortSize(t=!1){var e;const n=null==(e=this._scene)?void 0:e.getParent();let r,s;if(t||void 0===this._widthOrigin){const t=n.width;r=(n.classType===Zi.SCENE_VIEWER?t*n.scaleX:t)-(this._left+this._right)}else r=this._widthOrigin;if(t||void 0===this._heightOrigin){const t=n.height;s=(n.classType===Zi.SCENE_VIEWER?t*n.scaleY:t)-(this._top+this._bottom)}else s=this._heightOrigin;return{width:r,height:s}}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var t,e;if(!this._scrollBar)return;const n=(null==(t=this._scrollBar)?void 0:t.limitX)||1/0,r=(null==(e=this._scrollBar)?void 0:e.limitY)||1/0;let s=!0,o=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>n?this.scrollX=n:s=!1,this.scrollY<0?this.scrollY=0:this.scrollY>r?this.scrollY=r:o=!1,{isLimitedX:s,isLimitedY:o}}_triggerScrollStop(t,e,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout((()=>{var r,s;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:e,y:n,actualScrollX:t.x,actualScrollY:t.y,limitX:null==(r=this._scrollBar)?void 0:r.limitX,limitY:null==(s=this._scrollBar)?void 0:s.limitY})}),0)}_scroll(t,e){var n,r,s,o;const{x:i,y:a}=e;void 0!==i&&(1===t?this.scrollX+=i:this.scrollX=i),void 0!==a&&(1===t?this.scrollY+=a:this.scrollY=a);const l=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:i,y:a,limitX:null==(n=this._scrollBar)?void 0:n.limitX,limitY:null==(r=this._scrollBar)?void 0:r.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const h=this.transformScroll();return this.actualScrollX=h.x,this.actualScrollY=h.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:i,y:a,actualScrollX:h.x,actualScrollY:h.y,limitX:null==(s=this._scrollBar)?void 0:s.limitX,limitY:null==(o=this._scrollBar)?void 0:o.limitY}),this._triggerScrollStop(h,i,a),l}_calViewportRelativeBounding(){var t,e,n,r;let s=null!=(e=null==(t=this._scrollBar)?void 0:t.ratioScrollX)?e:1,o=null!=(r=null==(n=this._scrollBar)?void 0:n.ratioScrollY)?r:1,i=this.left,a=(this.width||0)+this.left,l=this.top,h=(this.height||0)+this.top,c=0,d=0;null!=this._preScrollX&&(c=(this._preScrollX-this.scrollX)/s),null!=this._preScrollY&&(d=(this._preScrollY-this.scrollY)/o);const u={tl:il.FromArray([i,l]),tr:il.FromArray([a,l]),bl:il.FromArray([i,h]),br:il.FromArray([a,h]),dx:c,dy:d};return u.tl=this.getRelativeVector(u.tl),u.tr=this.getRelativeVector(u.tr),u.bl=this.getRelativeVector(u.bl),u.br=this.getRelativeVector(u.br),u}drawScrollbar(t){if(!this._scrollBar)return;const e=this._scene.getParent();(e.classType===Zi.SCENE_VIEWER||e.classType===Zi.ENGINE)&&this._scrollBar.render(t)}_applyCache(t){if(!t)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,r=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,this.left,this.top,this.width||0,this.height||0)}}(Uc=Fc||(Fc={}))[Uc.OFF=0]="OFF",Uc[Uc.ON=1]="ON";class jc extends uc{constructor(t,e){super(t),this._skeleton=e}getSkeleton(){return this._skeleton}updateSkeleton(t){this._skeleton=t}render(t,e){if(!this.visible)return this.makeDirty(!1),this;t.save(),this._draw(t,e),t.restore()}getParentScale(){let{scaleX:t=1,scaleY:e=1}=this.parent;return this.parent.classType===Zi.SCENE_VIEWER&&(t=this.parent.ancestorScaleX||1,e=this.parent.ancestorScaleY||1),{scaleX:t,scaleY:e}}_getBounding(t,e,n){const r=t.length,s=e.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:s-1};let o=-1,i=-1,a=-1,l=-1;return o=d(t,n.tl.y),i=d(t,n.bl.y),-1===o&&(o=0),-1===i&&(i=r-1),i>=r&&(i=r-1),a=d(e,n.tl.x),l=d(e,n.tr.x),-1===a&&(a=0),-1===l&&(l=s-1),l>=s&&(l=s-1),{startRow:o-1,endRow:i+1,startColumn:a-1,endColumn:l+1}}_draw(t,e){}}class $c extends jc{_draw(t,e){this.draw(t,e)}}(Wc=zc||(zc={}))[Wc.GRID=0]="GRID";class Kc extends pc{constructor(){super(...arguments),this.type=0}getCellIndex(t,e,n,r,s){return Ja(t,e,n,r,s)}}class qc extends Kc{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(t,e,n){const{rowTitleWidth:r,columnTitleHeight:s,dataMergeCache:o,stylesCache:i}=n,{background:a}=i;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:h,columnWidthAccumulation:c,rowTotalHeight:d}=n;if(!l||!c||void 0===h||void 0===d)return;t.save();const{scaleX:u=1,scaleY:g=1}=e;a&&Object.keys(a).forEach((e=>{const n=a[e];t.fillStyle=e||ya([255,255,255]),t.beginPath(),n.forEach(((e,n)=>{n.forEach((n=>{let{isMerged:r,startY:s,endY:i,startX:a,endX:h}=this.getCellIndex(e,n,l,c,o);if(r)return!0;s=Fa(s,g),i=Fa(i,g),a=Fa(a,u),h=Fa(h,u),t.moveTo(a,s),t.lineTo(a,i),t.lineTo(h,i),t.lineTo(h,s)}))})),t.closePath(),t.fill()})),t.restore()}}_c.add(new qc);class Zc extends Kc{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(t,e,n){const{rowColumnSegment:r,rowTitleWidth:s,columnTitleHeight:o,dataMergeCache:i,stylesCache:a,overflowCache:l}=n,{border:h}=a;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const{scaleX:p=1,scaleY:_=1}=e,m=this._getScale(e);let f,v;null==h||h.forEach(((e,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:s,startY:o,endY:a,startX:h,endX:d}=this.getCellIndex(e,n,c,u,i);if(s)return!0;o=Fa(o,_),a=Fa(a,_),h=Fa(h,p),d=Fa(d,p);for(let i in r){const{type:s,style:c,color:u}=r[i];this._getOverflowExclusion(l,s,e,n)||(c!==f&&(cl(t,c),t.lineWidth=dl(c)/m,f=c),u!==v&&(t.strokeStyle=u||Xi,v=u),hl(t,s,{startX:h,startY:o,endX:d,endY:a}))}}))})),t.closePath(),t.restore()}_getOverflowExclusion(t,e,n,r){let s=!1;return e===ji.TOP||e===ji.BOTTOM||t&&t.forEach(((t,r)=>{if(t!==n)return!0;r.forEach(((t,n)=>{const{startColumn:r,endColumn:o}=n;return e===ji.LEFT&&t>r&&t<=o||e===ji.RIGHT&&t>=r&&t<o?(s=!0,!1):void 0}))})),s}}_c.add(new Zc);class Jc extends Kc{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0,dataMergeCache:i,overflowCache:a,stylesCache:l,showGridlines:h}=n,{startRow:c,endRow:d,startColumn:u,endColumn:g}=r;if(!n||h===be.FALSE)return;const{rowHeightAccumulation:p,columnTotalWidth:_,columnWidthAccumulation:m,rowTotalHeight:f}=n;if(!p||!m||void 0===_||void 0===f)return;t.save();const v=this._getScale(e);t.beginPath(),t.lineWidth=1/v,t.strokeStyle=ya([217,217,217]);let b=Fa(_,v),C=Fa(f,v);const T=m.length,w=p.length;for(let S=c-1;S<=d;S++){if(S<0||S>w-1)continue;const e=Fa(p[S],v);t.moveTo(0,e),t.lineTo(b,e)}for(let S=u;S<=g;S++){if(S<0||S>T-1)continue;const e=Fa(m[S],v);t.moveTo(e,0),t.lineTo(e,C)}t.stroke(),t.closePath(),this._clearRectangle(t,v,p,m,i),this._clearRectangle(t,v,p,m,a),t.restore()}_clearRectangle(t,e,n,r,s){null==s||s.forEach(((s,o)=>{null==o||o.forEach(((s,o)=>{const{startRow:i,endRow:a,startColumn:l,endColumn:h}=o,c=Fa(n[i-1]||0,e),d=Fa(n[a],e),u=Fa(r[l-1]||0,e),g=Fa(r[h],e);t.clearRect(u,c,g-u,d-c),t.beginPath(),t.moveTo(u,c),t.lineTo(g,c),t.lineTo(g,d),t.lineTo(u,d),t.lineTo(u,c),t.stroke(),t.closePath()}))}))}}_c.add(new Jc);class Qc extends Kc{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(t,e,n){this.changeFontColor.setValue(t,e,n)}draw(t,e,n){const{rowColumnSegment:r,rowTitleWidth:s,columnTitleHeight:o,stylesCache:i,dataMergeCache:a,overflowCache:l}=n,{font:h}=i;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const p=this._getScale(e),{scaleX:_=1,scaleY:m=1}=e;h&&Object.keys(h).forEach((e=>{h[e].forEach(((e,n)=>{n.forEach(((n,r)=>{let{isMerged:s,isMergedMainCell:o,startY:i,endY:h,startX:d,endX:g,mergeInfo:f}=this.getCellIndex(e,n,c,u,a);if(s)return!0;i=Fa(i,m),h=Fa(h,m),d=Fa(d,_),g=Fa(g,_);const v=g-d,b=h-i,C=l.getValue(e,n),{horizontalAlign:T}=r;if(t.save(),t.beginPath(),C){const{startColumn:r,startRow:s,endColumn:o,endRow:a}=C;r===o&&r===n?t.rect(d,i,v,b):T===ae.CENTER?this._clipRectangle(t,s,a,r,o,p,c,u):T===ae.RIGHT?this._clipRectangle(t,s,e,r,n,p,c,u):this._clipRectangle(t,e,a,n,o,p,c,u)}else t.rect(d,i,v,b);t.clip(),t.translate(d,i),this._renderDocuments(t,r,d,i,g,h,e,n),t.restore()}))}))})),t.restore()}_renderDocuments(t,e,n,r,s,o,i,a){const l=this.getDocuments(),{documentSkeleton:h,angle:c,verticalAlign:d,horizontalAlign:u,wrapStrategy:g,content:p}=e,_=s-n,m=o-r;g===de.WRAP&&0===c&&(h.updateDocumentDataPageSize(_),h.calculate()),h.makeDirty(!1),l.resize(_,m),l.changeSkeleton(h).render(t)}_clipRectangle(t,e,n,r,s,o,i,a){const l=Fa(i[e-1]||0,o),h=Fa(i[n],o),c=Fa(a[r-1]||0,o),d=Fa(a[s],o);t.rect(c,l,d-c,h-l)}}_c.add(new Qc);class td extends Kc{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:i,endRow:a,startColumn:l,endColumn:h}=r;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const p=this._getScale(e);t.fillStyle=ya([248,249,250]),t.fillRect(0,0,s,g),t.textAlign="center",t.textBaseline="middle",t.fillStyle=ya([0,0,0]),t.beginPath(),t.lineWidth=1/p,t.strokeStyle=ya([217,217,217]);let _=0;const m=c.length;for(let f=i-1;f<=a;f++){if(f<0||f>m-1)continue;const e=Fa(c[f],p);if(_===e)continue;t.moveTo(0,e),t.lineTo(s,e);const n=_+(e-_)/2;t.fillText(`${f+1}`,s/2,n+1),_=e}t.moveTo(Fa(s,p),0),t.lineTo(Fa(s,p),g),t.stroke()}}mc.add(new td);class ed extends Kc{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:i,endRow:a,startColumn:l,endColumn:h}=r;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const p=this._getScale(e);t.fillStyle=ya([248,249,250]),t.fillRect(0,0,d,o),t.textAlign="center",t.textBaseline="middle",t.fillStyle=ya([0,0,0]),t.beginPath(),t.lineWidth=1/p,t.strokeStyle=ya([217,217,217]);let _=0;const m=u.length;for(let v=l-1;v<=h;v++){if(v<0||v>m-1)continue;const e=Fa(u[v],p);if(_===e)continue;t.moveTo(e,0),t.lineTo(e,o);const n=_+(e-_)/2;t.fillText(Tr(v),n,o/2+1),_=e}const f=Fa(o,p);t.moveTo(0,f),t.lineTo(d,f),t.stroke()}}fc.add(new ed);class nd{constructor(t=hd.NORMAL){this._type=t}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}isEqual(t){const{startColumn:e,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:a,endColumn:l,endRow:h}=t;return e===i&&n===a&&r===l&&s===h}isInclude(t){const{startColumn:e,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:a,endColumn:l,endRow:h}=t;return!(l<e||i>r||a>s||h<n)}highlightToSelection(){return Nn(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(t,e){const{startColumn:n,startRow:r,endColumn:s,endRow:o,startX:i,startY:a,endX:l,endY:h}=t;this._startColumn=n,this._startRow=r,this._endColumn=s,this._endRow=o,this._startX=i,this._startY=a,this._endX=l,this._endY=h,this.setCurrentCell(e)}setCurrentCell(t){t&&(this._currentCell=t)}clearCurrentCell(){this._currentCell=null}}const rd="rgb(1,136,251)",sd="rgba(1,136,251, 0.1)",od=2,id=6,ad=1,ld="rgb(255,255,255)";var hd,cd,dd,ud;(cd=hd||(hd={}))[cd.NORMAL=0]="NORMAL",cd[cd.ROW=1]="ROW",cd[cd.COLUMN=2]="COLUMN",(ud=dd||(dd={})).Selection="__SpreadsheetSelectionShape__",ud.top="__SpreadsheetSelectionTopControl__",ud.bottom="__SpreadsheetSelectionBottomControl__",ud.left="__SpreadsheetSelectionShapeLeftControl__",ud.right="__SpreadsheetSelectionShapeRightControl__",ud.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",ud.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",ud.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",ud.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",ud.fill="__SpreadsheetSelectionFillControl__",ud.lineMain="__SpreadsheetDragLineMainControl__",ud.lineContent="__SpreadsheetDragLineContentControl__",ud.line="__SpreadsheetDragLineControl__";class gd{constructor(t,e){this._scene=t,this._zIndex=e,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}static create(t,e){return new this(t,e)}static fromJson(t,e,n){const r=gd.create(t,e);return r.update(n),r}_updateControl(){const{startX:t,startY:e,endX:n,endY:r}=this._selectionModel;this.leftControl.resize(void 0,r-e),this.rightControl.transformByState({height:r-e,left:n-t-od/2}),this.topControl.resize(n-t+od),this.bottomControl.transformByState({width:n-t+od,top:r-e-od/2}),this.fillControl.translate(n-t-id/2,r-e-id/2),this._updateBackgroundControl(),this.selectionShape.show(),this.selectionShape.translate(t,e),this.selectionShape.makeDirty(!0)}update(t,e){this._selectionModel.setValue(t,e),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}getScene(){return this._scene}dispose(){var t,e,n,r,s,o,i,a,l,h;null==(t=this._leftControl)||t.dispose(),null==(e=this._rightControl)||e.dispose(),null==(n=this._topControl)||n.dispose(),null==(r=this._bottomControl)||r.dispose(),null==(s=this._backgroundControlTop)||s.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(i=this._backgroundControlMiddleRight)||i.dispose(),null==(a=this._backgroundControlBottom)||a.dispose(),null==(l=this._fillControl)||l.dispose(),null==(h=this._selectionShape)||h.dispose()}getCurrentCellInfo(){const t=this.model.currentCell;if(t){let e;if(t.isMerged){const n=t.mergeInfo;e={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:r,startX:s,endX:o,startY:i,endY:a}=t;e={startRow:n,endRow:n,startColumn:r,endColumn:r,startX:s,endX:o,startY:i,endY:a}}return e}}_initialize(){this._selectionModel=new nd(0);const t=this._zIndex;this._leftControl=new Dl(dd.left+t,{top:0,left:-od/2,width:od,fill:rd,zIndex:t}),this._rightControl=new Dl(dd.right+t,{width:od,fill:rd,zIndex:t}),this._topControl=new Dl(dd.top+t,{top:-od/2,left:-od/2,height:od,fill:rd,zIndex:t}),this._bottomControl=new Dl(dd.bottom+t,{height:od,fill:rd,left:-od/2,zIndex:t}),this._backgroundControlTop=new Dl(dd.backgroundTop+t,{fill:sd,zIndex:t-1,evented:!1}),this._backgroundControlBottom=new Dl(dd.backgroundBottom+t,{fill:sd,zIndex:t-1,evented:!1}),this._backgroundControlMiddleLeft=new Dl(dd.backgroundMiddleLeft+t,{fill:sd,zIndex:t-1,evented:!1}),this._backgroundControlMiddleRight=new Dl(dd.backgroundMiddleRight+t,{fill:sd,zIndex:t-1,evented:!1});const e=id-ad;this._fillControl=new Dl(dd.fill+t,{width:e,height:e,fill:rd,strokeWidth:ad,stroke:ld,zIndex:t+1}),this._selectionShape=new Ol(dd.Selection+t,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=t;this.getScene().addObject(this._selectionShape)}_updateBackgroundControl(){const{startColumn:t,startRow:e,endColumn:n,endRow:r,startX:s,startY:o,endX:i,endY:a}=this._selectionModel,l=this._selectionModel.highlightToSelection();if(!l)return this._backgroundControlTop.resize(i-s,a-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:h,startY:c,endX:d,endY:u}=l,g=od/2,p={left:-g,top:-g,width:i-s+2*g,height:c-o+g};p.height<0&&(p.width=0,p.height=0),this._backgroundControlTop.transformByState(p);const _={left:-g,top:c-o,width:h-s+g,height:u-c};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleLeft.transformByState(_);const m={left:d-s-g,top:c-o,width:i-d+2*g,height:u-c};m.width<0&&(m.width=0,m.height=0),this._backgroundControlMiddleRight.transformByState(m);const f={left:-g,top:u-o,width:i-s+2*g,height:a-u+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlBottom.transformByState(f)}}class pd{constructor(t){this._spreadsheet=t,this.hasSelection=!1,this._selectionControls=[],this._startOffsetX=0,this._startOffsetY=0,this._mainEventInitial()}static create(t){return new pd(t)}addControlToCurrentByRangeData(t,e){const n=this.getCurrentControls();if(!n)return;const r=this._spreadsheet,s=gd.create(this.getScene(),n.length);let o=null;e&&(o=r.getCellByIndex(e.row,e.column));const{startRow:i,startColumn:a,endRow:l,endColumn:h}=t,c=r.getNoMergeCellPositionByIndex(i,a),d=r.getNoMergeCellPositionByIndex(l,h);s.update({startColumn:a,startRow:i,endColumn:h,endRow:l,startY:(null==c?void 0:c.startY)||0,endY:(null==d?void 0:d.endY)||0,startX:(null==c?void 0:c.startX)||0,endX:(null==d?void 0:d.endX)||0},o),n.push(s)}getSpreadsheet(){return this._spreadsheet}getMaxIndex(){return this._spreadsheet.zIndex+1}getScene(){return this._spreadsheet.getScene()}getSkeleton(){return this._spreadsheet.getSkeleton()}getRowAndColumnCount(){const t=this.getSkeleton();return{rowCount:(null==t?void 0:t.getRowCount())||1e3,columnCount:(null==t?void 0:t.getColumnCount())||50}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const t=this.getCurrentControls();if(t&&t.length>0)for(const e of t){if(e.model.currentCell)return e}}clearSelectionControls(){let t=this.getCurrentControls();if(t.length>0){for(let e of t)e.dispose();t.length=0}}getActiveRangeList(){const t=this.getCurrentControls();if(t&&t.length>0){return null==t?void 0:t.map((t=>{const e=t.model;return{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}))}}getActiveRange(){const t=this.getCurrentControls(),e=t&&t[t.length-1].model;return e&&{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}getActiveSelection(){const t=this.getCurrentControls();return t&&t[t.length-1]}dispose(){this.clearSelectionControls(),this._moveObserver=null,this._upObserver=null}_moving(t,e,n){const r=this._spreadsheet,{startRow:s,startColumn:o,endRow:i,endColumn:a}=this._startSelectionRange,l=r.getScrollXYByRelativeCoords(il.FromArray([this._startOffsetX,this._startOffsetY])),h=Nn(r.calculateCellIndexByPosition(t,e,l));if(!h)return!1;const{startRow:c,startColumn:d,endColumn:u,endRow:g}=h,p=Math.min(c,s),_=Math.min(d,o),m=Math.max(g,i),f=Math.max(u,a),v=r.getSelectionBounding(p,_,m,f);if(!v)return!1;const{startRow:b,startColumn:C,endRow:T,endColumn:w}=v,S=r.getNoMergeCellPositionByIndex(b,C),E=r.getNoMergeCellPositionByIndex(T,w),y={startColumn:C,startRow:b,endColumn:w,endRow:T,startY:(null==S?void 0:S.startY)||0,endY:(null==E?void 0:E.endY)||0,startX:(null==S?void 0:S.startX)||0,endX:(null==E?void 0:E.endX)||0},{startRow:R,endRow:I,startColumn:A,endColumn:O}=(null==n?void 0:n.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};A===C&&R===b&&O===w&&I===T||n&&n.update(y)}_endSelection(t){var e,n;t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),null==(e=this._scrollTimer)||e.stopScroll();const r=null==(n=t.getEngine())?void 0:n.activeScene;null==r||r.onPointerDownObserver.remove(this._cancelDownObserver),null==r||r.onPointerUpObserver.remove(this._cancelUpObserver)}_addCancelObserver(){var t;const e=this.getScene(),n=null==(t=e.getEngine())?void 0:t.activeScene;null!=n&&n!==e&&(n.onPointerDownObserver.remove(this._cancelDownObserver),n.onPointerUpObserver.remove(this._cancelUpObserver),this._cancelDownObserver=n.onPointerDownObserver.add((t=>{this._endSelection(e)})),this._cancelUpObserver=n.onPointerUpObserver.add((t=>{this._endSelection(e)})))}_mainEventInitial(){const t=this._spreadsheet;t.onPointerDownObserver.add(((e,n)=>{const{offsetX:r,offsetY:s}=e,o=this.getScene(),i=o.getRelativeCoord(il.FromArray([r,s])),{x:a,y:l}=i;this._startOffsetX=a,this._startOffsetY=l;const h=t.getScrollXYByRelativeCoords(i),c=t.calculateCellIndexByPosition(a,l,h),d=Nn(c);if(!d)return!1;const{startRow:u,startColumn:g,endColumn:p,endRow:_,startY:m,endY:f,startX:v,endX:b}=d,C={startColumn:g,startRow:u,endColumn:p,endRow:_,startY:m,endY:f,startX:v,endX:b};this._startSelectionRange=C;let T=this.getCurrentControl(),w=this.getCurrentControls();if(!w)return!1;for(let t of w){if(2===e.button&&t.model.isInclude(C))return void(T=t);if(t.model.isEqual(C)){T=t;break}e.shiftKey||t.clearHighlight()}if(w.length>0&&!e.ctrlKey&&!e.shiftKey){for(let t of w)t.dispose();w.length=0}const S=T&&T.model.currentCell;if(T&&e.shiftKey&&S){const{row:e,column:n}=S,r=t.getNoMergeCellPositionByIndex(e,n),s=t.getNoMergeCellPositionByIndex(_,p),o={startColumn:n,startRow:e,endColumn:C.startColumn,endRow:C.startRow,startY:(null==r?void 0:r.startY)||0,endY:(null==s?void 0:s.endY)||0,startX:(null==r?void 0:r.startX)||0,endX:(null==s?void 0:s.endX)||0};T.update(o,S)}else T=gd.create(o,w.length+this.getMaxIndex()),T.update(C,c),w.push(T);this.hasSelection=!0,o.disableEvent(),this._endSelection(o);const E=Nl.create(this.getScene());E.startScroll(a,l),this._scrollTimer=E,this._addCancelObserver(),this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:e,offsetY:n}=t,{x:r,y:s}=o.getRelativeCoord(il.FromArray([e,n]));this._moving(r,s,T),E.scrolling(r,s,(()=>{this._moving(r,s,T)}))})),this._upObserver=o.onPointerUpObserver.add((t=>{this._endSelection(o)})),n.stopPropagation()}))}}class _d extends jc{constructor(t,e,n=!0){super(t,e),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._hasSelection=!1,this._documents=new Nc("__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__",void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new El),this.onIsAddedToParentObserver.add((t=>{var e;null==(e=null==t?void 0:t.getEngine())||e.onTransformChangeObservable.add((t=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}draw(t,e){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(e);const s=qa(r),{rowTitleWidth:o,columnTitleHeight:i}=n;t.translate(Fa(o,s)-.5/s,Fa(i,s)-.5/s),this._calculateOverflow();const a=this.getExtensionsByOrder();for(let l of a)l.draw(t,r,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return e.x>r&&e.y>s}getNoMergeCellPositionByIndex(t,e){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowTitleWidth:o,columnTitleHeight:i}=n,{scaleX:a=1,scaleY:l=1}=this.getParentScale();let{startY:h,endY:c,startX:d,endX:u}=Za(t,e,r,s);return h=Fa(h+i,l),c=Fa(c+i,l),d=Fa(d+o,a),u=Fa(u+o,a),{startY:h,endY:c,startX:d,endX:u}}calculateCellIndexByPosition(t,e,n){const r=this.getSkeleton();if(!r)return;const{x:s,y:o}=n,{rowHeightAccumulation:i,columnWidthAccumulation:a,rowTitleWidth:l,columnTitleHeight:h,dataMergeCacheAll:c}=r;t+=s-l;let u=d(i,e+=o-h),g=d(a,t);if(-1===u){u=i[i.length-1]<=e?i.length-1:0}if(-1===g){g=a[a.length-1]<=t?a.length-1:0}const{scaleX:p=1,scaleY:_=1}=this.getParentScale();let{isMerged:m,startY:f,endY:v,startX:b,endX:C,mergeInfo:T,isMergedMainCell:w}=Ja(u,g,i,a,c);return f=Fa(f+h,_),v=Fa(v+h,_),b=Fa(b+l,p),C=Fa(C+l,p),T=tl(T,l,h,p,_),{row:u,column:g,startY:f,endY:v,startX:b,endX:C,isMerged:m,isMergedMainCell:w,mergeInfo:T}}getCellByIndex(t,e){const n=this.getSkeleton();if(!n)return;const{scaleX:r=1,scaleY:s=1}=this.getParentScale(),{rowHeightAccumulation:o,columnWidthAccumulation:i,rowTitleWidth:a,columnTitleHeight:l,dataMergeCacheAll:h}=n;let{isMerged:c,startY:d,endY:u,startX:g,endX:p,mergeInfo:_,isMergedMainCell:m}=Ja(t,e,o,i,h);return d=Fa(d+l,s),u=Fa(u+l,s),g=Fa(g+a,r),p=Fa(p+a,r),_=tl(_,a,l,r,s),{row:t,column:e,startY:d,endY:u,startX:g,endX:p,isMerged:c,isMergedMainCell:m,mergeInfo:_}}getScrollXYByRelativeCoords(t){let e=0,n=0;const r=this.getParent().getActiveViewportByRelativeCoord(t);if(r){e+=r.actualScrollX||0,n+=r.actualScrollY||0}return{x:e,y:n}}getAncestorScrollXY(t,e){let n=this.getParent(),r=0,s=0,o=il.FromArray([t,e]);for(;n;){if(n.classType===Zi.SCENE){const t=n.getActiveViewportByCoord(o);if(t){r+=t.actualScrollX||0,s+=t.actualScrollY||0}}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}return{x:r,y:s}}getSelectionBounding(t,e,n,r){var s;return null==(s=this.getSkeleton())?void 0:s.getMergeBounding(t,e,n,r)}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=e;const r=this._cacheCanvas.getContext();if(n){const{dx:t=0,dy:e=0}=n;this._cacheOffsetX=t,this._cacheOffsetY=e}this._cacheCanvas.clear(),r.save(),r.setTransform(t.getTransform()),this._draw(r,n),r.restore(),this._boundsCache=e}this._applyCache(t)}else t.save(),this._draw(t,e),t.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const t=this._getAncestorSize();if(!t||null==this._cacheCanvas)return;const{width:e,height:n}=t,r=this.getSkeleton();r&&(r.rowTitleWidth,r.columnTitleHeight),this._cacheCanvas.setSize(e,n),this.makeDirty(!0)}enableSelection(){this._hasSelection||(this._selection=pd.create(this),this._hasSelection=!0)}disableSelection(){var t;null==(t=this._selection)||t.dispose(),this._hasSelection=!1}getDocsSkeletonPageSize(t,e=0){const n=null==t?void 0:t.getSkeletonData();if(!n)return;const{pages:r}=n,s=r[r.length-1];if(0===e){const{width:t,height:e}=s;return{width:t,height:e}}let o=0,i=0;const a=gl(e),l=[];lh([s],(t=>{const{lines:n,width:r,spaceWidth:s}=t,{rotatedHeight:o,rotatedWidth:a}=pl(n,r,e);i+=o,l.push({rotatedWidth:a,spaceWidth:s})}));const h=Math.tan(e),c=Math.sin(e),d=l.length;for(let u=0;u<d;u++){const{rotatedWidth:t,spaceWidth:e}=l[u];0===u&&(o+=t),(a===Ki.UP&&0===u||a===Ki.DOWN&&u===d-1)&&(o+=(t+e/c)/h)}return{width:o,height:i}}_applyCache(t){t&&(t.save(),t.setTransform(1,0,0,1,0,0),t.drawImage(this._cacheCanvas.getCanvasEle(),0,0),t.restore())}_draw(t,e){this.draw(t,e)}_getAncestorSize(){const t=this._getAncestorParent();if(t){if(t.classType===Zi.ENGINE){const e=t.getCanvas();return{width:e.getWidth(),height:e.getHeight()}}return t.classType===Zi.SCENE_VIEWER?{width:t.width,height:t.height}:void 0}}_getAncestorParent(){let t=this.parent;for(;t;){if(t.classType===Zi.ENGINE||t.classType===Zi.SCENE_VIEWER)return t;t=(null==t?void 0:t.getParent)&&(null==t?void 0:t.getParent())}}_initialDefaultExtension(){_c.getData().sort(yr).forEach((t=>{this.register(t)})),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,(t=>{t.onScrollBeforeObserver.add((()=>{this.makeDirty(!0)}))}))}_hasScrollViewportOperator(t,e){let n=t.getParent();for(;n;){if(n.classType===Zi.SCENE){const t=n.getViewports();this._getHasScrollViewports(t);for(let n of t)n&&e(n)}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}}_getHasScrollViewports(t){const e=[];for(let n of t){n.getScrollBar()&&e.push(n)}return e}_calculateOverflow(){const t=new m,e=this.getSkeleton();if(!e)return;const n=e.getColumnCount(),{stylesCache:r,rowHeightAccumulation:s,columnWidthAccumulation:o,dataMergeCache:i}=e,{font:a}=r;a&&Object.keys(a).forEach((r=>{a[r].forEach(((r,a)=>{a.forEach(((a,l)=>{let{documentSkeleton:h,angle:c=0,verticalAlign:d,horizontalAlign:u,wrapStrategy:g}=l;const p=e.getCellData().getValue(r,a),_=this.getSkeleton();if(!_)return!0;const{t:m=Te.STRING}=p||{};if(g===de.OVERFLOW&&m!==Te.NUMBER&&m!==Te.BOOLEAN&&u!==ae.JUSTIFIED){let l=this.getDocsSkeletonPageSize(h,c);if(!l)return!0;if(0!==c){let{startY:t,endY:e,startX:n,endX:h}=Ja(r,a,s,o,i);const d=h-n,u=e-t;l.height>u&&(l={width:u/Math.tan(Math.abs(c))+d,height:u})}const d=e.getOverflowPosition(l,u,r,a,n),{startColumn:g,endColumn:p}=d;t.setValue(r,a,{startRow:r,endRow:r,startColumn:g,endColumn:p})}else if(g===de.WRAP&&0!==c){let{startY:e,endY:n}=Ja(r,a,s,o,i);const l=n-e;h.updateDocumentDataPageSize(l),h.calculate();const d=this.getDocsSkeletonPageSize(h,c);if(!d)return!0;const{startColumn:g,endColumn:p}=_.getOverflowPosition(d,u,r,a,_.getColumnCount());t.setValue(r,a,{startRow:r,endRow:r,startColumn:g,endColumn:p})}}))}))})),e.setOverflowCache(t)}_differentBounds(t){if(!this._boundsCache)return t;const{tl:e,tr:n,bl:r,br:s,dx:o,dy:i}=t,{tl:a,tr:l,bl:h,br:c,dx:d,dy:u}=this._boundsCache,g={tl:e,tr:n,bl:r,br:s,dx:0,dy:0};return e.x===a.x?(e.y>a.y?(g.tl=h,g.tr=c):(g.bl=a,g.br=l),g.dy=a.y-e.y):e.y===a.y&&(e.x>a.x?(g.tl=l,g.bl=c):(g.tr=a,g.br=h),g.dx=a.x-e.x),g}_checkSheetDifferentBounds(t,e){const{tl:n,tr:r,bl:s,br:o}=t,{tl:i,tr:a,bl:l,br:h}=e;return n.x===i.x&&r.x===a.x&&s.x===l.x&&o.x===h.x?n.y>=i.y&&n.y<=l.y||s.y>=i.y&&s.y<=l.y:n.y===i.y&&r.y===a.y&&s.y===l.y&&o.y===h.y&&(n.x>=i.x&&n.x<=a.x||r.x>=i.x&&(r.x,a.x),!0)}}class md extends $c{constructor(t,e){super(t,e),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(t,e){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(e);const s=qa(r),{columnTitleHeight:o}=n;t.translate(-.5/s,Fa(o,s)-.5/s);const i=this.getExtensionsByOrder();for(let a of i)a.draw(t,r,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return e.x>=0&&e.x<=r&&e.y>s}_initialDefaultExtension(){mc.getData().forEach((t=>{this.register(t)})),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class fd extends $c{constructor(t,e){super(t,e),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}draw(t,e){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(e);const s=qa(r),{rowTitleWidth:o}=n;t.translate(Fa(o,s)-.5/s,-.5/s);const i=this.getExtensionsByOrder();for(let a of i)a.draw(t,r,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return e.x>r&&e.y>=0&&e.y<=s}_initialDefaultExtension(){fc.getData().forEach((t=>{this.register(t)})),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}}class vd extends cc{constructor(t,e,n,r){super(r),this._config=t,this._cellData=e,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateLayout(),this.updateDataMerge()}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}get dataMergeCacheAll(){return this._dataMergeCacheAll}static create(t,e,n,r){return new vd(t,e,n,r)}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}setOverflowCache(t){this._overflowCache=t}calculate(t){if(!this._config)return;if(this.updateLayout(),!this._rowHeightAccumulation||!this._columnWidthAccumulation)return;const{mergeData:e}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(t),this._dataMergeCache=e&&this._getMergeCells(e,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateLayout(){if(!this.dirty)return;const{rowData:t,columnData:e,defaultRowHeight:n,defaultColumnWidth:r,rowCount:s,columnCount:o,rowTitle:i,columnTitle:a,showGridlines:l}=this._config,{rowTotalHeight:h,rowHeightAccumulation:c}=this._generateRowMatrixCache(s,t,n),{columnTotalWidth:d,columnWidthAccumulation:u}=this._generateColumnMatrixCache(o,e,r);return this._rowTitleWidth=i.hidden!==be.TRUE?i.width:0,this._columnTitleHeight=a.hidden!==be.TRUE?a.height:0,this._rowTotalHeight=h,this._rowHeightAccumulation=c,this._columnTotalWidth=d,this._columnWidthAccumulation=u,this._showGridlines=l,this.makeDirty(!0),this}updateDataMerge(){const{mergeData:t}=this._config;this._dataMergeCacheAll=t&&this._getMergeCells(t)}getRowColumnSegment(t){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,t)}getMergeBounding(t,e,n,r){const s=this._dataMergeCacheAll;if(!s)return{startRow:t,startColumn:e,endRow:n,endColumn:r};let o=!0,i=new m;for(;o;)o=!1,s.forEach(((s,a)=>{a.forEach(((a,l)=>{if(!l||i.getValue(s,a))return!0;const{startRow:h,startColumn:c,endRow:d,endColumn:u}=l;el({left:e,top:t,right:r,bottom:n},{left:c,top:h,right:u,bottom:d})&&(t=Math.min(t,h),e=Math.min(e,c),n=Math.max(n,d),r=Math.max(r,u),i.setValue(s,a,!0),o=!0)}))}));return{startRow:t,startColumn:e,endRow:n,endColumn:r}}appendToOverflowCache(t,e,n,r){this._overflowCache.setValue(t,e,{startRow:t,endRow:t,startColumn:n,endColumn:r})}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}getOverflowPosition(t,e,n,r,s){const{width:o,height:i}=t;let a=r,l=r;return e===ae.CENTER?(a=this._getOverflowBound(n,r,0,o/2),l=this._getOverflowBound(n,r,s-1,o/2)):e===ae.RIGHT?a=this._getOverflowBound(n,r,0,o):l=this._getOverflowBound(n,r,s-1,o),{startColumn:a,endColumn:l}}_getBounding(t,e,n){const r=t.length,s=e.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:s-1};let o=-1,i=-1,a=-1,l=-1;return o=d(t,n.tl.y-this.columnTitleHeight),i=d(t,n.bl.y-this.columnTitleHeight),-1===o&&(o=0),-1===i&&(i=r-1),i>=r&&(i=r-1),a=d(e,n.tl.x-this.rowTitleWidth),l=d(e,n.tr.x-this.rowTitleWidth),-1===a&&(a=0),-1===l&&(l=s-1),l>=s&&(l=s-1),{startRow:o-1,endRow:i+1,startColumn:a-1,endColumn:l+1}}_generateRowMatrixCache(t,e,n){let r=0;const s=[],o=new p(e);for(let i=0;i<t;i++){let t=n;if(null!=o.get(i)){const e=o.get(i);if(!e)continue;null!=e.h?t=e.h:null!=e.ah&&(t=e.ah),e.hd===be.TRUE&&(t=0)}r+=t,s.push(r)}return{rowTotalHeight:r,rowHeightAccumulation:s}}_generateColumnMatrixCache(t,e,n){let r=0;const s=[],o=new p(e);for(let i=0;i<t;i++){let t=n;if(null!=o.get(i)){const e=o.get(i);if(!e)continue;null!=e.w&&(t=e.w),e.hd===be.TRUE&&(t=0)}r+=t,s.push(r)}return{columnTotalWidth:r,columnWidthAccumulation:s}}_getOverflowBound(t,e,n,r){let s=0;if(e>n){const o=this._columnWidthAccumulation.length-1;for(let i=e;i>=n;i--){const n=i;if(!Mn(this._cellData.getValue(t,n))&&n!==e||this._intersectMergeRange(t,n))return n===e?n:n+1>o?o:n+1;const{startX:a,endX:l}=Za(t,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=l-a,r<s)return n}return e}for(let o=e;o<=n;o++){const n=o;if(!Mn(this._cellData.getValue(t,n))&&n!==e||this._intersectMergeRange(t,n))return n===e?n:n-1<0?0:n-1;const{startX:i,endX:a}=Za(t,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=a-i,r<s)return n}return n}_intersectMergeRange(t,e){const n=this.dataMergeCache;let r=!1;return null==n||n.forEach(((n,s)=>{null==s||s.forEach(((n,s)=>{const{startRow:o,endRow:i,startColumn:a,endColumn:l}=s;if(t>=o&&t<=i&&e>=a&&e<=l)return r=!0,!1}))})),r}_calculateStylesCache(){const t={background:{},font:{},border:new m},e=this.getFontLocale(),n=this._dataMergeCache,r=this._rowColumnSegment,s=this.columnWidthAccumulation,o=this._styles,i=this._cellData,{startRow:a,endRow:l,startColumn:h,endColumn:c}=r;for(let d=a;d<=l;d++){for(let n=h;n<=c;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:i,skipBackgroundAndBorder:!1},e);for(let n=0;n<h;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:i,skipBackgroundAndBorder:!0},e);for(let n=c+1;n<s.length;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:i,skipBackgroundAndBorder:!0},e)}return n&&n.forEach(((n,r)=>{r.forEach(((r,s)=>{if(!s)return!0;this.__setCellCache(n,r,{cache:t,styles:o,cellData:i,skipBackgroundAndBorder:!1},e)}))})),t}__setCellCache(t,e,n,r){const{cache:s,skipBackgroundAndBorder:o=!1,styles:i,cellData:a}=n;if(!a)return!0;const l=a.getValue(t,e);if(!l)return!0;const h=i&&i.getStyleByCell(l);if(!o&&h&&h.bg&&h.bg.rgb){const n=h.bg.rgb;s.background[n]||(s.background[n]=new m);s.background[n].setValue(t,e,n)}!o&&h&&h.bd&&(this.___setBorderProps(t,e,ji.TOP,h,s),this.___setBorderProps(t,e,ji.BOTTOM,h,s),this.___setBorderProps(t,e,ji.LEFT,h,s),this.___setBorderProps(t,e,ji.RIGHT,h,s));const c=l.m||l.v;let d,u="document";const g=this._getOtherStyle(h),p=g.textRotation||{a:0,v:be.FALSE},_=g.horizontalAlign||ae.UNSPECIFIED,f=g.verticalAlign||he.UNSPECIFIED,v=g.wrapStrategy||de.UNSPECIFIED;if(l.p){s.font[u]||(s.font[u]=new m);let{a:t=0,v:e=be.FALSE}=p,n=0,r=t;e===be.TRUE&&(n=90,r=90),d=this._updateRenderConfigAndHorizon(l.p,_,{horizontalAlign:_,verticalAlign:f,centerAngle:n,vertexAngle:r,wrapStrategy:v})}else if(c){const t=this._getFontFormat(h);u=Ua(t,r).fontString,s.font[u]||(s.font[u]=new m),d=this._getDocumentDataByStyle(c.toString(),t,g)}const b=s.font[u];let{a:C,v:T=be.FALSE}=p;if(T===be.TRUE&&(C=90),d){const n=dc.create(d,this.getContext());0!==C&&v===de.WRAP||n.calculate(),b.setValue(t,e,{documentSkeleton:n,angle:C,verticalAlign:f,horizontalAlign:_,wrapStrategy:v,content:null==c?void 0:c.toString()})}}_updateRenderConfigAndHorizon(t,e,n){var r;if(!n)return;if(!(null==(r=t.body)?void 0:r.blockElements))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.renderConfig=n;const s=t.body.blockElements;for(let o of s)if(o.blockType===I.PARAGRAPH){if(!o.paragraph)continue;o.paragraph.paragraphStyle||(o.paragraph.paragraphStyle={}),o.paragraph.paragraphStyle.horizontalAlign=e}return t}_getDocumentDataByStyle(t,e,n){const r=t.length-1,{textRotation:s={a:0,v:be.FALSE},textDirection:o=re.UNSPECIFIED,paddingData:i={t:0,r:2,b:0,l:2},horizontalAlign:a=ae.UNSPECIFIED,verticalAlign:l=he.UNSPECIFIED,wrapStrategy:h=de.UNSPECIFIED}=n,{a:c=0,v:d=be.FALSE}=s,{t:u,r:g,b:p,l:_}=i;L.NORMAL;let m=0,f=c;d===be.TRUE&&(m=90,f=90,L.TBRL);return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:r,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:a},elements:[{eId:"oneElement",st:0,ed:r,et:B.TEXT_RUN,tr:{ct:t,ts:e}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:u,marginBottom:p,marginRight:g,marginLeft:_,renderConfig:{horizontalAlign:a,verticalAlign:l,centerAngle:m,vertexAngle:f,wrapStrategy:h}}}}___setBorderProps(t,e,n,r,s){var o;const i=null==(o=r.bd)?void 0:o[n];if(!i||!s.border)return!0;const a=xn(i.cl)||Xi,l=s.border;l.getValue(t,e)||l.setValue(t,e,{[n]:{}}),l.getValue(t,e)[n]={type:n,style:i.s,color:a}}_getFontFormat(t){if(!t)return{};const{ff:e,fs:n,it:r,bl:s,ul:o,st:i,ol:a,cl:l,bg:h,bd:c}=t;return{ff:e,fs:n,it:r,bl:s,ul:o,st:i,ol:a,cl:l}}_getOtherStyle(t){if(!t)return{};const{tr:e,td:n,ht:r,vt:s,tb:o,pd:i}=t;return{textRotation:e,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:o,paddingData:i}}_getMergeCells(t,e){const n=this.columnWidthAccumulation.length-1;if(e)e={startRow:e.startRow,endRow:e.endRow,endColumn:n,startColumn:0};else{e={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:n}}const{startRow:r,startColumn:s,endRow:o,endColumn:i}=e,a=new m;for(let l=0;l<t.length;l++){const{startRow:e,endRow:n,startColumn:h,endColumn:c}=t[l];for(let t=r;t<=o;t++){let r=!1;for(let o=s;o<=i;o++)if(t>=e&&t<=n&&o>=h&&o<=c){a.setValue(e,h,{startRow:e,endRow:n,startColumn:h,endColumn:c}),r=!0;break}if(r)break}}return a}}function bd(t,e,n){t.onPointerEnterObserver.add((n=>{e(t,n)})),t.onPointerLeaveObserver.add((e=>{n(t,e)}))}var Cd,Td;(Td=Cd||(Cd={})).LEFT="__slideNavigationLeft__",Td.RIGHT="__slideNavigationRight__";const wd="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m200.746667-478.506667l1.749333-1.664 30.165333-30.165333-330.496-330.581333a42.837333 42.837333 0 0 0-60.288 0 42.538667 42.538667 0 0 0 0 60.330666l270.08 270.165334-270.08 269.952a42.496 42.496 0 0 0 0 60.288c16.64 16.64 43.861333 16.469333 60.288 0.042666l298.581334-298.368z";class Sd extends Po{constructor(){super(ze.BASE_RENDER),this._engine=new yl}static create(){return new Sd}installTo(t){t.install(this)}getEngine(){return this._engine}}var Ed,yd,Rd=Object.freeze(Object.defineProperty({__proto__:null,zh:Oi,en:Ni,RGB_PAREN:"rgb(",RGBA_PAREN:"rgba(",COLORS:Mi,get SHAPE_TYPE(){return xi},get EVENT_TYPE(){return ki},get LINK_VIEW_PORT_TYPE(){return Li},MIDDLE_CELL_POS_MAGIC_NUMBER:1,DEFAULT_FONTFACE_PLANE:Bi,DEFAULT_SKELETON_HEADER:Fi,DEFAULT_SKELETON_FOOTER:Ui,DEFAULT_MEASURE_TEXT:"0",DEFAULT_OFFSET_SPACING:1,DEFAULT_DOCUMENT_FONTSIZE:zi,get CURSOR_TYPE(){return Wi},get DOCUMENT_CONTEXT_CLIP_TYPE(){return Yi},COLOR_BLACK_RGB:Xi,get BORDER_TYPE(){return ji},get ORIENTATION_TYPE(){return Ki},get RENDER_CLASS_TYPE(){return Zi},FontCache:ta,get SkeletonType(){return ea},get BreakType(){return ra},get LineType(){return oa},get SpanType(){return aa},get PageLayoutType(){return ha},get DeviceInputEventType(){return da},EventConstants:ba,get DeviceType(){return ga},get PointerInput(){return _a},get TRANSFORM_CHANGE_OBSERVABLE_TYPE(){return fa},PerformanceMonitor:Ca,RollingAverage:Ta,INITIAL_MATRIX:al,Transform:ll,drawLineByBorderType:hl,setLineType:cl,getLineWidth:dl,calculateRectRotate:ul,getRotateOrientation:gl,getRotateOffsetAndFarthestHypotenuse:pl,Vector2:il,INITIAL_Path2:_l,Path2:ml,getColor:ya,toPx:Ra,requestNewFrame:Ia,cancelRequestFrame:Aa,createCanvasElement:Oa,createImageElement:()=>document.createElement("img"),radToDeg:Na,degToRad:Ma,getPointerPrefix:xa,IsSafari:ka,generateRandomKey:Da,getValueType:La,isFunction:Pa,isDate:function(t){return"[object Date]"===La(t)},isRegExp:function(t){return"[object RegExp]"===La(t)},isArray:function(t){return"[object Array]"===La(t)},isString:Ba,isNumber:function(t){return"[object Number]"===La(t)},isObject:function(t){return"[object Object]"===La(t)},precisionTo:Ha,fixLineWidthByScale:Fa,getFontStyleString:Ua,isSupportBoundingBox:function(t){return null!=t.measureText("").actualBoundingBoxAscent},hasChineseText:za,hasJapaneseText:Wa,hasKoreanText:function(t){return!!/[^a-zA-Z0-9\p{Hangul}]/gi.exec(t)},hasCJK:Va,hasWrappableText:function(t){return za(t)||Wa(t)},hasAllLatin:function(t){return!!/[\u0000-\u024F]/gi.exec(t)},hasBasicLatin:function(t){return!!/[\u0000-\u007F]/gi.exec(t)},hasLatinOneSupplement:function(t){return!!/[\u0080-\u00FF]/gi.exec(t)},hasLatinExtendedA:function(t){return!!/[\u0100-\u017F]/gi.exec(t)},hasLatinExtendedB:function(t){return!!/[\u0180-\u024F]/gi.exec(t)},hasArabic:Ya,hasTibetan:Ga,hasSpaceAndTab:Xa,getDPI:$a,ptToPx:function(t){return t/(72/$a())},pxToPt:Ka,ptToMM:function(t){return t*($a()/25.4)},pxToInch:function(t){return t*$a()},getScale:qa,getCellPositionByIndex:Za,getCellByIndex:Ja,mergeCellHandler:Qa,mergeInfoOffset:tl,isRectIntersect:el,injectStyle:nl,checkStyle:rl,pxToNum:sl,getSizeForDom:ol,BlockPlugin:class extends Po{dealWidthCustomBlock(t,e,n,r,s){return[]}onMapping(t){}onMounted(t){}onDestroy(){}},BulletPlugin:class extends Po{dealWidthCustomBulletOrderedSymbol(t,e,n){return""}onMapping(t){}onMounted(t){}onDestroy(){}},dealWidthCustomBlock:fl,dealWidthCustomBulletOrderedSymbol:vl,CustomObject:class extends Cl{constructor(t,e=(t=>{}),n){super(t),this._render=e,this._isHitCustom=n}toJson(){return __spreadValues({},super.toJson())}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(e&&!this.isInGroup){const{minX:t,maxX:n,minY:r,maxY:s}=wl(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();return t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._render(t),t.restore(),this.makeDirty(!1),this}isHit(t){return this._isHitCustom?this._isHitCustom(t):super.isHit(t)}},Engine:yl,BASE_OBJECT_ARRAY:bl,BaseObject:Cl,Layer:Rl,Scene:Yc,SceneViewer:Gc,Viewport:Xc,getDevicePixelRatio:Sl,Canvas:El,SceneCanvas:class extends El{constructor(t={width:0,height:0}){super(t),this.setSize(t.width,t.height)}},HitCanvas:class extends El{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.setSize(t.width,t.height)}},InputManager:Al,Group:Ol,SHAPE_OBJECT_ARRAY:Ml,Shape:xl,RECT_OBJECT_ARRAY:kl,Rect:Dl,Control:class{},Drawing:class{},Selection:class{},REGULAR_POLYGON_OBJECT_ARRAY:Ll,RegularPolygon:Pl,ScrollBar:Hl,Picture:Fl,PATH_OBJECT_ARRAY:Ul,Path:zl,CIRCLE_OBJECT_ARRAY:Wl,Circle:Vl,RICHTEXT_OBJECT_ARRAY:Mc,RichText:class extends Cl{constructor(t,e,n){super(e),this._allowCache=!1,(null==n?void 0:n.richText)?this._documentData=n.richText:n&&(this._fs=n.fs,this._ff=n.ff,this._it=n.it,this._bl=n.bl,this._ul=n.ul,this._st=n.st,this._ol=n.ol,this._bg=n.bg,this._bd=n.bd,this._cl=n.cl,this._documentData=this.convertToDocumentData(n.text||"")),this._allowCache&&(this._cacheCanvas=new El,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._context=t,this._documentSkeleton=dc.create(this._documentData,this._context),this._documents=new Nc(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(n),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:r}=t;if(e===fa.resize||e===fa.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.height=(null==t?void 0:t.height)||this.height,this._setTransForm()}}))}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var t;const e=null==(t=this._documentSkeleton)?void 0:t.getSkeletonData();if(!e)return;const{pages:n}=e,r=n[n.length-1],{width:s,height:o}=r;return{width:s,height:o}}setProps(t){if(!t)return;const e=Object.keys(t);return 0!==e.length?(e.forEach((e=>{if(void 0===t[e])return!0;-1===Mc.indexOf(e)&&(this[`_${e}`]=t[e])})),this.makeDirty(!0),this):void 0}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:t,maxX:n,minY:r,maxY:s}=wl(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();if(t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const t=this._cacheCanvas.getContext();this._cacheCanvas.clear(),t.save(),t.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(t),t.restore()}this._applyCache(t)}else this._draw(t);return t.restore(),this.makeDirty(!1),this}getContext(){return this._context}toJson(){const t={};return Mc.forEach((e=>{this[e]&&(t[e]=this[e])})),__spreadValues(__spreadValues({},super.toJson()),t)}_draw(t){this._documents.render(t)}convertToDocumentData(t){const e=t.length;return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:e,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:e,et:B.TEXT_RUN,tr:{ct:t,ts:{fs:this._fs||14,ff:this._ff,it:this._it,bl:this._bl,ul:this._ul,st:this._st,ol:this._ol,bg:this._bg,bd:this._bd,cl:this._cl}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(t){this._documentSkeleton.updateDocumentDataPageSize(null==t?void 0:t.width,null==t?void 0:t.height),this._documentSkeleton.calculate();const e=this.getDocsSkeletonPageSize();this.transformByState({width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,left:(null==t?void 0:t.left)||0,top:(null==t?void 0:t.top)||0,angle:null==t?void 0:t.angle}),this.setProps(t),this.makeDirty(!0)}_applyCache(t){if(!t||!this._cacheCanvas)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,r=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}},Skeleton:cc,ComponentExtension:pc,SpreadsheetExtensionRegistry:_c,SheetRowTitleExtensionRegistry:mc,SheetColumnTitleExtensionRegistry:fc,DocumentsSpanAndLineExtensionRegistry:vc,RenderComponent:uc,createSkeletonColumn:function(t=0,e,n=k.NONE,r=1/0){const{left:s,width:o,spaceWidth:i}=function(t=0,e,n){let r=0,s=0,o=0;for(let i=0;i<=t;i++){const{width:t,paddingEnd:a}=e[i];i===e.length-1?(r=n===1/0?n-r:t,s=0):(s=a,r=t,o+=r+s)}return{width:r,spaceWidth:s,left:o-r-s}}(t,e,r);return{lines:[],left:s,width:o,height:0,spaceWidth:i,separator:n,st:0,ed:0,drawingLRIds:[],isFull:!1}},createSkeletonLine:Lh,calculateLineTopByDrawings:Ph,setDivideFullState:Hh,setLineMarginBottom:function(t,e){t.marginBottom=e},updateDivideInLine:function(t){},isParagraphStart:Yh,createAndUpdateBlockAnchor:Gh,addSpanToDivide:Xh,createSkeletonPage:oc,createSkeletonSection:uh,setColumnFullState:gh,createSkeletonWordSpan:wh,createSkeletonLetterSpan:Sh,createSkeletonTabSpan:Eh,createSkeletonBulletSpan:Rh,setSpanGroupLeft:Ih,setSpanLeft:function(t,e=0){t.left=e},Liquid:wc,getLastPage:Yl,getLastSection:Gl,getLastColumn:function(t){const e=Gl(t).columns;return null==e?void 0:e[e.length-1]},getLastLine:Xl,getLastLineByColumn:jl,getPageContentWidth:$l,getPreLine:function(t){const e=t.parent,n=null==e?void 0:e.lines.indexOf(t);if(n&&-1!==n&&!(n-1<0))return null==e?void 0:e.lines[n-1]},getColumnByDivide:Kl,getLastNotFullColumnInfo:ql,getLastNotFullDivideInfo:Zl,getNextDivide:function(t,e){const n=t.divides.indexOf(e);if(-1!==n)return t.divides[n+1]},getLastRemainingDivide:function(t){if(t)for(let e=0;e<t.divides.length;e++){const n=t.divides[e],r=t.divides[e+1];if(0===n.spanGroup.length)return n;if(!r||0===r.spanGroup.length)return n}},getLastSpan:function(t){var e;const n=null==(e=Zl(t))?void 0:e.divide.spanGroup;return null==n?void 0:n[n.length-1]},isColumnFull:Jl,isBlankPage:Ql,isBlankColumn:th,reCalculateLineDivide:function(){},getNumberUnitValue:eh,getCharSpaceApply:nh,validationGrid:rh,getLineHeightConfig:sh,getCharSpaceConfig:oh,updateBlockIndex:ih,spanIterator:function(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t){const{lines:t}=n;for(let n of t){const{divides:t,lineHeight:r}=n,s=t.length;for(let n=0;n<s;n++){const r=t[n],{spanGroup:s}=r;for(let t of s)e&&Pa(e)&&e(t)}}}}}},lineIterator:ah,columnIterator:lh,getPositionHorizon:hh,getPositionVertical:ch,getPositionHorizonBySpan:function(t,e){},getSpanGroupWidth:dh,dealWidthBullet:vh,getDefaultBulletSke:bh,getBulletOrderedSymbol:_h,dealWidthInlineDrawing:function(t,e,n,r,s,o){return[]},composeCharForLanguage:Ah,calculateParagraphLayout:jh,dealWidthParagraph:tc,dealWidthTextRun:Qh,TableOfContents:class{},dealWithBlockError:nc,dealWithBlocks:rc,dealWidthBlocksByMultiColumnAndContinuous:function(){},get DocumentSkeletonState(){return kh},DocumentSkeleton:dc,Documents:Nc,DocumentHorizonBar:class{},DocumentVerticalBar:class{},get ShowGridlinesState(){return Fc},SheetComponent:jc,SpreadsheetTitle:$c,get SHEET_EXTENSION_TYPE(){return zc},SheetExtension:Kc,Background:qc,Border:Zc,BorderAuxiliary:Jc,Font:Qc,RowTitleLayout:td,ColumnTitleLayout:ed,Spreadsheet:_d,SpreadsheetRowTitle:md,SpreadsheetColumnTitle:fd,SpreadsheetSkeleton:vd,get SLIDE_NAVIGATION_KEY(){return Cd},Slide:class extends Gc{constructor(){super(...arguments),this.onSlideChangePageByNavigationObservable=new i,this._navigationEnabled=!1}activeFirstPage(){const t=this.getSubScenes().keys().next().value;null!=t&&this.changePage(t)}addPage(t){const e=t.sceneKey;null==this.getSubScene(e)&&(this.addSubScene(t),this.addNavigation())}changePage(t){null!==t&&(this.removeNavigation(),this.activeSubScene(t),this.addNavigation())}hasPage(t){return this.getSubScene(t)}addNavigation(){const t=this.getActiveSubScene();if(null==t||!1===this._navigationEnabled)return;const e=new zl(Cd.LEFT,{data:wd,width:60,height:60,left:90,top:(this.height-30)/2,fill:this._getArrowColor(),flipX:!0}),n=new zl(Cd.RIGHT,{data:wd,width:60,height:60,left:this.width-90,top:(this.height-30)/2,fill:this._getArrowColor()}),r=(t,e)=>{t.setCursor(Wi.POINTER),t.setProps({fill:this._getArrowColor(!0)})},s=(t,e)=>{t.setCursor(Wi.DEFAULT),t.setProps({fill:this._getArrowColor()})};bd(e,r,s),bd(n,r,s),this._addNavTrigger(e,n),t.addObjects([e,n],7)}removeNavigation(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(Cd.LEFT))||t.dispose(),null==(e=n.getObject(Cd.RIGHT))||e.dispose())}enableNav(){this._navigationEnabled=!0}disableNav(){this._navigationEnabled=!1}hiddenNav(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(Cd.LEFT))||t.hide(),null==(e=n.getObject(Cd.RIGHT))||e.hide())}showNav(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(Cd.LEFT))||t.show(),null==(e=n.getObject(Cd.RIGHT))||e.show())}renderToThumb(t,e,n=1,r=1){const s=this.getSubScene(e);null!=s&&(t.save(),t.scale(n,r),s.makeDirtyNoParent(!0).render(t),t.restore())}_getSubScenesIndex(t){if(null==t)return;const e=Array.from(this.getSubScenes()),n=e.length;let r=0;for(let i=0;i<n;i++){const[n]=e[i];if(t===n){r=i;break}}let s=r+1,o=r-1;return s=s>=n?0:s,o=o<0?n-1:o,{nextScene:e[s][1],previousScene:e[o][1]}}_addNavTrigger(t,e){t.onPointerDownObserver.add((()=>{var t;const e=this._getSubScenesIndex(null==(t=this.getActiveSubScene())?void 0:t.sceneKey),n=null==e?void 0:e.previousScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)})),e.onPointerDownObserver.add((()=>{var t;const e=this._getSubScenesIndex(null==(t=this.getActiveSubScene())?void 0:t.sceneKey),n=null==e?void 0:e.nextScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)}))}_getArrowColor(t=!1){return ya(Mi.white,t?.8:.5)}},RenderEngine:Sd,ScrollTimer:Nl},Symbol.toStringTag,{value:"Module"}));function Id(t){t.deleteObserve("onDragAndDropStartObserver"),t.deleteObserve("onDragAndDroppingObserver"),t.deleteObserve("onDragAndDropEndEndObserver"),t.deleteObserve("onFillStartObserver"),t.deleteObserve("onFillingObserver"),t.deleteObserve("onFillEndObserver"),t.deleteObserve("onChangeSelectionObserver"),t.deleteObserve("onChangeCurrentSheetObserver")}function Ad(t){t.pushToObserve("onDragAndDropStartObserver"),t.pushToObserve("onDragAndDroppingObserver"),t.pushToObserve("onDragAndDropEndEndObserver"),t.pushToObserve("onFillStartObserver"),t.pushToObserve("onFillingObserver"),t.pushToObserve("onFillEndObserver"),t.pushToObserve("onChangeSelectionObserver"),t.pushToObserve("onChangeCurrentSheetObserver")}class Od{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(t){}initialize(t,e){return this._scene=t,this._plugin=e,this._initialize(),this}_initialize(){}}(yd=Ed||(Ed={})).MAIN_SCENE="mainScene",yd.VIEW_MAIN="viewMain",yd.VIEW_TOP="viewTop",yd.VIEW_LEFT="viewLeft",yd.VIEW_LEFT_TOP="viewLeftTop",yd.SHEET_VIEW="sheetView",yd.DRAG_LINE_VIEW="dragLineView";const Nd=Go.create(),Md={selections:{}};var xd,kd,Dd;function Ld(t,e){const n=t.getContext().getPluginManager().getRequirePluginByName(ze.SPREADSHEET).getSelectionManager(),r=n.getCurrentModelsValue();return n.setModels(e),r}!function(t){t.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction"}(xd||(xd={}));class Pd extends Hr{constructor(t,e,n){super(t,e,n),this._doActionData=__spreadValues({},t);const r=this.do();this._oldActionData=__spreadProps(__spreadValues({},t),{selections:r}),this.validate()}do(){const{selections:t}=this._doActionData,e=Ld(this.getWorkSheet(),t);return this._observers.notifyObservers({type:xr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:t}=this._doActionData,e=this.do();this._oldActionData={actionName:xd.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:e}}undo(){const{selections:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:xd.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:Ld(n,t)},this._observers.notifyObservers({type:xr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Pd.NAME="SetSelectionValueAction",Br.register(Pd.NAME,Pd);class Bd{constructor(t){this._range=t}getRange(){return this._range}getRect(){return this._rect}setRect(t){this._rect=t}setRange(t){this._range=t}}class Hd{constructor(t){this._sheetId=t,this._antLineList=[]}deleteAntLineById(t){const e=this._antLineList.findIndex((e=>e.getRange().id===t));e>-1&&this._antLineList.splice(e,1)}addAntLine(t){this._antLineList.push(t)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(t){const e=this._antLineList.findIndex((e=>e.getRange().id===t));if(e>-1)return this._antLineList[e]}}(Dd=kd||(kd={})).Selection="__SelectionDragShape__",Dd.top="__TopDragControl__",Dd.bottom="__BottomDragControl__",Dd.left="__LeftDragControl__",Dd.right="__RightDragControl__";class Fd{constructor(t){this._control=t,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=t.zIndex+1,this._model=t.model,this._initialize()}static create(t){return new Fd(t)}dragEventInitial(){}dragDown(t,e){const n=this._control.getPlugin().getMainComponent(),r=this._model.getValue().selection;this._model=new jd(Wd.NORMAL,this._control.getPlugin()),this._model.setValue(r),this._updateControl();const{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let a=null;switch(e){case Ft.LEFT:a=n.calculateCellIndexByPosition(s+zd.strokeWidth,o,i);break;case Ft.TOP:a=n.calculateCellIndexByPosition(s,o+zd.strokeWidth,i);break;case Ft.RIGHT:a=n.calculateCellIndexByPosition(s-zd.strokeWidth,o,i);break;case Ft.BOTTOM:a=n.calculateCellIndexByPosition(s,o-zd.strokeWidth,i)}const l=Nn(a);if(!l)return!1;const{startRow:h,startColumn:c,endColumn:d,endRow:u,startY:g,endY:p,startX:_,endX:m}=l,f={startColumn:c,startRow:h,endColumn:d,endRow:u,startY:g,endY:p,startX:_,endX:m};this._oldSelectionRange=f,this._cellPositionOffset={top:f.startRow-this._model.startRow,bottom:this._model.endRow-f.endRow,left:f.startColumn-this._model.startColumn,right:this._model.endColumn-f.endColumn};const v=this._control.getScene();v.disableEvent();const b=Nl.create(v);b.startScroll(s,o),this._moveObserver=v.onPointerMoveObserver.add((t=>{this.dragMoving(t);const{offsetX:e,offsetY:n}=t;b.scrolling(e,n,(()=>{this.dragMoving(t)}))})),this._upObserver=v.onPointerUpObserver.add((t=>{this.dragUp(),v.onPointerMoveObserver.remove(this._moveObserver),v.onPointerUpObserver.remove(this._upObserver),v.enableEvent(),b.stopScroll()}))}dragMoving(t){const e=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:r,clientX:s,clientY:o}=t,i=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),a=Nn(e.calculateCellIndexByPosition(n,r,i));if(!a)return!1;const{startRow:l,startColumn:h,endColumn:c,endRow:d,startX:u,startY:g,endX:p,endY:_}=a,m={startColumn:h,startRow:l,endColumn:c,endRow:d,startY:g||0,endY:_||0,startX:u||0,endX:p||0},{startRow:f,endRow:v,startColumn:b,endColumn:C}=this._oldSelectionRange;if(b!==h||f!==l||C!==c||v!==d){this._oldSelectionRange=m;const{left:t,right:n,top:r,bottom:s}=this._cellPositionOffset,o=l-r,i=d+s,a=h-t,u=c+n;if(o<0||i<0||a<0||u<0)return;const g={startRow:o,endRow:i,startColumn:a,endColumn:u},p=e.getNoMergeCellPositionByIndex(g.startRow,g.startColumn),_=e.getNoMergeCellPositionByIndex(g.endRow,g.endColumn),f=Object.assign(g,{startY:(null==p?void 0:p.startY)||0,endY:(null==_?void 0:_.endY)||0,startX:(null==p?void 0:p.startX)||0,endX:(null==_?void 0:_.endX)||0});this._model.setValue(f),this._updateControl()}}dragUp(){const t=this._control.getPlugin().getMainComponent();this.hide();const{selection:e}=this._model.getValue(),n=t.getCellByIndex(e.startRow,e.startColumn);this._control.update(e,n)}_updateControl(){const{startX:t,startY:e,endX:n,endY:r}=this._model;this._leftDragControl.resize(void 0,r-e),this._rightDragControl.transformByState({height:r-e,left:n-t-zd.strokeWidth/2}),this._topDragControl.resize(n-t+zd.strokeWidth),this._bottomDragControl.transformByState({width:n-t+zd.strokeWidth,top:r-e-zd.strokeWidth/2}),this._selectionDragShape.show(),this._selectionDragShape.translate(t,e),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.hide(),this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:t,rightControl:e,topControl:n,bottomControl:r}=this._control;t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),r.onPointerEnterObserver.clear(),r.onPointerLeaveObserver.clear()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:t,rightControl:e,topControl:n,bottomControl:r,fillControl:s}=this._control;t.onPointerEnterObserver.add((e=>{t.cursor=Wi.MOVE})),t.onPointerLeaveObserver.add((e=>{t.resetCursor()})),e.onPointerEnterObserver.add((t=>{e.cursor=Wi.MOVE})),e.onPointerLeaveObserver.add((t=>{e.resetCursor()})),n.onPointerEnterObserver.add((t=>{n.cursor=Wi.MOVE})),n.onPointerLeaveObserver.add((t=>{n.resetCursor()})),r.onPointerEnterObserver.add((t=>{r.cursor=Wi.MOVE})),r.onPointerLeaveObserver.add((t=>{r.resetCursor()})),r.onPointerDownObserver.add((t=>{this.dragDown(t,Ft.BOTTOM)})),r.onPointerUpObserver.add((t=>{r.resetCursor()}));const o=this._zIndex;this._leftDragControl=new Dl(kd.left+o,{top:0,left:-zd.strokeWidth/2,width:2*zd.strokeWidth,fill:zd.strokeColor,zIndex:o}),this._rightDragControl=new Dl(kd.right+o,{width:2*zd.strokeWidth,fill:zd.strokeColor,zIndex:o}),this._topDragControl=new Dl(kd.top+o,{top:-zd.strokeWidth/2,left:-zd.strokeWidth/2,height:2*zd.strokeWidth,fill:zd.strokeColor,zIndex:o}),this._bottomDragControl=new Dl(kd.bottom+o,{height:2*zd.strokeWidth,fill:zd.strokeColor,left:-zd.strokeWidth/2,zIndex:o}),this._selectionDragShape=new Ol(kd.Selection+o,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=o;this._control.getScene().addObject(this._selectionDragShape)}}class Ud{constructor(t){this._control=t,this._initialize()}static create(t){return new Ud(t)}remove(){const{fillControl:t}=this._control;t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear()}_initialize(){const{fillControl:t}=this._control;this._control.getPlugin(),t.onPointerEnterObserver.add((e=>{t.cursor=Wi.CROSSHAIR})),t.onPointerLeaveObserver.add((e=>{t.resetCursor()}))}}const zd={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var Wd,Vd,Yd,Gd;!function(t){t[t.NORMAL=0]="NORMAL",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN"}(Wd||(Wd={})),function(t){t.Selection="__SpreadsheetSelectionShape__",t.top="__SpreadsheetSelectionTopControl__",t.bottom="__SpreadsheetSelectionBottomControl__",t.left="__SpreadsheetSelectionShapeLeftControl__",t.right="__SpreadsheetSelectionShapeRightControl__",t.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",t.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",t.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",t.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",t.fill="__SpreadsheetSelectionFillControl__",t.lineMain="__SpreadsheetDragLineMainControl__",t.lineContent="__SpreadsheetDragLineContentControl__",t.line="__SpreadsheetDragLineControl__"}(Vd||(Vd={}));class Xd{constructor(t,e){this._manager=t,this._zIndex=e,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}static create(t,e){return new this(t,e)}static fromJson(t,e,n){const r=Xd.create(t,e);return r.update(n),r}_updateControl(){const{startX:t,startY:e,endX:n,endY:r}=this._selectionModel;this.leftControl.resize(void 0,r-e),this.rightControl.transformByState({height:r-e,left:n-t-zd.strokeWidth/2}),this.topControl.resize(n-t+zd.strokeWidth),this.bottomControl.transformByState({width:n-t+zd.strokeWidth,top:r-e-zd.strokeWidth/2}),this.fillControl.translate(n-t-zd.fillSideLength/2,r-e-zd.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.show(),this.selectionShape.translate(t,e),this.selectionShape.makeDirty(!0)}update(t,e){this._selectionModel.setValue(t,e),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var t,e,n,r,s,o,i,a,l,h;null==(t=this._leftControl)||t.dispose(),null==(e=this._rightControl)||e.dispose(),null==(n=this._topControl)||n.dispose(),null==(r=this._bottomControl)||r.dispose(),null==(s=this._backgroundControlTop)||s.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(i=this._backgroundControlMiddleRight)||i.dispose(),null==(a=this._backgroundControlBottom)||a.dispose(),null==(l=this._fillControl)||l.dispose(),null==(h=this._selectionShape)||h.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}getCurrentCellInfo(){const t=this.model.currentCell;if(t){let e;if(t.isMerged){const n=t.mergeInfo;e={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:r,startX:s,endX:o,startY:i,endY:a}=t;e={startRow:n,endRow:n,startColumn:r,endColumn:r,startX:s,endX:o,startY:i,endY:a}}return e}}_initialize(){this._selectionModel=new jd(0,this._manager.getPlugin());const t=this._zIndex;this._leftControl=new Dl(Vd.left+t,{top:0,left:-zd.strokeWidth/2,width:zd.strokeWidth,fill:zd.strokeColor,zIndex:t}),this._rightControl=new Dl(Vd.right+t,{width:zd.strokeWidth,fill:zd.strokeColor,zIndex:t}),this._topControl=new Dl(Vd.top+t,{top:-zd.strokeWidth/2,left:-zd.strokeWidth/2,height:zd.strokeWidth,fill:zd.strokeColor,zIndex:t}),this._bottomControl=new Dl(Vd.bottom+t,{height:zd.strokeWidth,fill:zd.strokeColor,left:-zd.strokeWidth/2,zIndex:t}),this._backgroundControlTop=new Dl(Vd.backgroundTop+t,{fill:zd.backgroundColor,zIndex:t-1,evented:!1}),this._backgroundControlBottom=new Dl(Vd.backgroundBottom+t,{fill:zd.backgroundColor,zIndex:t-1,evented:!1}),this._backgroundControlMiddleLeft=new Dl(Vd.backgroundMiddleLeft+t,{fill:zd.backgroundColor,zIndex:t-1,evented:!1}),this._backgroundControlMiddleRight=new Dl(Vd.backgroundMiddleRight+t,{fill:zd.backgroundColor,zIndex:t-1,evented:!1});const e=zd.fillSideLength-zd.fillStrokeLength;this._fillControl=new Dl(Vd.fill+t,{width:e,height:e,fill:zd.strokeColor,strokeWidth:zd.fillStrokeLength,stroke:zd.fillStrokeColor,zIndex:t+1}),this._selectionShape=new Ol(Vd.Selection+t,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=t,this._selectionDragAndDrop=Fd.create(this),this._selectionControlFill=Ud.create(this);this.getScene().addObject(this._selectionShape)}_updateBackgroundControl(){const{startColumn:t,startRow:e,endColumn:n,endRow:r,startX:s,startY:o,endX:i,endY:a}=this._selectionModel,l=this._selectionModel.highlightToSelection();if(!l)return this._backgroundControlTop.resize(i-s,a-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:h,startY:c,endX:d,endY:u}=l,g=zd.strokeWidth/2,p={left:-g,top:-g,width:i-s+2*g,height:c-o+g};p.height<0&&(p.width=0,p.height=0),this._backgroundControlTop.transformByState(p);const _={left:-g,top:c-o,width:h-s+g,height:u-c};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleLeft.transformByState(_);const m={left:d-s-g,top:c-o,width:i-d+2*g,height:u-c};m.width<0&&(m.width=0,m.height=0),this._backgroundControlMiddleRight.transformByState(m);const f={left:-g,top:u-o,width:i-s+2*g,height:a-u+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlBottom.transformByState(f)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}}class jd{constructor(t=Wd.NORMAL,e){this._type=t,this._plugin=e}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}isEqual(t){const{startColumn:e,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:a,endColumn:l,endRow:h}=t;return e===i&&n===a&&r===l&&s===h}isInclude(t){const{startColumn:e,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:a,endColumn:l,endRow:h}=t;return!(l<e||i>r||a>s||h<n)}highlightToSelection(){return Nn(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(t,e){const{startColumn:n,startRow:r,endColumn:s,endRow:o,startX:i,startY:a,endX:l,endY:h}=t;this._startColumn=n,this._startRow=r,this._endColumn=s,this._endRow=o,this._startX=i,this._startY=a,this._endX=l,this._endY=h,this.setTypeByData(),this.setCurrentCell(e)}setCurrentCell(t){t&&(this._currentCell=t)}clearCurrentCell(){this._currentCell=null}setTypeByData(){const t=this._plugin.getWorkbook().getActiveSheet().getConfig().rowCount,e=this._plugin.getWorkbook().getActiveSheet().getConfig().columnCount;return 0===this._startRow&&this._endRow===t-1?this._type=Wd.COLUMN:0===this._startColumn&&this._endColumn===e-1?this._type=Wd.ROW:this._type=Wd.NORMAL}}(Gd=Yd||(Yd={})).lineMain="__SpreadsheetDragLineMain__",Gd.lineContent="__SpreadsheetDragLineContent__",Gd.line="__SpreadsheetDragLine__";const $d="rgb(1,136,251)",Kd=1,qd=5;var Zd,Jd,Qd,tu,eu,nu,ru;(Jd=Zd||(Zd={}))[Jd.VERTICAL=0]="VERTICAL",Jd[Jd.HORIZONTAL=1]="HORIZONTAL";class su{constructor(t){this._manager=t}getDragLine(){return this._dragLine}create(t){const{direction:e,end:n,dragUp:r,start:s}=t;this._direction=e,this._end=n,this._start=s,this._dragUp=r;const o=this._manager.getSheetView().getSpreadsheetColumnTitle().getSkeleton();if(e){const t=null==o?void 0:o.rowTitleWidth,e=null==o?void 0:o.columnTotalWidth;this._dragLineControlMain=new Dl(Yd.lineMain,{width:t,height:5,top:this._end-5,fill:$d}),this._dragLineControlContent=new Dl(Yd.lineContent,{width:e,height:1,top:this._end-1,left:t,fill:$d})}else{const t=null==o?void 0:o.columnTitleHeight,e=null==o?void 0:o.rowTotalHeight;this._dragLineControlMain=new Dl(Yd.lineMain,{width:qd,height:t,left:this._end-5,fill:$d}),this._dragLineControlContent=new Dl(Yd.lineContent,{width:Kd,height:e,top:t,left:this._end-1,fill:$d})}this._dragLine=new Ol(Yd.line,this._dragLineControlMain,this._dragLineControlContent),this._dragLine.hide(),this._dragLine.evented=!1;this._manager.getScene().addObject(this._dragLine,3)}dragDown(t){const e=this._manager.getScene();e.disableEvent(),this._state={distance:this._direction?t.clientY:t.clientX},this._dragLine.show(),this._moveObserver=e.onPointerMoveObserver.add((t=>{this.dragMoving(t)})),this._upObserver=e.onPointerUpObserver.add((t=>{this.dragUp(t),e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent()}))}dragMoving(t){if(this._direction){if(this._dragLine.cursor=Wi.ROW_RESIZE,t.clientY<this._state.distance&&this._state.distance-t.clientY>=this._end-this._start-5)return;this._dragLine.transformByState({top:t.clientY-this._state.distance})}else{if(this._dragLine.cursor=Wi.COLUMN_RESIZE,t.clientX<this._state.distance&&this._state.distance-t.clientX>=this._end-this._start-5)return;this._dragLine.transformByState({left:t.clientX-this._state.distance})}}dragUp(t){let e;this._direction?(e=t.clientY-this._state.distance,t.clientY<this._state.distance&&this._state.distance-t.clientY>=this._end-this._start-5&&(e=null)):(e=t.clientX-this._state.distance,t.clientX<this._state.distance&&this._state.distance-t.clientX>=this._end-this._start-5&&(e=null)),this._dragUp(e,t),this._dragLine.dispose()}}class ou{constructor(t){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentWidth=0,this._manager=t,this._leftTopWidth=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().width,this._content=new Dl("HighLightContent",{width:0,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._Item=new Dl("HighLightItem",{width:5,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem=new Ol("HighLightColumnTitle",this._content,this._Item),this._highlightItem.hide();this._manager.getScene().addObject(this._highlightItem,3),this._initialize()}pointerDown(t){var e,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),a=this._manager.getPlugin().getSheetContainerControl().getContentRef(),l=t.clientX+i.x-this._leftTopWidth-a.current.getBoundingClientRect().left,h=null!=(n=null==(e=r.getSkeleton())?void 0:e.columnWidthAccumulation)?n:[];for(let c=0;c<(null==h?void 0:h.length);c++)if(h[c]>=l){this._index=c;break}if(this._currentWidth=h[0],this._index&&(this._currentWidth=h[this._index]-h[this._index-1]),h[this._index]-l<=5){const e=h[this._index]+this._leftTopWidth,n=(this._index?h[this._index-1]:0)+this._leftTopWidth;this._manager.getDragLineControl().create({direction:Zd.VERTICAL,end:e,start:n,dragUp:(t,e)=>{this.setColumnWidth(t),this.highlightColumnTitle(e)}}),this._manager.getDragLineControl().dragDown(t)}this.highlightColumn()}setColumnWidth(t){const e=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();null===t?e.setColumnWidth(this._index,1,5):e.setColumnWidth(this._index,1,t+this._currentWidth),this.highlightColumn()}highlightColumn(){this._manager.clearSelectionControls();const t=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:0,startColumn:this._index,endColumn:this._index,endRow:t.getRowCount()-1},{row:0,column:this._index})}highlightColumnTitle(t){var e,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),a=this._manager.getPlugin().getSheetContainerControl().getContentRef(),l=t.clientX+i.x-this._leftTopWidth-a.current.getBoundingClientRect().left,h=null!=(n=null==(e=r.getSkeleton())?void 0:e.columnWidthAccumulation)?n:[];for(let d=0;d<(null==h?void 0:h.length);d++)if(h[d]>=l){this._index=d;break}this._currentWidth=h[0];let c=this._leftTopWidth;this._index&&(this._currentWidth=h[this._index]-h[this._index-1],c=this._leftTopWidth+h[this._index-1]),this._content.transformByState({width:this._currentWidth-5}),this._Item.transformByState({left:this._currentWidth-5}),this._highlightItem.transformByState({width:this._currentWidth,left:c}),this._highlightItem.show()}_initialize(){this._highlightItem.onPointerEnterObserver.add((t=>{this._highlightItem.show()})),this._highlightItem.onPointerMoveObserver.add((t=>{this._highlightItem.show()})),this._highlightItem.onPointerLeaveObserver.add((t=>{this._highlightItem.hide()})),this._Item.onPointerEnterObserver.add((t=>{this._Item.cursor=Wi.COLUMN_RESIZE})),this._Item.onPointerLeaveObserver.add((t=>{this._Item.resetCursor()})),this._Item.onPointerDownObserver.add((t=>{this.pointerDown(t)}))}}class iu{constructor(t){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentHeight=0,this._manager=t,this._leftTopHeight=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().height;const e=this._manager.getSheetView().getSpreadsheetSkeleton().rowTitleWidth;this._content=new Dl("RowTitleContent",{width:e,height:0,top:0,fill:"rgb(220,220,220,0.5)"}),this._Item=new Dl("RowTitleItem",{width:e,height:5,top:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem=new Ol("RowTitleGroup",this._content,this._Item),this._highlightItem.hide();this._manager.getScene().addObject(this._highlightItem,3),this._initialize()}pointerDown(t){var e,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),a=this._manager.getPlugin().getSheetContainerControl().getContentRef(),l=t.clientY+i.y-this._leftTopHeight-a.current.getBoundingClientRect().top,h=null!=(n=null==(e=r.getSkeleton())?void 0:e.rowHeightAccumulation)?n:[];for(let c=0;c<(null==h?void 0:h.length);c++)if(h[c]>=l){this._index=c;break}if(this._currentHeight=h[0],this._index&&(this._currentHeight=h[this._index]-h[this._index-1]),h[this._index]-l<=5){const e=h[this._index]+this._leftTopHeight,n=(this._index?h[this._index-1]:0)+this._leftTopHeight;this._manager.getDragLineControl().create({direction:Zd.HORIZONTAL,end:e,start:n,dragUp:this.setRowHeight.bind(this)}),this._manager.getDragLineControl().dragDown(t)}this.highlightRow()}setRowHeight(t){const e=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();null===t?e.setRowHeights(this._index,1,5):e.setRowHeights(this._index,1,t+this._currentHeight),this.highlightRow()}highlightRow(){this._manager.clearSelectionControls();const t=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:this._index,startColumn:0,endColumn:t.getColumnCount()-1,endRow:this._index},{row:this._index,column:0})}highlightRowTitle(t){var e,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),a=this._manager.getPlugin().getSheetContainerControl().getContentRef(),l=t.clientY+i.y-this._leftTopHeight-a.current.getBoundingClientRect().top,h=null!=(n=null==(e=r.getSkeleton())?void 0:e.rowHeightAccumulation)?n:[];for(let d=0;d<(null==h?void 0:h.length);d++)if(h[d]>=l){this._index=d;break}this._currentHeight=h[0];let c=this._leftTopHeight;this._index&&(this._currentHeight=h[this._index]-h[this._index-1],c=this._leftTopHeight+h[this._index-1]),this._content.transformByState({height:this._currentHeight-5}),this._Item.transformByState({top:this._currentHeight-5}),this._highlightItem.transformByState({height:this._currentHeight,top:c}),this._highlightItem.show()}_initialize(){this._highlightItem.onPointerEnterObserver.add((t=>{this._highlightItem.show()})),this._highlightItem.onPointerMoveObserver.add((t=>{this._highlightItem.show()})),this._highlightItem.onPointerLeaveObserver.add((t=>{this._highlightItem.hide()})),this._Item.onPointerEnterObserver.add((t=>{this._Item.cursor=Wi.ROW_RESIZE})),this._Item.onPointerLeaveObserver.add((t=>{this._Item.resetCursor()})),this._Item.onPointerDownObserver.add((t=>{this.pointerDown(t)}))}}class au{constructor(t){this._sheetView=t,this.hasSelection=!1,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getSheetView(){return this._sheetView}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(t){this._worksheet=t;const e=this.getWorksheetId();if(e){this._selectionModels.get(e)||this._selectionModels.set(e,[])}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const t=this.getCurrentControls();if(t&&t.length>0)for(const e of t){if(e.model.currentCell)return e}}getCurrentModels(){const t=this.getWorksheetId();if(!t)return;return this._selectionModels.get(t)||this._selectionModels.set(t,[]),this._selectionModels.get(t)}getCurrentCellModel(){const t=this.getCurrentModels();if(t&&t.length>0)for(const e of t){const t=e.currentCell;if(t)return t}}getCurrentModel(){const t=this.getCurrentModels();if(t&&t.length>0)for(const e of t){if(e.currentCell)return e}}getCurrentModelsValue(){const t=this.getCurrentModels();if(!t)return[];const e=[];for(let n of t)e.push(n.getValue());return e}renderCurrentControls(t=!0,e){const n=this.getWorksheetId();if(n){if(this._selectionControls)for(let t of this._selectionControls)t.dispose();const r=e||this._selectionModels.get(n);this._selectionControls=[],null==r||r.forEach((t=>{const e=t.currentCell,n=this._mainComponent,r=Xd.create(this,this._selectionControls.length);let s=null;e&&(s=n.getCellByIndex(e.row,e.column));const{startRow:o,startColumn:i,endRow:a,endColumn:l}=t,h=n.getNoMergeCellPositionByIndex(o,i),c=n.getNoMergeCellPositionByIndex(a,l);r.update({startColumn:i,startRow:o,endColumn:l,endRow:a,startY:(null==h?void 0:h.startY)||0,endY:(null==c?void 0:c.endY)||0,startX:(null==h?void 0:h.startX)||0,endX:(null==c?void 0:c.endX)||0},s),this._selectionControls.push(r)})),t&&this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var t;return null==(t=this._worksheet)?void 0:t.getSheetId()}addControlToCurrentByRangeData(t,e){const n=this.getCurrentControls();if(!n)return;const r=this._mainComponent,s=Xd.create(this,n.length);let o=null;e&&(o=r.getCellByIndex(e.row,e.column));const{startRow:i,startColumn:a,endRow:l,endColumn:h}=t,c=r.getNoMergeCellPositionByIndex(i,a),d=r.getNoMergeCellPositionByIndex(l,h);s.update({startColumn:a,startRow:i,endColumn:h,endRow:l,startY:(null==c?void 0:c.startY)||0,endY:(null==d?void 0:d.endY)||0,startX:(null==c?void 0:c.startX)||0,endX:(null==d?void 0:d.endX)||0},o),n.push(s),this.setSelectionModel()}clearSelectionControls(){let t=this.getCurrentControls();if(t.length>0){for(let e of t)e.dispose();t.length=0}}setSelectionModel(t){if(!this._worksheet)return;t||(t=this._selectionControls.map((t=>t.model.getValue())));const e=this._worksheet.getContext().getWorkBook(),n=e.getCommandManager();let r={sheetId:this._worksheet.getSheetId(),actionName:Pd.NAME,selections:t};r=jr.make(r).removeUndo().getAction();const s=new Fr({WorkBookUnit:e},r);n.invoke(s)}updateSelectionModel(t,e,n){const r=this.getWorksheetId();if(!this._worksheet||!r)return;const s=this._selectionModels.get(r),o=[];null==s||s.forEach(((r,s)=>{s===n?o.push({selection:t,cell:e}):o.push(r.getValue())}));const i=this._worksheet.getContext().getWorkBook(),a=i.getCommandManager();let l={sheetId:this._worksheet.getSheetId(),actionName:xd.SET_SELECTION_VALUE_ACTION,selections:o};l=jr.make(l).removeUndo().getAction();const h=new Fr({WorkBookUnit:i},l);a.invoke(h)}setModels(t){const e=this.getWorksheetId();if(!e)return;const n=t.map((({selection:t,cell:e})=>{const n=new jd(Wd.NORMAL,this._plugin);return n.setValue(t,e),n}));this._selectionModels.set(e,n)}move(t){var e,n;const r=this.getCurrentCellModel();if(!r)return;let{startRow:s,startColumn:o,endRow:i,endColumn:a}=r.mergeInfo,{row:l,column:h}=r;const c=(null==(e=this._worksheet)?void 0:e.getRowCount())||1e3,d=(null==(n=this._worksheet)?void 0:n.getColumnCount())||50;switch(t){case Ft.TOP:r.isMerged||r.isMergedMainCell?l=--s:l--,l<0&&(l=0);break;case Ft.BOTTOM:r.isMerged||r.isMergedMainCell?l=++i:l++,l>c&&(l=c);break;case Ft.LEFT:r.isMerged||r.isMergedMainCell?h=--o:h--,h<0&&(h=0);break;case Ft.RIGHT:r.isMerged||r.isMergedMainCell?h=++a:h++,h>d&&(h=d)}const u=Nn(this._mainComponent.getCellByIndex(l,h));if(!u)return;const{startRow:g,endRow:p,startColumn:_,endColumn:m}=u,f=this._mainComponent.getSelectionBounding(g,_,p,m);if(!f)return;const{startRow:v,startColumn:b,endRow:C,endColumn:T}=f;let w={startRow:v,endRow:C,startColumn:b,endColumn:T},S={row:g,column:_};this.clearSelectionControls(),this.addControlToCurrentByRangeData(w,S),this.updatePreviousSelection()}moving(t,e,n=!1){var r;const s=this._mainComponent,{offsetX:o,offsetY:i,clientX:a,clientY:l}=t,{startRow:h,startColumn:c,endRow:d,endColumn:u}=this._startSelectionRange,g=s.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),p=Nn(s.calculateCellIndexByPosition(o,i,g));if(!p)return!1;const{startRow:_,startColumn:m,endColumn:f,endRow:v}=p,b=Math.min(_,h),C=Math.min(m,c),T=Math.max(v,d),w=Math.max(f,u),S=s.getSelectionBounding(b,C,T,w);if(!S)return!1;const{startRow:E,startColumn:y,endRow:R,endColumn:I}=S,A=s.getNoMergeCellPositionByIndex(E,y),O=s.getNoMergeCellPositionByIndex(R,I),N={startColumn:y,startRow:E,endColumn:I,endRow:R,startY:(null==A?void 0:A.startY)||0,endY:(null==O?void 0:O.endY)||0,startX:(null==A?void 0:A.startX)||0,endX:(null==O?void 0:O.endX)||0},{startRow:M,endRow:x,startColumn:k,endColumn:D}=(null==e?void 0:e.model)||Me,{row:L,column:P}=(null==e?void 0:e.model.currentCell)||xe;if(k===y&&M===E&&D===I&&x===R||(e&&e.update(N),e&&(null==(r=this._plugin.getObserver("onChangeSelectionObserver"))||r.notifyObservers(e))),n)if(this._previousSelection){const{startRow:t,endRow:e,startColumn:n,endColumn:r}=this._previousSelection.selection||Me,{row:s,column:o}=this._previousSelection.cell||xe;n===y&&t===E&&r===I&&e===R&&s===L&&o===P||this.setSelectionModel()}else this.setSelectionModel()}up(t,e){this.moving(t,e,!0),this.updatePreviousSelection()}updatePreviousSelection(){let t=this.getCurrentControl();if(!t)return;const{startRow:e,endRow:n,startColumn:r,endColumn:s}=t.model,{row:o,column:i}=t.model.currentCell||xe;this._previousSelection={selection:{startRow:e,endRow:n,startColumn:r,endColumn:s},cell:{row:o,column:i}}}getActiveRangeListData(){const t=this.getCurrentModels();if(t&&t.length>0){return null==t?void 0:t.map((t=>({startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn})))}}getActiveRangeList(){var t;const e=this.getActiveRangeListData();return e&&(null==(t=this._worksheet)?void 0:t.getRangeList(e))}getActiveRangeData(){const t=this.getCurrentModels();if(t&&t.length>0)for(const e of t)if(e.currentCell)return{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}getActiveRange(){var t;const e=this.getActiveRangeData();return e&&(null==(t=this._worksheet)?void 0:t.getRange(e))}getCurrentCellData(){const t=this.getCurrentModels();if(t&&t.length>0)for(const e of t){const t=e.currentCell;if(t)return{startRow:t.row,startColumn:t.column,endRow:t.row,endColumn:t.column}}}getCurrentCell(){var t;const e=this.getCurrentCellData();return e&&(null==(t=this._worksheet)?void 0:t.getRange(e))}getDragLineControl(){return this._dragLineControl}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels(),this._dragLineControl=new su(this),this._columnTitleControl=new ou(this),this._rowTitleControl=new iu(this)}_mainEventInitial(){const t=this._mainComponent;t.onPointerDownObserver.add((e=>{var n;const{offsetX:r,offsetY:s}=e;this._startOffsetX=r,this._startOffsetY=s;const o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=t.calculateCellIndexByPosition(r,s,o),a=Nn(i);if(!a||!this._worksheet)return!1;const{startRow:l,startColumn:h,endColumn:c,endRow:d,startY:u,endY:g,startX:p,endX:_}=a,m={startColumn:h,startRow:l,endColumn:c,endRow:d,startY:u,endY:g,startX:p,endX:_};this._startSelectionRange=m;let f=this.getCurrentControl(),v=this.getCurrentControls();if(!v)return!1;for(let t of v){if(2===e.button&&t.model.isInclude(m))return void(f=t);if(t.model.isEqual(m)){f=t;break}e.shiftKey||t.clearHighlight()}if(v.length>0&&!e.ctrlKey&&!e.shiftKey){for(let t of v)t.dispose();v.length=0}const b=f&&f.model.currentCell;if(f&&e.shiftKey&&b){const{row:e,column:n}=b,r=t.getNoMergeCellPositionByIndex(e,n),s=t.getNoMergeCellPositionByIndex(d,c),o={startColumn:n,startRow:e,endColumn:m.startColumn,endRow:m.startRow,startY:(null==r?void 0:r.startY)||0,endY:(null==s?void 0:s.endY)||0,startX:(null==r?void 0:r.startX)||0,endX:(null==s?void 0:s.endX)||0};f.update(o,b)}else f=Xd.create(this,v.length),f.update(m,i),v.push(f);this.hasSelection=!0;const C=this.getScene();C.disableEvent();const T=Nl.create(this.getScene());T.startScroll(r,s),null==(n=this._plugin.getObserver("onChangeSelectionObserver"))||n.notifyObservers(f),this._moveObserver=C.onPointerMoveObserver.add((t=>{this.moving(t,f);const{offsetX:e,offsetY:n}=t;T.scrolling(e,n,(()=>{this.moving(t,f)}))})),this._upObserver=C.onPointerUpObserver.add((t=>{this.up(t,f),C.onPointerMoveObserver.remove(this._moveObserver),C.onPointerUpObserver.remove(this._upObserver),C.enableEvent(),T.stopScroll()}))}))}_rowEventInitial(){this._rowComponent.onPointerEnterObserver.add((t=>{}))}_columnEventInitial(){this._columnComponent.onPointerEnterObserver.add((t=>{}))}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add((t=>{}))}_initModels(){const t=this._plugin.getConfig().selections;Object.keys(t).forEach((e=>{const n=t[e],r=[];n.forEach((t=>{const{startColumn:e,startRow:n,endColumn:s,endRow:o}=t.selection,i=t.cell,a=new jd(Wd.NORMAL,this._plugin),l=i?{row:i.row,column:i.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:e,startRow:n,endColumn:s,endRow:o,startY:0,endY:0,startX:0,endX:0}}:null;a.setValue({startColumn:e,startRow:n,endColumn:s,endRow:o,startY:0,endY:0,startX:0,endX:0},l),r.push(a)})),this._selectionModels.set(e,r)}))}_initControls(){const t=this._plugin.getConfig().selections;Object.keys(t).forEach((e=>{const n=t[e],r=[];n.forEach((t=>{const e=t.selection,n=t.cell,s=this._mainComponent,o=Xd.create(this,r.length);let i=null;n&&(i=s.getCellByIndex(n.row,n.column));const{startRow:a,startColumn:l,endRow:h,endColumn:c}=e,d=s.getNoMergeCellPositionByIndex(a,l),u=s.getNoMergeCellPositionByIndex(h,c);o.model.setValue({startColumn:l,startRow:a,endColumn:c,endRow:h,startY:(null==d?void 0:d.startY)||0,endY:(null==u?void 0:u.endY)||0,startX:(null==d?void 0:d.startX)||0,endX:(null==u?void 0:u.endX)||0},i),r.push(o)}))}))}_initializeObserver(){var t;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this.renderCurrentControls()})),null==(t=this._worksheet)||t.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{this.renderCurrentControls()}))}}(tu=Qd||(Qd={})).MAIN="__SpreadsheetRender__",tu.ROW="__SpreadsheetRowTitle__",tu.COLUMN="__SpreadsheetColumnTitle__",tu.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__";class lu extends Od{constructor(){super(...arguments),this.viewKey=Ed.SHEET_VIEW}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(t){const e=this.getScene(),n=this._buildSkeleton(t),{rowTotalHeight:r,columnTotalWidth:s,rowTitleWidth:o,columnTitleHeight:i}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:o,height:i}),e.transformByState({width:this._columnWidthByTitle(t)+s,height:this._rowHeightByTitle(t)+r}),this._updateViewport(o,i),this._selectionManager.updateToSheet(t)}_initialize(){const t=this.getScene(),e=this.getContext().getWorkBook();let n=e.getActiveSheet();n||(n=e.getSheets()[0]);const r=this._buildSkeleton(n),{rowTotalHeight:s,columnTotalWidth:o,rowTitleWidth:i,columnTitleHeight:a}=r,l=new _d(Qd.MAIN,r),h=new md(Qd.ROW,r),c=new fd(Qd.COLUMN,r),d=new Dl(Qd.LEFT_TOP,{zIndex:2,left:-1,top:-1,width:i,height:a,fill:ya([248,249,250]),stroke:ya([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=r,this._spreadsheet=l,this._spreadsheetRowTitle=h,this._spreadsheetColumnTitle=c,this._spreadsheetLeftTopPlaceholder=d,t.addObjects([l],0),t.addObjects([h,c,d],2),t.transformByState({width:this._columnWidthByTitle(n),height:this._rowHeightByTitle(n)+s}),this._updateViewport(i,a),this._selectionManager=new au(this)}_updateViewport(t,e){const n=this.getScene(),r=t*n.scaleX,s=e*n.scaleY,o=n.getViewport(Ed.VIEW_MAIN),i=n.getViewport(Ed.VIEW_TOP),a=n.getViewport(Ed.VIEW_LEFT),l=n.getViewport(Ed.VIEW_LEFT_TOP);null==o||o.resize({left:r,top:s}),null==i||i.resize({left:r,height:s}),null==a||a.resize({top:s,width:r}),null==l||l.resize({width:r,height:s})}_buildSkeleton(t){const e=this.getContext(),n=e.getWorkBook(),r=t.getConfig();return vd.create(r,t.getCellMatrix(),n.getStyles(),e)}_rowHeightByTitle(t){const e=null==t?void 0:t.getConfig();return(null==e?void 0:e.columnTitle.height)||0}_columnWidthByTitle(t){const e=null==t?void 0:t.getConfig();return(null==e?void 0:e.rowTitle.width)||0}}Nd.add(new class{create(t,e){return(new lu).initialize(t,e)}}),function(t){t.MAIN="__SpreadsheetRender__Test",t.ROW="__SpreadsheetRowTitle__Test",t.COLUMN="__SpreadsheetColumnTitle__Test",t.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__Test"}(eu||(eu={})),function(t){t.MAIN_SCENE="mainScene_Test",t.VIEW_MAIN="viewMain_Test",t.VIEW_TOP="viewTop_Test",t.VIEW_LEFT="viewLeft_Test",t.VIEW_LEFT_TOP="viewLeftTop_Test",t.SHEET_VIEW="sheetView_Test",t.DRAG_LINE_VIEW="dragLineView_Test"}(nu||(nu={})),rt.COLUMN,ot.PARAGRAPH,z.WRAP_SQUARE,be.FALSE,F.BOTH_SIDES,y.START,y.START,y.START,y.START,S.ROMAN,y.START,S.ROMAN,y.START,S.ROMAN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,fe.SUPERSCRIPT,B.TEXT_RUN,B.TEXT_RUN,B.DRAWING,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN;class hu{constructor(t,e){this._engine=t,this._plugin=e,this._views=[],this._initialize()}getView(t){for(let e of this._views)if(e.viewKey===t)return e}getSheetView(){return this.getView(Ed.SHEET_VIEW)}updateToSheet(t){for(let e of this._views)e.updateToSheet(t)}_initialize(){const t=this._engine,e=this._plugin.getContext(),n=this._plugin.getWorkbook();let r=n.getActiveSheet();r||(r=n.getSheets()[0]);const s=r.getConfig(),o=s.rowTitle,i=s.columnTitle,a=new Yc(Ed.MAIN_SCENE,t,{width:1500,height:1e3});a.openTransformer(),this._scene=a;const l=new Xc(Ed.VIEW_MAIN,a,{left:o.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),h=new Xc(Ed.VIEW_TOP,a,{left:o.width,top:0,height:i.height,right:0,isWheelPreventDefaultX:!0}),c=new Xc(Ed.VIEW_LEFT,a,{left:0,top:i.height,bottom:0,width:o.width,isWheelPreventDefaultX:!0}),d=new Xc(Ed.VIEW_LEFT_TOP,a,{left:0,top:0,width:o.width,height:i.height,isWheelPreventDefaultX:!0});l.onScrollAfterObserver.add((t=>{const{scrollX:e,scrollY:n,actualScrollX:r,actualScrollY:s}=t;h.updateScroll({scrollX:e,actualScrollX:r}).makeDirty(!0),c.updateScroll({scrollY:n,actualScrollY:s}).makeDirty(!0)})),e.getContextObserver("onZoomRatioSheetObservable").add((t=>{this._plugin,this._scene.scale(t.zoomRatio,t.zoomRatio)})),a.addViewport(l,c,h,d).attachControl(),a.on(ki.wheel,((t,n)=>{const r=t;if(r.ctrlKey){const t=Math.abs(r.deltaX);let n=t<40?.2:t<80?.4:.2;if(n*=r.deltaY>0?-1:1,a.scaleX<1&&(n/=2),a.scaleX+n>4)a.scale(4,4);else if(a.scaleX+n<.1)a.scale(.1,.1);else{const t=e.getWorkBook().getActiveSheet(),n=r.deltaY>0?.1:-.1;t.setZoomRatio(t.getZoomRatio()+n),r.preventDefault()}}else l.onMouseWheel(r,n)})),new Hl(l),a.addLayer(Rl.create(a,[],0),Rl.create(a,[],2)),this._viewLoader(a,this._plugin),t.runRenderLoop((()=>{a.render();const e=document.getElementById("app");e&&(e.innerText=`fps:${Math.round(t.getFps()).toString()}`)}))}_viewLoader(t,e){Nd.getData().forEach((n=>{this._views.push(n.create(t,e))}))}}(ru||(ru={})).AntLine="__AntLineShape__";class cu{constructor(t){this._plugin=t}setCurrentEditRangeData(){const t=this._plugin.getSelectionManager().getCurrentCellModel();if(!t)return;let e,n;if(t.isMerged){const r=t.mergeInfo;e=r.startRow,n=r.startColumn}else e=t.row,n=t.column;this.currentEditRangeData={startRow:e,startColumn:n,endRow:e,endColumn:n}}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(t){const{startRow:e,startColumn:n,endRow:r,endColumn:s}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(e,n,r,s).setRangeData(t)}getSelectionValue(){const t=this._plugin.getSelectionManager().getActiveRange();if(!t)return"";const e=t&&t.getDisplayValue();return"string"==typeof e?e:"object"==typeof e&&null!==e?kn(e):""}getSelectionStyle(){var t;return null==(t=this._plugin.getSelectionManager().getActiveRange())?void 0:t.getTextStyle()}setSelectionValue(t){const e=this._plugin.getSelectionManager().getActiveRange();e&&("string"==typeof t&&e.setValue(t),"object"==typeof t&&e.setRangeData({p:t}))}handleBackSpace(){}handleDirection(t){}}class du{constructor(t){this._plugin=t}getPlugin(){return this._plugin}listenEventManager(){this._getCoreObserver("onUIChangeObservable").add((({name:t,value:e})=>{switch(t){case"changeZoom":{const t=this._plugin.getContext().getWorkBook();t&&t.getActiveSheet().setZoomRatio(e);break}}}))}_getCoreObserver(t){return this._plugin.getGlobalContext().getObserverManager().requiredObserver(t,"core")}}class uu{constructor(t){this.insertRow=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){const e=this._plugin.getContext().getWorkBook().getActiveSheet();null==e||e.insertRowBefore(t[0].startRow,t[0].endRow-t[0].startRow+1)}},this.deleteRow=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){const e=this._plugin.getContext().getWorkBook().getActiveSheet();null==e||e.deleteRows(t[0].startRow,t[0].endRow-t[0].startRow+1)}},this.insertColumn=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(t[0].startColumn,t[0].endColumn-t[0].startColumn+1)}},this.deleteColumn=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(t[0].startColumn,t[0].endColumn-t[0].startColumn+1)}},this.clearContent=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).clear()}},this.deleteCellLeft=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).deleteCells(0)}},this.deleteCellTop=()=>{const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).deleteCells(1)}},this._plugin=t}listenEventManager(){this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"insertRow":this.insertRow();break;case"insertColumn":this.insertColumn();break;case"deleteRow":this.deleteRow();break;case"deleteColumn":this.deleteColumn();break;case"moveTop":this.deleteCellTop();break;case"moveLeft":this.deleteCellLeft();break;case"clearContent":this.clearContent()}}))}setColumnWidth(t){if("Enter"!==t.key)return;const e=t.target.value,n=this._getSelections();if(1===(null==n?void 0:n.length)){this._plugin.getContext().getWorkBook().getActiveSheet().setColumnWidth(n[0].startColumn,n[0].endColumn-n[0].startColumn+1,Number(e))}}setRowHeight(t){if("Enter"!==t.key)return;const e=t.target.value,n=this._getSelections();if(1===(null==n?void 0:n.length)){this._plugin.getContext().getWorkBook().getActiveSheet().setRowHeights(n[0].startRow,n[0].endRow-n[0].startRow+1,Number(e))}}_getSelections(){var t;const e=null==(t=this._plugin)?void 0:t.getSelectionManager().getCurrentControls();return null==e?void 0:e.map((t=>{const e=t.model;return{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}))}}class gu{constructor(t){this._plugin=t}listenEventManager(){this._getCoreObserver("onUIChangeObservable").add((({name:t,value:e})=>{switch(t){case"deleteSheet":{const t=this._plugin.getContext().getWorkBook();t&&t.removeSheetBySheetId(e);break}case"copySheet":{const t=this._plugin.getContext().getWorkBook(),e=t.getActiveSheet(),n=this._plugin.getContext().getGenName(),r=this._plugin.getGlobalContext().getLocale(),s=e.copy(n.onlyName(`${e.getName()} ${r.get("BaseSheetLocale.CopyName")}`));t&&t.insertSheet(t.getActiveSheetIndex()+1,s.getConfig());break}case"renameSheet":{const{sheetId:t,sheetName:n}=e,r=this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheetBySheetId(t);r&&n!==r.getName()&&r.setName(n);break}case"addSheet":{const t=this._plugin.getContext().getWorkBook();t.insertSheet();const e=t.getSheetSize(),n=t.getSheets()[e-1];n&&n.activate();break}case"unHideSheet":{const t=this._plugin.getContext().getWorkBook().getSheetBySheetId(e);t&&t.showSheet();break}case"hideSheet":{const t=this._plugin.getContext().getWorkBook().getSheetBySheetId(e);t&&t.hideSheet();break}case"changeSheetColor":{const{color:t,sheetId:n}=e,r=this._plugin.getContext().getWorkBook().getSheetBySheetId(n);r&&r.setTabColor(t);break}}}))}_getCoreObserver(t){return this._plugin.getGlobalContext().getObserverManager().requiredObserver(t,"core")}}class pu{constructor(t){this._plugin=t,this._initialize()}_initialize(){Br.getCommandObservers().add((({actions:t})=>{const e=this._plugin;if(!e)return;if(!t||0===t.length)return;const n=t[0];if(e.context.getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;const r=n.getWorkBook().getActiveSheet();if(r)try{const t=e.getCanvasView();t&&(t.updateToSheet(r),e.getMainComponent().makeDirty(!0),e.getSelectionManager().renderCurrentControls(!1))}catch(s){console.info(s)}}))}}class _u{constructor(t){this._plugin=t,this._initialize()}listenEventManager(){this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"undo":this.setUndo();break;case"redo":this.setRedo()}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"fontSize":this.setFontSize(t.value);break;case"textRotation":this.setTextRotation(t.value);break;case"wrapStrategy":this.setWrapStrategy(t.value);break;case"verticalAlignment":this.setVerticalAlignment(t.value);break;case"horizontalAlignment":this.setHorizontalAlignment(t.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"borderInfo":this.setBorder(t.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"fontFamily":this.setFontFamily(t.value);break;case"fontColor":this.setFontColor(t.value);break;case"background":this.setBackground(t.value);break;case"merge":this.setMerge(t.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((t=>{switch(t.name){case"fontWeight":this.setFontWeight(t.value);break;case"fontStyle":this.setFontStyle(t.value);break;case"strikeThrough":this.setStrikeThrough(t.value);break;case"underLine":this.setUnderline(t.value)}}))}_initialize(){}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setFontColor(t)}setBackground(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setBackground(t)}setFontSize(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setFontSize(t)}setFontFamily(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setFontFamily(t)}setFontWeight(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setFontWeight(t)}setFontStyle(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setFontStyle(t)}setStrikeThrough(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setStrikeThrough(t)}setUnderline(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setUnderline(t)}setMerge(t){const e=this._plugin.getSelectionManager().getActiveRange();switch(t){case"all":null==e||e.merge();break;case"vertical":null==e||e.mergeVertically();break;case"horizontal":null==e||e.mergeAcross();break;case"cancel":null==e||e.breakApart()}}setHorizontalAlignment(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setHorizontalAlignment(t)}setVerticalAlignment(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setVerticalAlignment(t)}setWrapStrategy(t){var e;null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setWrapStrategy(t)}setTextRotation(t){var e,n;"v"===t?null==(e=this._plugin.getSelectionManager().getActiveRangeList())||e.setVerticalText(1):null==(n=this._plugin.getSelectionManager().getActiveRangeList())||n.setTextRotation(t)}setBorder(t){const e=this._plugin.getSelectionManager().getCurrentControls();e&&e.length>0&&(null==e||e.forEach((e=>{const n=e.model,r={startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(r).setBorderByType(t.type,t.color,t.style)})))}}class mu{constructor(t){this._plugin=t}}class fu extends Wr{execute(){this.actionDataList.forEach((t=>{if(null!=t.operation&&!jr.hasExtension(t))return!1;if(t.actionName===ft.INSERT_ROW_ACTION){const{sheetId:e,rowCount:n,rowIndex:r}=t,s=C.deepClone(this._plugin.getWorkbook().getConfig().namedRanges);for(let t=0;t<s.length;t++){const o=s[t].range.rangeData;if(r>o.endRow)continue;r>=o.startRow&&r<=o.endRow||(o.startRow+=n),o.endRow+=n;const i={actionName:ft.SET_NAMED_RANGE_ACTION,namedRange:s[t],sheetId:e};this.push(i)}}}))}}class vu extends Vr{get zIndex(){return 3}create(t){return new fu(t,this._plugin)}}var bu={BaseSheetLocale:{CopyName:""}},Cu={BaseSheetLocale:{CopyName:"Copy"}};class Tu extends Po{constructor(t){super(ze.SPREADSHEET),this._config=Object.assign(Md,t)}initialize(t){this.context=t,this.getGlobalContext().getLocale().load({en:Cu,zh:bu}),Ad(this),this.initConfig(),this.initController(),this.initCanvasView(),this.registerExtension()}getConfig(){return this._config}initConfig(){const t=this._config;if(!t.selections){const e=this.getContext().getWorkBook().getActiveSheet().getSheetId();t.selections={[e]:[{selection:Me}]}}}initController(){this._sheetContainerController=new pu(this),this._cellEditorController=new cu(this),this._formulaBarController=new mu(this),this._sheetBarControl=new gu(this),this._toolbarControl=new _u(this),this._rightMenuControl=new uu(this),this._countBarController=new du(this)}initCanvasView(){var t;const e=null==(t=this.getContext().getUniver().getGlobalContext().getPluginManager().getPluginByName(ze.BASE_RENDER))?void 0:t.getEngine();this._canvasEngine=e,null==this._canvasView&&(this._canvasView=new hu(e,this))}onMounted(t){this.initialize(t)}onDestroy(){super.onDestroy(),Id(this);this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._namedRangeActionExtensionFactory)}registerExtension(){const t=this.context.getCommandManager().getActionExtensionManager().getRegister();this._namedRangeActionExtensionFactory=new vu(this),t.add(this._namedRangeActionExtensionFactory)}listenEventManager(){this._countBarController.listenEventManager(),this._sheetBarControl.listenEventManager(),this._toolbarControl.listenEventManager(),this._rightMenuControl.listenEventManager()}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(Ed.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var t;return null==(t=this.getSheetView())?void 0:t.getSelectionManager()}getCurrentControls(){var t;return null==(t=this.getSelectionManager())?void 0:t.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolbarControl(){return this._toolbarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorController(){return this._cellEditorController}getFormulaBarController(){return this._formulaBarController}getSheetContainerControl(){return this._sheetContainerController}getCountBarController(){return this._countBarController}}var wu=Object.freeze(Object.defineProperty({__proto__:null,SheetPlugin:Tu,AntLine:Bd,AntLineModel:Hd,SelectionModel:jd,AntLineControl:class{constructor(t){this._plugin=t,this._antLineModelList=[],t.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this._activeSheetId=t.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})),t.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{this._activeSheetId=t.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}))}removeSheetAntLine(t=this._activeSheetId){this._removeAntLineModelBySheetId(t),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(t,e=this._activeSheetId){const n=this._findAntLineModelBySheetId(e,new Hd(e));n.addAntLine(new Bd(t)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}_removeAntLineModelBySheetId(t){const e=this._antLineModelList.findIndex((e=>e.getSheetId()!==t));e>-1&&this._antLineModelList.splice(e,1)}_findAntLineModelBySheetId(t,e){var n;return null!=(n=this._antLineModelList.find((e=>e.getSheetId()===t)))?n:e}_saveOrUpdateAntLineModel(t){for(let e=0;e<this._antLineModelList.length;e++){if(this._antLineModelList[e].getSheetId()===t.getSheetId())return void(this._antLineModelList[e]=t)}this._antLineModelList.push(t)}_createAntLineRectBySheetIdAndRange(t,e){let n=this.getWorkBook().getSheetBySheetId(t);if(null==n)throw new Error(`not found sheet from id: ${t}`);let r=n.getConfig().rowTitle.width,s=n.getConfig().columnTitle.height,o=n.getRowManager(),i=n.getColumnManager(),a=0,l=0;for(let d=e.startRow;d<e.endRow;d++)a+=o.getRowHeight(d);for(let d=e.startColumn;d<e.endColumn;d++)l+=i.getColumnWidth(d);let h=0,c=0;for(let d=0;d<=e.startRow-1;d++)c+=o.getRowHeight(d);for(let d=0;d<=e.startColumn-1;d++)h+=i.getColumnWidth(d);return new Dl(ru.AntLine,{stroke:"red",strokeWidth:2,left:h+r,top:c+s,height:a,width:l,strokeDashArray:[5],evented:!1})}_deleteSceneAllAntLineRect(){for(let t=0;t<this._antLineModelList.length;t++){let e=this._antLineModelList[t].getAntLineList();for(let t=0;t<e.length;t++){let n=e[t].getRect();n&&this.getSheetViewScene().removeObject(n)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let t=0;t<this._antLineModelList.length;t++){let e=this._antLineModelList[t],n=e.getAntLineList();if(e.getSheetId()===this._activeSheetId)for(let t=0;t<n.length;t++){let r=n[t],s=this._createAntLineRectBySheetIdAndRange(e.getSheetId(),r.getRange());r.setRect(s),console.log(s),this.getSheetViewScene().addObject(s)}}}},CellEditorController:cu,CountBarController:du,RightMenuController:uu,SelectionControlDragAndDrop:Fd,SelectionControlFill:Ud,DEFAULT_SELECTION_CONFIG:zd,get SELECTION_TYPE(){return Wd},SelectionControl:Xd,SelectionManager:au,SheetBarControl:gu,SheetContainerController:pu,SpreadsheetAction:class{},ToolbarController:_u,DEFAULT_SPREADSHEET_PLUGIN_DATA:Md,get ACTION_NAMES(){return xd},uninstall:Id,install:Ad,BaseView:Od,get CANVAS_VIEW_KEY(){return Ed},CanvasViewRegistry:Nd,CanvasView:hu},Symbol.toStringTag,{value:"Module"}));const Su="SheetUI",Eu={InsertRow:!0,InsertColumn:!0,AddRowTop:!1,AddRowBottom:!1,AddColumnLeft:!1,AddColumnRight:!1,DeleteRow:!0,DeleteColumn:!0,HideRow:!1,ShowRow:!1,RowHeight:!1,HideColumn:!1,ShowColumn:!1,ColumnWidth:!1,DeleteCell:!0,ClearContent:!0,Matrix:!1},yu={undo:!0,redo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,mergeCell:!0},Ru={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0,formulaBar:!0,rightMenu:!0,countBar:!0,sheetBar:!0},Iu={layout:{sheetContainerConfig:Ru,rightMenuConfig:Eu,toolbarConfig:yu}};var Au={spreadsheetLabel:"",spreadsheetRightLabel:" Sheets",spreadsheet:{one:"",two:"",three:""},toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:{main:"",right:""},resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:{main:"",right:""},border:{main:"",right:""},mergeCell:{main:"",right:""},horizontalAlignMode:{main:"",right:""},verticalAlignMode:{main:"",right:""},textWrapMode:{main:"",right:""},textRotateMode:{main:"",right:""},freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataValidation:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:"",borderMethod:{top:"",bottom:"",left:"",right:""},more:""},defaultFmt:{Automatic:{text:"",value:"General",example:""},Number:{text:"",value:"##0.00",example:"1000.12"},Percent:{text:"",value:"#0.00%",example:"12.21%"},PlainText:{text:"",value:"@",example:""},Scientific:{text:"",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"",value:"w",example:"120002500"},Currency:{text:"",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"24H",value:"hh:mm",example:"15:00"},DateTime:{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"",SimSun:"",SimHei:"",Kaiti:"",FangSong:"",NSimSun:"",STXinwei:"",STXingkai:"",STLiti:"",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},colorPicker:{collapse:"",customColor:"",change:"",confirmColor:"",cancelColor:""},borderLine:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{all:"",vertical:"",horizontal:"",cancel:"",overlappingError:"",partiallyError:""},textWrap:{overflow:"",wrap:"",clip:""},textRotate:{none:"",angleUp:"",angleDown:"",vertical:"",rotationUp:"90",rotationDown:"90"},sheetConfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"!"},rightClick:{copy:"",copyAs:"",cut:"",paste:"",insert:"",delete:"",insertRow:"",insertColumn:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",toTopAdd:"",toBottomAdd:"",toLeftAdd:"",toRightAdd:"",deleteSelectedRow:"",deleteSelectedColumn:"",hideSelectedRow:"",showHideRow:"",rowHeight:"",hideSelectedColumn:"",showHideColumn:"",columnWidth:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"}},Ou={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"120002500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",insertRow:"InsertRow",insertColumn:"InsertColumn",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",toTopAdd:"Towards Top Add",toBottomAdd:"Towards Bottom Add",toLeftAdd:"Towards Left Add",toRightAdd:"Towards Right Add",deleteSelectedRow:"Delete selected row",deleteSelectedColumn:"Delete selected column",hideSelectedRow:"Hide selected row",showHideRow:"Show selected row",rowHeight:"Row height",hideSelectedColumn:"Hide selected column",showHideColumn:"Show hide column",columnWidth:"Column width",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"}};function Nu(t){t.pushToObserve("onRichTextKeyDownObservable"),t.pushToObserve("onRichTextKeyUpObservable"),t.pushToObserve("onUIDidMount")}var Mu,xu,ku,Du,Lu,Pu,Bu,Hu={},Fu=[],Uu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function zu(t,e){for(var n in e)t[n]=e[n];return t}function Wu(t){var e=t.parentNode;e&&e.removeChild(t)}function Vu(t,e,n){var r,s,o,i={};for(o in e)"key"==o?r=e[o]:"ref"==o?s=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?Mu.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(o in t.defaultProps)void 0===i[o]&&(i[o]=t.defaultProps[o]);return Yu(t,i,r,s,null)}function Yu(t,e,n,r,s){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++ku:s};return null==s&&null!=xu.vnode&&xu.vnode(o),o}function Gu(){return{current:null}}function Xu(t){return t.children}function ju(t,e){this.props=t,this.context=e}function $u(t,e){if(null==e)return t.__?$u(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?$u(t):null}function Ku(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return Ku(t)}}function qu(t){(!t.__d&&(t.__d=!0)&&Du.push(t)&&!Zu.__r++||Lu!==xu.debounceRendering)&&((Lu=xu.debounceRendering)||Pu)(Zu)}function Zu(){var t,e,n,r,s,o,i,a;for(Du.sort((function(t,e){return t.__v.__b-e.__v.__b}));t=Du.shift();)t.__d&&(e=Du.length,r=void 0,s=void 0,i=(o=(n=t).__v).__e,(a=n.__P)&&(r=[],(s=zu({},o)).__v=o.__v+1,ag(a,o,s,n.__n,void 0!==a.ownerSVGElement,null!=o.__h?[i]:null,r,null==i?$u(o):i,o.__h),lg(r,o),o.__e!=i&&Ku(o)),Du.length>e&&Du.sort((function(t,e){return t.__v.__b-e.__v.__b})));Zu.__r=0}function Ju(t,e,n,r,s,o,i,a,l,h){var c,d,u,g,p,_,m,f=r&&r.__k||Fu,v=f.length;for(n.__k=[],c=0;c<e.length;c++)if(null!=(g=n.__k[c]=null==(g=e[c])||"boolean"==typeof g?null:"string"==typeof g||"number"==typeof g||"bigint"==typeof g?Yu(null,g,null,null,g):Array.isArray(g)?Yu(Xu,{children:g},null,null,null):g.__b>0?Yu(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(u=f[c])||u&&g.key==u.key&&g.type===u.type)f[c]=void 0;else for(d=0;d<v;d++){if((u=f[d])&&g.key==u.key&&g.type===u.type){f[d]=void 0;break}u=null}ag(t,g,u=u||Hu,s,o,i,a,l,h),p=g.__e,(d=g.ref)&&u.ref!=d&&(m||(m=[]),u.ref&&m.push(u.ref,null,g),m.push(d,g.__c||p,g)),null!=p?(null==_&&(_=p),"function"==typeof g.type&&g.__k===u.__k?g.__d=l=Qu(g,l,t):l=eg(t,g,u,f,p,l),"function"==typeof n.type&&(n.__d=l)):l&&u.__e==l&&l.parentNode!=t&&(l=$u(u))}for(n.__e=_,c=v;c--;)null!=f[c]&&("function"==typeof n.type&&null!=f[c].__e&&f[c].__e==n.__d&&(n.__d=ng(r).nextSibling),cg(f[c],f[c]));if(m)for(c=0;c<m.length;c++)hg(m[c],m[++c],m[++c])}function Qu(t,e,n){for(var r,s=t.__k,o=0;s&&o<s.length;o++)(r=s[o])&&(r.__=t,e="function"==typeof r.type?Qu(r,e,n):eg(n,r,r,s,r.__e,e));return e}function tg(t,e){return e=e||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){tg(t,e)})):e.push(t)),e}function eg(t,e,n,r,s,o){var i,a,l;if(void 0!==e.__d)i=e.__d,e.__d=void 0;else if(null==n||s!=o||null==s.parentNode)t:if(null==o||o.parentNode!==t)t.appendChild(s),i=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<r.length;l+=1)if(a==s)break t;t.insertBefore(s,o),i=o}return void 0!==i?i:s.nextSibling}function ng(t){var e,n,r;if(null==t.type||"string"==typeof t.type)return t.__e;if(t.__k)for(e=t.__k.length-1;e>=0;e--)if((n=t.__k[e])&&(r=ng(n)))return r;return null}function rg(t,e,n){"-"===e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||Uu.test(e)?n:n+"px"}function sg(t,e,n,r,s){var o;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof r&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||rg(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||rg(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r||t.addEventListener(e,o?ig:og,o):t.removeEventListener(e,o?ig:og,o);else if("dangerouslySetInnerHTML"!==e){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==e&&"height"!==e&&"href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(i){}"function"==typeof n||(null==n||!1===n&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,n))}}function og(t){return this.l[t.type+!1](xu.event?xu.event(t):t)}function ig(t){return this.l[t.type+!0](xu.event?xu.event(t):t)}function ag(t,e,n,r,s,o,i,a,l){var h,c,d,u,g,p,_,m,f,v,b,C,T,w,S,E=e.type;if(void 0!==e.constructor)return null;null!=n.__h&&(l=n.__h,a=e.__e=n.__e,e.__h=null,o=[a]),(h=xu.__b)&&h(e);try{t:if("function"==typeof E){if(m=e.props,f=(h=E.contextType)&&r[h.__c],v=h?f?f.props.value:h.__:r,n.__c?_=(c=e.__c=n.__c).__=c.__E:("prototype"in E&&E.prototype.render?e.__c=c=new E(m,v):(e.__c=c=new ju(m,v),c.constructor=E,c.render=dg),f&&f.sub(c),c.props=m,c.state||(c.state={}),c.context=v,c.__n=r,d=c.__d=!0,c.__h=[],c._sb=[]),null==c.__s&&(c.__s=c.state),null!=E.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=zu({},c.__s)),zu(c.__s,E.getDerivedStateFromProps(m,c.__s))),u=c.props,g=c.state,c.__v=e,d)null==E.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==E.getDerivedStateFromProps&&m!==u&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(m,v),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(m,c.__s,v)||e.__v===n.__v){for(e.__v!==n.__v&&(c.props=m,c.state=c.__s,c.__d=!1),c.__e=!1,e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(t){t&&(t.__=e)})),b=0;b<c._sb.length;b++)c.__h.push(c._sb[b]);c._sb=[],c.__h.length&&i.push(c);break t}null!=c.componentWillUpdate&&c.componentWillUpdate(m,c.__s,v),null!=c.componentDidUpdate&&c.__h.push((function(){c.componentDidUpdate(u,g,p)}))}if(c.context=v,c.props=m,c.__P=t,C=xu.__r,T=0,"prototype"in E&&E.prototype.render){for(c.state=c.__s,c.__d=!1,C&&C(e),h=c.render(c.props,c.state,c.context),w=0;w<c._sb.length;w++)c.__h.push(c._sb[w]);c._sb=[]}else do{c.__d=!1,C&&C(e),h=c.render(c.props,c.state,c.context),c.state=c.__s}while(c.__d&&++T<25);c.state=c.__s,null!=c.getChildContext&&(r=zu(zu({},r),c.getChildContext())),d||null==c.getSnapshotBeforeUpdate||(p=c.getSnapshotBeforeUpdate(u,g)),S=null!=h&&h.type===Xu&&null==h.key?h.props.children:h,Ju(t,Array.isArray(S)?S:[S],e,n,r,s,o,i,a,l),c.base=e.__e,e.__h=null,c.__h.length&&i.push(c),_&&(c.__E=c.__=null),c.__e=!1}else null==o&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=function(t,e,n,r,s,o,i,a){var l,h,c,d=n.props,u=e.props,g=e.type,p=0;if("svg"===g&&(s=!0),null!=o)for(;p<o.length;p++)if((l=o[p])&&"setAttribute"in l==!!g&&(g?l.localName===g:3===l.nodeType)){t=l,o[p]=null;break}if(null==t){if(null===g)return document.createTextNode(u);t=s?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,u.is&&u),o=null,a=!1}if(null===g)d===u||a&&t.data===u||(t.data=u);else{if(o=o&&Mu.call(t.childNodes),h=(d=n.props||Hu).dangerouslySetInnerHTML,c=u.dangerouslySetInnerHTML,!a){if(null!=o)for(d={},p=0;p<t.attributes.length;p++)d[t.attributes[p].name]=t.attributes[p].value;(c||h)&&(c&&(h&&c.__html==h.__html||c.__html===t.innerHTML)||(t.innerHTML=c&&c.__html||""))}if(function(t,e,n,r,s){var o;for(o in n)"children"===o||"key"===o||o in e||sg(t,o,null,n[o],r);for(o in e)s&&"function"!=typeof e[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===e[o]||sg(t,o,e[o],n[o],r)}(t,u,d,s,a),c)e.__k=[];else if(p=e.props.children,Ju(t,Array.isArray(p)?p:[p],e,n,r,s&&"foreignObject"!==g,o,i,o?o[0]:n.__k&&$u(n,0),a),null!=o)for(p=o.length;p--;)null!=o[p]&&Wu(o[p]);a||("value"in u&&void 0!==(p=u.value)&&(p!==t.value||"progress"===g&&!p||"option"===g&&p!==d.value)&&sg(t,"value",p,d.value,!1),"checked"in u&&void 0!==(p=u.checked)&&p!==t.checked&&sg(t,"checked",p,d.checked,!1))}return t}(n.__e,e,n,r,s,o,i,l);(h=xu.diffed)&&h(e)}catch(y){e.__v=null,(l||null!=o)&&(e.__e=a,e.__h=!!l,o[o.indexOf(a)]=null),xu.__e(y,e,n)}}function lg(t,e){xu.__c&&xu.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(n){xu.__e(n,e.__v)}}))}function hg(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(r){xu.__e(r,n)}}function cg(t,e,n){var r,s;if(xu.unmount&&xu.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||hg(r,null,e)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){xu.__e(o,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&cg(r[s],e,n||"function"!=typeof t.type);n||null==t.__e||Wu(t.__e),t.__=t.__e=t.__d=void 0}function dg(t,e,n){return this.constructor(t,n)}function ug(t,e,n){var r,s,o;xu.__&&xu.__(t,e),s=(r="function"==typeof n)?null:n&&n.__k||e.__k,o=[],ag(e,t=(!r&&n||e).__k=Vu(Xu,null,[t]),s||Hu,Hu,void 0!==e.ownerSVGElement,!r&&n?[n]:s?null:e.firstChild?Mu.call(e.childNodes):null,o,!r&&n?n:s?s.__e:e.firstChild,r),lg(o,t)}function gg(t,e){ug(t,e,gg)}function pg(t,e,n){var r,s,o,i=zu({},t.props);for(o in e)"key"==o?r=e[o]:"ref"==o?s=e[o]:i[o]=e[o];return arguments.length>2&&(i.children=arguments.length>3?Mu.call(arguments,2):n),Yu(t.type,i,r||t.key,s||t.ref,null)}function _g(t,e){var n={__c:e="__cC"+Bu++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var n,r;return this.getChildContext||(n=[],(r={})[e]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&n.some((function(t){t.__e=!0,qu(t)}))},this.sub=function(t){n.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n.splice(n.indexOf(t),1),e&&e.call(t)}}),t.children}};return n.Provider.__=n.Consumer.contextType=n}Mu=Fu.slice,xu={__e:function(t,e,n,r){for(var s,o,i;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&null!=o.getDerivedStateFromError&&(s.setState(o.getDerivedStateFromError(t)),i=s.__d),null!=s.componentDidCatch&&(s.componentDidCatch(t,r||{}),i=s.__d),i)return s.__E=s}catch(a){t=a}throw t}},ku=0,ju.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=zu({},this.state),"function"==typeof t&&(t=t(zu({},n),this.props)),t&&zu(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),qu(this))},ju.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),qu(this))},ju.prototype.render=Xu,Du=[],Pu="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Zu.__r=0,Bu=0;class mg{constructor(t,e){this._cell=t,this._value=e}getCell(){return this._cell}}class fg{constructor(){this._data=[]}static create(){return new fg}add(t){this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const vg=fg.create();class bg{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...t){this._cellEditExtensionFactoryList.push(...t),this._cellEditExtensionFactoryList.sort(yr)}delete(t){const e=this._cellEditExtensionFactoryList.indexOf(t);this._cellEditExtensionFactoryList.splice(e,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...vg.getData().sort(yr))}}class Cg{static create(){return this.register||(this.register=new bg,this.register.initialize()),this.register}handle(t){var e;const n=null==(e=null==Cg?void 0:Cg.register)?void 0:e.cellEditExtensionFactoryList;if(!n)return;this._cellEditExtensionFactoryList=n;const r=this._checkExtension(t);return r?(r.execute(),r.getCell()):void 0}_checkExtension(t){let e=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length;n++){if(e=this._cellEditExtensionFactoryList[n].check(t),!1!==e)break}return e}}class Tg{constructor(t,e){this._cell=t,this._value=e}getCell(){return this._cell}setValue(t){}execute(){}}class wg{constructor(){this._data=[]}static create(){return new wg}add(t){this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const Sg=wg.create();class Eg{constructor(){this._cellInputExtensionFactoryList=[]}get cellInputExtensionFactoryList(){return this._cellInputExtensionFactoryList}initialize(){this._initExtensions()}add(...t){this._cellInputExtensionFactoryList.push(...t),this._cellInputExtensionFactoryList.sort(yr)}delete(t){const e=this._cellInputExtensionFactoryList.indexOf(t);this._cellInputExtensionFactoryList.splice(e,1)}_initExtensions(){this._cellInputExtensionFactoryList.push(...Sg.getData().sort(yr))}}class yg{static create(){return this.register||(this.register=new Eg,this.register.initialize()),this.register}handle(t){var e;const n=null==(e=null==yg?void 0:yg.register)?void 0:e.cellInputExtensionFactoryList;if(!n)return;this._cellInputExtensionFactoryList=n;const r=this._checkExtension(t);return r?(r.execute(),r.getCell()):void 0}_checkExtension(t){let e=!1;if(!this._cellInputExtensionFactoryList)return!1;for(let n=0;n<this._cellInputExtensionFactoryList.length;n++){if(e=this._cellInputExtensionFactoryList[n].check(t),!1!==e)break}return e}}class Rg{constructor(t,e){this._data=t,this._plugin=e}execute(){}}class Ig{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...t){this._clipboardExtensionFactoryList.push(...t),this._clipboardExtensionFactoryList.sort(yr)}delete(t){const e=this._clipboardExtensionFactoryList.indexOf(t);this._clipboardExtensionFactoryList.splice(e,1)}}const Ag=class{static async writeText(t,e){var n;if(Ag.clipboard)return Ag.clipboard.writeText(t).then((()=>!0),(t=>console.dir(t)));null==(n=null==e?void 0:e.clipboardData)||n.setData("text/html",t)}static async write(t,e){var n,r,s;if(Ag.clipboard){const e=new Blob([t.data],{type:null!=(n=t.type)?n:"text/html"}),r=[new ClipboardItem({"text/html":e})];return Ag.clipboard.write(r).then((()=>!0),(()=>!1))}null==(s=null==e?void 0:e.clipboardData)||s.setData(null!=(r=t.type)?r:"text/html",t.data)}static async readText(){return Ag.clipboard?Ag.clipboard.readText().then((t=>t),(()=>null)):Ag.textArea?new Promise(((t,e)=>{t(Ag.textArea.value)})).then((t=>t)).then((()=>null)):null}static async read(t){if(Ag.clipboard){const t=await Ag.clipboard.read(),e=[];for(const n of t)for(const t of n.types){const r=await n.getType(t),s=new FileReader;"image/png"===t?s.readAsDataURL(r):s.readAsText(r);const o=new Promise(((e,n)=>{s.onload=n=>{const r={type:t,result:s.result};e(r)}})).then((t=>t),(()=>null));e.push(o)}return Promise.all(e)}const e=[],n=null==t?void 0:t.clipboardData,r=null==n?void 0:n.types;if(!r)return null;for(let s=0;s<r.length;s++)e.push({type:r[s],result:n.getData(r[s])});return e}};let Og=Ag;Og.clipboard=window.navigator.clipboard;class Ng{constructor(){this._register=new Ig}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.clipboardExtensionFactoryList;if(!n)return;this._clipboardExtensionFactoryList=n;const r=this._checkExtension(t);r&&r.execute()}pasteResolver(t){return new Promise(((e,n)=>{Og.read(t).then((t=>{var n,r;if(!t)return[];const s=t.findIndex(((t,e)=>t&&"text/html"===t.type)),o=t.findIndex(((t,e)=>t&&"text/plain"===t.type)),i={};if(s>-1){const e=null==(n=t[s])?void 0:n.result;i.html=e}if(o>-1){const e=null==(r=t[o])?void 0:r.result;i.plain=e}e(i)}))}))}_checkExtension(t){if(!this._clipboardExtensionFactoryList)return!1;let e=!1;for(let n=0;n<this._clipboardExtensionFactoryList.length;n++){if(e=this._clipboardExtensionFactoryList[n].check(t),!1!==e)break}return e}}class Mg{constructor(t,e){this._data=t,this._plugin=e}execute(){}}class xg{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...t){this._DragAndDropExtensionFactoryList.push(...t),this._DragAndDropExtensionFactoryList.sort(yr)}delete(t){const e=this._DragAndDropExtensionFactoryList.indexOf(t);this._DragAndDropExtensionFactoryList.splice(e,1)}}class kg{constructor(){this._register=new xg}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.DragAndDropExtensionFactoryList;n&&(this._DragAndDropExtensionFactoryList=n,this._checkExtension(t))}dragResolver(t){return new Promise(((e,n)=>{if(!t.dataTransfer)return;const r=[];t.dataTransfer.items?[...t.dataTransfer.items].forEach(((t,e)=>{if("file"===t.kind){const e=t.getAsFile();e&&r.push({kind:t.kind,type:t.type,file:e})}})):[...t.dataTransfer.files].forEach(((t,e)=>{t&&r.push({kind:"file",type:t.type,file:t})})),e(r)}))}_checkExtension(t){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach((e=>{const n=e.check(t);!1!==n&&n.execute()}))}}const Dg=_g({});class Lg{constructor(t){this._plugin=t,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}handleKeyboardAction(t){t.addEventListener("keydown",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyDownObservable","core"))||e.notifyObservers(t)})),t.addEventListener("keyup",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyUpObservable","core"))||e.notifyObservers(t)})),t.addEventListener("copy",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyCopyObservable","core"))||e.notifyObservers(t)})),t.addEventListener("paste",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyPasteObservable","core"))||e.notifyObservers(t)})),t.addEventListener("cut",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyCutObservable","core"))||e.notifyObservers(t)})),t.addEventListener("compositionstart",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyCompositionStartObservable","core"))||e.notifyObservers(t)})),t.addEventListener("compositionupdate",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyCompositionUpdateObservable","core"))||e.notifyObservers(t)})),t.addEventListener("compositionend",(t=>{var e;null==(e=this._observerManager.requiredObserver("onKeyCompositionEndObservable","core"))||e.notifyObservers(t)}))}_installObserver(){this._observerManager.addObserver("onKeyDownObservable","core",new i),this._observerManager.addObserver("onKeyUpObservable","core",new i),this._observerManager.addObserver("onKeyCopyObservable","core",new i),this._observerManager.addObserver("onKeyPasteObservable","core",new i),this._observerManager.addObserver("onKeyCutObservable","core",new i),this._observerManager.addObserver("onKeyCompositionStartObservable","core",new i),this._observerManager.addObserver("onKeyCompositionUpdateObservable","core",new i),this._observerManager.addObserver("onKeyCompositionEndObservable","core",new i)}}class Pg{constructor(t){this._plugin=t,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}handleDragAction(t){t.addEventListener("drop",(t=>{var e;t.preventDefault(),null==(e=this._observerManager.requiredObserver("onDropObservable","core"))||e.notifyObservers(t)})),t.addEventListener("dragover",(t=>{t.preventDefault()}))}_installObserver(){this._observerManager.addObserver("onDropObservable","core",new i)}}class Bg{constructor(t){this._plugin=t,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onUIChangeObservable","core",new i),this._observerManager.addObserver("onAfterChangeUISkinObservable","core",new i),this._observerManager.addObserver("onAfterChangeUILocaleObservable","core",new i),this._observerManager.addObserver("onViewComponentFocusChange","core",new i),this._observerManager.addObserver("onAddSheet","core",new i),this._observerManager.addObserver("onDeleteSheet","core",new i),this._observerManager.addObserver("onHideSheet","core",new i),this._observerManager.addObserver("onUnHideSheet","core",new i),this._observerManager.addObserver("onToLeftSheet","core",new i),this._observerManager.addObserver("onToRightSheet","core",new i),this._observerManager.addObserver("onCopySheet","core",new i),this._observerManager.addObserver("onRemoveSheet","core",new i),this._observerManager.addObserver("onSheetColor","core",new i)}}var Hg,Fg,Ug,zg,Wg=0,Vg=[],Yg=[],Gg=xu.__b,Xg=xu.__r,jg=xu.diffed,$g=xu.__c,Kg=xu.unmount;function qg(t,e){xu.__h&&xu.__h(Fg,t,Wg||e),Wg=0;var n=Fg.__H||(Fg.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:Yg}),n.__[t]}function Zg(t){return Wg=1,Jg(cp,t)}function Jg(t,e,n){var r=qg(Hg++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):cp(void 0,e),function(t){var e=r.__N?r.__N[0]:r.__[0],n=r.t(e,t);e!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=Fg,!Fg.u)){Fg.u=!0;var s=Fg.shouldComponentUpdate;Fg.shouldComponentUpdate=function(t,e,n){if(!r.__c.__H)return!0;var o=r.__c.__H.__.filter((function(t){return t.__c}));if(o.every((function(t){return!t.__N})))return!s||s.call(this,t,e,n);var i=!1;return o.forEach((function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(i=!0)}})),!(!i&&r.__c.props===t)&&(!s||s.call(this,t,e,n))}}return r.__N||r.__}function Qg(t,e){var n=qg(Hg++,3);!xu.__s&&hp(n.__H,e)&&(n.__=t,n.i=e,Fg.__H.__h.push(n))}function tp(t,e){var n=qg(Hg++,4);!xu.__s&&hp(n.__H,e)&&(n.__=t,n.i=e,Fg.__h.push(n))}function ep(t){return Wg=5,np((function(){return{current:t}}),[])}function np(t,e){var n=qg(Hg++,7);return hp(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function rp(t,e){return Wg=8,np((function(){return t}),e)}function sp(){for(var t;t=Vg.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ap),t.__H.__h.forEach(lp),t.__H.__h=[]}catch(e){t.__H.__h=[],xu.__e(e,t.__v)}}xu.__b=function(t){Fg=null,Gg&&Gg(t)},xu.__r=function(t){Xg&&Xg(t),Hg=0;var e=(Fg=t.__c).__H;e&&(Ug===Fg?(e.__h=[],Fg.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.__V=Yg,t.__N=t.i=void 0}))):(e.__h.forEach(ap),e.__h.forEach(lp),e.__h=[])),Ug=Fg},xu.diffed=function(t){jg&&jg(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==Vg.push(e)&&zg===xu.requestAnimationFrame||((zg=xu.requestAnimationFrame)||ip)(sp)),e.__H.__.forEach((function(t){t.i&&(t.__H=t.i),t.__V!==Yg&&(t.__=t.__V),t.i=void 0,t.__V=Yg}))),Ug=Fg=null},xu.__c=function(t,e){e.some((function(t){try{t.__h.forEach(ap),t.__h=t.__h.filter((function(t){return!t.__||lp(t)}))}catch(n){e.some((function(t){t.__h&&(t.__h=[])})),e=[],xu.__e(n,t.__v)}})),$g&&$g(t,e)},xu.unmount=function(t){Kg&&Kg(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach((function(t){try{ap(t)}catch(n){e=n}})),n.__H=void 0,e&&xu.__e(e,n.__v))};var op="function"==typeof requestAnimationFrame;function ip(t){var e,n=function(){clearTimeout(r),op&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);op&&(e=requestAnimationFrame(n))}function ap(t){var e=Fg,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),Fg=e}function lp(t){var e=Fg;t.__c=t.__(),Fg=e}function hp(t,e){return!t||t.length!==e.length||e.some((function(e,n){return e!==t[n]}))}function cp(t,e){return"function"==typeof e?e(t):e}function dp(t,e){for(var n in e)t[n]=e[n];return t}function up(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var r in e)if("__source"!==r&&t[r]!==e[r])return!0;return!1}function gp(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e}function pp(t){this.props=t}(pp.prototype=new ju).isPureReactComponent=!0,pp.prototype.shouldComponentUpdate=function(t,e){return up(this.props,t)||up(this.state,e)};var _p=xu.__b;xu.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),_p&&_p(t)};var mp="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function fp(t){function e(e){var n=dp({},e);return delete n.ref,t(n,e.ref||null)}return e.$$typeof=mp,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var vp=function(t,e){return null==t?null:tg(tg(t).map(e))},bp={map:vp,forEach:vp,count:function(t){return t?tg(t).length:0},only:function(t){var e=tg(t);if(1!==e.length)throw"Children.only";return e[0]},toArray:tg},Cp=xu.__e;xu.__e=function(t,e,n,r){if(t.then)for(var s,o=e;o=o.__;)if((s=o.__c)&&s.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),s.__c(t,e);Cp(t,e,n,r)};var Tp=xu.unmount;function wp(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(t){"function"==typeof t.__c&&t.__c()})),t.__c.__H=null),null!=(t=dp({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return wp(t,e,n)}))),t}function Sp(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return Sp(t,e,n)})),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function Ep(){this.__u=0,this.t=null,this.__b=null}function yp(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Rp(){this.u=null,this.o=null}xu.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&!0===t.__h&&(t.type=null),Tp&&Tp(t)},(Ep.prototype=new ju).__c=function(t,e){var n=e.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var s=yp(r.__v),o=!1,i=function(){o||(o=!0,n.__R=null,s?s(a):a())};n.__R=i;var a=function(){if(!--r.__u){if(r.state.__a){var t=r.state.__a;r.__v.__k[0]=Sp(t,t.__c.__P,t.__c.__O)}var e;for(r.setState({__a:r.__b=null});e=r.t.pop();)e.forceUpdate()}},l=!0===e.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(i,i)},Ep.prototype.componentWillUnmount=function(){this.t=[]},Ep.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=wp(this.__b,n,r.__O=r.__P)}this.__b=null}var s=e.__a&&Vu(Xu,null,t.fallback);return s&&(s.__h=null),[Vu(Xu,null,e.__a?null:t.children),s]};var Ip=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function Ap(t){return this.getChildContext=function(){return t.context},t.children}function Op(t){var e=this,n=t.i;e.componentWillUnmount=function(){ug(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),t.__v?(e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(t){this.childNodes.push(t),e.i.appendChild(t)},insertBefore:function(t,n){this.childNodes.push(t),e.i.appendChild(t)},removeChild:function(t){this.childNodes.splice(this.childNodes.indexOf(t)>>>1,1),e.i.removeChild(t)}}),ug(Vu(Ap,{context:e.context},t.__v),e.l)):e.l&&e.componentWillUnmount()}(Rp.prototype=new ju).__a=function(t){var e=this,n=yp(e.__v),r=e.o.get(t);return r[0]++,function(s){var o=function(){e.props.revealOrder?(r.push(s),Ip(e,t,r)):s()};n?n(o):o()}},Rp.prototype.render=function(t){this.u=null,this.o=new Map;var e=tg(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},Rp.prototype.componentDidUpdate=Rp.prototype.componentDidMount=function(){var t=this;this.o.forEach((function(e,n){Ip(t,n,e)}))};var Np="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Mp=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,xp="undefined"!=typeof document,kp=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(t)};ju.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(t){Object.defineProperty(ju.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})}));var Dp=xu.event;function Lp(){}function Pp(){return this.cancelBubble}function Bp(){return this.defaultPrevented}xu.event=function(t){return Dp&&(t=Dp(t)),t.persist=Lp,t.isPropagationStopped=Pp,t.isDefaultPrevented=Bp,t.nativeEvent=t};var Hp,Fp={configurable:!0,get:function(){return this.class}},Up=xu.vnode;xu.vnode=function(t){var e=t.type,n=t.props,r=n;if("string"==typeof e){var s=-1===e.indexOf("-");for(var o in r={},n){var i=n[o];xp&&"children"===o&&"noscript"===e||"value"===o&&"defaultValue"in n&&null==i||("defaultValue"===o&&"value"in n&&null==n.value?o="value":"download"===o&&!0===i?i="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!kp(n.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():s&&Mp.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===i&&(i=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),r[o]&&(o="oninputCapture")),r[o]=i)}"select"==e&&r.multiple&&Array.isArray(r.value)&&(r.value=tg(n.children).forEach((function(t){t.props.selected=-1!=r.value.indexOf(t.props.value)}))),"select"==e&&null!=r.defaultValue&&(r.value=tg(n.children).forEach((function(t){t.props.selected=r.multiple?-1!=r.defaultValue.indexOf(t.props.value):r.defaultValue==t.props.value}))),t.props=r,n.class!=n.className&&(Fp.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Fp))}t.$$typeof=Np,Up&&Up(t)};var zp=xu.__r;xu.__r=function(t){zp&&zp(t),Hp=t.__c};var Wp=xu.diffed;function Vp(t){return!!t&&t.$$typeof===Np}xu.diffed=function(t){Wp&&Wp(t);var e=t.props,n=t.__e;null!=n&&"textarea"===t.type&&"value"in e&&e.value!==n.value&&(n.value=null==e.value?"":e.value),Hp=null};function Yp(t){t()}var Gp={useState:Zg,useId:function(){var t=qg(Hg++,11);if(!t.__){for(var e=Fg.__v;null!==e&&!e.__m&&null!==e.__;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__},useReducer:Jg,useEffect:Qg,useLayoutEffect:tp,useInsertionEffect:tp,useTransition:function(){return[!1,Yp]},useDeferredValue:function(t){return t},useSyncExternalStore:function(t,e){var n=e(),r=Zg({h:{__:n,v:e}}),s=r[0].h,o=r[1];return tp((function(){s.__=n,s.v=e,gp(s.__,e())||o({h:s})}),[t,n,e]),Qg((function(){return gp(s.__,s.v())||o({h:s}),t((function(){gp(s.__,s.v())||o({h:s})}))}),[t]),n},startTransition:Yp,useRef:ep,useImperativeHandle:function(t,e,n){Wg=6,tp((function(){return"function"==typeof t?(t(e()),function(){return t(null)}):t?(t.current=e(),function(){return t.current=null}):void 0}),null==n?n:n.concat(t))},useMemo:np,useCallback:rp,useContext:function(t){var e=Fg.context[t.__c],n=qg(Hg++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(Fg)),e.props.value):t.__},useDebugValue:function(t,e){xu.useDebugValue&&xu.useDebugValue(e?e(t):t)},version:"17.0.2",Children:bp,render:function(t,e,n){return null==e.__k&&(e.textContent=""),ug(t,e),"function"==typeof n&&n(),t?t.__c:null},hydrate:function(t,e,n){return gg(t,e),"function"==typeof n&&n(),t?t.__c:null},unmountComponentAtNode:function(t){return!!t.__k&&(ug(null,t),!0)},createPortal:function(t,e){var n=Vu(Op,{__v:t,i:e});return n.containerInfo=e,n},createElement:Vu,createContext:_g,createFactory:function(t){return Vu.bind(null,t)},cloneElement:function(t){return Vp(t)?pg.apply(null,arguments):t},createRef:Gu,Fragment:Xu,isValidElement:Vp,findDOMNode:function(t){return t&&(t.base||1===t.nodeType&&t)||null},Component:ju,PureComponent:pp,memo:function(t,e){function n(t){var n=this.props.ref,r=n==t.ref;return!r&&n&&(n.call?n(null):n.current=null),e?!e(this.props,t)||!r:up(this.props,t)}function r(e){return this.shouldComponentUpdate=n,Vu(t,e)}return r.displayName="Memo("+(t.displayName||t.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r},forwardRef:fp,flushSync:function(t,e){return t(e)},unstable_batchedUpdates:function(t,e){return t(e)},StrictMode:Xu,Suspense:Ep,SuspenseList:Rp,lazy:function(t){var e,n,r;function s(s){if(e||(e=t()).then((function(t){n=t.default||t}),(function(t){r=t})),r)throw r;if(!n)throw e;return Vu(n,s)}return s.displayName="Lazy",s.__f=!0,s},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:{current:{readContext:function(t){return Hp.__n[t.__c].props.value}}}}};class Xp extends ju{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){if(t)return this.getContext().getLocale().get(t)}initialize(t){}}Xp.contextType=Dg;class jp extends pp{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){return this.getContext().getLocale().get(t)}initialize(t){}}jp.contextType=Dg;var $p={};class Kp extends Xp{constructor(){super(...arguments),this.canvasRef={current:null}}componentDidMount(){this.drawLine()}drawLine(){const t=this.canvasRef;this.props.drawLine(t)}setLineDash(t,e,n,r,s,o,i){try{"Hair"===e?t.setLineDash([1,2]):e.indexOf("DashDotDot")>-1?t.setLineDash([2,2,5,2,2]):e.indexOf("DashDot")>-1?t.setLineDash([2,5,2]):e.indexOf("Dotted")>-1?t.setLineDash([2]):e.indexOf("Dashed")>-1?t.setLineDash([3]):t.setLineDash([0])}catch(a){console.log(a)}t.beginPath(),e.indexOf("Medium")>-1?("h"===n?(t.moveTo(r,s-.5),t.lineTo(o,i-.5)):(t.moveTo(r-.5,s),t.lineTo(o-.5,i)),t.lineWidth=2):"Thick"===e?(t.moveTo(r,s),t.lineTo(o,i),t.lineWidth=3):(t.moveTo(r,s),t.lineTo(o,i),t.lineWidth=1)}render(){return Vu("canvas",{ref:this.canvasRef,className:$p.canvas,width:this.props.width,height:this.props.height})}}class qp extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thin","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class Zp extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Hair","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class Jp extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dotted","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class Qp extends ju{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class t_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class e_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class n_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Medium","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class r_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class s_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class o_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class i_ extends Xp{constructor(){super(...arguments),this.ref={current:null}}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thick","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return Vu(Kp,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}var a_=Object.freeze(Object.defineProperty({__proto__:null,BorderThin:qp,BorderHair:Zp,BorderDotted:Jp,BorderDashed:Qp,BorderDashDot:t_,BorderDashDotDot:e_,BorderMedium:n_,BorderMediumDashed:r_,BorderMediumDashDot:s_,BorderMediumDashDotDot:o_,BorderThick:i_},Symbol.toStringTag,{value:"Module"}));function l_(t){return t instanceof Element||t instanceof HTMLDocument}const h_="object"==typeof HTMLElement?t=>t instanceof HTMLElement:t=>t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName;function c_(t,e){let n=(e=e||document).querySelectorAll(t);return 1===n.length?Array.prototype.slice.call(n)[0]:Array.prototype.slice.call(n)}function d_(t){return(t=t?`${t}-`:"")+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function u_(t){let e=[],n=t.getElementsByTagName("*");for(let r=0,s=n.length;r<s;++r){if(1!==n[r].nodeType)continue;let s=n[r].parentNode;s&&1===s.nodeType?s===t&&(e[e.length]=n[r]):s&&s.parentNode===t&&(e[e.length]=n[r])}return e}function g_(...t){if(!t.length)return;let e="";return t.forEach((t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=t?` ${t}`:""})),e}function p_(t,e){let n=null;return(...r)=>{clearTimeout(n),n=setTimeout((()=>{t(...r)}),e)}}function __(t){var e,n;if(window.getSelection){let r=document.createRange(),s=t.firstChild;s&&(r.setStart(s,0),r.setEnd(s,s.length),r.startContainer&&f_(r.startContainer)&&(null==(e=window.getSelection())||e.removeAllRanges(),null==(n=window.getSelection())||n.addRange(r)))}}function m_(t,e){var n,r;if(window.getSelection){let s=document.createRange(),o=t.firstChild,i=e.firstChild;o&&i&&(s.setStart(o,0),s.setEnd(i,i.length),s.startContainer&&f_(s.startContainer)&&(null==(n=window.getSelection())||n.removeAllRanges(),null==(r=window.getSelection())||r.addRange(s)))}}function f_(t){return t!==document.body&&document.body.contains(t)}function v_(t){return 0===t.length?t:t.replace(/^\s+|\s+$/gm,"")}function b_(t){if(h_(t.current))return t.current;let e=t.current;return e?null==e?void 0:e.base:t.base}function C_(t){return"string"!=typeof t?t:t.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}function T_(t){const e=window.getSelection();e&&e.selectAllChildren(t),e&&e.collapseToEnd()}function w_(t,e){for(let n in t)if(n.endsWith("Locale")&&"string"==typeof t[n]){const r=n.indexOf("Locale");t[n.slice(0,r)]=e(t[n])}return t}var S_="univer-icon";const E_=t=>{const{spin:e,rotate:n,children:r,name:s,style:o,className:i}=t;let a;o?(a=o,a.transform=n?`rotate(${n}deg)`:""):a=n?{transform:`rotate(${n}deg)`}:{};return Vu("span",{role:"img",className:g_(S_,{[`${S_}-${s}`]:s,[`${S_}-spin`]:e||"loading"===s},i),style:__spreadValues({},a)},r)},y_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"loading",style:t.style},Vu("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));var R_={AddNumIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),Vu("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),Vu("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),Vu("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),Vu("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),ReduceNumIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),Vu("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),Vu("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),Vu("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),PercentIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),MoneyIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),FxIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),AddIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),Vu("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),ReduceIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})))};const I_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),A_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),Vu("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),Vu("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),O_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),Vu("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),Vu("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),N_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),Vu("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),Vu("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),Vu("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),M_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));var x_={BoldIcon:I_,ItalicIcon:A_,DeleteLineIcon:O_,UnderLineIcon:N_,TextColorIcon:M_};const k_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),Vu("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),D_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),Vu("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),L_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),Vu("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),Vu("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),P_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),Vu("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),Vu("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),Vu("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),Vu("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),Vu("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),Vu("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),B_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),Vu("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),Vu("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),Vu("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),Vu("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),Vu("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),H_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),Vu("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),Vu("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),Vu("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),Vu("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),Vu("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),Vu("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),F_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),Vu("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),Vu("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),U_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),Vu("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),Vu("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),Vu("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),z_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),Vu("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),Vu("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),W_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),Vu("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),V_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),Vu("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),Y_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),Vu("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));var G_={FillColorIcon:k_,FullBorderIcon:D_,TopBorderIcon:L_,BottomBorderIcon:P_,LeftBorderIcon:B_,RightBorderIcon:H_,NoneBorderIcon:F_,OuterBorderIcon:U_,InnerBorderIcon:z_,StripingBorderIcon:W_,VerticalBorderIcon:V_,MergeIcon:Y_};const X_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),j_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),$_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),K_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),q_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),Z_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),J_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),Q_=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),tm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),em=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),nm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),rm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),sm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),Vu("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),Vu("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),om=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),Vu("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),im=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),Vu("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));var am={LeftAlignIcon:X_,CenterAlignIcon:j_,RightAlignIcon:$_,TopVerticalIcon:K_,CenterVerticalIcon:q_,BottomVerticalIcon:Z_,TextRotateIcon:J_,TextRotateAngleUpIcon:Q_,BrIcon:sm,OverflowIcon:om,CutIcon:im};var lm={PhotoIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),LinkIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),Vu("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),ChartIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),Vu("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),Vu("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})))};const hm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),cm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),dm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),um=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"nextIcon",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),gm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"rightIcon",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),pm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),Vu("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),_m=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},Vu("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),Vu("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),mm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),Vu("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),fm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),vm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),Vu("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),Vu("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var bm={BackIcon:hm,ForwardIcon:cm,FormatIcon:dm,NextIcon:um,RightIcon:gm,CorrectIcon:pm,LtIcon:_m,CloseIcon:mm,MenuIcon:fm,HideIcon:vm};var Cm={PivotableIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),SumIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),OrderIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),OrderDESCIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),OrderASCIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),FilterIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),FilterRankIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),Vu("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),CleanIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),CheckIcon:t=>Vu(E_,{spin:t.spin,className:t.className,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})))};const Tm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),Vu("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"}))),wm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},Vu("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),Vu("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),Vu("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),Vu("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),Vu("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"}))),Sm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"}))),Em=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"}))),ym=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"}))),Rm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"}))),Im=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"}))),Am=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"}))),Om=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),Vu("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),Vu("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"}))),Nm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),Vu("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),Vu("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"}))),Mm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"}))),xm=t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));var km={CommentIcon:Tm,FreezeIcon:wm,conditionalFormatIcon:Sm,DivideIcon:Em,ReplaceIcon:ym,SearchIcon:Rm,LockIcon:Im,LocationIcon:Am,PageIcon:Om,RegularIcon:Nm,LayoutIcon:Mm,TableIcon:xm};var Dm={PrintIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),Vu("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),Vu("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),ScreenshotIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),PrintAreaIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),PrintTitleIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),Vu("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),ImageIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})))};var Lm,Pm,Bm,Hm,Fm,Um,zm,Wm={Close:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"logo",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},Vu("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),Vu("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),DropDownIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"dropdown",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},Vu("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),Vu("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})))},Vm=Object.freeze(Object.defineProperty({__proto__:null,LoadingIcon:y_,LogoIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"logo",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},Vu("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),Vu("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),Vu("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),Vu("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),Vu("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"}))),DeleteIcon:t=>Vu(E_,{spin:t.spin,rotate:t.rotate,name:"logo",style:t.style},Vu("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},Vu("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),Vu("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"}))),Math:R_,Font:x_,Cell:G_,Text:am,Insert:lm,Format:bm,Data:Cm,Sheet:km,View:Dm,Other:Wm,BackIcon:hm,ForwardIcon:cm,FormatIcon:dm,NextIcon:um,RightIcon:gm,CorrectIcon:pm,LtIcon:_m,CloseIcon:mm,MenuIcon:fm,HideIcon:vm,BoldIcon:I_,ItalicIcon:A_,DeleteLineIcon:O_,UnderLineIcon:N_,TextColorIcon:M_,FillColorIcon:k_,FullBorderIcon:D_,TopBorderIcon:L_,BottomBorderIcon:P_,LeftBorderIcon:B_,RightBorderIcon:H_,NoneBorderIcon:F_,OuterBorderIcon:U_,InnerBorderIcon:z_,StripingBorderIcon:W_,VerticalBorderIcon:V_,MergeIcon:Y_,LeftAlignIcon:X_,CenterAlignIcon:j_,RightAlignIcon:$_,TopVerticalIcon:K_,CenterVerticalIcon:q_,BottomVerticalIcon:Z_,TextRotateIcon:J_,TextRotateAngleUpIcon:Q_,TextRotateAngleDownIcon:tm,TextRotateVerticalIcon:em,TextRotateRotationUpIcon:nm,TextRotateRotationDownIcon:rm,BrIcon:sm,OverflowIcon:om,CutIcon:im,CommentIcon:Tm,FreezeIcon:wm,conditionalFormatIcon:Sm,DivideIcon:Em,ReplaceIcon:ym,SearchIcon:Rm,LockIcon:Im,LocationIcon:Am,PageIcon:Om,RegularIcon:Nm,LayoutIcon:Mm,TableIcon:xm},Symbol.toStringTag,{value:"Module"}));class Ym{constructor(){this._componentList=new Map;const t={ForwardIcon:cm,BackIcon:hm,BoldIcon:I_,ItalicIcon:A_,DeleteLineIcon:O_,UnderLineIcon:N_,TextColorIcon:M_,FillColorIcon:k_,MergeIcon:Y_,TopBorderIcon:L_,BottomBorderIcon:P_,LeftBorderIcon:B_,RightBorderIcon:H_,NoneBorderIcon:F_,FullBorderIcon:D_,OuterBorderIcon:U_,InnerBorderIcon:z_,StripingBorderIcon:W_,VerticalBorderIcon:V_,LeftAlignIcon:X_,CenterAlignIcon:j_,RightAlignIcon:$_,TopVerticalIcon:K_,CenterVerticalIcon:q_,BottomVerticalIcon:Z_,OverflowIcon:om,BrIcon:sm,CutIcon:im,TextRotateIcon:J_,TextRotateAngleUpIcon:Q_,TextRotateAngleDownIcon:tm,TextRotateVerticalIcon:em,TextRotateRotationUpIcon:nm,TextRotateRotationDownIcon:rm,BorderThin:qp,BorderHair:Zp,BorderDotted:Jp,BorderDashed:Qp,BorderDashDot:t_,BorderDashDotDot:e_,BorderMedium:n_,BorderMediumDashed:r_,BorderMediumDashDot:s_,BorderMediumDashDotDot:o_,BorderThick:i_};for(let e in t)this.register(e,t[e])}register(t,e){this._componentList.set(t,e)}get(t){return this._componentList.get(t)}delete(t){this._componentList.delete(t)}}class Gm{constructor(t){this._plugin=t,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new Ng;const t=this._plugin.getContext().getObserverManager().getObserver("onKeyPasteObservable","core");t&&!t.hasObservers()&&t.add((t=>{this._clipboardExtensionManager.pasteResolver(t).then((t=>{this._clipboardExtensionManager.handle(t)}))}))}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new kg;const t=this._plugin.getContext().getObserverManager().getObserver("onDropObservable","core");t&&!t.hasObservers()&&t.add((t=>{this._dragAndDropExtensionManager.dragResolver(t).then((t=>{0!==t.length&&this._dragAndDropExtensionManager.handle(t)}))}))}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}function Xm(t){var e;let n=t.childNodes;if(0===n.length)return t.textContent;if("DIV"===n[0].nodeName&&(n=n[0].childNodes),1===n.length&&"#text"===n[0].nodeName)return n[0].textContent;const r=[];let s=0;for(let i=0;i<n.length;i++){let t,o=n[`${i}`];"#text"===o.nodeName?(t=null!=(e=o.textContent)?e:"",o=o.parentElement):t=o.innerText;let a=jm(o);$m(t).forEach((t=>{s=+t.length;let e=C.generateRandomId(6);r.push({eId:e,st:0,ed:t.length-1,et:0,tr:{ct:t,ts:a}})}))}const o=C.generateRandomId(6);return{id:C.generateRandomId(6),body:{blockElements:[{blockId:o,st:0,ed:s,blockType:0,paragraph:{elements:r}},{blockId:"b",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}]},documentStyle:{}}}function jm(t){const e=t.style.cssText;if(null==e||0===e.length)return{};let n=e.split(";"),r={};return n.forEach((n=>{let s=v_((n=n.toLowerCase()).substr(0,n.indexOf(":"))),o=v_(n.substr(n.indexOf(":")+1));if("font-weight"===s)r.bl="bold"===o?1:0;else if("font-style"===s)r.it="italic"===o?1:0;else if("font-family"===s)r.ff=o;else if("font-size"===s){let t=parseInt(o);e.indexOf("vertical-align")>-1&&(e.indexOf("sub")>-1||e.indexOf("sup")>-1)&&(t*=2),-1!==o.indexOf("px")&&(t=Ka(parseInt(o))),r.fs=t}else"color"===s?r.cl={rgb:o}:"background"===s||"background-color"===s?r.bg={rgb:o}:"text-decoration-line"===s?"underline"===o?(r.ul||(r.ul={s:1}),r.ul.s=1):"line-through"===o?(r.st||(r.st={s:1}),r.st.s=1):"overline"===o&&(r.ol||(r.ol={s:1}),r.ol.s=1):"text-decoration-color"===s?(r.hasOwnProperty("ul")&&(r.ul||(r.ul={s:1,cl:{rgb:o}}),r.ul.cl={rgb:o}),r.hasOwnProperty("st")&&(r.st||(r.st={s:1,cl:{rgb:o}}),r.st.cl={rgb:o}),r.hasOwnProperty("ol")&&(r.ol||(r.ol={s:1,cl:{rgb:o}}),r.ol.cl={rgb:o})):"text-decoration-style"===s?(r.hasOwnProperty("ul")&&(r.ul||(r.ul={s:1,t:Number(o)}),r.ul.t=Number(o)),r.hasOwnProperty("st")&&(r.st||(r.st={s:1,t:Number(o)}),r.st.t=Number(o)),r.hasOwnProperty("ol")&&(r.ol||(r.ol={s:1,t:Number(o)}),r.ol.t=Number(o))):"text-decoration"!==s&&"univer-strike"!==s||(r.st={s:1});if("univer-underline"===s&&(r.ul={s:1}),"vertical-align"===s&&("sub"===o?r.va=1:"super"===o?r.va=2:"top"===o?r.vt=1:"middle"===o?r.vt=2:"bottom"===o?r.vt=3:r.va=0),"transform"===s){const e=o.split(")"),n=e.findIndex((t=>t.includes("rotate")));if(n>-1){const s=e[n].match(/\d+/g);let o=0,i=0;(null==s?void 0:s.length)&&(o=+s[0]),t.dataset.vertical&&(i=+t.dataset.vertical),r.tr={a:o,v:i}}}"text-align"===s&&(r.ht="left"===o?1:"center"===o?2:"right"===o?3:"justify"===o?4:0),"overflow-wrap"!==s&&"overflowWrap"!==s||"break-word"===o&&(r.tb=3)})),r}function $m(t){if(""===t)return[t];return t.match(/(?:(\n+.+)|(.+))/g).map((t=>t.replace(/\n/g,"\r\n")))}(Pm=Lm||(Lm={}))[Pm.Button=0]="Button",Pm[Pm.SingleButton=1]="SingleButton",Pm[Pm.Select=2]="Select",Pm[Pm.Container=3]="Container",Pm[Pm.CellRangeModal=4]="CellRangeModal",Pm[Pm.Modal=5]="Modal",Pm[Pm.SiderModal=6]="SiderModal",Pm[Pm.Layout=7]="Layout",Pm[Pm.Header=8]="Header",Pm[Pm.Footer=9]="Footer",Pm[Pm.Content=10]="Content",Pm[Pm.Sider=11]="Sider",Pm[Pm.Demo=12]="Demo",Pm[Pm.Checkbox=13]="Checkbox",Pm[Pm.CheckboxGroup=14]="CheckboxGroup",Pm[Pm.ColorPicker=15]="ColorPicker",Pm[Pm.ColorPickerCircleButton=16]="ColorPickerCircleButton",Pm[Pm.Input=17]="Input",Pm[Pm.Radio=18]="Radio",Pm[Pm.RadioGroup=19]="RadioGroup",Pm[Pm.Tab=20]="Tab",Pm[Pm.TabPane=21]="TabPane",Pm[Pm.Avatar=22]="Avatar",Pm[Pm.Tooltip=23]="Tooltip",Pm[Pm.Ul=24]="Ul",Pm[Pm.Collapse=25]="Collapse",Pm[Pm.Panel=26]="Panel",Pm[Pm.FormatModal=27]="FormatModal",Pm[Pm.RichText=28]="RichText",Pm[Pm.NextIcon=29]="NextIcon",Pm[Pm.RightIcon=30]="RightIcon",Pm[Pm.OrderIcon=31]="OrderIcon",Pm[Pm.CommentIcon=32]="CommentIcon",Pm[Pm.ConditionalFormatIcon=33]="ConditionalFormatIcon",Pm[Pm.ScreenshotIcon=34]="ScreenshotIcon",Pm[Pm.CheckIcon=35]="CheckIcon",Pm[Pm.SearchIcon=36]="SearchIcon",Pm[Pm.ReplaceIcon=37]="ReplaceIcon",Pm[Pm.FreezeIcon=38]="FreezeIcon",Pm[Pm.PivotableIcon=39]="PivotableIcon",Pm[Pm.FillColorIcon=40]="FillColorIcon",Pm[Pm.BoldIcon=41]="BoldIcon",Pm[Pm.FullBorderIcon=42]="FullBorderIcon",Pm[Pm.TopBorderIcon=43]="TopBorderIcon",Pm[Pm.BottomBorderIcon=44]="BottomBorderIcon",Pm[Pm.LeftBorderIcon=45]="LeftBorderIcon",Pm[Pm.RightBorderIcon=46]="RightBorderIcon",Pm[Pm.NoneBorderIcon=47]="NoneBorderIcon",Pm[Pm.OuterBorderIcon=48]="OuterBorderIcon",Pm[Pm.InnerBorderIcon=49]="InnerBorderIcon",Pm[Pm.StripingBorderIcon=50]="StripingBorderIcon",Pm[Pm.VerticalBorderIcon=51]="VerticalBorderIcon",Pm[Pm.MergeIcon=52]="MergeIcon",Pm[Pm.SumIcon=53]="SumIcon",Pm[Pm.OrderDESCIcon=54]="OrderDESCIcon",Pm[Pm.OrderASCIcon=55]="OrderASCIcon",Pm[Pm.FilterIcon=56]="FilterIcon",Pm[Pm.FilterRankIcon=57]="FilterRankIcon",Pm[Pm.CleanIcon=58]="CleanIcon",Pm[Pm.DeleteIcon=59]="DeleteIcon",Pm[Pm.DeleteLineIcon=60]="DeleteLineIcon",Pm[Pm.UnderLineIcon=61]="UnderLineIcon",Pm[Pm.ItalicIcon=62]="ItalicIcon",Pm[Pm.TextColorIcon=63]="TextColorIcon",Pm[Pm.BackIcon=64]="BackIcon",Pm[Pm.ForwardIcon=65]="ForwardIcon",Pm[Pm.FormatIcon=66]="FormatIcon",Pm[Pm.CorrectIcon=67]="CorrectIcon",Pm[Pm.LtIcon=68]="LtIcon",Pm[Pm.CloseIcon=69]="CloseIcon",Pm[Pm.DropDownIcon=70]="DropDownIcon",Pm[Pm.MenuIcon=71]="MenuIcon",Pm[Pm.HideIcon=72]="HideIcon",Pm[Pm.PhotoIcon=73]="PhotoIcon",Pm[Pm.LinkIcon=74]="LinkIcon",Pm[Pm.ChartIcon=75]="ChartIcon",Pm[Pm.LoadingIcon=76]="LoadingIcon",Pm[Pm.LogoIcon=77]="LogoIcon",Pm[Pm.AddNumIcon=78]="AddNumIcon",Pm[Pm.ReduceNumIcon=79]="ReduceNumIcon",Pm[Pm.PercentIcon=80]="PercentIcon",Pm[Pm.MoneyIcon=81]="MoneyIcon",Pm[Pm.FxIcon=82]="FxIcon",Pm[Pm.AddIcon=83]="AddIcon",Pm[Pm.ReduceIcon=84]="ReduceIcon",Pm[Pm.DivideIcon=85]="DivideIcon",Pm[Pm.LockIcon=86]="LockIcon",Pm[Pm.LocationIcon=87]="LocationIcon",Pm[Pm.PageIcon=88]="PageIcon",Pm[Pm.RegularIcon=89]="RegularIcon",Pm[Pm.LayoutIcon=90]="LayoutIcon",Pm[Pm.TableIcon=91]="TableIcon",Pm[Pm.ImageIcon=92]="ImageIcon",Pm[Pm.LeftAlignIcon=93]="LeftAlignIcon",Pm[Pm.CenterAlignIcon=94]="CenterAlignIcon",Pm[Pm.RightAlignIcon=95]="RightAlignIcon",Pm[Pm.TopVerticalIcon=96]="TopVerticalIcon",Pm[Pm.CenterVerticalIcon=97]="CenterVerticalIcon",Pm[Pm.BottomVerticalIcon=98]="BottomVerticalIcon",Pm[Pm.TextRotateIcon=99]="TextRotateIcon",Pm[Pm.TextRotateAngleUpIcon=100]="TextRotateAngleUpIcon",Pm[Pm.TextRotateAngleDownIcon=101]="TextRotateAngleDownIcon",Pm[Pm.TextRotateVerticalIcon=102]="TextRotateVerticalIcon",Pm[Pm.TextRotateRotationUpIcon=103]="TextRotateRotationUpIcon",Pm[Pm.TextRotateRotationDownIcon=104]="TextRotateRotationDownIcon",Pm[Pm.BrIcon=105]="BrIcon",Pm[Pm.OverflowIcon=106]="OverflowIcon",Pm[Pm.CutIcon=107]="CutIcon",Pm[Pm.PrintIcon=108]="PrintIcon",Pm[Pm.PrintAreaIcon=109]="PrintAreaIcon",Pm[Pm.PrintTitleIcon=110]="PrintTitleIcon",Pm[Pm.BorderDashDot=111]="BorderDashDot",Pm[Pm.BorderDashDotDot=112]="BorderDashDotDot",Pm[Pm.BorderDashed=113]="BorderDashed",Pm[Pm.BorderDotted=114]="BorderDotted",Pm[Pm.BorderHair=115]="BorderHair",Pm[Pm.BorderMedium=116]="BorderMedium",Pm[Pm.BorderMediumDashDot=117]="BorderMediumDashDot",Pm[Pm.BorderMediumDashDotDot=118]="BorderMediumDashDotDot",Pm[Pm.BorderMediumDashed=119]="BorderMediumDashed",Pm[Pm.BorderThick=120]="BorderThick",Pm[Pm.BorderThin=121]="BorderThin",(Hm=Bm||(Bm={})).BUTTON="Button",Hm.CONTAINER="Container",Hm.CELL_RANGE_MODAL="CellRangeModal",Hm.LAYOUT="Layout",Hm.HEADER="Header",Hm.FOOTER="Footer",Hm.CONTENT="Content",Hm.SIDER="Sider",Hm.DEMO="Demo",Hm.SHEET_CONTAINER="SheetContainer",(Um=Fm||(Fm={})).INPUT="input",Um.COLOR="color",Um.DOUBLE="double",Um.JSX="jsx",Um.INPUT_NUMBER="inputNumber",function(t){t.EN="en",t.ZH="zh"}(zm||(zm={}));var Km="univer-avatar";var qm="univer-btn";class Zm extends Xp{constructor(t){var e;super(),this.handleClick=t=>{const{disabled:e,onClick:n,unActive:r}=this.props;e?t.preventDefault():r?null==n||n(t):this.setState({isActive:!this.state.isActive},(()=>{n&&n.call(null,t,this.state.isActive)}))},this.state={isActive:null!=(e=t.active)&&e}}getSizeCls(){const{size:t}=this.props;let e="";switch(t){case"large":e="lg";break;case"small":e="sm"}return e}getClass(){const{isActive:t}=this.state,{type:e,shape:n,danger:r,block:s,loading:o,size:i,className:a,unActive:l}=this.props;return g_(qm,{[`${qm}-${e}`]:e,[`${qm}-${n}`]:n,[`${qm}-${this.getSizeCls()}`]:i,[`${qm}-danger`]:!!r,[`${qm}-block`]:s,[`${qm}-loading`]:o,[`${qm}-active`]:t},a)}componentWillReceiveProps(t){this.setState({isActive:t.active})}render(){const{htmlType:t,disabled:e,style:n,loading:r,children:s}=this.props;return Vu("button",{type:t,onClick:this.handleClick,className:this.getClass(),disabled:e,style:n},r?Vu(y_,null):"",s)}}var Jm="univer-checkbox-wrapper",Qm="univer-check-box",tf="univer-checkbox-input",ef="univer-checkbox-inner",nf="univer-checkbox-group";class rf extends Xp{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${Qm}`:Qm,check:!0},this.handleStyle=(t,e)=>{let n=g_(Qm,{[`${Qm}-checked`]:t,[`${Qm}-disabled`]:e});this.setState((e=>({classes:n,check:t})))},this.handleChange=t=>{var e,n;const r=t.target;this.handleStyle(r.checked,this.props.disabled),null==(n=(e=this.props).onChange)||n.call(e,t)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(t){this.handleStyle(t.checked,t.disabled)}render(t,e){const{classes:n,check:r}=e,{value:s,name:o,disabled:i,children:a}=t;return Vu("label",{className:Jm},Vu("span",{className:n},Vu("span",{className:ef}),Vu("input",{type:"checkbox",name:o,checked:r,disabled:i,className:tf,value:s,onChange:this.handleChange})),a&&Vu("span",null,a))}}var sf={panelWrapper:"univer-panel-wrapper",panelHeader:"univer-panel-header",panelHeaderIcon:"univer-panel-header-icon",panelHeaderIconRotate:"univer-panel-header-icon-rotate",panelBody:"univer-panel-body",active:"univer-active"};function of(){return(of=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function af(t,e){if(null==t)return{};var n,r,s={},o=Object.keys(t);for(r=0;r<o.length;r++)e.indexOf(n=o[r])>=0||(s[n]=t[n]);return s}function lf(t){var e=ep(t),n=ep((function(t){e.current&&e.current(t)}));return e.current=t,n.current}var hf=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>n?n:t<e?e:t},cf=function(t){return"touches"in t},df=function(t){return t&&t.ownerDocument.defaultView||self},uf=function(t,e,n){var r=t.getBoundingClientRect(),s=cf(e)?function(t,e){for(var n=0;n<t.length;n++)if(t[n].identifier===e)return t[n];return t[0]}(e.touches,n):e;return{left:hf((s.pageX-(r.left+df(t).pageXOffset))/r.width),top:hf((s.pageY-(r.top+df(t).pageYOffset))/r.height)}},gf=function(t){!cf(t)&&t.preventDefault()},pf=Gp.memo((function(t){var e=t.onMove,n=t.onKey,r=af(t,["onMove","onKey"]),s=ep(null),o=lf(e),i=lf(n),a=ep(null),l=ep(!1),h=np((function(){var t=function(t){gf(t),(cf(t)?t.touches.length>0:t.buttons>0)&&s.current?o(uf(s.current,t,a.current)):n(!1)},e=function(){return n(!1)};function n(n){var r=l.current,o=df(s.current),i=n?o.addEventListener:o.removeEventListener;i(r?"touchmove":"mousemove",t),i(r?"touchend":"mouseup",e)}return[function(t){var e,r=t.nativeEvent,i=s.current;if(i&&(gf(r),e=r,(!l.current||cf(e))&&i)){if(cf(r)){l.current=!0;var h=r.changedTouches||[];h.length&&(a.current=h[0].identifier)}i.focus(),o(uf(i,r,a.current)),n(!0)}},function(t){var e=t.which||t.keyCode;e<37||e>40||(t.preventDefault(),i({left:39===e?.05:37===e?-.05:0,top:40===e?.05:38===e?-.05:0}))},n]}),[i,o]),c=h[0],d=h[1],u=h[2];return Qg((function(){return u}),[u]),Gp.createElement("div",of({},r,{onTouchStart:c,onMouseDown:c,className:"react-colorful__interactive",ref:s,onKeyDown:d,tabIndex:0,role:"slider"}))})),_f=function(t){return t.filter(Boolean).join(" ")},mf=function(t){var e=t.color,n=t.left,r=t.top,s=void 0===r?.5:r,o=_f(["react-colorful__pointer",t.className]);return Gp.createElement("div",{className:o,style:{top:100*s+"%",left:100*n+"%"}},Gp.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},ff=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=Math.pow(10,e)),Math.round(n*t)/n},vf=function(t){var e=t.s,n=t.v,r=t.a,s=(200-e)*n/100;return{h:ff(t.h),s:ff(s>0&&s<200?e*n/100/(s<=100?s:200-s)*100:0),l:ff(s/2),a:ff(r,2)}},bf=function(t){var e=vf(t);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Cf=function(t){var e=vf(t);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},Tf=function(t){var e=t.r,n=t.g,r=t.b,s=t.a,o=Math.max(e,n,r),i=o-Math.min(e,n,r),a=i?o===e?(n-r)/i:o===n?2+(r-e)/i:4+(e-n)/i:0;return{h:ff(60*(a<0?a+6:a)),s:ff(o?i/o*100:0),v:ff(o/255*100),a:s}},wf=Gp.memo((function(t){var e=t.hue,n=t.onChange,r=_f(["react-colorful__hue",t.className]);return Gp.createElement("div",{className:r},Gp.createElement(pf,{onMove:function(t){n({h:360*t.left})},onKey:function(t){n({h:hf(e+360*t.left,0,360)})},"aria-label":"Hue","aria-valuenow":ff(e),"aria-valuemax":"360","aria-valuemin":"0"},Gp.createElement(mf,{className:"react-colorful__hue-pointer",left:e/360,color:bf({h:e,s:100,v:100,a:1})})))})),Sf=Gp.memo((function(t){var e=t.hsva,n=t.onChange,r={backgroundColor:bf({h:e.h,s:100,v:100,a:1})};return Gp.createElement("div",{className:"react-colorful__saturation",style:r},Gp.createElement(pf,{onMove:function(t){n({s:100*t.left,v:100-100*t.top})},onKey:function(t){n({s:hf(e.s+100*t.left,0,100),v:hf(e.v-100*t.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+ff(e.s)+"%, Brightness "+ff(e.v)+"%"},Gp.createElement(mf,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:bf(e)})))}));var Ef="undefined"!=typeof window?tp:Qg,yf=new Map,Rf=function(t){Ef((function(){var e=t.current?t.current.ownerDocument:document;if(void 0!==e&&!yf.has(e)){var n=e.createElement("style");n.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',yf.set(e,n);var r="undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0;r&&n.setAttribute("nonce",r),e.head.appendChild(n)}}),[])},If=function(t){var e=t.className,n=t.hsva,r=t.onChange,s={backgroundImage:"linear-gradient(90deg, "+Cf(Object.assign({},n,{a:0}))+", "+Cf(Object.assign({},n,{a:1}))+")"},o=_f(["react-colorful__alpha",e]),i=ff(100*n.a);return Gp.createElement("div",{className:o},Gp.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),Gp.createElement(pf,{onMove:function(t){r({a:t.left})},onKey:function(t){r({a:hf(n.a+t.left)})},"aria-label":"Alpha","aria-valuetext":i+"%","aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"},Gp.createElement(mf,{className:"react-colorful__alpha-pointer",left:n.a,color:Cf(n)})))},Af=function(t){var e=t.className,n=t.colorModel,r=t.color,s=void 0===r?n.defaultColor:r,o=t.onChange,i=af(t,["className","colorModel","color","onChange"]),a=ep(null);Rf(a);var l=function(t,e,n){var r=lf(n),s=Zg((function(){return t.toHsva(e)})),o=s[0],i=s[1],a=ep({color:e,hsva:o});Qg((function(){if(!t.equal(e,a.current.color)){var n=t.toHsva(e);a.current={hsva:n,color:e},i(n)}}),[e,t]),Qg((function(){var e;(function(t,e){if(t===e)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0})(o,a.current.hsva)||t.equal(e=t.fromHsva(o),a.current.color)||(a.current={hsva:o,color:e},r(e))}),[o,t,r]);var l=rp((function(t){i((function(e){return Object.assign({},e,t)}))}),[]);return[o,l]}(n,s,o),h=l[0],c=l[1],d=_f(["react-colorful",e]);return Gp.createElement("div",of({},i,{ref:a,className:d}),Gp.createElement(Sf,{hsva:h,onChange:c}),Gp.createElement(wf,{hue:h.h,onChange:c}),Gp.createElement(If,{hsva:h,onChange:c,className:"react-colorful__last-control"}))},Of={defaultColor:"rgba(0, 0, 0, 1)",toHsva:function(t){var e=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(t);return e?Tf({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}},fromHsva:function(t){var e=function(t){var e=t.h,n=t.s,r=t.v,s=t.a;e=e/360*6,n/=100,r/=100;var o=Math.floor(e),i=r*(1-n),a=r*(1-(e-o)*n),l=r*(1-(1-e+o)*n),h=o%6;return{r:ff(255*[r,a,i,i,l,r][h]),g:ff(255*[l,r,r,a,i,i][h]),b:ff(255*[i,i,l,r,r,a][h]),a:ff(s,2)}}(t);return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},equal:function(t,e){return t.replace(/\s/g,"")===e.replace(/\s/g,"")}},Nf=function(t){return Gp.createElement(Af,of({},t,{colorModel:Of}))},Mf=/^#?([0-9A-F]{3,8})$/i,xf=function(t){var e=t.color,n=void 0===e?"":e,r=t.onChange,s=t.onBlur,o=t.escape,i=t.validate,a=t.format,l=t.process,h=af(t,["color","onChange","onBlur","escape","validate","format","process"]),c=Zg((function(){return o(n)})),d=c[0],u=c[1],g=lf(r),p=lf(s),_=rp((function(t){var e=o(t.target.value);u(e),i(e)&&g(l?l(e):e)}),[o,l,i,g]),m=rp((function(t){i(t.target.value)||u(o(n)),p(t)}),[n,o,i,p]);return Qg((function(){u(o(n))}),[n,o]),Gp.createElement("input",of({},h,{value:a?a(d):d,spellCheck:"false",onChange:_,onBlur:m}))},kf=function(t){return"#"+t},Df=function(t){var e=t.prefixed,n=t.alpha,r=af(t,["prefixed","alpha"]),s=rp((function(t){return t.replace(/([^0-9A-F]+)/gi,"").substring(0,n?8:6)}),[n]),o=rp((function(t){return e=t,r=n,s=Mf.exec(e),3===(o=s?s[1].length:0)||6===o||!!r&&4===o||!!r&&8===o;var e,r,s,o}),[n]);return Gp.createElement(xf,of({},r,{escape:s,format:e?kf:void 0,process:kf,validate:o}))};var Lf="univer-input";class Pf extends Xp{constructor(){super(...arguments),this.ref={current:null},this.setValue=(t,e)=>{this.setState((e=>({value:t})),e)},this.handleChange=t=>{const{onChange:e}=this.props;if(!e)return;const n=t.target;this.setValue(n.value),e(t)},this.handlePressEnter=t=>{const{onPressEnter:e}=this.props;"Enter"===t.key&&(null==e||e(t),this.ref.current.blur())},this.onFocus=t=>{const{onFocus:e}=this.props;null==e||e(t)},this.onClick=t=>{const{onClick:e}=this.props;null==e||e(t)},this.onBlur=t=>{const{onBlur:e}=this.props;null==e||e(t)},this.getValue=()=>this.ref.current.value}initialize(t){this.state={value:t.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(t){t.value&&t.value!==this.state.value&&this.setValue(t.value)}render(t,e){const{id:n,disabled:r,type:s,placeholder:o,bordered:i=!0,className:a="",readonly:l}=t,{value:h}=e,c=g_(Lf,{[`${Lf}-disable`]:r,[`${Lf}-borderless`]:!i},a);return Vu("input",{type:s,onBlur:this.onBlur,onFocus:this.onFocus,className:c,placeholder:o,disabled:r,ref:this.ref,onChange:this.handleChange,value:h,onClick:this.onClick,readonly:l,id:n,onKeyUp:this.handlePressEnter})}}const Bf=t=>{let e,{color:n}=t;if(!n)return null;if(n.indexOf("#")>-1){if(n=Je.hexToRgbString(n),!n)return null;e=n.replace("rgba(","").replace(")","").split(",")}else n.indexOf("rgba")>-1?e=n.replace("rgba(","").replace(")","").split(","):(e=n.replace("rgb(","").replace(")","").split(","),e.push("1"));let r=ep(null);return Vu(Pf,{ref:r,type:"text",value:`rgba(${e})`,onChange:()=>{t.onChange(r.current.base.value)}})};var Hf={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class Ff extends Xp{initialize(t){this.state={color:t.color||"#000"}}setColor(t){this.setState({color:t}),this.props.onChange(t)}render(){return Vu("div",{className:Hf.colorPickerPanel,onClick:t=>t.stopPropagation()},Vu(Nf,{className:Hf.colorPicker,color:this.state.color,onChange:p_(this.setColor.bind(this),500)}),Vu("div",{className:Hf.colorPickerPanelSetting},Vu("div",{className:Hf.panelInput},this.props.rgb?Vu(Bf,{color:this.state.color,onChange:p_(this.setColor.bind(this),500)}):Vu(Df,{color:this.state.color,onChange:p_(this.setColor.bind(this),500)})),Vu("div",{className:Hf.panelColor},Vu("div",{style:{background:this.state.color}}),Vu("div",{style:{background:this.props.color}}))))}}var Uf="univer-color-picker-outer",zf="univer-color-picker",Wf="univer-picker",Vf="univer-picker-swatches",Yf="univer-picker-swatches-item",Gf="univer-picker-swatch",Xf="univer-picker-swatch-btn",jf="univer-colorful-warp";let $f=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class Kf extends Xp{constructor(){super(...arguments),this.ulRef={current:null},this.onChange=t=>{this.props.onChange&&this.props.onChange(t),this.setState({afterColor:t})},this.onClick=(t,e)=>{this.props.onClick&&this.props.onClick(t,e)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=t=>{t&&this.ulRef.current.contains(t.target)||(this.setState((t=>({styles:{display:"none"}}))),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=t=>{this.setState((t=>({styles:{display:"block"}}))),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(t,e)=>{const n=t.getBoundingClientRect(),r=this.ulRef.current.getBoundingClientRect(),s=document.documentElement.clientWidth||document.body.clientWidth,o=document.documentElement.clientHeight||document.body.clientHeight;let i=0,a=0;return a=n.top+r.height>o?n.top-r.height:n.top+n.height,i=n.left+r.width>s?s-r.width:n.left,{left:i,top:a}},this.onSwitch=t=>{t.stopImmediatePropagation(),new Promise(((t,e)=>{this.setState({setting:!this.state.setting}),t("end")})).then((()=>{if(this.state.root){const{top:t,left:e}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${e}px`,this.ulRef.current.style.top=`${t}px`}}))}}initialize(t){this.state={presetColors:$f,defaultColor:t.color||"#000",afterColor:t.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}render(){const t=Object.assign(this.state.styles||{},this.props.style);return Vu("div",{className:`${Uf} ${this.props.className}`,ref:this.ulRef,style:__spreadValues({},t)},Vu("div",{className:zf,onClick:t=>{}},Vu("div",{className:Wf},Vu("div",{className:Vf},this.state.presetColors.map((t=>Vu("div",{className:Yf},t.map((t=>Vu("span",{className:Gf,style:{background:t}},Vu(zv,{title:t,placement:"top"},Vu("button",{key:t,className:Xf,style:{background:t},onClick:e=>{this.props.onClick&&this.props.onClick(t,e)}}))))))))),Vu("div",{onClick:t=>t.stopImmediatePropagation()},Vu(Zm,{onClick:this.onSwitch},this.state.setting?this.getLocale("colorPicker.collapse"):this.getLocale("colorPicker.customColor")))),this.state.setting?Vu("div",{className:jf},Vu(Ff,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),Vu("div",null,Vu(Zm,{type:"primary",onClick:t=>{var e;null==(e=this.onClick)||e.call(this,this.state.afterColor,t)}},this.getLocale("colorPicker.confirmColor")),Vu(Zm,{danger:!0,onClick:t=>{this.onCancel()}},this.getLocale("colorPicker.cancelColor")),Vu(Zm,{onClick:t=>{t.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.getLocale("colorPicker.change")))):null))}}var qf="univer-color-picker-circle-button",Zf="univer-color-select-circle",Jf="univer-vertical-middle";const Qf=fp(((t,e)=>{const{children:n,style:r,className:s,onClick:o,onContextMenu:i}=t;return Vu("div",{onContextMenu:i,ref:e,style:r,className:s,onClick:o},n)}));var tv="univer-format-modal";var ev="univer-layout-wrapper",nv="univer-layout-wrapper-has-sider",rv="univer-header-wrapper",sv="univer-footer-wrapper",ov="univer-content-wrapper",iv="univer-sider-wrapper";class av extends Xp{constructor(){super(...arguments),this.ref={current:null},this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let t=u_(this.ref.current);const e=t instanceof Array?t:[t];for(const n of e)"ASIDE"===n.tagName&&this.setState({isAside:!0})}}render(t,e){const{children:n,style:r,className:s=""}=t,{isAside:o}=e;return Vu("section",{style:r,ref:this.ref,className:o?`${ev} ${nv} ${s}`:`${ev} ${s}`},n)}}const lv=t=>{const{children:e,style:n,className:r=""}=t;return Vu("header",{style:n,className:`${rv} ${r}`},e)},hv=t=>{const{children:e,style:n,className:r=""}=t;return Vu("footer",{style:n,className:`${sv} ${r}`},e)},cv=fp(((t,e)=>{const{children:n,style:r,className:s=""}=t;return Vu("main",{ref:e,style:r,className:`${ov} ${s}`},n)})),dv=t=>{const{children:e,style:n,className:r=""}=t;return Vu("aside",{style:n,className:`${iv} ${r}`},e)};var uv="univer-cols-menu",gv="univer-cols-menuitem",pv="univer-cols-menuitem-line",_v="univer-cols-menuitem-disabled";class mv extends Xp{constructor(){super(...arguments),this._MenuRef={current:null},this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(t,e,n)=>{var r,s;const{deep:o=0}=this.props;null==(r=e.onClick)||r.call(null,t,e.value,n,o),null==(s=this.props.onClick)||s.call(null,t,e.value,n,o),this.showMenu(!1)},this.showMenu=t=>{this.setState((e=>({show:t})),(()=>{this.getStyle()}))},this.mouseEnter=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!0)},this.mouseLeave=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!1)},this.getStyle=()=>{var t;const e=this._MenuRef.current;if(!e)return;let n={};const r=e.getBoundingClientRect();let s;const{dom:o,parent:i}=this.props;if(s=o?o.getBoundingClientRect():{left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},i){e.style.position="fixed";let o=null==(t=e.parentElement)?void 0:t.getBoundingClientRect();if(!o)return;o.right+r.width>s.right?(n.left=o.left-r.width+"px",n.top=`${o.top}px`):(n.left=`${o.right}px`,n.top=`${o.top}px`),r.bottom>s.bottom&&(n.top="auto",n.bottom="5px"),this.setState({posStyle:n})}}}render(){const{className:t="",style:e="",menu:n,deep:r=0}=this.props,{show:s,posStyle:o}=this.state;return Vu("ul",{className:g_(uv,t),style:__spreadProps(__spreadValues(__spreadValues({},e),o),{display:s?"block":"none"}),ref:this._MenuRef},null==n?void 0:n.map(((t,e)=>{var n,s;if(!1!==t.show)return Vu(Xu,null,Vu("li",{className:g_(gv,null!=(n=t.className)?n:"",t.disabled?_v:""),style:null!=(s=t.style)?s:"",onClick:n=>this.handleClick(n,t,e),onMouseEnter:t=>{this.mouseEnter(t,e)},onMouseLeave:t=>{this.mouseLeave(t,e)}},t.label,t.children?Vu(mv,{ref:t=>this._refs[e]=t,menu:t.children,onClick:t.onClick,className:t.className,style:t.style,parent:this,deep:r+1}):Vu(Xu,null)),t.border?Vu("div",{className:pv}):"")})))}initialize(){this.state={show:!1,posStyle:{}}}}var fv="univer-drag";class vv extends Xp{constructor(){super(...arguments),this.root={current:null},this.onMouseMove=t=>{let e=this.state.offsetX,n=this.state.offsetY,r=t.x-e+"px",s=t.y-n+"px";this.setState({top:s,left:r})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(t){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(t){window.addEventListener("mousemove",this.onMouseMove);let e=t.offsetX,n=t.offsetY;this.setState({offsetX:e,offsetY:n})}getWindowRect(){const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth,r=this.root.current.offsetHeight,s=this.root.current.offsetLeft,o=this.root.current.offsetTop,i=(e-r)/2+"px",a=(t-n)/2+"px";this.setState({width:t,height:e,rootW:n,rootH:r,rootL:s,rootT:o,top:i,left:a})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:t,className:e=""}=this.props;return Vu(Xu,null,t?Vu("div",{ref:this.root,className:`${fv} ${e}`,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}var bv="univer-modal-mask",Cv="univer-modal-wrapper",Tv="univer-modal-drag",wv="univer-modal-darg-wrapper",Sv="univer-modal-header",Ev="univer-modal-close",yv="univer-modal-body",Rv="univer-modal-footer";class Iv extends Xp{constructor(){super(...arguments),this.handleClickCancel=t=>{t&&t()},this.showModal=t=>{this.setState((e=>({visible:t})))},this.handleClick=t=>{this.showModal(!1),t&&t()}}initialize(){var t;this.state={visible:null!=(t=this.props.visible)&&t}}componentWillReceiveProps(t){t.visible!==this.state.visible&&this.setState({visible:t.visible})}render(){const{title:t,width:e=500,top:n=0,style:r,children:s,className:o="",group:i=[],isDrag:a=!1,mask:l=!0,footer:h=!0}=this.props,{visible:c}=this.state;return Vu(Xu,null,c?Vu("div",{className:o},l?Vu("div",{className:bv,onClick:t=>{var e,n;null==(n=(e=this.props).onCancel)||n.call(e,t),this.showModal(!1)}}):null,Vu(vv,{isDrag:a,className:Tv},Vu("div",{className:`${a?wv:Cv}`,style:__spreadValues({width:`${e}px`},r)},Vu("div",{className:Sv},Vu("span",null,t),Vu("span",{className:Ev,onClick:t=>{var e,n;null==(n=(e=this.props).onCancel)||n.call(e,t),this.showModal(!1)}},Vu(Wm.Close,null))),Vu("div",{className:yv},s),h?Vu("div",{className:Rv},i.map((t=>Vu(Zm,{type:t.type,onClick:()=>this.handleClick(t.onClick)},this.getLocale(t.label))))):null))):null)}}var Av="univer-radio-group",Ov="univer-radio-wrap",Nv="univer-radio-left",Mv="univer-circle",xv="univer-active",kv="univer-fork",Dv="univer-label";var Lv={resizeDialog:"univer-resize-dialog",dialogMove:"univer-dialog-move",moveItem:"univer-move-item",moveTop:"univer-move-top",moveRight:"univer-move-right",moveBottom:"univer-move-bottom",moveLeft:"univer-move-left",dialogResize:"univer-dialog-resize",dialogResizeActive:"univer-dialog-resize-active",resizeItem:"univer-resize-item",resizeLt:"univer-resize-lt",resizeMt:"univer-resize-mt",resizeLm:"univer-resize-lm",resizeRm:"univer-resize-rm",resizeRt:"univer-resize-rt",resizeLb:"univer-resize-lb",resizeMb:"univer-resize-mb",resizeRb:"univer-resize-rb"};var Pv="univer-tooltip-Group",Bv="univer-tooltip-title",Hv="univer-tooltip-body",Fv="univer-tooltip-triangle";const Uv={top:"univer-top",bottom:"univer-bottom",left:"univer-left",right:"univer-right"};class zv extends Xp{constructor(){super(...arguments),this.tooltip={current:null}}initialize(t){this.state={placement:t.placement||"top",placementClassName:g_(Bv,Uv[t.placement||"top"]),top:"",left:"",show:!1}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let t=this.tooltip.current.getBoundingClientRect(),e=t.height,n=t.width;"bottom"===this.state.placement?this.setState({top:e+10,left:n/2,show:!0}):"left"===this.state.placement?this.setState({top:e/2,left:n+5,show:!0}):"right"===this.state.placement?this.setState({top:e/2,left:-n-10,show:!0}):this.setState({top:-e-20,left:n/2,show:!0})}}handleMouseLeave(){this.setState({show:!1})}render(){return Vu("div",{ref:this.tooltip,className:Pv,style:this.props.styles},Vu("div",{className:Hv,onMouseEnter:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},this.props.children),this.props.title?Vu("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`,display:""+(this.state.show?"block":"none")}},this.props.title,Vu("span",{className:Fv})):null)}}var Wv="univer-dropdown",Vv="univer-drop-content",Yv="univer-drop-icon";class Gv extends Xp{constructor(){super(...arguments),this.MenuRef={current:null},this.DropRef={current:null},this.IconRef={current:null},this.handleClick=t=>{var e,n,r,s,o;null==(n=(e=this.props).onClick)||n.call(e),null==(s=(r=this.props).onMainClick)||s.call(r);const{icon:i}=this.props;i||null==(o=this.MenuRef.current)||o.showMenu(!0)},this.handleSubClick=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!0)},this.hideMenu=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!1)},this.hideMenuClick=t=>{var e;this.DropRef.current&&(null==(e=this.DropRef.current)?void 0:e.contains(t.target))||this.hideMenu()}}componentDidMount(){const{placement:t}=this.props;let e={position:"absolute"};t&&"Bottom"!==t?"Top"===t?(e.left=0,e.top="-100%"):"Left"===t?(e.left="-100%",e.top=0):(e.left="100%",e.top=0):(e.left=0,e.top="100%"),this.setState({menuStyle:e}),window.addEventListener("click",this.hideMenuClick,!0)}componentWillUnmount(){window.removeEventListener("click",this.hideMenuClick,!0)}render(){const{children:t,menu:e,showArrow:n,icon:r,tooltip:s}=this.props,{menuStyle:o}=this.state;return Vu("div",{className:Wv,ref:this.DropRef},Vu(zv,{title:s,placement:"bottom"},Vu("div",{className:Vv,onClick:this.handleClick},t,n?Vu(bm.NextIcon,null):"")),r?Vu("div",{ref:this.IconRef,className:Yv,onClick:this.handleSubClick},r):"",Vu(mv,{onClick:e.onClick,ref:this.MenuRef,menu:e.menu,className:e.className,style:__spreadValues(__spreadValues({},e.style),o)}))}initialize(){this.state={menuStyle:{}}}}var Xv="univer-line",jv="univer-vertical";var $v="univer-sider-modal",Kv="univer-sider-modal-header",qv="univer-sider-modal-title",Zv="univer-sider-modal-close",Jv="univer-sider-modal-body",Qv="univer-sider-modal-body-inner",tb="univer-sider-modal-footer";var eb="univer-slider";class nb extends Xp{constructor(){super(...arguments),this.ref={current:null},this.onInput=(t,e)=>{var n;const r=e.target.value;this.changeInputValue(t,r),null==(n=this.props.onChange)||n.call(this,e)},this.onClick=(t,e)=>{var n;const{min:r=0,max:s=100,step:o=1}=this.props,i=e.currentTarget;let a=e.offsetX;const l=i.offsetWidth;if(a<0||a>l)return;let h=a/this.width*(s-r);h%o&&(h+=o-h%o),this.changeInputValue(t,h),null==(n=this.props.onClick)||n.call(this,e,h)},this.changeInputValue=(t,e)=>{let n=this.ref.current,r=n.getElementsByTagName("input")[t].id;n.style.setProperty(`--${r}`,e),t?this.setValue({valueNext:e}):this.setValue({valuePrev:e})},this.setValue=(t,e)=>{this.setState((e=>__spreadValues({},t)),e)}}initialize(t){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=d_("slider"),this.idNext=d_("slider")}componentDidMount(){const{min:t=0,max:e=100,range:n}=this.props;let r=e-t,s=this.ref.current;if(this.width=s.offsetWidth,s.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${eb}::after`,`margin-left: calc((var(--${this.idNext}) - ${t})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${eb}::after {margin-left: calc((var(--${this.idNext}) - ${t})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);}`,0),document.styleSheets[0].addRule(`.${eb}::before`,`margin-left: calc((var(--${this.idPrev}) - ${t})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${eb}::before {margin-left: calc((var(--${this.idPrev}) - ${t})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);}`,0),n){let{value:t}=this.props;t=t||[0,0],this.setValue({valuePrev:t[0],valueNext:t[1]})}else{let{value:t}=this.props;t=t||0,this.changeInputValue(0,t)}}render(t,e){const{valuePrev:n,valueNext:r}=e,{step:s=1,min:o=0,max:i=100,range:a=!1}=t;return a?Vu("div",{className:eb,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":i},ref:this.ref},Vu("label",{class:"sr-only",for:this.idPrev}),Vu("input",{id:this.idPrev,type:"range",min:o,value:n,max:i,step:s,onInput:t=>this.onInput(0,t)}),Vu("label",{class:"sr-only",for:this.idNext}),Vu("input",{id:this.idNext,type:"range",min:o,value:r,max:i,step:s,onInput:t=>this.onInput(1,t)})):Vu("div",{className:eb,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":i},ref:this.ref,onClick:t=>this.onClick(0,t)},Vu("label",{class:"sr-only",for:this.idPrev}),Vu("input",{id:this.idPrev,type:"range",min:o,value:n,max:i,step:s,onInput:t=>this.onInput(0,t)}))}}var rb="univer-tabs",sb="univer-tabs-nav",ob="univer-tabs-nav-wrap",ib="univer-tabs-nav-list",ab="univer-tabs-tab",lb="univer-tabs-tab-active",hb="univer-tabs-content",cb="univer-tabs-panel",db="univer-tabs-panel-active";const ub=t=>{const{id:e,keys:n,style:r,children:s,active:o}=t;return Vu("div",{id:e&&`${e}-panel-${n}`,role:"tabpanel",style:__spreadValues({},r),className:g_(cb,o&&db)},o&&s)};var gb="univer-cols-menu",pb="univer-cols-menu-jsx",_b="univer-cols-menuitem",mb="univer-line",fb="univer-cols-menuitem-content",vb="univer-ul-icon",bb="univer-submenu-arrow";class Cb extends Xp{constructor(){super(...arguments),this.refs=[],this.ulRef={current:null},this.filterChildren=t=>{let e;return Array.from(t.children).forEach((t=>{"UL"===t.nodeName&&(e=!0)})),e},this.mouseOver=(t,e)=>{this.refs.forEach((t=>{t.hideSelect()}));const n=t.currentTarget;this.filterChildren(n)&&this.refs[e].showSelect()},this.mouseLeave=(t,e)=>{"jsx"!==(this.refs[e]?this.refs[e].props.children[0].selectType:"")&&this.refs.forEach((t=>{t.hideSelect()}))},this.handleClick=(t,{item:e,index:n,ref:r},s)=>{t.stopImmediatePropagation(),null==s||s.call(this,t,{item:e,index:n,ref:r})},this.handleKeyUp=(t,{item:e,index:n,ref:r},s)=>{t.stopImmediatePropagation(),null==s||s.call(this,t,{item:e,index:n,ref:r})},this.sendParent=()=>this,this.hideSelect=()=>{var t;window.removeEventListener("resize",this.resizeUl),"none"!==(null==(t=this.state.style)?void 0:t.display)&&(this.refs.forEach((t=>{t.hideSelect()})),this.setState((t=>({style:{display:"none"}}))))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState((t=>({style:{display:"inline-block"}})),(()=>{this.getStyle()}))},this.getStyle=()=>{var t;const e=null==(t=this.ulRef.current)?void 0:t.parentElement,n=this.ulRef.current;let r,s={};if(!n||!e)return;const o=n.getBoundingClientRect();let i=null==e?void 0:e.getBoundingClientRect();r=this.getContext().getPluginManager().getPluginByName("spreadsheet").getSheetContainerControl().getContentRef().current.getBoundingClientRect(),r&&i&&("LI"===(null==e?void 0:e.nodeName)?(n.style.position="fixed",i=null==e?void 0:e.getBoundingClientRect(),i.right+o.width>r.right?(s.left=i.left-o.width+"px",s.top=`${i.top}px`):(s.left=`${i.right}px`,s.top=`${i.top}px`)):"DIV"===(null==e?void 0:e.nodeName)&&(i.right+o.width>r.right||i.right+o.width>document.documentElement.clientWidth?(s.right="0",s.left="auto"):(s.left="0",s.right="auto"),o.top>=r.bottom&&(s.top="auto",s.bottom="100%")),this.setState((t=>({posStyle:s}))))},this.showIcon=t=>"selected"in t||"hidden"in t?t.selected?Vu("span",{className:vb},Vu(bm.CorrectIcon,{style:{fontSize:"13px"}})):t.hidden?Vu("span",{className:vb},Vu(bm.HideIcon,{style:{fontSize:"13px"}})):Vu("span",{className:vb}):"",this.getIcon=t=>{let e=t;return"string"==typeof e&&/Icon$/.test(e)&&(e=Vm[e]),Vu("span",{className:bb},e)},this.getParent=()=>{var t;return null!=(t=this.props.getParent())?t:null}}componentWillMount(){const{show:t=!1}=this.props;t&&this.setState((t=>({style:{display:"inline-block"}})))}render(t,e){var n;const{children:r,onClick:s,style:o,onKeyUp:i}=t,{posStyle:a}=e,l=Object.assign(null!=(n=this.state.style)?n:{},a,o||{});return(null==r?void 0:r.length)?(r.some(((t,e)=>!!t.selected&&(r.forEach(((t,n)=>{e!==n&&(t.selected=!1)})),!0))),Vu("ul",{className:"jsx"===r[0].selectType?pb:gb,style:__spreadValues({},l),ref:this.ulRef},null==r?void 0:r.map(((t,e)=>{var n;let r=t.className?`${_b} ${t.className}`:_b;if(!t.hideLi)return Vu("li",{className:r,style:__spreadValues({},t.style),onClick:n=>{n.stopPropagation(),this.handleClick(n,{item:t,index:e,ref:this},t.onClick?t.onClick:s)},onMouseEnter:t=>{this.mouseOver(t,e)},onMouseLeave:t=>{this.mouseLeave(t,e)},onKeyUp:n=>{this.handleKeyUp(n,{item:t,index:e,ref:this},t.onKeyUp?t.onKeyUp:i)}},Vu("div",{className:"jsx"===t.selectType?"":fb},this.showIcon(t),Vu("div",null,"jsx"===t.selectType?Vu("span",null,pg(t.label,{onChange:this.getStyle})):Vu("span",null,t.label),t.icon?this.getIcon(t.icon):"")),(null==(n=t.children)?void 0:n.length)?Vu(Cb,{children:t.children,onClick:t.onClick,ref:t=>this.refs[e]=t,getParent:this.sendParent}):Vu(Xu,null),t.border?Vu("div",{className:mb}):"")})))):Vu(Xu,null)}initialize(t){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=p_(this.getStyle,200)}}var Tb="univer-confirm-modal";var wb="univer-select-item",Sb="univer-select-item-selected",Eb="univer-select-item-content",yb="univer-select-item-suffix",Rb="univer-select-disabled-item";class Ib extends Xp{render(){const{selected:t,label:e,suffix:n,disabled:r}=this.props;return Vu("div",{className:g_(wb,r?Rb:"")},t?Vu("span",{className:Sb},Vu(pm,null)):"",Vu("span",{className:Eb},e),n?Vu("span",{className:yb},n):"")}}var Ab,Ob,Nb,Mb,xb="univer-select-component",kb="univer-select-single",Db="univer-select-input",Lb="univer-select-double",Pb="univer-select-label";(Ob=Ab||(Ab={}))[Ob.SINGLE=0]="SINGLE",Ob[Ob.INPUT=1]="INPUT",Ob[Ob.COLOR=2]="COLOR",Ob[Ob.DOUBLE=3]="DOUBLE",Ob[Ob.FIX=4]="FIX",Ob[Ob.DOUBLEFIX=5]="DOUBLEFIX",(Mb=Nb||(Nb={}))[Mb.LABEL=0]="LABEL",Mb[Mb.SUFFIX=1]="SUFFIX";class Bb extends pp{constructor(){super(...arguments),this.handleSelected=t=>{const{children:e=[],hideSelectedIcon:n}=this.props;e.length&&(e.forEach((t=>{t.selected=!1})),null!==t&&(e[t].selected=!0));return this.resetMenu(e,n)},this.getSingle=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:r,onMainClick:s}=this.props;return Vu("div",{className:`${kb} ${n}`},Vu(Gv,{onMainClick:s,tooltip:r,menu:{menu:e,onClick:this.onClick},showArrow:!0},Vu("div",null,t)))},this.handlePressEnter=(t,e)=>{var n;this.onPressEnter(t),null==(n=e.current)||n.hideMenu()},this.getInput=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:r,onMainClick:s}=this.props,o={current:null};return Vu("div",{className:`${Db} ${n}`},Vu(Gv,{onMainClick:s,ref:o,tooltip:r,menu:{menu:e,onClick:this.onClick},showArrow:!0},Vu(Pf,{onPressEnter:t=>this.handlePressEnter(t,o),onBlur:this.onPressEnter,type:"number",value:t})))},this.getDouble=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:r,onClick:s}=this.props;return Vu("div",{className:`${Lb} ${n}`},Vu(Gv,{onClick:s,tooltip:r,menu:{menu:e,onClick:this.onClick},icon:Vu(um,null)},Vu("div",{className:Pb},t)))},this.getFix=()=>{const{label:t,className:e="",tooltip:n}=this.props,{menu:r}=this.state;return Vu("div",{className:`${Lb} ${e}`},Vu(Gv,{tooltip:n,menu:{menu:r,onClick:this.onClick},showArrow:!0},Vu("div",{className:Pb},t)))},this.getDoubleFix=()=>{const{label:t,className:e="",tooltip:n,onClick:r}=this.props,{menu:s}=this.state;return Vu("div",{className:`${Lb} ${e}`},Vu(Gv,{tooltip:n,onClick:r,menu:{menu:s,onClick:this.onClick},icon:Vu(um,null)},Vu("div",{className:Pb},t)))}}initialize(){var t;const{children:e=[],hideSelectedIcon:n}=this.props,r=this.resetMenu(e,n);this.state={menu:r,color:null!=(t=this.props.defaultColor)?t:"#000",content:"",value:""}}getType(t){switch(t){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:t,display:e,children:n=[],label:r}=this.props;if(0===t||3===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const r=this.handleSelected(t),s=n[t];1===e?this.setState({content:s.suffix,menu:r}):this.setState({content:s.label,menu:r}),this.onClick=(...t)=>{var r,s;const o=n[t[2]];if(null==(s=(r=this.props).onClick)||s.call(r,t[1],t[2],t[3]),o.unSelectable)return;const i=this.handleSelected(t[2]);1===e?this.setState({content:n[t[2]].suffix,menu:i}):this.setState({content:n[t[2]].label,menu:i})}}else if(1===t){if(!n.length)return;const t=t=>{if(null!==t){if(""===t)return;let e=n.findIndex((e=>t===e.label)),r=this.handleSelected(e<0?null:e);this.setState({content:t,menu:r})}else{let t=n.findIndex((t=>t.selected));t<0&&(t=0);let e=this.handleSelected(t);const r=n[t];this.setState({content:r.label,menu:e})}};t(r),this.onClick=(...t)=>{var e,r;null==(r=(e=this.props).onClick)||r.call(e,t[1],t[2],t[3]);const s=this.handleSelected(t[2]);this.setState({content:n[t[2]].label,menu:s})},this.onPressEnter=e=>{var n,r;const s=e.currentTarget.value;null==(r=(n=this.props).onPressEnter)||r.call(n,s),t(s)}}else if(2===t){const t=this.handleSelected(null);this.setState({menu:t}),this.onClick=()=>{var t,e;const{color:n}=this.state;null==(e=(t=this.props).onClick)||e.call(t,n)}}else if(4===t||5===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const e=n[t],r=this.handleSelected(t);this.setState({menu:r,value:e.value}),this.onClick=(...t)=>{var e,r,s,o;if(t.length){null==(r=(e=this.props).onClick)||r.call(e,t[1],t[2],t[3]);const s=this.handleSelected(t[2]);this.setState({menu:s,value:n[t[2]].value})}else null==(o=(s=this.props).onClick)||o.call(s,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(t){}resetMenu(t,e){var n;const r=[];for(let s=0;s<t.length;s++){let o=!1;e||(o=null!=(n=t[s].selected)&&n),r[s]={label:""},r[s].label=Vu(Ib,{disabled:t[s].disabled,border:t[s].border,selected:o,label:t[s].label,suffix:t[s].suffix}),r[s].disabled=t[s].disabled,r[s].style=t[s].style,r[s].value=t[s].value,r[s].className=t[s].className,r[s].onClick=t[s].onClick,r[s].border=t[s].border,t[s].children&&(r[s].children=this.resetMenu(t[s].children))}return r}render(){const{type:t=0}=this.props;return Vu("div",{className:xb},this.getType(t))}}var Hb="univer-cell-range-modal",Fb="univer-cell-modal-icon";var Ub=Object.freeze(Object.defineProperty({__proto__:null,BaseCellEditExtension:mg,BaseCellEditExtensionFactory:class{get zIndex(){return 0}create(t,e){return new mg(t,e)}check(t){return!1}},CellEditExtensionManager:Cg,CellEditExtensionRegister:bg,BaseCellInputExtension:Tg,BaseCellInputExtensionFactory:class{constructor(t){this._plugin=t}get zIndex(){return 0}create(t,e){return new Tg(t,e)}check(t){return!1}},CellInputExtensionManager:yg,CellInputExtensionRegister:Eg,BaseClipboardExtension:Rg,BaseClipboardExtensionFactory:class{constructor(t){this._plugin=t}get zIndex(){return 0}create(t){return new Rg(t,this._plugin)}check(t){return!1}},ClipboardExtensionManager:Ng,ClipboardExtensionRegister:Ig,BaseDragAndDropExtension:Mg,BaseDragAndDropExtensionFactory:class{constructor(t){this._plugin=t}get zIndex(){return 0}create(t){return new Mg(t,this._plugin)}check(t){return!1}},DragAndDropExtensionManager:kg,DragAndDropExtensionRegister:xg,Clipboard:Og,AppContext:Dg,KeyboardManager:Lg,DragManager:Pg,EventManager:Bg,ComponentManager:Ym,RegisterManager:Gm,get DescriptionEnum(){return Lm},get ComponentType(){return Bm},get ISelectButton(){return Fm},get LocaleType(){return zm},isElement:l_,isDOM:h_,$$:c_,addClass:function(t,e,n){if("string"!=typeof e)return void e.classList.add(t);n=n||document,Array.prototype.slice.call(n.querySelectorAll(e)).forEach((e=>{e.classList.add(t)}))},removeClass:function(t,e,n){if("string"!=typeof e)return void e.classList.remove(t);n=n||document,Array.prototype.slice.call(n.querySelectorAll(e)).forEach((e=>{e.classList.remove(t)}))},closest:function(t,e){const n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;for(;t;){if(n.call(t,e))return t;t=t.parentElement}return null},randomId:d_,getFirstChildren:u_,joinClassNames:g_,getNodeindex:t=>[...t.parentNode.children].indexOf(t),debounce:p_,selectTextContent:__,selectTextContentCross:m_,isInPage:f_,textTrim:v_,getRefElement:b_,printableCharacter:function(t){return t>47&&t<58||32===t||13===t||t>64&&t<91||t>95&&t<112||t>185&&t<193||t>218&&t<223},xssDeal:C_,setLastCaretPosition:T_,findLocale:w_,handleDomToJson:Xm,handleStringToStyle:jm,splitSpanText:$m,handelTableToJson:function(t){let e=[];const n=document.createElement("DIV");if(n.innerHTML=t,e=new Array(n.querySelectorAll("table tr").length),!e.length)return[];let r=0;const s=n.querySelectorAll("table tr");s[0].querySelectorAll("td").forEach((t=>{let e=0;const n=t.getAttribute("colSpan");e=null!==n?+n:1,r+=e}));for(let i=0;i<e.length;i++)e[i]=new Array(r);let o=0;return s.forEach((t=>{let n=0;t.querySelectorAll("td").forEach((t=>{let s={};if(t.querySelectorAll("span").length||t.querySelectorAll("font").length){const e=Xm(t);"string"!=typeof e&&(s.p=e)}let i=t.innerText;0===i.trim().length?(s.v="",s.m=""):(s.v=i,s.m=i);const a=jm(t);for(C.isPlainObject(a)&&(s.s=a);n<r&&null!=e[o][n];)n++;if(n!==r){if(null==e[o][n]){e[o][n]=s;let r=Number(t.getAttribute("rowSpan")),i=Number(t.getAttribute("colSpan"));if(Number.isNaN(r)&&(r=1),Number.isNaN(i)&&(i=1),r>1||i>1){let t={rs:r-1,cs:i-1,r:o,c:n};e[o][n].mc=t;for(let s=0;s<r;s++)for(let t=0;t<i;t++)0===s&&0===t||(e[o+s][n+t]={mc:null})}}n++}})),o++})),e},handlePlainToJson:function(t){let e=[];document.createElement("DIV").innerHTML=t;let n=t.replace(/\r/g,"").split("\n"),r=n[0].split("\t").length;for(let s=0;s<n.length;s++)n[s].split("\t").length<r||e.push(n[s].split("\t"));for(let s=0;s<e.length;s++)for(let t=0;t<e[s].length;t++)e[s][t].length?e[s][t]={v:e[s][t]||"",m:e[s][t]||""}:e[s][t]=null;return e},handleTableMergeData:function(t,e){t.length,t[0].length;let n=0,r=0;e&&(n=e.startRow,r=e.startColumn);const s=[];for(let o=0;o<t.length;o++)for(let e=0;e<t[o].length;e++)if(t[o][e]&&"object"==typeof t[o][e]&&"mc"in t[o][e])if(t[o][e].mc){const i=t[o][e].mc,a=i.r+n,l=a+i.rs,h=i.c+r,c=h+i.cs;s.push({startRow:a,endRow:l,startColumn:h,endColumn:c}),delete t[o][e].mc}else t[o][e]=null;return{data:t,mergeData:s}},Prompt:class extends Xp{constructor(t){var e;super(),this.state={show:null!=(e=t.show)&&e}}showModal(t){this.setState({show:t})}handleClick(){const{onClick:t}=this.props;null==t||t(),this.showModal(!1)}getGroup(){return[{label:this.getLocale("button.confirm"),type:"primary",onClick:()=>this.handleClick()},{label:this.getLocale("button.cancel"),onClick:()=>this.showModal(!1)}]}componentWillReceiveProps(t){t.show!==this.props.show&&this.setState({show:t.show})}render(){const{title:t,content:e}=this.props,{show:n}=this.state;return Vu("div",{className:Tb},Vu(Iv,{visible:n,isDrag:!0,title:t,group:this.getGroup()},e))}},get SelectTypes(){return Ab},Select:Bb,CellRange:class extends Xp{constructor(t){var e;super(),this.ref={current:null},this.handleOk=t=>{const{onClick:e}=this.props;this.ref.current.getValue(),null==e||e(t),this.showModal(!1)},this.handleChange=t=>{const{onChange:e}=this.props;null==e||e(t)},this.state={value:null!=(e=t.value)?e:"",show:!1},this.group=[{label:"button.confirm",type:"primary",onClick:t.onClick}]}showModal(t){this.setState({show:t})}componentWillReceiveProps(t){t.value!==this.state.value&&this.setState({value:t.value})}render(){const{placeholder:t,title:e,contentPlaceholder:n}=this.props,{value:r,show:s}=this.state;return Vu("div",{className:Hb},Vu(Pf,{placeholder:t,value:r,onChange:this.handleChange}),Vu("span",{className:Fb,onClick:()=>this.showModal(!0)},Vu(km.TableIcon,null)),Vu(Iv,{title:e,visible:s,group:this.group},Vu(Pf,{readonly:!0,placeholder:n,value:r,ref:this.ref})))}},Avatar:t=>{const{alt:e,shape:n="circle",size:r,src:s,onError:o,style:i,fit:a="fill",children:l,onLoad:h,title:c}=t,d="number"==typeof r?{width:r,height:r,lineHeight:`${r}px`}:{},u=g_(Km,{[`${Km}-${n}`]:n,[`${Km}-image`]:s,[`${Km}-lg`]:"large"===r,[`${Km}-sm`]:"small"===r}),g=a?{objectFit:a}:{};return s?Vu("span",{className:u,style:__spreadValues(__spreadValues(__spreadValues({},d),i),g)},Vu("img",{src:s,title:c,alt:e,onError:o,onLoad:h}),l):Vu("span",{className:u,style:__spreadValues(__spreadValues({},d),i)},l)},Button:Zm,Collapse:t=>{const{children:e}=t;return Vu("div",{className:sf.collapseWrapper},e)},Panel:t=>{const{header:e,children:n}=t;let[r,s]=Zg(g_(sf.panelBody));return Vu("div",{className:sf.panelWrapper},Vu("div",{className:sf.panelHeader,onClick:()=>{r.includes("active")?s(g_(sf.panelBody)):s(g_(sf.panelBody,sf.active))}},e,Vu("span",{className:`${sf.panelHeaderIcon} ${r.includes("active")?sf.panelHeaderIconRotate:""}`},Vu(bm.NextIcon,null))),Vu("div",{className:r},n))},Menu:mv,Container:Qf,Layout:av,Header:lv,Footer:hv,Content:cv,Sider:dv,Tooltip:zv,Icon:Vm,Input:Pf,Separator:t=>{const{mode:e}=t;return Vu("div",{className:`${Xv} ${e?jv:""}`})},ColorPicker:Kf,Ul:Cb,Modal:Iv,Slider:nb,Radio:class extends Xp{render(){return Vu("div",{className:Ov},Vu("div",{className:Nv},Vu("div",{onClick:this.props.onClick.bind(this,this.props.value)},Vu("div",{className:`${Mv} ${this.props.active&&xv}`},Vu("div",{className:kv})),Vu("div",{className:Dv},this.props.label)),this.props.children))}},RadioGroup:class extends Xp{handleActiveChange(t){this.props.onChange(t)}render(){const{vertical:t,className:e=""}=this.props;return Vu("div",{className:`${t?Av:""} ${e||""}`},this.props.children.map((t=>{let e=this.props.active===t.props.value;return pg(t,{label:t.props.label,children:t.props.children,value:t.props.value,active:e,onClick:this.handleActiveChange.bind(this)})})))}},FormatModal:class extends Xp{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(t,e)=>{this.setState((e=>__spreadValues({},t)),e)},this.showModal=(t,e)=>{let n=this.state.data,r=n.findIndex((e=>e.name===t));r>-1&&(n[r].show=e,this.setValue({data:n},(()=>({data:n}))))}}initialize(t){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const t=this.context.locale;let e=this.state.data;e.forEach((e=>{var n;e.title=t.get(e.name),"format.titleCurrency"===e.name?e.children=t.get("currencyDetail").map((t=>({label:t.name,icon:t.value}))):"format.titleDateTime"===e.name?e.children=t.get("dateFmtList").map((t=>({label:t.name,icon:t.value}))):"format.titleNumber"===e.name&&(e.children=t.get("numFmtList").map((t=>({label:t.name,icon:t.value})))),(null==(n=e.group)?void 0:n.length)&&e.group.forEach((e=>{e.label=t.get(e.locale)}))})),this.setState((t=>({data:e})))}componentWillMount(){var t;this.setLocale(),this._localeObserver=null==(t=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))?void 0:t.add((()=>{this.setLocale()}))}componentWillUnmount(){}render(t,e){const{data:n}=e;return Vu(Xu,null,n.map(((t,e)=>t.show?Vu(Iv,{title:t.title,className:tv,group:t.group,visible:t.show,onCancel:t.onCancel},t.label,Vu(Cb,{show:!0,children:t.children,ref:t=>this.refs[e]=t})):Vu(Xu,null))))}},Checkbox:rf,CheckboxGroup:t=>{let{options:e,onChange:n,disabled:r,name:s}=t,o=ep(null);r&&e.forEach((t=>{t.disabled=!0})),s&&e.forEach((t=>{t.name=s}));const i=()=>{var t;if(!n)return;let e=null==(t=o.current)?void 0:t.querySelectorAll("label input"),r=[];null==e||e.forEach((t=>{let e=t;e.checked&&r.push(e.value)})),n(r)};return Vu("div",{className:nf,ref:o},e.map((t=>Vu(rf,{name:t.name,disabled:t.disabled,checked:t.checked,onChange:i,value:t.value},t.label))))},Tab:class extends jp{constructor(){super(...arguments),this.state={active:""},this.setValue=(t,e)=>{this.setState((e=>__spreadValues({},t)),e)},this.parseNavList=()=>{const{active:t}=this.state;return tg(this.props.children).map((e=>{const{tab:n,keys:r}=e.props,s=`${d_("tab")}-${r}`;return Vu("div",t===r?{id:s,onClick:this.handleClick,className:g_(ab,lb)}:{id:s,onClick:this.handleClick,className:ab},n)}))},this.handleClick=t=>{var e,n;const r=t.target.id,s=r.lastIndexOf("-"),o=r.slice(s+1);this.setValue({active:o}),null==(n=(e=this.props).onTabClick)||n.call(e,o,t)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(t,e){const{children:n,type:r="line",className:s=""}=t;return Vu("div",{className:g_(rb,{[`${rb}-card`]:"card"===r},s)},Vu("div",{className:sb},Vu("div",{className:ob},Vu("div",{className:ib},this.parseNavList()))),Vu("div",{className:hb},n.map((t=>Vu(ub,{keys:t.props.keys,active:t.props.keys===this.state.active},t.props.children)))))}},TabPane:ub,ColorPickerCircleButton:class extends Xp{constructor(){super(...arguments),this.ref={current:null},this.colorRef={current:null},this.handleColorSelectButtonClick=t=>{t.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(t){const{color:e,onClick:n,onCancel:r,style:s,colorPickerStyle:o}=t,i=this.getComponentRender().renderFunction("NextIcon");return Vu("div",{style:s,className:qf,ref:this.ref,onClick:this.handleColorSelectButtonClick},Vu("span",{className:`${Zf} ${Jf}`,style:{backgroundColor:e}}),Vu(i,{className:Jf}),Vu(Kf,{color:e,onClick:n,onCancel:r,style:o,ref:this.colorRef}))}},BorderLine:a_,SiderModal:class extends Xp{initialize(t){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(t){const{className:e="",style:n}=t;return Vu("div",{className:`${$v} ${e}`,style:__spreadValues({},n)},Vu("div",{className:Kv},Vu("h3",{className:qv},this.props.title),Vu("span",{className:Zv,onClick:()=>this.close()},Vu(Wm.Close,null))),Vu("div",{className:Jv},Vu("div",{className:Qv},this.props.children)),Vu("div",{className:tb},this.props.footer))}},ResizeDialog:t=>{let{left:e=0,top:n=0,width:r=100,height:s=50,children:o,ratio:i=1}=t;const a=ep(null),l=ep(null);Qg((()=>{const t=a.current;t&&(t.style.width=r*i+"px",t.style.height=s*i+"px",t.style.left=e*i+"px",t.style.top=n*i+"px")}),[]);let h=[0,0],c=[0,0],d=!1,u=!1,g=null;const p=()=>{if(!a.current)return;const t=a.current.parentElement;if(!t)return;t.querySelectorAll(`.${Lv.dialogResize}`).forEach((t=>{t.classList.remove(Lv.dialogResizeActive)}))},_=t=>{if(!a.current||!l.current)return;const e=l.current.classList;a.current.contains(t.target)?e.add(Lv.dialogResizeActive):e.contains(Lv.dialogResizeActive)&&e.remove(Lv.dialogResizeActive)},m=t=>{t.stopPropagation(),p(),_(t)},f=t=>{if(t.stopPropagation(),!a.current)return;const r=a.current.parentElement;if(!r)return;if(!r.contains(t.target))return;if(!d&&!u)return;const s=a.current;if(s){if(c=[t.pageX,t.pageY],e=parseFloat(s.style.left)+c[0]-h[0],e=e<0?0:e,e+a.current.offsetWidth>r.offsetWidth&&(e=r.offsetWidth-a.current.offsetWidth),n=parseFloat(s.style.top)+c[1]-h[1],n=n<0?0:n,n+a.current.offsetHeight>r.offsetHeight&&(n=r.offsetHeight-a.current.offsetHeight),u){let t,o;const i=g.dataset.type;"rm"!==i&&"rb"!==i&&"rt"!==i||(t=parseFloat(s.style.width)+c[0]-h[0],t<10&&(t=10),e+t>r.offsetWidth&&(t=r.offsetWidth-e),s.style.width=`${t}px`),"lm"!==i&&"lb"!==i&&"lt"!==i||(t=parseFloat(s.style.width)-(c[0]-h[0]),t<10&&(t=10),e+t>r.offsetWidth&&(t=r.offsetWidth-e),s.style.width=`${t}px`,s.style.left=`${e}px`),"lb"!==i&&"mb"!==i&&"rb"!==i||(o=parseFloat(s.style.height)+c[1]-h[1],o<10&&(o=10),o+n>r.offsetHeight&&(o=r.offsetHeight-n),s.style.height=`${o}px`),"lt"!==i&&"mt"!==i&&"rt"!==i||(o=parseFloat(s.style.height)-(c[1]-h[1]),o<10&&(o=10),o+n>r.offsetHeight&&(o=r.offsetHeight-n),s.style.height=`${o}px`,s.style.top=`${n}px`)}d&&(s.style.left=`${e}px`,s.style.top=`${n}px`),h=c}},v=t=>{if(window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",v),window.removeEventListener("click",m),t.stopPropagation(),!d&&!u)return;a.current&&(d=!1,u=!1)};return Vu("div",{className:Lv.resizeDialog,ref:a},Vu("div",{className:Lv.dialogMove,onMouseDown:t=>{window.addEventListener("mousemove",f),window.addEventListener("mouseup",v),window.addEventListener("click",m),t.stopPropagation(),p(),_(t),h=[t.pageX,t.pageY],d=!0}},Vu("div",{className:`${Lv.moveItem} ${Lv.moveTop}`}),Vu("div",{className:`${Lv.moveItem} ${Lv.moveRight}`}),Vu("div",{className:`${Lv.moveItem} ${Lv.moveBottom}`}),Vu("div",{className:`${Lv.moveItem} ${Lv.moveLeft}`})),Vu("div",{className:Lv.dialogResize,onMouseDown:t=>{t.stopPropagation();const e=t.target;e.className.includes(`${Lv.resizeItem}`)&&(g=e,h=[t.pageX,t.pageY],u=!0)},ref:l},Vu("div",{"data-type":"lt",className:`${Lv.resizeItem} ${Lv.resizeLt}`}),Vu("div",{"data-type":"mt",className:`${Lv.resizeItem} ${Lv.resizeMt}`}),Vu("div",{"data-type":"lm",className:`${Lv.resizeItem} ${Lv.resizeLm}`}),Vu("div",{"data-type":"rm",className:`${Lv.resizeItem} ${Lv.resizeRm}`}),Vu("div",{"data-type":"rt",className:`${Lv.resizeItem} ${Lv.resizeRt}`}),Vu("div",{"data-type":"lb",className:`${Lv.resizeItem} ${Lv.resizeLb}`}),Vu("div",{"data-type":"mb",className:`${Lv.resizeItem} ${Lv.resizeMb}`}),Vu("div",{"data-type":"rb",className:`${Lv.resizeItem} ${Lv.resizeRb}`})),Vu("div",{className:Lv.dialogContent},o))},Dropdown:Gv,render:ug,Component:Xp,forwardRef:fp,createRef:Gu,PureComponent:jp,cloneElement:pg,useRef:ep,useState:Zg,useEffect:Qg,toChildArray:tg},Symbol.toStringTag,{value:"Module"}));var zb={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",bgHover:"#efefef",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};
/*!
   * css-vars-ponyfill
   * v2.4.8
   * https://jhildenbiddle.github.io/css-vars-ponyfill/
   * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
   * MIT license
   */function Wb(){return(Wb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}
/*!
   * get-css-data
   * v2.1.0
   * https://github.com/jhildenbiddle/get-css-data
   * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
   * MIT license
   */function Vb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={mimeType:e.mimeType||null,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},r=Array.isArray(t)?t:[t],s=Array.apply(null,Array(r.length)).map((function(t){return null}));function o(t){var e="string"==typeof t,n=e&&"<"===t.trim().charAt(0);return e&&!n}function i(t,e){n.onError(t,r[e],e)}function a(t,e){var o=n.onSuccess(t,r[e],e);t=!1===o?"":o||t,s[e]=t,-1===s.indexOf(null)&&n.onComplete(s)}var l=document.createElement("a");r.forEach((function(t,e){if(l.setAttribute("href",t),l.href=String(l.href),Boolean(document.all&&!window.atob)&&l.host.split(":")[0]!==location.host.split(":")[0]){if(l.protocol===location.protocol){var r=new XDomainRequest;r.open("GET",t),r.timeout=0,r.onprogress=Function.prototype,r.ontimeout=Function.prototype,r.onload=function(){var t=r.responseText;o(t)?a(t,e):i(r,e)},r.onerror=function(t){i(r,e)},setTimeout((function(){r.send()}),0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(t,")")),i(null,e)}else{var s=new XMLHttpRequest;s.open("GET",t),n.mimeType&&s.overrideMimeType&&s.overrideMimeType(n.mimeType),n.onBeforeSend(s,t,e),s.onreadystatechange=function(){if(4===s.readyState){var t=s.responseText;s.status<400&&o(t)||0===s.status&&o(t)?a(t,e):i(s,e)}},s.send()}}))}
/**
   * Gets CSS data from <style> and <link> nodes (including @imports), then
   * returns data in order processed by DOM. Allows specifying nodes to
   * include/exclude and filtering CSS data using RegEx.
   *
   * @preserve
   * @param {object}   [options] The options object
   * @param {object}   [options.rootElement=document] Root element to traverse for
   *                   <link> and <style> nodes.
   * @param {string}   [options.include] CSS selector matching <link> and <style>
   *                   nodes to include
   * @param {string}   [options.exclude] CSS selector matching <link> and <style>
   *                   nodes to exclude
   * @param {object}   [options.filter] Regular expression used to filter node CSS
   *                   data. Each block of CSS data is tested against the filter,
   *                   and only matching data is included.
   * @param {boolean}  [options.skipDisabled=true] Determines if disabled
   *                   stylesheets will be skipped while collecting CSS data.
   * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
   *                   collected from a stylesheet's runtime values instead of its
   *                   text content. This is required to get accurate CSS data
   *                   when a stylesheet has been modified using the deleteRule()
   *                   or insertRule() methods because these modifications will
   *                   not be reflected in the stylesheet's text content.
   * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
   *                   1) the XHR object, 2) source node reference, and 3) the
   *                   source URL as arguments.
   * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
   *                   1) CSS text, 2) source node reference, and 3) the source
   *                   URL as arguments.
   * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
   *                   object for inspection, 2) soure node reference, and 3) the
   *                   source URL that failed (either a <link> href or an @import)
   *                   as arguments
   * @param {function} [options.onComplete] Callback after all nodes have been
   *                   processed. Passes 1) concatenated CSS text, 2) an array of
   *                   CSS text in DOM order, and 3) an array of nodes in DOM
   *                   order as arguments.
   *
   * @example
   *
   *   getCssData({
   *     rootElement : document,
   *     include     : 'style,link[rel="stylesheet"]',
   *     exclude     : '[href="skip.css"]',
   *     filter      : /red/,
   *     skipDisabled: true,
   *     useCSSOM    : false,
   *     onBeforeSend(xhr, node, url) {
   *       // ...
   *     }
   *     onSuccess(cssText, node, url) {
   *       // ...
   *     }
   *     onError(xhr, node, url) {
   *       // ...
   *     },
   *     onComplete(cssText, cssArray, nodeArray) {
   *       // ...
   *     }
   *   });
   */function Yb(t){var e=/\/\*[\s\S]+?\*\//g,n=/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g,r={rootElement:t.rootElement||document,include:t.include||'style,link[rel="stylesheet"]',exclude:t.exclude||null,filter:t.filter||null,skipDisabled:!1!==t.skipDisabled,useCSSOM:t.useCSSOM||!1,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},s=Array.apply(null,r.rootElement.querySelectorAll(r.include)).filter((function(t){return e=t,n=r.exclude,!(e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector).call(e,n);var e,n})),o=Array.apply(null,Array(s.length)).map((function(t){return null}));function i(){if(-1===o.indexOf(null)){o.reduce((function(t,e,n){return""===e&&t.push(n),t}),[]).reverse().forEach((function(t){return[s,o].forEach((function(e){return e.splice(t,1)}))}));var t=o.join("");r.onComplete(t,o,s)}}function a(t,e,n,s){var a=r.onSuccess(t,n,s);h(t=void 0!==a&&!1===Boolean(a)?"":a||t,n,s,(function(t,s){null===o[e]&&(s.forEach((function(t){return r.onError(t.xhr,n,t.url)})),!r.filter||r.filter.test(t)?o[e]=t:o[e]="",i())}))}function l(t,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o={};return o.rules=(t.replace(e,"").match(n)||[]).filter((function(t){return-1===s.indexOf(t)})),o.urls=o.rules.map((function(t){return t.replace(n,"$1")})),o.absoluteUrls=o.urls.map((function(t){return Gb(t,r)})),o.absoluteRules=o.rules.map((function(t,e){var n=o.urls[e],s=Gb(o.absoluteUrls[e],r);return t.replace(n,s)})),o}function h(t,e,n,s){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=l(t,n,i);a.rules.length?Vb(a.absoluteUrls,{onBeforeSend:function(t,n,s){r.onBeforeSend(t,e,n)},onSuccess:function(t,n,s){var o=r.onSuccess(t,e,n),a=l(t=!1===o?"":o||t,n,i);return a.rules.forEach((function(e,n){t=t.replace(e,a.absoluteRules[n])})),t},onError:function(r,l,c){o.push({xhr:r,url:l}),i.push(a.rules[c]),h(t,e,n,s,o,i)},onComplete:function(r){r.forEach((function(e,n){t=t.replace(a.rules[n],e)})),h(t,e,n,s,o,i)}}):s(t,o)}s.length?s.forEach((function(t,e){var n=t.getAttribute("href"),s=t.getAttribute("rel"),l="link"===t.nodeName.toLowerCase()&&n&&s&&-1!==s.toLowerCase().indexOf("stylesheet"),h=!1!==r.skipDisabled&&t.disabled,c="style"===t.nodeName.toLowerCase();if(l&&!h)if(-1!==n.indexOf("data:text/css")){var d=decodeURIComponent(n.substring(n.indexOf(",")+1));r.useCSSOM&&(d=Array.apply(null,t.sheet.cssRules).map((function(t){return t.cssText})).join("")),a(d,e,t,location.href)}else Vb(n,{mimeType:"text/css",onBeforeSend:function(e,n,s){r.onBeforeSend(e,t,n)},onSuccess:function(r,s,o){var i=Gb(n);a(r,e,t,i)},onError:function(n,s,a){o[e]="",r.onError(n,t,s),i()}});else if(c&&!h){var u=t.textContent;r.useCSSOM&&(u=Array.apply(null,t.sheet.cssRules).map((function(t){return t.cssText})).join("")),a(u,e,t,location.href)}else o[e]="",i()})):r.onComplete("",[])}function Gb(t,e){var n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),r.href=e||document.baseURI||(document.querySelector("base")||{}).href||location.href,s.href=t,s.href}var Xb=jb;function jb(t,e,n){t instanceof RegExp&&(t=$b(t,n)),e instanceof RegExp&&(e=$b(e,n));var r=Kb(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function $b(t,e){var n=e.match(t);return n?n[0]:null}function Kb(t,e,n){var r,s,o,i,a,l=n.indexOf(t),h=n.indexOf(e,l+1),c=l;if(l>=0&&h>0){if(t===e)return[l,h];for(r=[],o=n.length;c>=0&&!a;)c==l?(r.push(c),l=n.indexOf(t,c+1)):1==r.length?a=[r.pop(),h]:((s=r.pop())<o&&(o=s,i=h),h=n.indexOf(e,c+1)),c=l<h&&l>=0?l:h;r.length&&(a=[o,i])}return a}function qb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,removeComments:!1},r=Wb({},n,e),s=[];function o(t){throw new Error("CSS parse error: ".concat(t))}function i(e){var n=e.exec(t);if(n)return t=t.slice(n[0].length),n}function a(){return i(/^{\s*/)}function l(){return i(/^}/)}function h(){i(/^\s*/)}function c(){if(h(),"/"===t[0]&&"*"===t[1]){for(var e=2;t[e]&&("*"!==t[e]||"/"!==t[e+1]);)e++;if(!t[e])return o("end of comment is missing");var n=t.slice(2,e);return t=t.slice(e+2),{type:"comment",comment:n}}}function d(){for(var t,e=[];t=c();)e.push(t);return r.removeComments?[]:e}function u(){for(h();"}"===t[0];)o("extra closing bracket");var e=i(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(e){var n,r=e[0].trim();/\/\*/.test(r)&&(r=r.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var s=/["']\w*,\w*["']/.test(r);return s&&(r=r.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(function(t){return t.replace(/,/g,"")}))),n=/,/.test(r)?r.split(/\s*(?![^(]*\)),\s*/):[r],s&&(n=n.map((function(t){return t.replace(/\u200C/g,",")}))),n}}function g(){if("@"===t[0])return R();i(/^([;\s]*)+/);var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=i(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(n){if(n=n[0].trim(),!i(/^:\s*/))return o("property missing ':'");var r=i(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),s={type:"declaration",property:n.replace(e,""),value:r?r[0].replace(e,"").trim():""};return i(/^[;\s]*/),s}}function p(){if(!a())return o("missing '{'");for(var t,e=d();t=g();)e.push(t),e=e.concat(d());return l()?e:o("missing '}'")}function _(){h();for(var t,e=[];t=i(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)e.push(t[1]),i(/^,\s*/);if(e.length)return{type:"keyframe",values:e,declarations:p()}}function m(){var t=i(/^@([-\w]+)?keyframes\s*/);if(t){var e=t[1];if(!(t=i(/^([-\w]+)\s*/)))return o("@keyframes missing name");var n,r=t[1];if(!a())return o("@keyframes missing '{'");for(var s=d();n=_();)s.push(n),s=s.concat(d());return l()?{type:"keyframes",name:r,vendor:e,keyframes:s}:o("@keyframes missing '}'")}}function f(){if(i(/^@page */))return{type:"page",selectors:u()||[],declarations:p()}}function v(){var t=i(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(t)return{type:"page-margin-box",name:"".concat(t[1],"-").concat(t[2])+(t[3]?"-".concat(t[3]):""),declarations:p()}}function b(){if(i(/^@font-face\s*/))return{type:"font-face",declarations:p()}}function C(){var t=i(/^@supports *([^{]+)/);if(t)return{type:"supports",supports:t[1].trim(),rules:A()}}function T(){if(i(/^@host\s*/))return{type:"host",rules:A()}}function w(){var t=i(/^@media([^{]+)*/);if(t)return{type:"media",media:(t[1]||"").trim(),rules:A()}}function S(){var t=i(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(t)return{type:"custom-media",name:t[1].trim(),media:t[2].trim()}}function E(){var t=i(/^@([-\w]+)?document *([^{]+)/);if(t)return{type:"document",document:t[2].trim(),vendor:t[1]?t[1].trim():null,rules:A()}}function y(){var t=i(/^@(import|charset|namespace)\s*([^;]+);/);if(t)return{type:t[1],name:t[2].trim()}}function R(){if(h(),"@"===t[0]){var e=y()||b()||w()||m()||C()||E()||S()||T()||f()||v();if(e&&!r.preserveStatic){var n=!1;if(e.declarations)n=e.declarations.some((function(t){return/var\(/.test(t.value)}));else n=(e.keyframes||e.rules||[]).some((function(t){return(t.declarations||[]).some((function(t){return/var\(/.test(t.value)}))}));return n?e:{}}return e}}function I(){if(!r.preserveStatic){var e=Xb("{","}",t);if(e){var n=/:(?:root|host)(?![.:#(])/.test(e.pre)&&/--\S*\s*:/.test(e.body),s=/var\(/.test(e.body);if(!n&&!s)return t=t.slice(e.end+1),{}}}var i=u()||[],a=r.preserveStatic?p():p().filter((function(t){var e=i.some((function(t){return/:(?:root|host)(?![.:#(])/.test(t)}))&&/^--\S/.test(t.property),n=/var\(/.test(t.value);return e||n}));return i.length||o("selector missing"),{type:"rule",selectors:i,declarations:a}}function A(e){if(!e&&!a())return o("missing '{'");for(var n,r=d();t.length&&(e||"}"!==t[0])&&(n=R()||I());)n.type&&r.push(n),r=r.concat(d());return e||l()?r:o("missing '}'")}return{type:"stylesheet",stylesheet:{rules:A(!0),errors:s}}}function Zb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={parseHost:!1,store:{},onWarning:function(){}},r=Wb({},n,e),s=new RegExp(":".concat(r.parseHost?"host":"root","$"));return"string"==typeof t&&(t=qb(t,r)),t.stylesheet.rules.forEach((function(t){"rule"===t.type&&t.selectors.some((function(t){return s.test(t)}))&&t.declarations.forEach((function(t,e){var n=t.property,s=t.value;n&&0===n.indexOf("--")&&(r.store[n]=s)}))})),r.store}function Jb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r={charset:function(t){return"@charset "+t.name+";"},comment:function(t){return 0===t.comment.indexOf("__CSSVARSPONYFILL")?"/*"+t.comment+"*/":""},"custom-media":function(t){return"@custom-media "+t.name+" "+t.media+";"},declaration:function(t){return t.property+":"+t.value+";"},document:function(t){return"@"+(t.vendor||"")+"document "+t.document+"{"+s(t.rules)+"}"},"font-face":function(t){return"@font-face{"+s(t.declarations)+"}"},host:function(t){return"@host{"+s(t.rules)+"}"},import:function(t){return"@import "+t.name+";"},keyframe:function(t){return t.values.join(",")+"{"+s(t.declarations)+"}"},keyframes:function(t){return"@"+(t.vendor||"")+"keyframes "+t.name+"{"+s(t.keyframes)+"}"},media:function(t){return"@media "+t.media+"{"+s(t.rules)+"}"},namespace:function(t){return"@namespace "+t.name+";"},page:function(t){return"@page "+(t.selectors.length?t.selectors.join(", "):"")+"{"+s(t.declarations)+"}"},"page-margin-box":function(t){return"@"+t.name+"{"+s(t.declarations)+"}"},rule:function(t){var e=t.declarations;if(e.length)return t.selectors.join(",")+"{"+s(e)+"}"},supports:function(t){return"@supports "+t.supports+"{"+s(t.rules)+"}"}};function s(t){for(var s="",o=0;o<t.length;o++){var i=t[o];n&&n(i);var a=r[i.type](i);a&&(s+=a,a.length&&i.selectors&&(s+=e))}return s}return s(t.stylesheet.rules)}function Qb(t,e){t.rules.forEach((function(n){n.rules?Qb(n,e):n.keyframes?n.keyframes.forEach((function(t){"keyframe"===t.type&&e(t.declarations,n)})):n.declarations&&e(n.declarations,t)}))}jb.range=Kb;function tC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=Wb({},n,e);return"string"==typeof t&&(t=qb(t,r)),Qb(t.stylesheet,(function(t,e){for(var n=0;n<t.length;n++){var s=t[n],o=s.type,i=s.property,a=s.value;if("declaration"===o)if(r.preserveVars||!i||0!==i.indexOf("--")){if(-1!==a.indexOf("var(")){var l=nC(a,r);l!==s.value&&(l=eC(l),r.preserveVars?(t.splice(n,0,{type:o,property:i,value:l}),n++):s.value=l)}}else t.splice(n,1),n--}})),Jb(t)}function eC(t){return(t.match(/calc\(([^)]+)\)/g)||[]).forEach((function(e){var n="calc".concat(e.split("calc").join(""));t=t.replace(e,n)})),t}function nC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(-1===t.indexOf("var("))return t;var r=Xb("(",")",t);function s(t){var r=t.split(",")[0].replace(/[\s\n\t]/g,""),s=(t.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],o=Object.prototype.hasOwnProperty.call(e.variables,r)?String(e.variables[r]):void 0,i=o||(s?String(s):void 0),a=n||t;return o||e.onWarning('variable "'.concat(r,'" is undefined')),i&&"undefined"!==i&&i.length>0?nC(i,e,a):"var(".concat(a,")")}if(r){if("var"===r.pre.slice(-3)){var o=0===r.body.trim().length;return o?(e.onWarning("var() must contain a non-whitespace string"),t):r.pre.slice(0,-3)+s(r.body)+nC(r.post,e)}return r.pre+"(".concat(nC(r.body,e),")")+nC(r.post,e)}return-1!==t.indexOf("var(")&&e.onWarning('missing closing ")" in the value "'.concat(t,'"')),t}var rC="undefined"!=typeof window,sC=rC&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),oC={group:0,job:0},iC={rootElement:rC?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},aC={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},lC={dom:{},job:{},user:{}},hC=!1,cC=null,dC=0,uC=null,gC=!1;
/**
   * Fetches, parses, and transforms CSS custom properties from specified
   * <style> and <link> elements into static values, then appends a new <style>
   * element with static values to the DOM to provide CSS custom property
   * compatibility for legacy browsers. Also provides a single interface for
   * live updates of runtime values in both modern and legacy browsers.
   *
   * @preserve
   * @param {object}   [options] Options object
   * @param {object}   [options.rootElement=document] Root element to traverse for
   *                   <link> and <style> nodes
   * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
   *                   and <style> nodes will be processed.
   * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
   *                   matching <link re="stylesheet"> and <style> nodes to
   *                   process
   * @param {string}   [options.exclude] CSS selector matching <link
   *                   rel="stylehseet"> and <style> nodes to exclude from those
   *                   matches by options.include
   * @param {object}   [options.variables] A map of custom property name/value
   *                   pairs. Property names can omit or include the leading
   *                   double-hyphen (), and values specified will override
   *                   previous values
   * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
   *                   only generate legacy-compatible CSS in browsers that lack
   *                   native support (i.e., legacy browsers)
   * @param {boolean}  [options.preserveStatic=true] Determines if CSS
   *                   declarations that do not reference a custom property will
   *                   be preserved in the transformed CSS
   * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
   *                   property declarations will be preserved in the transformed
   *                   CSS
   * @param {boolean}  [options.silent=false] Determines if warning and error
   *                   messages will be displayed on the console
   * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
   *                   update the DOM after processing CSS custom properties
   * @param {boolean}  [options.updateURLs=true] Determines if relative url()
   *                   paths will be converted to absolute urls in external CSS
   * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
   *                   be created that will execute the ponyfill when a <link> or
   *                   <style> DOM mutation is observed
   * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
   *                   1) the XHR object, 2) source node reference, and 3) the
   *                   source URL as arguments
   * @param {function} [options.onError] Callback after a CSS parsing error has
   *                   occurred or an XHR request has failed. Passes 1) an error
   *                   message, and 2) source node reference, 3) xhr, and 4 url as
   *                   arguments.
   * @param {function} [options.onWarning] Callback after each CSS parsing warning
   *                   has occurred. Passes 1) a warning message as an argument.
   * @param {function} [options.onSuccess] Callback after CSS data has been
   *                   collected from each node and before CSS custom properties
   *                   have been transformed. Allows modifying the CSS data before
   *                   it is transformed by returning any string value (or false
   *                   to skip). Passes 1) CSS text, 2) source node reference, and
   *                   3) the source URL as arguments.
   * @param {function} [options.onComplete] Callback after all CSS has been
   *                   processed, legacy-compatible CSS has been generated, and
   *                   (optionally) the DOM has been updated. Passes 1) a CSS
   *                   string with CSS variable values resolved, 2) an array of
   *                   output <style> node references that have been appended to
   *                   the DOM, 3) an object containing all custom properies names
   *                   and values, and 4) the ponyfill execution time in
   *                   milliseconds.
   * @param {function} [options.onFinally] Callback in modern and legacy browsers
   *                   after the ponyfill has finished all tasks. Passes 1) a
   *                   boolean indicating if the last ponyfill call resulted in a
   *                   style change, 2) a boolean indicating if the current
   *                   browser provides native support for CSS custom properties,
   *                   and 3) the ponyfill execution time in milliseconds.
   * @example
   *
   *   cssVars({
   *     rootElement   : document,
   *     shadowDOM     : false,
   *     include       : 'style,link[rel="stylesheet"]',
   *     exclude       : '',
   *     variables     : {},
   *     onlyLegacy    : true,
   *     preserveStatic: true,
   *     preserveVars  : false,
   *     silent        : false,
   *     updateDOM     : true,
   *     updateURLs    : true,
   *     watch         : false,
   *     onBeforeSend(xhr, node, url) {},
   *     onError(message, node, xhr, url) {},
   *     onWarning(message) {},
   *     onSuccess(cssText, node, url) {},
   *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
   *     onFinally(hasChanged, hasNativeSupport, benchmark)
   *   });
   */
function pC(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="cssVars(): ",n=Wb({},iC,t);function r(t,r,s,o){!n.silent&&window.console&&console.error("".concat(e).concat(t,"\n"),r),n.onError(t,r,s,o)}function s(t){!n.silent&&window.console&&console.warn("".concat(e).concat(t)),n.onWarning(t)}function o(t){n.onFinally(Boolean(t),sC,TC()-n.__benchmark)}if(rC){if(n.watch)return n.watch=iC.watch,_C(n),void pC(n);if(!1===n.watch&&cC&&(cC.disconnect(),cC=null),!n.__benchmark){if(hC===n.rootElement)return void mC(t);var i=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(n.__benchmark=TC(),n.exclude=[cC?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",n.exclude].filter((function(t){return t})).join(","),n.variables=bC(n.variables),i.forEach((function(t){var e="style"===t.nodeName.toLowerCase()&&t.__cssVars.text,n=e&&t.textContent!==t.__cssVars.text;e&&n&&(t.sheet&&(t.sheet.disabled=!1),t.setAttribute("data-cssvars",""))})),!cC){var a=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars="out"]'));a.forEach((function(t){var e=t.getAttribute("data-cssvars-group");(e?n.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(e,'"]')):null)||t.parentNode.removeChild(t)})),dC&&i.length<dC&&(dC=i.length,lC.dom={})}}if("loading"!==document.readyState)if(sC&&n.onlyLegacy){var l=!1;if(n.updateDOM){var h=n.rootElement.host||(n.rootElement===document?document.documentElement:n.rootElement);Object.keys(n.variables).forEach((function(t){var e=n.variables[t];l=l||e!==getComputedStyle(h).getPropertyValue(t),h.style.setProperty(t,e)}))}o(l)}else!gC&&(n.shadowDOM||n.rootElement.shadowRoot||n.rootElement.host)?Yb({rootElement:iC.rootElement,include:iC.include,exclude:n.exclude,skipDisabled:!1,onSuccess:function(t,e,n){return!((e.sheet||{}).disabled&&!e.__cssVars)&&((t=((t=t.replace(aC.cssComments,"").replace(aC.cssMediaQueries,"")).match(aC.cssVarDeclRules)||[]).join(""))||!1)},onComplete:function(t,e,r){Zb(t,{store:lC.dom,onWarning:s}),gC=!0,pC(n)}}):(hC=n.rootElement,Yb({rootElement:n.rootElement,include:n.include,exclude:n.exclude,skipDisabled:!1,onBeforeSend:n.onBeforeSend,onError:function(t,e,n){var s=t.responseURL||CC(n,location.href),o=t.statusText?"(".concat(t.statusText,")"):"Unspecified Error"+(0===t.status?" (possibly CORS related)":"");r("CSS XHR Error: ".concat(s," ").concat(t.status," ").concat(o),e,t,s)},onSuccess:function(t,e,r){if((e.sheet||{}).disabled&&!e.__cssVars)return!1;var s="link"===e.nodeName.toLowerCase(),o="style"===e.nodeName.toLowerCase()&&t!==e.textContent,i=n.onSuccess(t,e,r);return t=void 0!==i&&!1===Boolean(i)?"":i||t,n.updateURLs&&(s||o)&&(t=vC(t,r)),t},onComplete:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=Wb({},lC.dom,lC.user);if(lC.job={},i.forEach((function(t,o){var i=e[o];if(t.__cssVars=t.__cssVars||{},t.__cssVars.text=i,aC.cssVars.test(i))try{var a=qb(i,{preserveStatic:n.preserveStatic,removeComments:!0});Zb(a,{parseHost:Boolean(n.rootElement.host),store:lC.dom,onWarning:s}),t.__cssVars.tree=a}catch(l){r(l.message,t)}})),Wb(lC.job,lC.dom),n.updateDOM?(Wb(lC.user,n.variables),Wb(lC.job,lC.user)):(Wb(lC.job,lC.user,n.variables),Wb(a,n.variables)),oC.job>0&&Boolean(Object.keys(lC.job).length>Object.keys(a).length||Boolean(Object.keys(a).length&&Object.keys(lC.job).some((function(t){return lC.job[t]!==a[t]})))))wC(n.rootElement),pC(n);else{var l=[],h=[],c=!1;if(n.updateDOM&&oC.job++,i.forEach((function(t,o){var i=!t.__cssVars.tree;if(t.__cssVars.tree)try{tC(t.__cssVars.tree,Wb({},n,{variables:lC.job,onWarning:s}));var a=Jb(t.__cssVars.tree);if(n.updateDOM){var d=e[o],u=aC.cssVarFunc.test(d);if(t.getAttribute("data-cssvars")||t.setAttribute("data-cssvars","src"),a.length&&u){var g=t.getAttribute("data-cssvars-group")||++oC.group,p=a.replace(/\s/g,""),_=n.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(g,'"]'))||document.createElement("style");c=c||aC.cssKeyframes.test(a),n.preserveStatic&&t.sheet&&(t.sheet.disabled=!0),_.hasAttribute("data-cssvars")||_.setAttribute("data-cssvars","out"),p===t.textContent.replace(/\s/g,"")?(i=!0,_&&_.parentNode&&(t.removeAttribute("data-cssvars-group"),_.parentNode.removeChild(_))):p!==_.textContent.replace(/\s/g,"")&&([t,_].forEach((function(t){t.setAttribute("data-cssvars-job",oC.job),t.setAttribute("data-cssvars-group",g)})),_.textContent=a,l.push(a),h.push(_),_.parentNode||t.parentNode.insertBefore(_,t.nextSibling))}}else t.textContent.replace(/\s/g,"")!==a&&l.push(a)}catch(m){r(m.message,t)}i&&t.setAttribute("data-cssvars","skip"),t.hasAttribute("data-cssvars-job")||t.setAttribute("data-cssvars-job",oC.job)})),dC=n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,n.shadowDOM)for(var d,u=[].concat(n.rootElement).concat([].slice.call(n.rootElement.querySelectorAll("*"))),g=0;d=u[g];++g)if(d.shadowRoot&&d.shadowRoot.querySelector("style")){var p=Wb({},n,{rootElement:d.shadowRoot});pC(p)}n.updateDOM&&c&&fC(n.rootElement),hC=!1,n.onComplete(l.join(""),h,JSON.parse(JSON.stringify(lC.job)),TC()-n.__benchmark),o(h.length)}}}));else document.addEventListener("DOMContentLoaded",(function e(n){pC(t),document.removeEventListener("DOMContentLoaded",e)}))}}function _C(t){function e(t){var e=n(t)&&t.hasAttribute("disabled"),r=(t.sheet||{}).disabled;return e||r}function n(t){return"link"===t.nodeName.toLowerCase()&&-1!==(t.getAttribute("rel")||"").indexOf("stylesheet")}function r(t){return"style"===t.nodeName.toLowerCase()}window.MutationObserver&&(cC&&(cC.disconnect(),cC=null),(cC=new MutationObserver((function(s){s.some((function(s){return function(r){var s=!1;if("attributes"===r.type&&n(r.target)&&!e(r.target)){var o="disabled"===r.attributeName,i="href"===r.attributeName,a="skip"===r.target.getAttribute("data-cssvars"),l="src"===r.target.getAttribute("data-cssvars");o?s=!a&&!l:i&&(a?r.target.setAttribute("data-cssvars",""):l&&wC(t.rootElement,!0),s=!0)}return s}(s)||function(t){var e=!1;if("childList"===t.type){var n=r(t.target),s="out"===t.target.getAttribute("data-cssvars");e=n&&!s}return e}(s)||function(t){var s=!1;return"childList"===t.type&&(s=[].slice.call(t.addedNodes).some((function(t){var s=1===t.nodeType&&t.hasAttribute("data-cssvars"),o=r(t)&&aC.cssVars.test(t.textContent);return!s&&(n(t)||o)&&!e(t)}))),s}(s)||function(e){var n=!1;return"childList"===e.type&&(n=[].slice.call(e.removedNodes).some((function(e){var n=1===e.nodeType,r=n&&"out"===e.getAttribute("data-cssvars"),s=n&&"src"===e.getAttribute("data-cssvars"),o=s;if(s||r){var i=e.getAttribute("data-cssvars-group"),a=t.rootElement.querySelector('[data-cssvars-group="'.concat(i,'"]'));s&&wC(t.rootElement,!0),a&&a.parentNode.removeChild(a)}return o}))),n}(s)}))&&pC(t)}))).observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function mC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;clearTimeout(uC),uC=setTimeout((function(){t.__benchmark=null,pC(t)}),e)}function fC(t){var e=["animation-name","-moz-animation-name","-webkit-animation-name"].filter((function(t){return getComputedStyle(document.body)[t]}))[0];if(e){for(var n=[].slice.call(t.querySelectorAll("*")),r=[],s="__CSSVARSPONYFILL-KEYFRAMES__",o=0,i=n.length;o<i;o++){var a=n[o];"none"!==getComputedStyle(a)[e]&&(a.style[e]+=s,r.push(a))}document.body.offsetHeight;for(var l=0,h=r.length;l<h;l++){var c=r[l].style;c[e]=c[e].replace(s,"")}}}function vC(t,e){return(t.replace(aC.cssComments,"").match(aC.cssUrls)||[]).forEach((function(n){var r=n.replace(aC.cssUrls,"$1"),s=CC(r,e);t=t.replace(n,n.replace(r,s))})),t}function bC(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=/^-{2}/;return Object.keys(t).reduce((function(n,r){return n[e.test(r)?r:"--".concat(r.replace(/^-+/,""))]=t[r],n}),{})}function CC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),r.href=e,s.href=t,s.href}function TC(){return rC&&(window.performance||{}).now?window.performance.now():(new Date).getTime()}function wC(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[].slice.call(t.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));n.forEach((function(t){return t.setAttribute("data-cssvars","")})),e&&(lC.dom={})}pC.reset=function(){for(var t in oC.job=0,oC.group=0,hC=!1,cC&&(cC.disconnect(),cC=null),dC=0,uC=null,gC=!1,lC)lC[t]={}};var SC="univer-layout-container",EC="univer-content-container-horizontal",yC="univer-content-inner-left-container",RC="univer-hover-cursor",IC="univer-content-inner-right-container",AC="univer-content-container-vertical",OC="univer-main-content",NC="univer-outer-right-container";var MC="univer-info-detail",xC="univer-sheet-name",kC="univer-info-detail-update",DC="univer-info-detail-save";class LC extends Xp{initialize(){this.state={infoList:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}setInfoList(t){this.setState({infoList:t})}render(){const{renameSheet:t}=this.props;if(!this.state.infoList)return;const{back:e,sheet:n,update:r,save:s,rename:o}=this.state.infoList;return Vu(Qf,{className:MC},Vu("div",{className:xC},Vu(zv,{title:o.label,placement:"bottom"},Vu(Pf,{bordered:!1,value:n.label,onBlur:t}))),Vu("div",{className:kC},r.label),Vu("div",{className:DC},s.label))}}var PC="univer-context-menu",BC="univer-right-menu-center",HC="univer-right-menu-item";class FC extends Xp{constructor(){super(...arguments),this.ulRef={current:null},this.root={current:null},this.handleContextMenu=async(t,e,n)=>{t.preventDefault(),this.setState({visible:!0,srcElement:t.target,eventType:t.type},(()=>{new Promise(((t,e)=>{this.ulRef.current.showMenu(!0),t()})).then((()=>{const r=n?e.x:t.clientX,s=n?e.y:t.clientY,o=window.innerWidth,i=window.innerHeight,a=this.ulRef.current.base.offsetWidth,l=this.ulRef.current.base.offsetHeight,h=o-r>a,c=!h,d=i-s>l,u=!d;h&&(this.root.current.style.left=`${r}px`),c&&(this.root.current.style.left=r-a+"px"),d&&(this.root.current.style.top=`${s}px`),u&&(this.root.current.style.top=s-l+"px")}))}))},this.handleClick=t=>{const{visible:e,eventType:n,srcElement:r}=this.state;this.root.current&&("click"===n&&r&&r.contains(t.target)||this.root.current.contains(t.target)||e&&this.setState({visible:!1}))}}initialize(){this.state={visible:!1,srcElement:null,eventType:null,children:[],replace:[]}}resetMenuList(t,e){var n,r;const s=null==(n=this.getContext().getPluginManager().getPluginByName(Su))?void 0:n.getComponentManager();for(let o=0;o<t.length;o++){const n=t[o];if(n.customLabel){const t=null==s?void 0:s.get(n.customLabel.name),e=null!=(r=n.customLabel.props)?r:{};t&&(n.label=Vu(t,__spreadValues({},e)))}else"string"==typeof n.label&&(n.label=this.getLocale(e[o].label));n.children&&(n.children=this.resetMenuList(n.children,e[o].children))}return t}setMenuList(t){this.setState({children:t,replace:JSON.parse(JSON.stringify(t))})}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this),document.addEventListener("click",this.handleClick)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}showRightMenu(t){this.ulRef.current.showMenu(t)}render(){if(!this.state.children.length)return;const t=__spreadValues({},this.props.style),{visible:e}=this.state;return e&&Vu("div",{ref:this.root,className:PC,style:t,onContextMenu:t=>{t.preventDefault()}},Vu(mv,{ref:this.ulRef,menu:this.resetMenuList(this.state.children,this.state.replace),onClick:this.handleClick}))}}class UC extends Xp{handleClick(t){t.stopPropagation()}handleKeyUp(t){const{onKeyUp:e}=this.props;null==e||e(t)}render(){const{prefix:t,suffix:e}=this.props;return Vu("div",null,this.getLocale(t),Vu(Pf,{onPressEnter:this.handleKeyUp.bind(this),type:"number",placeholder:"1",onClick:this.handleClick}),this.getLocale(e))}}class zC extends Xp{render(){const{label:t}=this.props;return Vu("div",{className:HC},this.getLocale(t),Vu(bm.RightIcon,null))}}var WC="univer-count-bar",VC="univer-count-zoom",YC="univer-count-slider",GC="univer-count-statistic";class XC extends Xp{constructor(){super(...arguments),this.max=400,this.min=0,this.ref={current:null},this.setValue=(t,e)=>{this.setState((e=>__spreadValues({},t)),e)},this.onChange=t=>{let e=t.target;this.props.onChange&&this.props.onChange(e.value),this.setValue({zoom:e.value}),this.ref.current.changeInputValue(0,e.value)},this.handleClick=(t,e)=>{this.setValue({zoom:e})},this.addZoom=()=>{let t=10*(Math.floor(this.state.zoom/10)+1);t>=this.max&&(t=this.max),this.setValue({zoom:t}),this.props.onChange&&this.props.onChange(String(t))},this.reduceZoom=()=>{let t=10*(Math.ceil(this.state.zoom/10)-1);t<=this.min&&(t=this.min),this.setValue({zoom:t}),this.props.onChange&&this.props.onChange(String(t)),this.ref.current.changeInputValue(0,t)}}initialize(t){this.state={zoom:100,content:""}}setZoom(t){t!==this.state.zoom&&(this.setValue({zoom:t}),this.ref.current.changeInputValue(0,t))}componentDidMount(){var t;null==(t=this.getContext().getObserverManager().getObserver("onCountBarDidMountObservable",ze.SPREADSHEET))||t.notifyObservers(this)}render(t,e){const{zoom:n,content:r}=e;return Vu("div",{className:WC},Vu(Zm,{type:"text",className:VC},n),Vu(Zm,{type:"text",onClick:this.addZoom},Vu(R_.AddIcon,null)),Vu("div",{className:YC},Vu(nb,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),Vu(Zm,{type:"text",onClick:this.reduceZoom},Vu(R_.ReduceIcon,null)),Vu(Zm,{type:"text"},Vu(km.RegularIcon,null)),Vu("span",{className:GC},r))}}var jC="univer-sheet-bar",$C="univer-sheet-bar-options",KC="univer-sheet-bar-options-button",qC="univer-sheet_bar_scroll_button",ZC="univer-slide-tab-bar",JC="univer-slide-tab-active",QC="univer-slide-tab-item",tT="univer-slide-tab-divider",eT="univer-slide-tab-content",nT="univer-slide-tab-title",rT="univer-slide-tab-span",sT="univer-slide-tab-icon",oT="univer-slide-tab-footer",iT="univer-slide-tab-active-bar",aT="univer-sheet-ul",lT="univer-select-color-picker-parent",hT="univer-select-color-picker",cT="univer-sheet-bar-menu",dT="univer-sheet-bar-menu-item",uT="univer-sheet-bar-menu-icon",gT="univer-sheet-bar-menu-svg",pT="univer-sheet-bar-menu-title";class _T extends Xp{constructor(){super(...arguments),this.hideMenu=()=>{this.showMenu(!1)}}initialize(){this.state={show:!1}}handleClick(t,e){t.stopPropagation();const{onClick:n}=this.props;e.onClick&&e.onClick(t),null==n||n(t),this.showMenu(!1),window.removeEventListener("click",this.hideMenu,!0)}showMenu(t){this.setState({show:t},(()=>{this.state.show&&window.addEventListener("click",this.hideMenu,!0)}))}render(){const{menu:t,style:e}=this.props,{show:n}=this.state;return Vu("ul",{className:cT,style:__spreadProps(__spreadValues({},e),{display:n?"block":" none"})},t.map((t=>Vu("li",{onClick:e=>this.handleClick(e,t),className:g_(dT)},Vu("span",{className:uT},Vu(mT,{item:t})),Vu("span",{className:pT},t.label)))))}}function mT(t){return t.item.hide?Vu(vm,null):t.item.selected?Vu(Cm.CheckIcon,{className:gT}):Vu(Xu,null)}class fT{constructor(t){const e=t.primeval();this._scrollX=e.scrollLeft,this._slideTabBar=t}scrollX(t){const e=this._slideTabBar.primeval();e.scrollLeft=t,this._scrollX=e.scrollLeft}scrollRight(){const t=this._slideTabBar.primeval();t.scrollLeft=t.scrollWidth,this._scrollX=t.scrollLeft}getScrollX(){return this._scrollX}}const vT={easeOutStrong:(t,e,n,r)=>-n*((t=t/r-1)*t*t*t-1)+e,backOut:(t,e,n,r,s)=>(void 0===s&&(s=.7),n*((t=t/r-1)*t*((s+1)*t+s)+1)+e)},bT={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(t){},success(t){},cancel(t){},complete(t){}};var CT,TT;(TT=CT||(CT={}))[TT.Request=0]="Request",TT[TT.Cancel=1]="Cancel";class wT{constructor(t){this._config=__spreadValues(__spreadValues({},bT),t),this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...t){let e=0;return new Promise((n=>{for(let r=0;r<t.length;r++){let s=t[r],o=s._config,i=o.success;o.loop||(o.success=r=>{e++,i&&i.call(s,r),e===t.length&&n()})}}))}request(){0===this._config.delay?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout((()=>{this._status=0,this._start=Date.now(),this._fakeHandle()}),this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let t=Date.now()-this._start;t=t>=this._config.duration?this._config.duration:t;let e=vT[this._config.type](t,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);return this._config.receive(e),1===this._status?(this._config.cancel(e),void this._config.complete(e)):t===this._config.duration?(this._config.success(e),void this._config.complete(e)):void(this._handle=requestAnimationFrame((()=>{this._fakeHandle()})))}}class ST{constructor(t,e){this._slideTabItem=t,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=e,this._placeholder=null,this._scrollbar=e.getScrollbar(),this.update()}static midline(t){return t.getBoundingRect().x+t.getBoundingRect().width/2}static make(t,e){let n=[];return t.forEach((t=>n.push(new ST(t,e)))),n}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}primeval(){return this._slideTabItem}translateX(t){return this._translateX=t,this._slideTabItem.style.transform=`translateX(${t}px)`,this.getTranslateXDirection()}editor(t){if(!1===this._editMode){let e=this.primeval().querySelector("span"),n=s=>{this._editMode=!1,e&&(e.removeAttribute("contentEditable"),e.removeEventListener("blur",n),e.removeEventListener("input",r)),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName&&this._slideTabBar.getConfig().onChangeName(s),t&&t(s)},r=()=>{if(e){const t=e.querySelectorAll("br");t.length>0&&(t.forEach((t=>{e&&e.removeChild(t)})),e.blur())}};e&&(e.setAttribute("contentEditable","true"),e.addEventListener("blur",n),e.addEventListener("input",r),this._editMode=!0,ET.keepLastIndex(e))}}animate(){return{translateX:t=>{this._translateX!==t&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new wT({begin:this._translateX,end:t,receive:t=>{this._slideTabItem.style.transform=`translateX(${t}px)`}}),this._translateX=t,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(t){this._slideTabItem.after(t._slideTabItem||t)}update(){this._midline=ST.midline(this)}disableFixed(){if(this._placeholder){const t=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("box-shadow"),this._slideTabItem.style.removeProperty("background"),this._placeholder.after(this._slideTabItem),t.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const t=document.createElement("div"),e=this.getBoundingRect();this._placeholder=t,this._placeholder.style.width=`${e.width}px`,this._placeholder.style.height=`${e.height}px`,this._placeholder.style.flexShrink="0",this._slideTabItem.style.left=e.x-this.getScrollbar().getScrollX()+"px",this._slideTabItem.style.top=`${e.y}px`,this._slideTabItem.style.width=`${e.width}px`,this._slideTabItem.style.height=`${e.height}px`,this._slideTabItem.style.background=getComputedStyle(this._slideTabItem).background,this._slideTabItem.style.boxShadow="0px 0px 1px 1px rgba(82,82,82,0.1)",this._slideTabItem.style.position="fixed",this._slideTabItem.after(t),document.body.appendChild(this._slideTabItem)}addEventListener(t,e,n){this._slideTabItem.addEventListener(t,e,n)}removeEventListener(t,e,n){this._slideTabItem.removeEventListener(t,e,n)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const t=this._slideTabItem.getBoundingClientRect();return t.x+=this._scrollbar.getScrollX(),t}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const t=ST.midline(this);return t>this._midline?1:t<this._midline?-1:0}equals(t){return t&&t._slideTabItem===this._slideTabItem}}class ET{constructor(t){var e,n;if(null==t.slideTabRoot)throw new Error("not found slide-tab-bar root element");const r=t.slideTabRoot.querySelector(`.${null!=(e=t.slideTabBarClassName)?e:"slide-tab-bar"}`),s=t.slideTabRoot.querySelectorAll(`.${null!=(n=t.slideTabBarItemClassName)?n:"slide-tab-item"}`);if(null==r)throw new Error("not found slide-tab-bar");this._config=t,this._activeTabItem=null,this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._activeTabItemIndex=0,this._slideTabBar=r,this._slideScrollbar=new fT(this),this._slideTabItems=ST.make(s,this);let o=0,i=0,a=0;this._downAction=t=>{var e;if(2===t.button)return o=0,a=0,void(i=0);const{pageX:n,pageY:r}=t,s=Date.now();if(s-a<=800&&n===o&&r===i){const e=this._slideTabItems.find((e=>e.equals(new ST(t.currentTarget,this))));e&&e.editor(),a=0,o=0,i=0}else{if(!this._hasEditItem()){if(ET.checkedSkipSlide(t))return o=0,a=0,void(i=0);const n=this._slideTabItems.findIndex((e=>e.equals(new ST(t.currentTarget,this))));n>-1?(this._compareIndex=n,this._downActionX=t.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[n],this._activeTabItemIndex=n,this._config.activeClassNameAutoController&&(this._slideTabItems.forEach((t=>{var e;t.classList().remove(null!=(e=this._config.slideTabBarItemActiveClassName)?e:"slide-tab-active")})),this._activeTabItem.classList().add(null!=(e=this._config.slideTabBarItemActiveClassName)?e:"slide-tab-active")),this._activeTabItem.enableFixed(),this._startAutoScroll()):(this.updateItems(),this._activeTabItemIndex=0,this._downActionX=0,this._scrollIncremental=0,this._compareIndex=0,this._activeTabItem=null)}o=n,i=r,a=s}},this._upAction=t=>{if(this._activeTabItem){this._closeAutoScroll(),this._activeTabItem.disableFixed(),this._sortedItems(),this.updateItems(),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&this._config.onSlideEnd(t);let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this._activeTabItem.primeval().dispatchEvent(e),this._scrollIncremental=0,this._activeTabItemIndex=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null}},this._moveAction=t=>{this._activeTabItem&&(this._moveActionX=t.pageX-this._downActionX,this._scrollIncremental=0,this._scrollLeft(t),this._scrollRight(t))},this._wheelAction=t=>{t.deltaY,this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+t.deltaY)},this._initialize()}static checkedSkipSlide(t){let e=t.target;for(;null!=e&&e!==document.body;){if(e.getAttribute("data-slide-skip"))return!0;e=e.parentElement}return!1}static keepLastIndex(t){setTimeout((()=>{const e=window.getSelection();e&&(e.selectAllChildren(t),e.collapseToEnd())}))}primeval(){return this._slideTabBar}updateItems(){for(let t=0;t<this._slideTabItems.length;t++)this._slideTabItems[t].animate().cancel(),this._slideTabItems[t].translateX(0),this._slideTabItems[t].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}destroy(){document.removeEventListener("mousemove",this._moveAction),document.removeEventListener("mouseup",this._upAction),document.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((t=>{t.removeEventListener("mousedown",this._downAction)}))}_hasEditItem(){for(let t=0;t<this._slideTabItems.length;t++){if(this._slideTabItems[t].isEditMode())return!0}return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break;case 0:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break;case-1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft()}this._autoScrollTime=requestAnimationFrame((()=>{this._autoScrollFrame()}))}_startAutoScroll(){null==this._autoScrollTime&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(t){const e=this.getBoundingRect(),n=t.pageX-e.x;n<10&&(this._scrollIncremental=-Math.min(.1*Math.abs(n-10),50))}_scrollRight(t){const e=this.getBoundingRect(),n=t.pageX-e.x;n>e.width-10&&(this._scrollIncremental=Math.min(.1*Math.abs(n-(e.width-10)),50))}_sortedItems(){if(null!=this._activeTabItem&&null!=this._activeTabItemIndex&&null!=this._compareIndex&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let t=0;t<this._slideTabItems.length;t++){let e=this._slideTabItems[t],n=this._slideTabItems[t+1];n&&e.after(n)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let t=this._slideTabItems.findIndex((t=>t.equals(this._activeTabItem))),e=this._slideTabItems.length,n=[];for(let s=0;s<t&&!(s>=t);s++)n.push(this._slideTabItems[s]);for(let s=t+1;s<e;s++)this._slideTabItems[s].animate().translateX(0);let r=!0;for(let s=n.length-1;s>=0;s--){let t=n[s];ST.midline(this._activeTabItem)<t.getMidLine()?(t.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=s,r=!1):(t.animate().translateX(0),r&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let t=this._slideTabItems.findIndex((t=>t.equals(this._activeTabItem))),e=this._slideTabItems.length,n=[];for(let s=t+1;s<e;s++)n.push(this._slideTabItems[s]);for(let s=0;s<t;s++)this._slideTabItems[s].animate().translateX(0);let r=!0;for(let s=0;s<n.length;s++){let e=n[s];ST.midline(this._activeTabItem)>e.getMidLine()?(e.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=t+s+1,r=!1):(e.animate().translateX(0),r&&(this._compareIndex=this._activeTabItemIndex))}}}_initialize(){document.addEventListener("mousemove",this._moveAction),document.addEventListener("mouseup",this._upAction),this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((t=>{t.addEventListener("mousedown",this._downAction)}))}}class yT extends Xp{constructor(){super(...arguments),this.ref={current:null},this.ulRef={current:null},this.sheetContainerRef={current:null},this.slideTabRoot={current:null},this.sheetContentRef={current:null},this.sheetBarContentRef={current:null},this.time=0,this.target=null,this.cloneTarget=null,this._renderKey=1,this.setValue=(t,e)=>{let{sheetList:n,menuList:r,sheetUl:s}=t;n&&(n=this.resetLabel(n)),r&&(r=this.resetLabel(r)),s&&(s=this.resetLabel(s)),this.setState((e=>__spreadValues({},t)),e)},this.scrollLeft=t=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()-50)},this.scrollRight=t=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()+50)},this.overGrid=()=>{},this.contextMenu=t=>{t.preventDefault(),this.showUlList(t)},this.showSelect=(t,e)=>{t.stopImmediatePropagation();const n=e.current;n&&n.showMenu(!0),window.addEventListener("click",this.hideSelect)},this.hideSelect=t=>{const e=this.ulRef.current;e&&e.showMenu(!1),window.removeEventListener("click",this.hideSelect)},this.showUlList=t=>{new Promise((e=>{t.currentTarget.dataset.id,this.showSelect(t,this.ulRef),e()})).then((()=>{const e=t.currentTarget.closest(`.${QC}`);if(e){const t=e.getBoundingClientRect(),n=`${t.left}px`,r=`${t.height}px`,s=this.ulRef.current.base;s.style.left=n,s.style.bottom=r,s.style.top="auto",s.style.right="auto"}}))},this.reNameSheet=t=>{const e=this.slideTabBar.getSlideTabItems().find((e=>e.primeval().dataset.id===t));e&&e.editor()},this.changeEditable=t=>{const e=t.target;let n;e.contentEditable="true",e.focus(),e.addEventListener("blur",n=r=>{var s,o;null==(o=(s=this.props).changeSheetName)||o.call(s,t),e.contentEditable="false",e.removeEventListener("blur",n)})}}initialize(t){this.state={sheetList:[],sheetUl:[],menuList:[]}}resetLabel(t){var e,n;const r=null==(e=this.getContext().getPluginManager().getPluginByName(Su))?void 0:e.getComponentManager();for(let s=0;s<t.length;s++){const e=t[s];if(e.customLabel){const t=null==r?void 0:r.get(e.customLabel.name);if(t){const r=null!=(n=e.customLabel.props)?n:{};e.label=Vu(t,__spreadValues({},r))}}e.children&&(e.children=this.resetLabel(e.children))}return t}componentDidUpdate(){this.slideTabBar&&this.slideTabBar.destroy(),this.slideTabBar=new ET({slideTabBarClassName:"univer-slide-tab-bar",slideTabBarItemActiveClassName:"univer-slide-tab-active",slideTabBarItemClassName:"univer-slide-tab-item",slideTabBarItemAutoSort:!0,slideTabRoot:this.slideTabRoot.current,onChangeName:t=>{var e,n;null==(n=(e=this.props).changeSheetName)||n.call(e,t)},onSlideEnd:t=>{var e,n;null==(n=(e=this.props).dragEnd)||n.call(e,this.slideTabBar.getSlideTabItems().map((t=>t.primeval())))}})}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}render(t,e){const{sheetList:n,menuList:r,sheetUl:s}=e,{addSheet:o,selectSheet:i}=this.props;if(n.length)return Vu("div",{className:jC,ref:this.slideTabRoot},Vu("div",{className:$C},Vu(Zm,{className:KC,onClick:o,type:"text"},Vu(R_.AddIcon,{style:{fontSize:"20px"}})),Vu(Zm,{className:KC,onClick:t=>this.ref.current.showMenu(!0),type:"text"},Vu(fm,{style:{fontSize:"20px"}}),Vu(_T,{onClick:i,menu:r,ref:this.ref}))),Vu("div",{className:ZC,ref:this.sheetContainerRef},n.map((t=>Vu("div",{onMouseDown:t.onDown,onClick:t.onClick,onContextMenu:this.contextMenu,"data-id":t.sheetId,key:this._renderKey++,className:`${QC} ${t.selected?JC:""}`},Vu("div",{className:`${eT}`},Vu("div",{className:`${tT}`}),Vu("div",{className:`${nT}`},Vu("span",{className:`${rT}`,style:{padding:"2px 5px 2px 5px"}},t.label)),Vu("div",{className:`${sT}`,"data-slide-skip":"true",style:{lineHeight:1},"data-id":t.sheetId,onClick:this.contextMenu},Vu(um,null))),Vu("div",{className:`${oT}`},Vu("div",{className:`${iT}`,style:t.color?{background:t.color}:{}})))))),Vu(mv,{className:aT,menu:s,ref:this.ulRef}),Vu("div",{className:`${$C} ${qC}`},Vu(Zm,{type:"text",className:KC,onClick:this.scrollLeft},Vu(um,{rotate:90,style:{padding:"5px"}})),Vu(Zm,{type:"text",className:KC,onClick:this.scrollRight},Vu(um,{rotate:-90,style:{padding:"5px"}}))))}}var RT="univer-formula-box",IT="univer-formula-bar",AT="univer-formula-icon",OT="univer-formula-grey",NT="univer-formula-black",MT="univer-formula-input",xT="univer-formula-content";class kT extends Xp{constructor(){super(...arguments),this.onkeyUp=t=>{},this.printChange=t=>{this.onkeyUp(t.target)}}initialize(t){this.state={namedRanges:[{value:"1",label:"1"}],spanClass:OT,formulaContent:"",fx:null},this.onkeyUp=p_(this.onkeyUp,300)}setFormulaContent(t){this.setState({formulaContent:t})}setFx(t){this.setState({fx:t})}setNamedRanges(t){this.setState({namedRanges:t})}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}getIcon(t){var e;const n=null==(e=this.getContext().getPluginManager().getPluginByName(Su))?void 0:e.getComponentManager();return Vu(null==n?void 0:n.get(t),null)}render(t,e){const{namedRanges:n,fx:r}=e;return Vu("div",{className:RT},Vu("div",{className:IT},Vu("div",{className:AT},Vu("span",{className:e.spanClass},Vu(bm.CloseIcon,null)),Vu("span",{className:e.spanClass},Vu(bm.CorrectIcon,null)),r?Vu("span",{className:NT,onClick:r.onClick},this.getIcon(r.icon)):null),Vu("div",{className:MT},Vu("div",{autoFocus:!0,contentEditable:!0,className:xT,onKeyUp:t=>this.printChange(t)},e.formulaContent))))}}var DT="univer-rich-text-editor-container",LT="univer-rich-text-editor";class PT{constructor(t){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=t}updateFormat(t,e){if(t in this.inlineStyleAffectAttribute){"="!==this.editor.textContent.substr(0,1)&&this.updateInlineStringFormat(t,e)}}updateInlineStringFormat(t,e){var n;let r,s=window.getSelection();if("None"===(null==s?void 0:s.type)||(r=null==s?void 0:s.getRangeAt(0)),!r)return;let o=this.editor,i=r.endContainer,a=r.startContainer,l=r.endOffset,h=r.startOffset;if(o)if(a===i){let r,s=a.parentNode,i=!1,c=s.innerHTML;"<span"!==o.innerHTML.substr(0,5)&&(i=!0);let d="",u="",g="",p=0,_=h,m=l,f=c.length;d=c.substring(p,_),u=c.substring(_,m),g=c.substring(m,f);let v="";if(""!==d){let t=s.style.cssText;if(i){let e=s.closest(`.${DT}`);null!=e&&(t=this.extendCssText(e.style.cssText,t))}v+=`<span style='${t}'>${d}</span>`}if(""!==u){let n=this.getCssText(s.style.cssText,t,e);if(i){let t=s.closest(`.${DT}`);null!=t&&(n=this.extendCssText(t.style.cssText,n))}v+=`<span style='${n}'>${u}</span>`}if(""!==g){let t=s.style.cssText;if(i){let e=s.closest(`.${DT}`);null!=e&&(t=this.extendCssText(e.style.cssText,t))}v+=`<span style='${t}'>${g}</span>`}if("SPAN"===a.parentNode.tagName){r=c_("span",o).indexOf(s);let t=null==(n=s.parentElement)?void 0:n.innerHTML,e=s.outerHTML.replace("\\","");const i=null==t?void 0:t.replace(e,v);s.parentElement.innerHTML=i}else r=0,s.innerHTML=v;let b=0;b=p===_?r:r+1,__(o.querySelectorAll("span")[b])}else if("SPAN"===a.parentNode.tagName&&"SPAN"===i.parentNode.tagName){let n,r,s=a.parentNode,c=i.parentNode;n=c_("span",o).indexOf(s),r=c_("span",o).indexOf(c);let d=s.innerHTML,u=c.innerHTML,g="",p="",_="",m="",f=0,v=h,b=l,C=u.length;g=d.substring(f,v),p=d.substring(v,d.length),_=u.substring(0,b),m=u.substring(b,C);let T=Array.prototype.slice.call(o.querySelectorAll("span"));T.slice(n,r+1);let w,S,E="";for(let t=0;t<n;t++){let e=T[`${t}`],n=e.innerHTML;E+=`<span style='${e.style.cssText}'>${n}</span>`}if(""!==g&&(E+=`<span style='${s.style.cssText}'>${g}</span>`),""!==p){E+=`<span style='${this.getCssText(s.style.cssText,t,e)}'>${p}</span>`}if(n<r)for(let o=n+1;o<r;o++){let n=T[`${o}`],r=n.innerHTML;E+=`<span style='${this.getCssText(n.style.cssText,t,e)}'>${r}</span>`}if(""!==_){E+=`<span style='${this.getCssText(c.style.cssText,t,e)}'>${_}</span>`}""!==m&&(E+=`<span style='${c.style.cssText}'>${m}</span>`);for(let t=r+1;t<T.length;t++){let e=T[`${t}`],n=e.innerHTML;E+=`<span style='${e.style.cssText}'>${n}</span>`}o.innerHTML=E,f===v?(w=n,S=r):(w=n+1,S=r+1),T=o.querySelectorAll("span"),m_(T[`${w}`],T[`${S}`])}}extendCssText(t,e,n=!0){let r=t.split(";"),s=e.split(";"),o="",i={};for(let a=0;a<r.length;a++){let t=r[a],e=!0;t=t.toLowerCase();let l=v_(t.substr(0,t.indexOf(":")));if("font-size"===l)continue;let h=v_(t.substr(t.indexOf(":")+1));if(!n||l in this.inlineStyleAffectCssName){for(let t=0;t<s.length;t++){let n=s[t];n=n.toLowerCase();let r=v_(n.substr(0,n.indexOf(":"))),i=v_(n.substr(n.indexOf(":")+1));l!==r||(o+=`${r}:${i};`,e=!1)}e&&(o+=`${l}:${h};`),i[l]=1}}for(let a=0;a<s.length;a++){let t=s[a];t=t.toLowerCase();let e=v_(t.substr(0,t.indexOf(":"))),r=v_(t.substr(t.indexOf(":")+1));n&&!(e in this.inlineStyleAffectCssName)||(e in i||(o+=`${e}:${r};`))}return o}getCssText(t,e,n){let r={};if(r[e]=n,"un"===e){let e=this.getClassWithcss(t,"color");""===e&&(e="#000000");let n=this.getClassWithcss(t,"font-size"),s=parseInt(n);""===n&&(s=11),r._fontSize=s,r._color=e}let s=this.getFontStyleByCell(r,void 0,void 0,!1),o=v_(s&&s.substr(0,s.indexOf(":"))),i=v_(s&&s.substr(s.indexOf(":")+1));return i=i.substr(0,i.length-1),t=this.removeClassWidthCss(t,e),t=this.upsetClassWithCss(t,o,i)}getClassWithcss(t,e){let n=t.split(";");if(null==e||0===e.length)return t;if(t.indexOf(e)>-1)for(let r=0;r<n.length;r++){let t=n[r];t=t.toLowerCase();let s=v_(t.substr(0,t.indexOf(":"))),o=v_(t.substr(t.indexOf(":")+1));if(s===e)return o}return""}removeClassWidthCss(t,e){let n=t.split(";"),r="",s=e;if(null==e||0===e.length)return t;if(e in this.univerToCssName&&(e=this.univerToCssName[e]),t.indexOf(e)>-1)for(let o=0;o<n.length;o++){let t=n[o];t=t.toLowerCase();let i=v_(t.substr(0,t.indexOf(":"))),a=v_(t.substr(t.indexOf(":")+1));i===e||"cl"===s&&"lucky-strike"===i||"un"===s&&"lucky-underline"===i||i.length>0&&(r+=`${i}:${a};`)}else r=t;return r}upsetClassWithCss(t,e,n){let r=t.split(";"),s="";if(null==e||0===e.length)return t;if(t.indexOf(e)>-1)for(let o=0;o<r.length;o++){let t=r[o];t=t.toLowerCase();let i=v_(t.substr(0,t.indexOf(":"))),a=v_(t.substr(t.indexOf(":")+1));i===e?s+=`${i}:${n};`:i.length>0&&(s+=`${i}:${a};`)}else e.length>0&&(s=t+=`${e}:${n};`);return s}getFontStyleByCell(t,e,n,r=!0){if(null==t)return"";let s="";for(let o in t){let i=t[o];if(r&&(i=this.checkstatusByCell(t,o)),"bl"===o&&"0"!==i&&(s+="font-weight: bold;"),"it"===o&&"0"!==i&&(s+="font-style:italic;"),"ff"===o){s+=`font-family: ${i};`}if("fs"===o&&"10"!==i&&(s+=`font-size: ${i}pt;`),("fc"===o&&"#000000"!==i||null!=e||null!=n&&null!=n.textColor)&&(null!=n&&null!=n.textColor?s+=`color: ${n.textColor};`:s+=null!=e?`color: ${e[0]};`:`color: ${i};`),"bg"===o&&"#ffffff"!==i&&"#fff"!==i&&(s+=`background: ${i};`),"cl"===o&&"0"!==i&&(s+="text-decoration: line-through;"),"un"===o&&("1"===i||"3"===i)){let e=t._color;null==e&&(e=t.fc);let n=t._fontSize||11;null==n&&(n=t.fs||11),s+=`border-bottom: ${Math.floor(n/9)}px solid ${e};`}}return s}checkstatusByCell(t,e){let n;return e in{bl:1,it:1,ff:1,cl:1,un:1}?null==n?n="0":(n=n[e],null==n&&(n="0")):"fc"===e?null==n?n="#000000":(n=n[e],null==n&&(n="#000000"),n.indexOf("rgba")>-1&&(n=Je.rgbColorToHexValue(n))):"bg"===e?null==n?n=null:(n=n[e],null==n?n=null:n.toString().indexOf("rgba")>-1&&(n=Je.rgbColorToHexValue(n))):"bs"===e.substr(0,2)?null==n?n="none":(n=n[e],null==n&&(n="none")):"bc"===e.substr(0,2)?null==n?n="#000000":(n=n[e],null==n&&(n="#000000")):"ht"===e?(null==n?n="1":(n=n[e],null==n&&(n="1")),-1===["0","1","2"].indexOf(n.toString())&&(n="1")):"vt"===e?(null==n?n="0":(n=n[e],null==n&&(n="0")),-1===["0","1","2"].indexOf(n.toString())&&(n="0")):"ct"===e?null==n?n=null:(n=n[e],null==n&&(n=null)):"fs"===e?null==n?n="10":(n=n[e],null==n&&(n="10")):"tb"===e||"tr"===e?null==n?n="0":(n=n[e],null==n&&(n="0")):"rt"===e&&(null==n?n=null:(n=n[e],null==n&&(n=null))),n}}class BT extends Xp{constructor(){super(...arguments),this.container={current:null},this.ref={current:null},this.hooks=new Map}initialize(t){}setValue(t){this.ref.current&&(this.ref.current.innerHTML=C_(t))}getValue(){var t;return(null==(t=this.ref.current)?void 0:t.innerHTML)||""}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(t){const e=this.hooks.get("onKeyDown");e&&e(t),"Enter"===t.key&&t.preventDefault()}onKeyUp(t){const e=this.hooks.get("onKeyUp");e&&e(t),"Enter"===t.key&&t.preventDefault()}componentWillMount(){}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this),this.cellTextStyle=new PT(this.ref.current)}componentWillUnmount(){}render(t,e){const{style:n,className:r="",onClick:s,text:o}=t;return Vu("div",{className:`${DT} ${r}`,style:n,ref:this.container},Vu("div",{ref:this.ref,className:LT,onClick:s,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:o||""},contentEditable:!0}))}}class HT extends Xp{constructor(){super(...arguments),this.refMap=new Map}initialize(){this.state={slotGroup:new Map}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}setSlotGroup(t,e){this.setState({slotGroup:t},e)}getSlotGroup(){return this.refMap}getRender(t){const e=[];return t.forEach(((n,r)=>{var s,o;const i=null==(s=t.get(r))?void 0:s.component,a=null==(o=t.get(r))?void 0:o.props;i&&e.push(Vu(i,__spreadValues({ref:t=>{this.refMap.set(r,t)}},a)))})),e}render(){const{slotGroup:t}=this.state;return Vu("div",null,this.getRender(t))}}var FT="univer-toolbar-warp",UT="univer-toolbar",zT="univer-select-label-string",WT="univer-select-double-string",VT="univer-select-color-picker-parent",YT="univer-select-color-picker",GT="univer-select-line-bold-parent",XT="univer-text-button",jT="univer-more-button",$T="univer-more-tool",KT="univer-tooltip-title",qT="univer-bottom";class ZT extends Xp{constructor(){super(...arguments),this.toolbarRef={current:null},this.moreBtnRef={current:null},this.moreToolRef={current:null},this.SelectRef={current:null},this.clientWidth=0,this.debounceSetToolbarListWidth=p_((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let t=this.state.showMore;this.setState({showMore:!t}),t||document.addEventListener("click",this.hide,!0)},this.hide=t=>{this.moreToolRef.current.contains(t.target)||(t.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const t=this.toolbarRef.current.querySelectorAll(`.${FT} > div`),e=this.moreBtnRef.current.clientWidth;let n=60+e,r=null;const s=document.documentElement.clientWidth;if(s<=this.clientWidth){this.clientWidth=s;for(let e=0;e<t.length;e++)if(n+=t[e].clientWidth+6,n>s){r=e;break}null!==r&&this.setState({defaultToolList:this.state.toolList.slice(0,r),moreToolList:r?this.state.toolList.slice(r):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=s,this.state.moreToolList.length){let n=30+e;for(let e=0;e<t.length;e++)n+=t[e].clientWidth+6;const r=this.moreToolRef.current.querySelectorAll(`.${$T} > div`);let o=null,i=!1;for(let t=0;t<r.length;t++){if(n+=r[t].clientWidth+6,n>s){o=t;break}t===r.length-1&&(o=t,i=!0)}null!==o&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,i?o+1:o)),moreToolList:i?[]:this.state.moreToolList.slice(o)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=t=>{var e,n,r;const s=null==(e=this.getContext().getPluginManager().getPluginByName(Su))?void 0:e.getComponentManager();for(let o=0;o<t.length;o++){const e=w_(t[o],this.getLocale.bind(this));if(e.customLabel){const t=null==s?void 0:s.get(e.customLabel.name);if(t){const r=null!=(n=e.customLabel.props)?n:{};e.label=Vu(t,__spreadValues({},r))}}if(e.customSuffix){const t=null==s?void 0:s.get(e.customSuffix.name);if(t){const n=null!=(r=e.customSuffix.props)?r:{};e.suffix=Vu(t,__spreadValues({},n))}}e.children&&(e.children=this.resetLabel(e.children))}return t},this.setToolbar=t=>{this.setState({toolList:t,defaultToolList:t},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var t;const e=`${(null==(t=this.getContext().getPluginManager().getPluginByName(Su))?void 0:t.getAppUIController().getSheetContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let r=0;r<n.length;r++)n[r].style.maxHeight=e}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(t){return(t=this.resetLabel(t)).map((t=>{if(t.toolbarType){if(t.show)return Vu(zv,{title:this.getLocale(t.tooltip),placement:"bottom"},Vu(Zm,{unActive:t.unActive,className:XT,type:"text",active:t.active,onClick:t.onClick},t.label))}else if(t.show)return Vu(Bb,{tooltip:this.getLocale(t.tooltip),type:t.type,display:t.display,children:t.children,customLabel:t.customLabel,customSuffix:t.customSuffix,label:t.label,onClick:t.onClick,onPressEnter:t.onPressEnter,onMainClick:t.onMainClick,defaultColor:t.defaultColor,hideSelectedIcon:t.hideSelectedIcon,className:t.className});return null}))}render(){const{defaultToolList:t,moreToolList:e,showMore:n}=this.state;return Vu(Qf,{style:{position:"relative"}},Vu("div",{className:`${FT} ${UT}`,ref:this.toolbarRef},this.getToolbarList(t),Vu("div",{ref:this.moreBtnRef,className:jT,style:{visibility:e.length?"visible":"hidden"}},Vu(zv,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},Vu(Zm,{type:"text",onClick:this.showMore},Vu("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),e.length?Vu("div",{style:{visibility:n?"visible":"hidden"},className:`${$T} ${UT}`,ref:this.moreToolRef},this.getToolbarList(e)):"")}}ZT.contextType=Dg;class JT extends Xp{constructor(t){super(),this.splitLeftRef={current:null},this.contentRef={current:null},this.handleSplitBarMouseDown=t=>{var e,n,r,s,o;this.leftContentLeft=null==(e=this.splitLeftRef.current)?void 0:e.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const i=null==(r=this.splitLeftRef.current)?void 0:r.parentElement;this.rightBorderX=null==(s=null==i?void 0:i.getBoundingClientRect())?void 0:s.width,this.rightBorderY=null==(o=null==i?void 0:i.getBoundingClientRect())?void 0:o.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=t=>{var e;const n=null==(e=this.props.config.layout)?void 0:e.sheetContainerConfig;let r=(t=t||window.event).clientX-this.leftContentLeft,s=t.clientY-this.leftContentTop;r=r>=this.rightBorderX?this.rightBorderX:r,s=s>=this.rightBorderY?this.rightBorderY:s,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${s}px`:this.splitLeftRef.current.style.width=`${r}px`},this.handleSplitBarMouseUp=t=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(t.config.container,"default")}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(t,e){let n=document.documentElement;const r="string"==typeof t?t:t.id;let s={default:zb}[e];if(s=Object.fromEntries(Object.keys(s).map((t=>[`--${t.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,s[t]]))),C.isIEBrowser())pC({rootElement:n,variables:s});else{(function(t){const e="universheet-skin-style";for(let s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].title===e)return o(document.styleSheets[s],t),document.styleSheets[s];const n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.title=e,n.appendChild(r),document.styleSheets[document.styleSheets.length-1]})(r).insertRule(`#${r} ${JSON.stringify(s).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function o(t,e){let n=0;for(let r=0;r<t.cssRules.length;r++){const s=t.cssRules[r];if(s instanceof CSSStyleRule&&s.selectorText===`#${e}`){n=r,t.deleteRule(n);break}}}}render(){const{methods:t}=this.props,{layout:e}=this.props.config,n=null==e?void 0:e.sheetContainerConfig;return Vu(Qf,{className:SC},Vu(av,null,Vu(dv,{style:{display:n.outerLeft?"block":"none"}}),Vu(av,{className:OC,style:{position:"relative"}},Vu(lv,{style:{display:n.header?"block":"none"}},n.infoBar&&Vu(LC,__spreadValues({},t.infoBar)),n.toolbar&&Vu(ZT,__spreadValues({},t.toolbar)),n.formulaBar&&Vu(kT,__spreadValues({},t.formulaBar))),Vu(av,null,Vu(dv,{style:{display:n.innerLeft?"block":"none"}}),Vu(cv,{className:"vertical"===n.contentSplit?AC:EC},Vu(HT,__spreadValues({},t.slot)),!!n.contentSplit&&Vu(Qf,{ref:this.splitLeftRef,className:yC},Vu("div",{className:RC,onMouseDown:this.handleSplitBarMouseDown})),Vu(Qf,{onContextMenu:t=>t.preventDefault(),ref:this.contentRef,className:IC},n.rightMenu&&Vu(FC,__spreadValues({},t.rightMenu)),Vu(BT,__spreadValues({},t.cellEditor)))),Vu(dv,{style:{display:n.innerRight?"block":"none"}})),Vu(hv,{style:{display:n.footer?"block":"none"}},n.sheetBar&&Vu(yT,__spreadValues({},t.sheetBar)),n.countBar&&Vu(XC,__spreadValues({},t.countBar)))),Vu(dv,{style:{display:n.outerRight?"block":"none"},className:NC})))}}class QT extends Xp{constructor(t){super(t),this.state={locale:this.props.locale}}setLocale(t){const e=t.target.value;this.props.changeLocale(e),this.setState({locale:e})}render(){const{context:t,UIConfig:e}=this.props,{locale:n}=this.state;return Vu(Dg.Provider,{value:{context:t,locale:n}},Vu("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},Vu("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),Vu("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},Vu("option",{value:"en"},"English"),Vu("option",{value:"zh"},""))),Vu(JT,__spreadValues({},e)))}}var tw="univer-color-select",ew="univer-color-select-line";class nw extends Xp{componentDidMount(){var t,e,n;const r=null==(t=this.getContext().getPluginManager().getPluginByName(Su))?void 0:t.getComponentManager();let s=this.props.label;if(this.props.customLabel){s=Vu(null==r?void 0:r.get(this.props.customLabel.name),__spreadValues({},this.props.customLabel.props))}this.setState({label:s,color:this.props.color}),null==(n=(e=this.props).getComponent)||n.call(e,this)}componentWillReceiveProps(t){this.setState({color:t.color})}setColor(t){this.setState({color:t})}render(){return Vu("div",{className:tw},Vu("div",null,this.state.label),Vu("div",{className:ew,style:{background:this.state.color}}))}}class rw extends Xp{initialize(){this.state={img:""}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}componentWillReceiveProps(t){this.setState({img:t.img})}setImg(t=""){this.setState({img:t})}getImg(t){var e;if(!t)return null;const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},r=null==(e=this.getContext().getPluginManager().getPluginByName(Su))?void 0:e.getComponentManager();return Vu(null==r?void 0:r.get(t),__spreadValues({},n))}render(){const{img:t}=this.state,{label:e}=this.props;return Vu("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},Vu("span",{className:"base-sheets-line-bold",style:{position:"relative"}},this.getLocale(e),Vu("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"14px"}},t.length?this.getImg(t):"")),Vu(gm,null))}}class sw extends Xp{initialize(){this.state={color:this.props.color}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}componentWillReceiveProps(t){this.setState({color:t.color})}setColor(t){this.setState({color:t})}render(){const{color:t}=this.state,{label:e}=this.props;return Vu("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},Vu("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},this.getLocale(e)),Vu(gm,null))}}class ow{constructor(t){this._initialize(t)}static create(t){return new ow(t)}_initialize(t){let e;const n=t.container;if("string"==typeof n){const t=document.getElementById(n);null==t?(e=document.createElement("div"),e.id=n):e=t}else l_(n)?e=n:(e=document.createElement("div"),e.id="univer");ug(Vu(QT,__spreadValues({},t)),e)}}class iw{constructor(t,e){this.getComponent=t=>{this._rightMenu=t,this.setMenuList()},this._plugin=t,this._sheetPlugin=t.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(ze.SPREADSHEET),this._config=C.deepMerge({},Eu,e),this._menuList=[{label:"rightClick.insertRow",onClick:()=>this.insertRow(),show:this._config.InsertRow},{label:"rightClick.insertColumn",onClick:()=>this.insertColumn(),show:this._config.InsertColumn},{customLabel:{name:UC.name,props:{prefix:"rightClick.toTopAdd",suffix:"rightClick.row"}},show:this._config.AddRowTop},{customLabel:{name:UC.name,props:{prefix:"rightClick.toBottomAdd",suffix:"rightClick.row"}},show:this._config.AddRowBottom},{customLabel:{name:UC.name,props:{prefix:"rightClick.toLeftAdd",suffix:"rightClick.column"}},show:this._config.AddColumnLeft},{customLabel:{name:UC.name,props:{prefix:"rightClick.toRightAdd",suffix:"rightClick.column"}},show:this._config.AddColumnRight},{label:"rightClick.deleteSelectedRow",onClick:()=>this.deleteRow(),show:this._config.DeleteRow},{label:"rightClick.deleteSelectedColumn",onClick:()=>this.deleteColumn(),show:this._config.DeleteColumn},{label:"rightClick.hideSelectedRow",show:this._config.HideRow},{label:"rightClick.showHideRow",show:this._config.ShowRow},{customLabel:{name:UC.name,props:{prefix:"rightClick.rowHeight",suffix:"px",onKeyUp:this.setRowHeight.bind(this)}},onClick:()=>{},show:this._config.RowHeight},{label:"rightClick.hideSelectedColumn",show:this._config.HideColumn},{label:"rightClick.showHideColumn",show:this._config.ShowColumn},{customLabel:{name:UC.name,props:{prefix:"rightClick.columnWidth",suffix:"px",onKeyUp:this.setColumnWidth.bind(this)}},show:this._config.ColumnWidth},{show:this._config.DeleteCell,customLabel:{name:zC.name,props:{label:"rightClick.deleteCell"}},border:!0,children:[{label:"rightClick.moveLeft",className:BC,onClick:()=>this.deleteCellLeft()},{label:"rightClick.moveUp",className:BC,onClick:()=>this.deleteCellTop()}]},{label:"rightClick.clearContent",onClick:()=>this.clearContent(),border:!0,show:this._config.ClearContent}],this._initialize()}setMenuList(){var t;null==(t=this._rightMenu)||t.setMenuList(this._menuList)}setUIObserve(t){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(t)}insertRow(){this.setUIObserve({name:"insertRow"})}insertColumn(){this.setUIObserve({name:"insertColumn"})}deleteRow(){this.setUIObserve({name:"deleteRow"})}deleteColumn(){this.setUIObserve({name:"deleteColumn"})}setRowHeight(t){if("Enter"!==t.key)return;const e={name:"setRowHeight",value:t.target.value};this.setUIObserve(e)}setColumnWidth(t){if("Enter"!==t.key)return;const e={name:"setColumnWidth",value:t.target.value};this.setUIObserve(e)}deleteCellLeft(){this.setUIObserve({name:"moveLeft"})}deleteCellTop(){this.setUIObserve({name:"moveTop"})}clearContent(){this.setUIObserve({name:"clearContent"})}_initialize(){this._plugin.getComponentManager().register(UC.name,UC),this._plugin.getComponentManager().register(zC.name,zC),this._sheetPlugin.getMainComponent().onPointerDownObserver.add((t=>{2===t.button&&(t.preventDefault(),this._rightMenu.handleContextMenu(t))}))}}const aw=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],lw=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimHei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.Kaiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.FangSong",style:{"font-family":""},value:""},{labelLocale:"fontFamily.NSimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXinwei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXingkai",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STLiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],hw=[{labelLocale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{labelLocale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{labelLocale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{labelLocale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{labelLocale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{labelLocale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{labelLocale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{labelLocale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{labelLocale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{labelLocale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],cw=[{labelLocale:"borderLine.borderNone",value:St.NONE},{customLabel:{name:"BorderThin"},value:St.THIN},{customLabel:{name:"BorderHair"},value:St.HAIR},{customLabel:{name:"BorderDotted"},value:St.DOTTED},{customLabel:{name:"BorderDashed"},value:St.DASHED},{customLabel:{name:"BorderDashDot"},value:St.DOTTED},{customLabel:{name:"BorderDashDotDot"},value:St.DASH_DOT_DOT},{customLabel:{name:"BorderMedium"},value:St.MEDIUM},{customLabel:{name:"BorderMediumDashed"},value:St.MEDIUM_DASHED},{customLabel:{name:"BorderMediumDashDot"},value:St.MEDIUM_DASH_DOT},{customLabel:{name:"BorderMediumDashDotDot"},value:St.MEDIUM_DASH_DOT_DOT},{customLabel:{name:"BorderThick"},value:St.THICK}],dw=[{labelLocale:"merge.all",value:"all"},{labelLocale:"merge.vertical",value:"vertical"},{labelLocale:"merge.horizontal",value:"horizontal"},{labelLocale:"merge.cancel",value:"cancel"}],uw=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],gw=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],pw=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],_w=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var mw,fw;(fw=mw||(mw={}))[fw.SELECT=0]="SELECT",fw[fw.BUTTON=1]="BUTTON";class vw{constructor(t,e){this._textColor="#000",this._background="#fff",this._borderInfo={type:yt.ALL,color:"#000",style:1},this.getComponent=t=>{this._toolbar=t,this.setToolbar()},this._plugin=t,this._sheetPlugin=t.getContext().getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(ze.SPREADSHEET),this._config=C.deepMerge({},yu,e),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",unActive:!0,customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",unActive:!0,customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:zT,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:t=>{this.setFontFamily(t)},children:lw},{type:1,tooltip:"toolbar.fontSize",label:String(Le.fs),name:"fontSize",show:this._config.fontSize,onClick:t=>{this.setFontSize(t)},onMainClick:()=>{this.hideTooltip()},onPressEnter:t=>{this.setFontSize(t),this.hideTooltip()},children:aw},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,name:"bold",show:this._config.bold,onClick:(t,e)=>{this.setFontWeight(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},name:"italic",show:this._config.italic,onClick:(t,e)=>{this.setFontStyle(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},name:"strikethrough",show:this._config.strikethrough,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"strikethrough"===t.name));n&&(n.active=e,this.setStrikeThrough(e))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},name:"underline",show:this._config.underline,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"underline"===t.name));n&&(n.active=e,this.setUnderline(e))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:Su+nw.name,props:{getComponent:t=>{this._colorSelect1=t},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"textColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:VT,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:Su+Kf.name,props:{onClick:(t,e)=>{this._colorSelect1.setColor(t),this._textColor=t}}},className:YT}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:Su+nw.name,props:{getComponent:t=>{this._colorSelect2=t},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"fillColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:VT,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:Su+Kf.name,props:{onClick:(t,e)=>{this._colorSelect2.setColor(t),this._background=t}}},className:YT}],name:"fillColor",show:this._config.fillColor},{type:3,display:1,show:this._config.border,tooltip:"toolbar.border.main",className:WT,onClick:t=>{t&&(this._borderInfo.type=t),this.hideTooltip(),this.setBorder()},name:"border",children:[...hw,{name:"borderColor",customLabel:{name:Su+sw.name,props:{color:"#000",label:"borderLine.borderColor",getComponent:t=>this._lineColor=t}},unSelectable:!0,className:VT,children:[{customLabel:{name:Su+Kf.name,props:{onClick:(t,e)=>{var n;this._lineColor.setColor(t),this._borderInfo.color=t;const r=this._toolList.find((t=>"border"===t.name)),s=null==(n=null==r?void 0:r.children)?void 0:n.find((t=>"borderColor"===t.name));s&&s.customLabel&&s.customLabel.props&&(s.customLabel.props.color=t)}}},className:YT,onClick:(...t)=>{t[0].stopPropagation()}}]},{customLabel:{name:Su+rw.name,props:{img:0,label:"borderLine.borderSize",getComponent:t=>this._lineBold=t}},onClick:(...t)=>{var e;t[0].stopPropagation(),this._lineBold.setImg(null==(e=cw[t[2]].customLabel)?void 0:e.name),this._borderInfo.style=t[1]},className:GT,unSelectable:!0,children:cw}]},{type:5,tooltip:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:this._config.mergeCell,onClick:t=>{this.setMerge(null!=t?t:"all"),this.hideTooltip()},name:"mergeCell",children:dw},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:WT,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:t=>{this.setHorizontalAlignment(t),this.hideTooltip()},children:uw},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:WT,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:t=>{this.setVerticalAlignment(t),this.hideTooltip()},children:gw},{type:3,className:WT,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:t=>{this.setWrapStrategy(t),this.hideTooltip()},children:pw},{type:3,className:WT,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:t=>{this.setTextRotation(t),this.hideTooltip()},children:_w}],this._initialize()}addToolbarConfig(t){this._toolList.findIndex((e=>e.name===t.name))>-1||this._toolList.push(t)}deleteToolbarConfig(t){const e=this._toolList.findIndex((e=>e.name===t));e>-1&&this._toolList.splice(e,1)}setToolbar(){var t;null==(t=this._toolbar)||t.setToolbar(this._toolList)}setUIObserve(t){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(t)}changeColor(t){var e,n;const r=this._toolList.find((t=>"strikethrough"===t.name)),s=this._toolList.find((t=>"underline"===t.name));this.setFontColor(t),s&&this.setUnderline(null!=(e=s.active)&&e),r&&this.setStrikeThrough(null!=(n=r.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(t){const e={name:"fontFamily",value:t};this.setUIObserve(e)}setFontSize(t){const e={name:"fontSize",value:t};this.setUIObserve(e)}setFontWeight(t){const e={name:"fontWeight",value:t};this.setUIObserve(e)}setFontStyle(t){const e={name:"fontStyle",value:t};this.setUIObserve(e)}setStrikeThrough(t){const e={name:"strikeThrough",value:t};this.setUIObserve(e)}setUnderline(t){const e={name:"underLine",value:t};this.setUIObserve(e)}setFontColor(t){const e={name:"fontColor",value:t};this.setUIObserve(e)}setBackground(t){const e={name:"background",value:t};this.setUIObserve(e)}setMerge(t){const e={name:"merge",value:t};this.setUIObserve(e)}setTextRotation(t){const e={name:"textRotation",value:t};this.setUIObserve(e)}setWrapStrategy(t){const e={name:"wrapStrategy",value:t};this.setUIObserve(e)}setVerticalAlignment(t){const e={name:"verticalAlignment",value:t};this.setUIObserve(e)}setHorizontalAlignment(t){const e={name:"horizontalAlignment",value:t};this.setUIObserve(e)}setBorder(){const t={name:"borderInfo",value:this._borderInfo};this.setUIObserve(t)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${KT}.${qT}`).forEach((t=>{t.style.display="none"}))}_changeToolbarState(t){var e,n,r,s,o,i,a,l;if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet()){const h=t.getFontWeight(),c=t.getFontStyle(),d=t.getStrikeThrough(),u=t.getFontSize(),g=t.getFontWeight(),p=t.getFontFamily(),_=t.getFontStyle(),m=t.getUnderline(),f=null!=(e=t.getHorizontalAlignment())?e:ae.LEFT,v=null!=(n=t.getVerticalAlignment())?n:he.BOTTOM,b=t.getTextRotation(),C=null!=(r=t.getWrapStrategy())?r:de.CLIP,T=this._toolList.find((t=>"bold"===t.name)),w=this._toolList.find((t=>"italic"===t.name)),S=this._toolList.find((t=>"textRotateMode"===t.name)),E=this._toolList.find((t=>"fontSize"===t.name)),y=this._toolList.find((t=>"font"===t.name)),R=this._toolList.find((t=>"bold"===t.name)),I=this._toolList.find((t=>"italic"===t.name)),A=this._toolList.find((t=>"strikethrough"===t.name)),O=this._toolList.find((t=>"underline"===t.name)),N=this._toolList.find((t=>"horizontalAlignMode"===t.name)),M=this._toolList.find((t=>"verticalAlignMode"===t.name)),x=this._toolList.find((t=>"textWrapMode"===t.name));T&&(T.active=h===_e.BOLD),w&&(w.active=c===ge.ITALIC),A&&(A.active=!(!d||!d.s)),y&&(null==(s=y.children)||s.forEach((t=>{t.selected=p===t.value}))),E&&(E.label=u.toString()),R&&(R.active=!!g),I&&(I.active=!!_),O&&(O.active=!(!m||!m.s)),N&&(null==(o=N.children)||o.forEach((t=>{t.selected=f===t.value}))),S&&(null==(i=S.children)||i.forEach((t=>{b.v?t.selected="v"===t.value:t.selected=b.a===t.value}))),M&&(null==(a=M.children)||a.forEach((t=>{t.selected=v===t.value}))),x&&(null==(l=x.children)||l.forEach((t=>{t.selected=C===t.value}))),this.setToolbar()}}_initialize(){this._plugin.getComponentManager().register(Su+nw.name,nw),this._plugin.getComponentManager().register(Su+Kf.name,Kf),this._plugin.getComponentManager().register(Su+sw.name,sw),this._plugin.getComponentManager().register(Su+rw.name,rw),Br.getCommandObservers().add((({actions:t})=>{if(!t||0===t.length)return;const e=t[0];if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId()!==e.getWorkBook().getUnitId())return;const n=this._sheetPlugin.getSelectionManager(),r=null==n?void 0:n.getCurrentCell();r&&this._changeToolbarState(r)}))}}class bw{constructor(t){this.getComponent=t=>{this._richText=t,this._initRichText()},this._plugin=t,this._sheetPlugin=t.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(ze.SPREADSHEET),this._initialize()}getCellEditor(){return this._richText}hideEditContainer(){this._richTextEle.style.maxHeight="1px",this._richTextEle.style.maxWidth="1px",this._richTextEle.style.minWidth="1px",this._richTextEle.style.minHeight="1px",this._richTextEle.style.borderWidth="0px",this._richTextEle.style.transform="scale(0)"}enterEditMode(t=!1){var e,n,r,s;if(this.focusEditEle(),this.isEditMode)return;setTimeout((()=>{T_(this._richTextEditEle)}),1),this.isEditMode=!0;const o=this._sheetPlugin.getSelectionManager().getCurrentCellModel();if(!o)return!1;let i,a,l,h;if(o.isMerged){const t=o.mergeInfo;i=t.startX,a=t.endX,l=t.startY,h=t.endY}else i=o.startX,a=o.endX,l=o.startY,h=o.endY;const c=(null==(n=null==(e=this._sheetPlugin.getMainScene())?void 0:e.getViewport(Ed.VIEW_TOP))?void 0:n.actualScrollX)||0,d=(null==(s=null==(r=this._sheetPlugin.getMainScene())?void 0:r.getViewport(Ed.VIEW_LEFT))?void 0:s.actualScrollY)||0;this._richTextEle.style.left=i-c+"px",this._richTextEle.style.top=l-d+"px",this._richTextEle.style.minWidth=a-i+"px",this._richTextEle.style.minHeight=h-l+"px",this._richTextEle.style.borderWidth="2px";const u=b_(this._plugin.getAppUIController().getSheetContainerController().getContentRef()).getBoundingClientRect();this._richTextEle.style.maxWidth=`${u.width-i+c}px`,this._richTextEle.style.maxHeight=`${u.height-l+d}px`,this._richTextEle.style.transform="";let g=this._sheetPlugin.getCellEditorController().getSelectionValue();const p=this._cellEditExtensionManager.handle({row:o.row,column:o.column,value:g});p&&(g=p.value),t&&(g=""),this._richText.setValue(g);const _=this._sheetPlugin.getCellEditorController().getSelectionStyle();this._richTextEditEle.style.cssText="",_&&(this._richTextEditEle.style.cssText=Dn(_,!0)),this._sheetPlugin.getCellEditorController().setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const t=Xm(this._richTextEditEle),e=this._richTextEditEle.innerText;let n={};"string"==typeof t?(n.v=t,n.m=t):"object"==typeof t&&(n.p=t,n.v=e,n.m=e);const r=jm(this._richTextEditEle);C.isPlainObject(r)&&(n.s=r),this._sheetPlugin.getCellEditorController().setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout((()=>{this._richTextEditEle.focus()}),100)}getRichTextEle(){return this._richTextEle}getRichTextEditEle(){return this._richTextEditEle}_initialize(){const t=this._sheetPlugin.getMainComponent();t.onDblclickObserver.add((t=>{2!==t.button&&this.enterEditMode()})),t.onPointerDownObserver.add((t=>{this.exitEditMode(),t.preventDefault()})),this._cellEditExtensionManager=new Cg,this._keyboardManager=new Lg(this._plugin)}_initRichText(){this._richTextEle=b_(this._richText.container),this._richTextEditEle=c_("div",this._richTextEle),this._richTextEditEle.focus(),this.hideEditContainer(),this._keyboardManager.handleKeyboardAction(this._richTextEditEle),this._handleKeyboardObserver(),this._richText.hooks.set("onKeyDown",(t=>{var e;null==(e=this._plugin.getObserver("onRichTextKeyDownObservable"))||e.notifyObservers(t)})),this._richText.hooks.set("onKeyUp",(t=>{var e;null==(e=this._plugin.getObserver("onRichTextKeyUpObservable"))||e.notifyObservers(t)}))}_handleKeyboardObserver(){const t=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyDownObservable","core"),e=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyCompositionStartObservable","core");t&&!t.hasObservers()&&t.add((t=>{if(!t.ctrlKey&&Qn(t.key))this.enterEditMode(!0);else switch(t.key){case"Enter":if(this.isEditMode){this.exitEditMode();const t=this._sheetPlugin.getSelectionManager().getCurrentCellModel();(null==t?void 0:t.isMerged)||this._sheetPlugin.getSelectionManager().move(Ft.BOTTOM)}else this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode(!0);break;case"ArrowUp":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Ft.TOP);break;case"ArrowDown":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Ft.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Ft.LEFT);break;case"ArrowRight":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Ft.RIGHT);break;case"Tab":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Ft.RIGHT),t.preventDefault()}})),e&&!e.hasObservers()&&e.add((t=>{this.isEditMode||this.enterEditMode(!0)}))}}class Cw{constructor(t){var e;this.onChange=t=>{this._setUIObserve("onUIChangeObservable",{name:"changeZoom",value:C.numberFixed(parseFloat(t)/100,2)})},this.getComponent=t=>{this._countBar=t,this._refreshComponent()},this._plugin=t,Br.getActionObservers().add((t=>{const e=t.action,n=t.data;if(e.getWorkBook().getUnitId()===this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId())switch(n.actionName){case Lo.NAME:this._refreshCountBarUI()}}));const n=t.getContext().getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getRequirePluginByName(ze.SPREADSHEET).getSelectionManager();null==(e=t.getObserver("onChangeSelectionObserver"))||e.add((()=>{const t=n.getActiveRangeList();t&&this._countBar&&this._totalRangeList(t)}))}setCountBar(t){this._countBar.setValue({content:t})}_totalRangeList(t){let e=t.getRangeList(),n=[],r=this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet().getCellMatrix(),s=0,o=0,i=0;for(let a=0;a<e.length;a++){let t=e[a];for(let e=t.startRow;e<=t.endRow;e++)for(let s=t.startColumn;s<=t.endColumn;s++){if(n.includes(`${e}${s}`))continue;const t=r.getValue(e,s);if(t){let e=parseFloat(t.v);isNaN(e)||(i+=1,o+=e)}n.push(`${e}${s}`)}}i>0&&(s=o/i),this._countBar.setState({content:`${C.numberFixed(s,2)} ${C.numberFixed(o,2)} ${i}`})}_refreshCountBarUI(){}_refreshComponent(){this._refreshCountBarUI()}_setUIObserve(t,e){this._plugin.getContext().getObserverManager().requiredObserver(t,"core").notifyObservers(e)}}class Tw{constructor(t){this.getComponent=t=>{this._formulaBar=t,this._initFormulaBar()},this._plugin=t,this._sheetPlugin=t.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(ze.SPREADSHEET),this._initialize()}getFormulaBar(){return this._formulaBar}_initialize(){var t;null==(t=this._sheetPlugin.getObserver("onChangeSelectionObserver"))||t.add((t=>{var e,n;const r=t.model.currentCell;if(r){let t;if(r.isMerged){const e=r.mergeInfo;t={startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn}}else{const{row:e,column:n}=r;t={startRow:e,endRow:e,startColumn:n,endColumn:n}}const s=this._sheetPlugin.getWorkbook().getActiveSheet().getRange(t).getObjectValue({isIncludeStyle:!0});if(s){let n=String(s.m||s.v||"");const r=this._cellInputExtensionManager.handle({row:t.startRow,column:t.startColumn,value:n});r&&(n=r.value),null==(e=this._formulaBar)||e.setFormulaContent(n)}else null==(n=this._formulaBar)||n.setFormulaContent("")}})),this._cellInputExtensionManager=new yg}_initFormulaBar(){this._namedRanges=this._sheetPlugin.getContext().getWorkBook().getConfig().namedRanges;const t=this._namedRanges.map((t=>({value:t.name,label:t.name})));this._formulaBar.setNamedRanges(t)}}class ww{constructor(t){this._name=t}get name(){return this._name}setName(t){this._name=t}}class Sw{constructor(t){this.getComponent=t=>{this._infoBar=t,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=t}resetInfoList(t){const e=this._plugin.getContext().getLocale();for(let n in t)t[n].locale&&(t[n].label=e.get(t[n].locale));this._infoBar.setInfoList(t)}setSheetName(t){const e=t.target.value;this._infoBarModel.setName(e)}_refreshComponent(){const t=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getConfig().name;this._infoBarModel=new ww(t),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},sheet:{label:t,onBlur:t=>{this.setSheetName(t)}}}}}class Ew{constructor(t){var e,n;this.getComponent=t=>{this._sheetBar=t,this._refreshComponent()},this.addSheet=(t,e)=>{this.setUIObserve("onUIChangeObservable",{name:"addSheet",value:{position:t,config:e}})},this.changeSheetName=t=>{this.setUIObserve("onUIChangeObservable",{name:"renameSheet",value:{sheetId:this._dataId,sheetName:t.target.innerText}})},this.dragEnd=t=>{let e=[],n=this._dataId;Array.from(t).forEach((t=>{const n=this._sheetList.find((e=>e.sheetId===t.dataset.id));n&&e.push(n)})),e.forEach(((t,e)=>{t.sheetId===n&&this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().setSheetOrder(t.sheetId,e)}))};let r=this;this._plugin=t,this._sheetUl=[{locale:"sheetConfig.delete",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"deleteSheet",value:this._dataId})}},{locale:"sheetConfig.copy",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"copySheet"})}},{locale:"sheetConfig.rename",onClick:()=>{this._sheetBar.reNameSheet(this._dataId)}},{locale:"sheetConfig.changeColor",border:!0,className:lT,children:[{customLabel:{name:this._plugin.getPluginName()+Kf.name,props:{onClick:t=>{this.setUIObserve("onUIChangeObservable",{name:"changeSheetColor",value:{color:t,sheetId:this._dataId}})}}},className:hT}]},{locale:"sheetConfig.hide",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"hideSheet",value:this._dataId})}},{locale:"sheetConfig.unhide",onClick:()=>{this._sheetBar.ref.current.showMenu(!0),r.setUIObserve("onUIChangeObservable",{name:"unHideSheet",value:this._dataId})}}],null==(e=this._plugin.getPluginByName(Su))||e.getComponentManager().register(this._plugin.getPluginName()+Kf.name,Kf),Br.getActionObservers().add((t=>{const e=t.action,n=t.data;if(e.getWorkBook().getUnitId()===this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId())switch(n.actionName){case yo.NAME:case Oo.NAME:case Qs.NAME:case oo.NAME:case ko.NAME:case Io.NAME:case Do.NAME:case Mo.NAME:this._refreshSheetData(),this._refreshSheetBarUI()}})),null==(n=this._plugin.getPluginByName(Su))||n.getComponentManager().register(this._plugin.getPluginName()+Kf.name,Kf)}resetLabel(t){const e=this._plugin.getGlobalContext().getLocale();let n="";return t instanceof Array?t.forEach((t=>{t.includes(".")?n+=e.get(t):n+=t})):t.includes(".")?n=e.get(t):n+=t,n}findLocale(t){for(let e in t)if("locale"===e)t.label=this.resetLabel(t[e]);else if(e.endsWith("Locale")){const n=e.indexOf("Locale");t[e.slice(0,n)]=this.resetLabel(t[e])}else t[e].$$typeof||("[object Object]"===Object.prototype.toString.call(t[e])?this.findLocale(t[e]):"[object Array]"===Object.prototype.toString.call(t[e])&&(t[e]=this.resetSheetUl(t[e])));return t}setUIObserve(t,e){this._plugin.getContext().getObserverManager().requiredObserver(t,"core").notifyObservers(e)}getSheetBar(){return this._sheetBar}getDataId(){return this._dataId}getSheetList(){return this._sheetList}getMenuList(){return this._menuList}resetSheetUl(t){for(let e=0;e<t.length;e++){let n=t[e];n=this.findLocale(n),n.children&&(n.children=this.resetSheetUl(n.children))}return t}selectSheet(){}deleteSheet(){}sortMenu(t,e,n){}copySheet(){}hideSheet(){}unHideSheet(){this._sheetBar.ref.current.showSelect()}moveSheet(t){}contextMenu(t){this._sheetBar.contextMenu(t)}_refreshSheetBarUI(){this._sheetBar.setValue({sheetList:this._sheetList,sheetUl:this._sheetUl,menuList:this._menuList,selectSheet:(t,e)=>{this._dataId=e.item.sheetId;const n=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheetBySheetId(this._dataId);n&&n.activate()},contextMenu:t=>{const e=t.currentTarget;this._dataId=e.dataset.id},changeSheetName:t=>{},dragEnd:t=>{}})}_refreshSheetData(){const t=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheets();this._menuList=t.map(((t,e)=>({label:t.getName(),index:String(e),sheetId:t.getSheetId(),hide:1===t.isSheetHidden(),selected:1===t.getStatus(),onClick:e=>{if(e){const n=e.currentTarget;this._dataId=n.dataset.id,t.showSheet(),t.activate()}}}))),this._sheetList=t.filter((t=>!t.isSheetHidden())).map(((t,e)=>({sheetId:t.getSheetId(),label:t.getName(),index:String(e),selected:1===t.getStatus(),color:t.getTabColor(),onDown:t=>{const e=t.currentTarget;this._dataId=e.dataset.id},onClick:e=>{const n=e.currentTarget;this._dataId=n.dataset.id,t.activate()}}))),this._sheetIndex=t.findIndex((t=>1===t.getStatus())),this._sheetIndex>-1&&(this._dataId=t[this._sheetIndex].getSheetId())}_refreshComponent(){this._sheetUl=this.resetSheetUl(this._sheetUl),this._refreshSheetData(),this._refreshSheetBarUI()}}class yw{constructor(){this._slotGroup=new Map,this.getComponent=t=>{this._slot=t}}addSlot(t,e,n){var r;this._slotGroup.get(t)||(this._slotGroup.set(t,{component:e.component,props:null!=(r=e.props)?r:{}}),this.setSlot(n))}getSlot(t){return this._slot.getSlotGroup().get(t)}removeSlot(t){this._slotGroup.delete(t),this.setSlot()}setSlot(t){var e;null==(e=this._slot)||e.setSlotGroup(this._slotGroup,t)}}class Rw{constructor(t){var e,n;this.getComponent=t=>{var e;this._sheetContainer=t,null==(e=this._plugin.getObserver("onUIDidMount"))||e.notifyObservers(this._sheetContainer),this._initSheetContainer()},this.changeLocale=t=>{this._plugin.getContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._config=this._plugin.getConfig(),this._initialize(),this._slotController=new yw,this._toolbarController=new vw(this._plugin,null==(e=this._config.layout)?void 0:e.toolbarConfig),this._cellEditorUIController=new bw(this._plugin),this._formulaBarUIController=new Tw(this._plugin),this._infoBarController=new Sw(this._plugin),this._rightMenuController=new iw(this._plugin,null==(n=this._config.layout)?void 0:n.rightMenuConfig),this._countBarController=new Cw(this._plugin),this._sheetBarController=new Ew(this._plugin)}getUIConfig(){return{context:this._plugin.getContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},cellEditor:{getComponent:this._cellEditorUIController.getComponent},formulaBar:{getComponent:this._formulaBarUIController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent},rightMenu:{getComponent:this._rightMenuController.getComponent},countBar:{getComponent:this._countBarController.getComponent,onChange:this._countBarController.onChange},sheetBar:{getComponent:this._sheetBarController.getComponent,addSheet:this._sheetBarController.addSheet,selectSheet:this._sheetBarController.selectSheet,dragEnd:this._sheetBarController.dragEnd,changeSheetName:this._sheetBarController.changeSheetName},slot:{getComponent:this._slotController.getComponent}}}}getContentRef(){return this._sheetContainer.getContentRef()}setEventManager(){this._plugin.getUniver().getAllUniverSheetsInstance().forEach((t=>{t.getWorkBook().getContext().getPluginManager().getRequirePluginByName(ze.SPREADSHEET).listenEventManager()}))}getEventManager(){return this._eventManager}getCellEditorUIController(){return this._cellEditorUIController}getFormulaBarUIController(){return this._formulaBarUIController}getMainSlotController(){return this._slotController}getToolbarController(){return this._toolbarController}UIDidMount(t){var e;if(this._sheetContainer)return t(this._sheetContainer);null==(e=this._plugin.getObserver("onUIDidMount"))||e.add((()=>t(this._sheetContainer)))}_initialize(){this._dragManager=new Pg(this._plugin),this._eventManager=new Bg(this._plugin),this.setEventManager()}_initSheetContainer(){this._dragManager.handleDragAction(b_(this._sheetContainer))}}class Iw{constructor(t){this.changeLocale=t=>{this._plugin.getGlobalContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._sheetContainerController=new Rw(this._plugin);const e=this._sheetContainerController.getUIConfig();ow.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:e,container:this._plugin.getConfig().container})}getSheetContainerController(){return this._sheetContainerController}}class Aw extends Po{constructor(t){super(Su),this._config=C.deepMerge({},Iu,t)}static create(t){return new Aw(t)}installTo(t){t.installPlugin(this)}initialize(t){Nu(this),this.getLocale().load({zh:Au,en:Ou}),this._componentManager=new Ym,this._registerManager=new Gm(this),this._appUIController=new Iw(this),this.UIDidMount((()=>{this.initRender()}))}getConfig(){return this._config}initRender(){var t;const e=null==(t=this.getPluginByName(ze.BASE_RENDER))?void 0:t.getEngine();let n=b_(this._appUIController.getSheetContainerController().getContentRef());e.setContainer(n),window.addEventListener("resize",(()=>{e.resize()})),setTimeout((()=>{e.resize()}),0)}initUI(){}onMounted(t){this.initialize(t)}onDestroy(){}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}setFormulaContent(t){this._appUIController.getSheetContainerController().getFormulaBarUIController().getFormulaBar().setFormulaContent(t)}setFx(t){this._appUIController.getSheetContainerController().getFormulaBarUIController().getFormulaBar().setFx(t)}UIDidMount(t){this._appUIController.getSheetContainerController().UIDidMount(t)}addSlot(t,e,n){this._appUIController.getSheetContainerController().getMainSlotController().addSlot(t,e,n)}addToolButton(t){this._appUIController.getSheetContainerController().getToolbarController().addToolbarConfig(t)}deleteToolButton(t){this._appUIController.getSheetContainerController().getToolbarController().deleteToolbarConfig(t)}}var Ow=Object.freeze(Object.defineProperty({__proto__:null,SHEET_UI_PLUGIN_NAME:Su,DefaultRightMenuConfig:Eu,DefaultToolbarConfig:yu,DefaultSheetContainerConfig:Ru,DefaultSheetUiConfig:Iu,zh:Au,en:Ou,uninstallObserver:function(t){t.deleteObserve("onRichTextKeyDownObservable"),t.deleteObserve("onRichTextKeyUpObservable"),t.deleteObserve("onUIDidMount")},installObserver:Nu,RightMenuUIController:iw,ToolbarUIController:vw,SheetContainerUIController:Rw,InfoBarUIController:Sw,SheetUIPlugin:Aw},Symbol.toStringTag,{value:"Module"}));const Nw={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:rt.COLUMN,posOffset:100},positionV:{relativeFrom:ot.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:z.WRAP_SQUARE,behindDoc:be.FALSE,wrapText:F.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:y.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:21},{bulletAlignment:y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:42},{bulletAlignment:y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:y.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:21},{bulletAlignment:y.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:42},{bulletAlignment:y.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"shapeTest1",et:B.DRAWING,st:0,ed:0},{eId:"smallSub",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:fe.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}},{blockId:"twoParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"threeParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2018"}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"17"}}]}},{blockId:"fourParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"fiveParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"3-23"}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Mw={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:fe.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},xw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:["sheet-01","sheet-02","sheet-03","sheet-04","sheet-05","sheet-06"],pluginMeta:{},styles:{1:{cl:{rgb:"blue"},fs:16,bd:{t:{s:St.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:St.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:St.THICK,cl:{rgb:"black"}},b:{s:St.THIN,cl:{rgb:"red"}}},ht:3},2:{bg:{rgb:"rgb(200, 2, 0)"},fs:24,ht:ae.RIGHT,vt:he.TOP},3:{ht:ae.RIGHT,vt:he.MIDDLE,tb:de.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:be.FALSE},bd:{t:{s:St.THIN,cl:{rgb:"black"}},l:{s:St.THIN,cl:{rgb:"black"}},r:{s:St.THIN,cl:{rgb:"black"}},b:{s:St.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}},5:{tb:de.WRAP}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-01":{type:ee.GRID,id:"sheet-01",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:1,m:"1"},1:{v:1,m:"1"},2:{v:80,m:"80",s:"3"},3:{v:"",m:"",s:"2"}},2:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:" MVCMVPMVVM ",s:"3",p:Mw}},20:{10:{v:"20141019",s:"3"},12:{s:"4"}},29:{13:{p:C.deepClone(Mw),s:"4"}},32:{3:{p:Nw,s:"5"}}},name:"sheet1",tabColor:"red",hidden:be.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10},{startRow:32,endRow:53,startColumn:3,endColumn:5}],rowData:{3:{h:50,hd:be.FALSE},4:{h:60,hd:be.FALSE},29:{h:200,hd:be.FALSE}},columnData:{5:{w:100,hd:be.FALSE},6:{w:200,hd:be.FALSE},13:{w:300,hd:be.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}},"sheet-02":{type:ee.GRID,id:"sheet-02",name:"sheet2",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},20:{0:{v:"sheet2",m:"sheet2"},1:{v:"sheet2 - 2",m:"sheet2 - 2"}}}},"sheet-03":{type:ee.GRID,id:"sheet-03",name:"sheet3"},"sheet-04":{type:ee.GRID,id:"sheet-04",name:"sheet4"},"sheet-05":{type:ee.GRID,id:"sheet-05",name:"sheet5"},"sheet-06":{type:ee.GRID,id:"sheet-06",name:"sheet6"}},namedRanges:[{namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}},{namedRangeId:"named-range-02",name:"namedRange02",range:{sheetId:"sheet-01",rangeData:{startRow:4,startColumn:2,endRow:5,endColumn:3}}}]},kw={id:"workbook-02",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{cl:{rgb:"green"},fs:16,bd:{t:{s:St.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:St.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:St.THICK,cl:{rgb:"black"}},b:{s:St.THIN,cl:{rgb:"blue"}}},ht:3},2:{bg:{rgb:"rgb(2, 200, 0)"},fs:24},3:{ht:ae.RIGHT,vt:he.TOP,tb:de.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:be.FALSE},bd:{t:{s:St.THIN,cl:{rgb:"black"}},l:{s:St.THIN,cl:{rgb:"black"}},r:{s:St.THIN,cl:{rgb:"black"}},b:{s:St.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:ee.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",v:2,m:"2"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:22,m:"22"},1:{v:22,m:"22"},2:{v:80,m:"80",s:"3"},3:{v:"",m:"",s:"2"}},2:{0:{v:2222,m:"2222"},1:{v:2222,m:"2222"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:" MVCMVPMVVM ",s:"3",p:Mw}},20:{10:{v:"20141019",s:"3"},12:{s:"4"}},29:{13:{p:C.deepClone(Mw),s:"4"}}},name:"sheet0001",tabColor:"green",hidden:be.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10}],rowData:{3:{h:50,hd:be.FALSE},4:{h:60,hd:be.FALSE},29:{h:200,hd:be.FALSE}},columnData:{5:{w:100,hd:be.FALSE},6:{w:200,hd:be.FALSE},13:{w:300,hd:be.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}},"sheet-0002":{type:ee.GRID,id:"sheet-0002",name:"sheet0003"}},namedRanges:[{namedRangeId:"named-range-0001",name:"namedRange0001",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Dw={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:y.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:21},{bulletAlignment:y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:42},{bulletAlignment:y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:y.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:21},{bulletAlignment:y.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:42},{bulletAlignment:y.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:S.ROMAN,hanging:21,indentStart:63}]}},Lw={id:"d",lists:Dw,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:B.TEXT_RUN,tr:{ct:"Whats New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:be.TRUE,fs:16,cl:{rgb:"rgb(255,255,255)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:B.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:12,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p4",st:402,ed:429,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:B.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:B.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:12,bl:be.TRUE}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:B.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:12,bl:be.TRUE}}}]}},{blockId:"p5",st:430,ed:479,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:B.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:B.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:12,cl:{rgb:"rgb(0, 0, 0)"},bl:be.TRUE}}}]}},{blockId:"p6",st:480,ed:510,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:B.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Pw={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement",et:B.PAGE_BREAK,st:0,ed:0},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement1",et:B.PAGE_BREAK,st:0,ed:0},{eId:"threeElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement2",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fourElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement3",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fiveElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Bw={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Hw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"UniverSheet Demo",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:St.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},57:{ht:1,vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:ee.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:Bw,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)                                                         ",s:"49"},7:{m:"(Lower) ",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:be.FALSE,freezeColumn:1,rowCount:13,columnCount:14,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}},"sheet-0003":{type:ee.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"},7:{p:Lw,s:"57"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:be.FALSE,freezeColumn:1,rowCount:100,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:200}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}},"sheet-0002":{type:ee.GRID,id:"sheet-0002",name:"sheet0002",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"",s:"123"}}},tabColor:"yellow",hidden:be.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}},"sheet-0001":{type:ee.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:Pw}}},name:"sheet0001",tabColor:"red",hidden:be.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:0,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Fw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:St.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0003":{type:ee.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:be.FALSE,freezeColumn:1,rowCount:27,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:30}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0003",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Uw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:St.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0002":{type:ee.GRID,id:"sheet-0002",name:"sheet0003",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"",s:"123"}}},tabColor:"yellow",hidden:be.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},zw={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement",et:B.PAGE_BREAK,st:0,ed:0},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement1",et:B.PAGE_BREAK,st:0,ed:0},{eId:"threeElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement2",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fourElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement3",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fiveElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Ww={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:St.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:ee.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:zw}}},name:"sheet0001",tabColor:"red",hidden:be.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Vw={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Yw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:St.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:St.THIN,cl:{rgb:"#000"}},l:{s:St.THIN,cl:{rgb:"#000"}},r:{s:St.THIN,cl:{rgb:"#000"}},b:{s:St.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:St.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:St.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:St.THIN,cl:{rgb:"#fff"}},r:{s:St.THIN,cl:{rgb:"#fff"}},b:{s:St.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:ee.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:Vw,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)                                                         ",s:"49"},7:{m:"(Lower) ",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:be.FALSE,freezeColumn:1,rowCount:10,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Gw={id:"workbook-01",theme:"default",locale:Kt.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:be.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}},6:{ht:1,vt:2,tb:3,bg:{rgb:"rgba(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:St.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:ee.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:be.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"},9:{p:Lw,s:"6"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1},{startRow:1,endRow:10,startColumn:9,endColumn:10}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:be.FALSE},columnTitle:{height:20,hidden:be.FALSE},selections:["A2"],rightToLeft:be.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Xw={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:rt.COLUMN,posOffset:100},positionV:{relativeFrom:ot.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:z.WRAP_SQUARE,behindDoc:be.FALSE,wrapText:F.BOTH_SIDES}},lists:Dw,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"shapeTest1",et:B.DRAWING,st:0,ed:0},{eId:"smallSub",st:16,ed:17,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:fe.SUPERSCRIPT}}},{eId:"twoElement",st:18,ed:59,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}},{blockId:"twoParagraph",st:60,ed:88,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:60,ed:74,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:75,ed:88,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"threeParagraph",st:89,ed:230,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:89,ed:138,et:B.TEXT_RUN,tr:{ct:"2018"}},{eId:"twoElement",st:139,ed:230,et:B.TEXT_RUN,tr:{ct:"17"}}]}},{blockId:"fourParagraph",st:231,ed:322,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:231,ed:286,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:287,ed:322,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"fiveParagraph",st:323,ed:400,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:[{eId:"oneElement",st:323,ed:360,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:361,ed:400,et:B.TEXT_RUN,tr:{ct:"3-23"}}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:20}],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},jw={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:222.6,height:129.6},positionH:{relativeFrom:rt.COLUMN,posOffset:130},positionV:{relativeFrom:ot.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/gartner-tech-2022.png"}},layoutType:z.WRAP_SQUARE,behindDoc:be.FALSE,wrapText:F.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:254.8,height:234.3},positionH:{relativeFrom:rt.COLUMN,posOffset:130},positionV:{relativeFrom:ot.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:z.WRAP_SQUARE,behindDoc:be.FALSE,wrapText:F.BOTH_SIDES}},lists:Dw,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:B.TEXT_RUN,tr:{ct:"Whats New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:be.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:B.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}]}},{blockId:"p4",st:402,ed:429,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:B.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}]}},{blockId:"p5",st:430,ed:479,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:B.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}]}},{blockId:"p6",st:480,ed:510,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:B.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}]}},{blockId:"p7",st:511,ed:705,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:511,ed:672,et:B.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},{eId:"e2",st:673,ed:705,et:B.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:be.TRUE}}}]}},{blockId:"p8",st:706,ed:762,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:[{eId:"e1",st:706,ed:762,et:B.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p9",st:763,ed:1233,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:763,ed:1233,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}},{eId:"shapeTest1",st:0,ed:0,et:B.DRAWING}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}},{blockId:"p10",st:1234,ed:1576,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1234,ed:1576,et:B.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}]}},{blockId:"p11",st:1577,ed:1972,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1577,ed:1972,et:B.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}]}},{blockId:"p12",st:1973,ed:2047,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1973,ed:2047,et:B.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:B.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:be.TRUE}}},{eId:"e2",st:2071,ed:2278,et:B.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:B.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:be.TRUE}}},{eId:"e2",st:2294,ed:2421,et:B.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:B.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:be.TRUE}}},{eId:"e2",st:2451,ed:2610,et:B.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}]}},{blockId:"twoSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},$w={id:"cover_1",pageType:Ge.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:je.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},Kw={id:"catalog_1",pageType:Ge.SLIDE,zIndex:2,title:"catalog",description:"this is second page, catalog",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:3,left:180,top:240,width:200,height:40,title:"Catalog",description:"",type:je.TEXT,richText:{text:"Catalog",fs:42,cl:{rgb:"rgb(255,255,255)"}}},centerRect1:{id:"centerRect1",zIndex:2,left:140,top:168,width:203,height:203,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},firstRect1:{id:"firstRect1",zIndex:2,left:547,top:115,width:44,height:44,title:"index1",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},secondRect1:{id:"secondRect1",zIndex:2,left:547,top:210,width:44,height:44,title:"index2",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},thirdRect1:{id:"thirdRect1",zIndex:2,left:547,top:304,width:44,height:44,title:"index2",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},forth1:{id:"forth1",zIndex:2,left:547,top:397,width:44,height:44,title:"index2",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},first_index1:{id:"first_index1",zIndex:3,left:557,top:120,width:44,height:44,title:"mask",description:"",type:je.TEXT,richText:{text:"01",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},first_title1:{id:"first_title1",zIndex:3,left:610,top:115,width:248,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"Strategic technology trends",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},first_detail1:{id:"first_detail1",zIndex:3,left:610,top:140,width:300,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"How they impact business goals.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},second_index1:{id:"second_index1",zIndex:3,left:557,top:215,width:44,height:44,title:"mask",description:"",type:je.TEXT,richText:{text:"02",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},second_title1:{id:"second_title1",zIndex:3,left:610,top:210,width:248,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"Technical profile",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},second_detail1:{id:"second_detail1",zIndex:3,left:610,top:235,width:300,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"What the technologies are and do.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},third_index1:{id:"third_index1",zIndex:3,left:557,top:310,width:44,height:44,title:"mask",description:"",type:je.TEXT,richText:{text:"03",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},third_title1:{id:"third_title1",zIndex:3,left:610,top:305,width:248,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"Opportunities",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},third_detail1:{id:"third_detail1",zIndex:3,left:610,top:330,width:300,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"What benefits and outcomes they drive.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},forth_index1:{id:"forth_index1",zIndex:3,left:557,top:405,width:44,height:44,title:"mask",description:"",type:je.TEXT,richText:{text:"04",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},forth_title1:{id:"forth_title1",zIndex:3,left:610,top:400,width:248,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"Implementation steps",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},forth_detail1:{id:"forth_detail1",zIndex:3,left:610,top:425,width:300,height:39,title:"mask",description:"",type:je.TEXT,richText:{text:"Action plans for implementation.",fs:14,cl:{rgb:"rgb(255,255,255)"}}}}},qw={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:je.TEXT,richText:{rich:{id:"d",lists:Dw,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Zw={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:je.TEXT,richText:{rich:{id:"d",lists:Dw,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Jw={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:je.TEXT,richText:{rich:{id:"d",lists:Dw,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Qw={id:"strategic_1",pageType:Ge.SLIDE,zIndex:1,title:"cover",description:"this is third page, strategic",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:je.TEXT,richText:{text:"Strategic technology trends",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:je.TEXT,richText:{text:"We expect the 2023 trends to impact enterprise strategies in the coming three years by enabling organizations to address four key priorities:",fs:18,cl:{rgb:"rgb(127,127,127)"}}},chart1:{id:"chart1",zIndex:2,left:53,top:214,width:125,height:58,title:"chart1",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(105,126,146)"}}}},chartTitle1:{id:"chartTitle1",zIndex:3,left:53,top:186,width:84,height:28,title:"chartTitle1",description:"",type:je.TEXT,richText:{text:"Optimize",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber1:{id:"chartNumber1",zIndex:3,left:63,top:230,width:61,height:36,title:"chartNumber1",description:"",type:je.TEXT,richText:{text:"20%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart2:{id:"chart2",zIndex:2,left:178,top:214,width:428,height:58,title:"chart2",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(57,74,87)"}}}},chartTitle2:{id:"chartTitle2",zIndex:3,left:178,top:186,width:59,height:28,title:"chartTitle2",description:"",type:je.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber2:{id:"chartNumber2",zIndex:3,left:188,top:230,width:61,height:36,title:"chartNumber2",description:"",type:je.TEXT,richText:{text:"50%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart3:{id:"chart3",zIndex:2,left:605,top:214,width:302,height:58,title:"chart3",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},chartTitle3:{id:"chartTitle3",zIndex:3,left:605,top:186,width:74,height:28,title:"chartTitle3",description:"",type:je.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber3:{id:"chartNumber3",zIndex:3,left:615,top:230,width:61,height:36,title:"chartNumber3",description:"",type:je.TEXT,richText:{text:"30%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:53,top:326,width:152,height:28,title:"detailTitle1",description:"",type:je.TEXT,richText:{text:"Theme 1: Optimize",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:qw,detailTitle2:{id:"detailTitle2",zIndex:3,left:334,top:326,width:129,height:28,title:"detailTitle2",description:"",type:je.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent2:Zw,detailTitle3:{id:"detailTitle3",zIndex:3,left:652,top:326,width:143,height:28,title:"detailTitle3",description:"",type:je.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent3:Jw}},tS=Gw.sheets[Gw.sheetOrder[0]],eS=Gw.styles,nS={id:"business_1",pageType:Ge.SLIDE,zIndex:2,title:"business",description:"this is second page, business",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:je.TEXT,richText:{text:"The Business Objectives",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:je.TEXT,richText:{text:"What we hope to achieve in the short and long run",fs:18,cl:{rgb:"rgb(127,127,127)"}}},spreadSheet1:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:je.SPREADSHEET,spreadsheet:{worksheet:tS,styles:eS}}}},rS={id:"technology_1",pageType:Ge.SLIDE,zIndex:2,title:"technology",description:"this is second page, technology",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:je.TEXT,richText:{text:"Sustainable Technology",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:je.TEXT,richText:{text:"Delivering technology alone will not be enough in 2023",fs:18,cl:{rgb:"rgb(127,127,127)"}}},picture1:{id:"picture1",zIndex:2,left:53,top:151,width:258,height:156,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P1.png"}}},picture2:{id:"picture2",zIndex:2,left:315,top:151,width:241,height:156,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P2.png"}}},picture3:{id:"picture3",zIndex:2,left:53,top:310,width:258,height:156,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P3.png"}}},picture4:{id:"picture4",zIndex:2,left:310,top:315,width:241,height:156,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P4.jpg"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"detailTitle1",description:"",type:je.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:{id:"detailContent1",zIndex:3,left:580,top:167,width:373,height:81,title:"detailContent1",description:"",type:je.TEXT,richText:{text:"Investments in sustainable technology also have the potential to create greater operational resiliency and financial performance, while providing new avenues for growth.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitle1:{id:"listTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"listTitle1",description:"",type:je.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},listTitlePicture1:{id:"listTitlePicture1",zIndex:2,left:572,top:261,width:53,height:53,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon1.png"}}},listContent1:{id:"listContent1",zIndex:3,left:637,top:265,width:309,height:61,title:"listContent1",description:"",type:je.TEXT,richText:{text:"Gartners Top 10 Strategic Technology Trends will help fulfill your business needs to optimize, scale or pioneer.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture2:{id:"listTitlePicture2",zIndex:2,left:572,top:341,width:53,height:53,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon2.png"}}},listContent2:{id:"listContent2",zIndex:3,left:637,top:345,width:309,height:61,title:"listContent2",description:"",type:je.TEXT,richText:{text:"The trends allow you to align your technology innovation with the future strategic objectives of your enterprise.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture3:{id:"listTitlePicture3",zIndex:2,left:572,top:421,width:53,height:53,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon3.png"}}},listContent3:{id:"listContent3",zIndex:3,left:637,top:425,width:309,height:61,title:"listContent3",description:"",type:je.TEXT,richText:{text:"Investments in sustainable technology provide operational and financial benefits, and can create growth opportunities.",fs:12,cl:{rgb:"rgb(127,127,127)"}}}}},sS={id:"richText_1",pageType:Ge.SLIDE,zIndex:2,title:"business",description:"this is fix page, rich text",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:je.TEXT,richText:{text:"The Work-like Editor",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:je.TEXT,richText:{text:"Open source WYSIWYG editor built for the modern web",fs:18,cl:{rgb:"rgb(127,127,127)"}}},document:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:je.DOCUMENT,document:jw}}};function oS(t=1,e){const n={id:"slide_unlimited",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{unlimited_1:{id:"unlimited_1",pageType:Ge.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:je.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},catalog_1:Kw,strategic_1:Qw,technology_1:rS,richText_1:sS,business_1:nS},pageOrder:["unlimited_1","catalog_1","strategic_1","technology_1","richText_1","business_1"]}};return e&&(n.body.pages.unlimited_1.pageElements.slide={id:"slide",zIndex:3,left:960*(1-t)/2,top:540*(1-t)/2,width:960,height:540,scaleX:t,scaleY:t,title:"slide",description:"",type:je.SLIDE,slide:e}),n}const iS={id:"unlimited_1",pageType:Ge.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:je.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:je.SHAPE,shape:{shapeType:Ie.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:je.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:je.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}},slide1:{id:"slide",zIndex:3,left:960*(1-.9)/2,top:540*(1-.9)/2,width:960,height:540,scaleX:.9,scaleY:.9,title:"slide",description:"",type:je.SLIDE,slide:oS(.9,oS(.9,oS(.9,oS(.9,oS(.9,oS(.9,oS(.9,oS(.9,oS(.9)))))))))}}},aS={id:"slide_test",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{cover_1:$w,catalog_1:Kw,strategic_1:Qw,technology_1:rS,richText_1:sS,business_1:nS,unlimited_1:iS},pageOrder:["cover_1","catalog_1","strategic_1","technology_1","richText_1","business_1","unlimited_1"]}};var lS=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_WORKBOOK_DATA:xw,DEFAULT_WORKBOOK_DATA_DOWN:kw,DEFAULT_WORKBOOK_DATA_DEMO:Hw,DEFAULT_WORKBOOK_DATA_DEMO1:Fw,DEFAULT_WORKBOOK_DATA_DEMO2:Uw,DEFAULT_WORKBOOK_DATA_DEMO3:Ww,DEFAULT_WORKBOOK_DATA_DEMO4:Yw,SLIDE_WORKBOOK_DATA:Gw,DEFAULT_DOCUMENT_DATA:Xw,DEFAULT_DOCUMENT_DATA_EN:jw,DEFAULT_SLIDE_DATA:aS},Symbol.toStringTag,{value:"Module"}));class hS{constructor(){}init(t={}){const e=new ri;e.install(new Sd);const n=ti.newInstance(t.coreConfig);return e.addUniverSheet(n),n.installPlugin(new Tu(t.baseSheetsConfig)),e.install(new Aw(t.uiSheetsConfig)),n}}return t.BaseComponent=Ub,t.BaseRender=Rd,t.BaseSheets=wu,t.CommonPluginData=lS,t.UIPluginSheets=Ow,t.UniverCore=Ai,t.univerSheetCustom=function(t){return(new hS).init(t)},Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),t}({});
